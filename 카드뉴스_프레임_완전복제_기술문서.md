# ğŸ¨ ì¹´ë“œë‰´ìŠ¤ í”„ë ˆì„ ì™„ì „ ë³µì œ ê¸°ìˆ  ë¬¸ì„œ

> Hospital AIì˜ ì¹´ë“œë‰´ìŠ¤ í”„ë ˆì„ ì™„ì „ ë³µì œ ì‹œìŠ¤í…œ
> 
> **ì‘ì„±ì¼**: 2026-01-21  
> **ì‘ì„±ì**: Hospital AI Development Team  
> **ê¸°ìˆ  ìŠ¤íƒ**: TypeScript, React, Google Gemini AI 3 Pro Image Preview

---

## ğŸ“‹ ëª©ì°¨

1. [ê°œìš”](#ê°œìš”)
2. [ì „ì²´ íë¦„](#ì „ì²´-íë¦„)
3. [í•µì‹¬ ì½”ë“œ ë¶„ì„](#í•µì‹¬-ì½”ë“œ-ë¶„ì„)
4. [í”„ë ˆì„ ë³µì œ ë©”ì»¤ë‹ˆì¦˜](#í”„ë ˆì„-ë³µì œ-ë©”ì»¤ë‹ˆì¦˜)
5. [ì‹¤ì œ ë™ì‘ ì˜ˆì‹œ](#ì‹¤ì œ-ë™ì‘-ì˜ˆì‹œ)
6. [ì „ì²´ ë°ì´í„° íë¦„](#ì „ì²´-ë°ì´í„°-íë¦„)
7. [í•µì‹¬ ì •ë¦¬](#í•µì‹¬-ì •ë¦¬)
8. [ì¥ì  ë° í™œìš©](#ì¥ì -ë°-í™œìš©)

---

## ê°œìš”

### ë¬¸ì œ ì •ì˜

ì¹´ë“œë‰´ìŠ¤ ì œì‘ ì‹œ ë§¤ë²ˆ ìƒˆë¡œìš´ ë””ìì¸ì„ ë§Œë“¤ë©´:
- âŒ ë¸Œëœë”© ì¼ê´€ì„± ë¶€ì¡±
- âŒ ì‹œê°„ ì†Œìš” ì¦ê°€
- âŒ í’ˆì§ˆ í¸ì°¨ ë°œìƒ

### í•´ê²° ë°©ì•ˆ

**í”„ë ˆì„ ë³µì œ ì‹œìŠ¤í…œ**: ê²€ì¦ëœ ë””ìì¸ì˜ ë ˆì´ì•„ì›ƒë§Œ ë³µì œí•˜ê³ , ë‚´ìš©ì€ ìƒˆë¡­ê²Œ ìƒì„±

```
[ì°¸ê³  ì´ë¯¸ì§€] â†’ AI ë¶„ì„ â†’ [ê°™ì€ í”„ë ˆì„ + ìƒˆë¡œìš´ ë‚´ìš©]
```

---

## ì „ì²´ íë¦„

```mermaid
graph TD
    A[ì‚¬ìš©ì: ì¹´ë“œ ì¬ìƒì„± ë²„íŠ¼ í´ë¦­] --> B[ResultPreview.tsx: handleCardRegenerate]
    B --> C[generateSingleImage í˜¸ì¶œ]
    C --> D[buildFrameBlock: í”„ë ˆì„ ë³µì œ í”„ë¡¬í”„íŠ¸ ìƒì„±]
    D --> E[Gemini AI: ì°¸ê³  ì´ë¯¸ì§€ ë ˆì´ì•„ì›ƒë§Œ ë³µì œ]
    E --> F[ìƒˆë¡œìš´ ë‚´ìš©ì„ ê°™ì€ í”„ë ˆì„ì— ë Œë”ë§]
```

**ë‹¨ê³„ë³„ ì„¤ëª…**:

1. ì‚¬ìš©ìê°€ ì¹´ë“œ ì¬ìƒì„± ë²„íŠ¼ í´ë¦­
2. `ResultPreview.tsx` â†’ `handleCardRegenerate()` ì‹¤í–‰
3. `generateSingleImage()` í˜¸ì¶œ ì‹œ **ì°¸ê³  ì´ë¯¸ì§€ + copyMode** ì „ë‹¬
4. `buildFrameBlock()` í•¨ìˆ˜ë¡œ **í”„ë ˆì„ ë³µì œ í”„ë¡¬í”„íŠ¸** ìƒì„±
5. Gemini AIì—ê²Œ **"ì°¸ê³  ì´ë¯¸ì§€ì˜ ë ˆì´ì•„ì›ƒë§Œ ë³µì œ"** ì§€ì‹œ
6. ìƒˆë¡œìš´ ë‚´ìš©ì„ ê°™ì€ í”„ë ˆì„ì— ë Œë”ë§

---

## í•µì‹¬ ì½”ë“œ ë¶„ì„

### [1ë‹¨ê³„] ResultPreview.tsx - ì¹´ë“œ ì¬ìƒì„± í˜¸ì¶œ

**íŒŒì¼**: `src/components/ResultPreview.tsx` (Line 818-825)

```typescript
const newImage = await generateSingleImage(
  imagePromptToUse,           // í…ìŠ¤íŠ¸ ë‚´ìš© (ë¶€ì œ, ë©”ì¸ì œëª©, ì„¤ëª…)
  style,                      // ìŠ¤íƒ€ì¼: 'illustration', 'photo' ë“±
  '1:1',                      // ê°€ë¡œì„¸ë¡œ ë¹„ìœ¨
  customStylePrompt,          // ì»¤ìŠ¤í…€ ìŠ¤íƒ€ì¼ (ì„ íƒ)
  cardRegenRefImage,          // â­ ì°¸ê³  ì´ë¯¸ì§€ (ë³µì œí•  í”„ë ˆì„)
  refImageMode === 'copy'     // â­ copyMode: true = ì™„ì „ë³µì œ, false = ìƒ‰ìƒë³€ê²½
);
```

**íŒŒë¼ë¯¸í„° ì„¤ëª…**:

| ìˆœì„œ | íŒŒë¼ë¯¸í„° | íƒ€ì… | ì„¤ëª… |
|------|----------|------|------|
| 1 | `imagePromptToUse` | `string` | í…ìŠ¤íŠ¸ ë‚´ìš© (ë¶€ì œ, ë©”ì¸ì œëª©, ì„¤ëª…) |
| 2 | `style` | `ImageStyle` | ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼ ('illustration', 'photo', 'medical') |
| 3 | `aspectRatio` | `string` | ê°€ë¡œì„¸ë¡œ ë¹„ìœ¨ (ì¹´ë“œë‰´ìŠ¤ëŠ” '1:1') |
| 4 | `customStylePrompt` | `string?` | ì»¤ìŠ¤í…€ ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸ (ì„ íƒ) |
| 5 | `referenceImage` | `string?` | **â­ ì°¸ê³  ì´ë¯¸ì§€ (ë³µì œí•  í”„ë ˆì„)** |
| 6 | `copyMode` | `boolean?` | **â­ ë³µì œ ëª¨ë“œ (true=ì™„ì „ë³µì œ, false=ìƒ‰ìƒë³€ê²½)** |

---

### [2ë‹¨ê³„] geminiService.ts - buildFrameBlock()

**íŒŒì¼**: `src/services/geminiService.ts` (Line 517-520)

```typescript
const buildFrameBlock = (referenceImage?: string, copyMode?: boolean): string => {
  if (!referenceImage) return CARD_FRAME_RULE;
  return copyMode ? FRAME_FROM_REFERENCE_COPY : FRAME_FROM_REFERENCE_RECOLOR;
};
```

**âš¡ í•µì‹¬ ë¡œì§**:

```typescript
// ì°¸ê³  ì´ë¯¸ì§€ ì—†ìŒ
if (!referenceImage)
  â†’ CARD_FRAME_RULE (ê¸°ë³¸ í”„ë ˆì„ ê·œì¹™)

// ì™„ì „ ë³µì œ ëª¨ë“œ
else if (copyMode === true)
  â†’ FRAME_FROM_REFERENCE_COPY (ë ˆì´ì•„ì›ƒ ì •í™•íˆ ë³µì œ)

// ìƒ‰ìƒ ë³€ê²½ ëª¨ë“œ
else
  â†’ FRAME_FROM_REFERENCE_RECOLOR (ë ˆì´ì•„ì›ƒ ìœ ì§€ + ìƒ‰ìƒ ì¡°ì •)
```

---

### [3ë‹¨ê³„] geminiService.ts - í”„ë ˆì„ ë³µì œ í”„ë¡¬í”„íŠ¸

**íŒŒì¼**: `src/services/geminiService.ts` (Line 390-394)

#### ì™„ì „ ë³µì œ í”„ë¡¬í”„íŠ¸ (copyMode = true)

```typescript
const FRAME_FROM_REFERENCE_COPY = `
[FRAME LAYOUT]
Copy EXACTLY the frame/layout/text placement from the reference image.
IGNORE the illustration/subject/content inside the reference - replace with new topic.
`;
```

**í•µì‹¬ ì§€ì‹œë¬¸ ë¶„ì„**:

| ì§€ì‹œë¬¸ | ì˜ë¯¸ | ê²°ê³¼ |
|--------|------|------|
| `Copy EXACTLY the frame/layout/text placement` | í”„ë ˆì„, ë ˆì´ì•„ì›ƒ, í…ìŠ¤íŠ¸ ë°°ì¹˜ë¥¼ **ì •í™•íˆ** ë³µì œ | âœ… ì°¸ê³  ì´ë¯¸ì§€ì™€ ë™ì¼í•œ êµ¬ì¡° |
| `IGNORE the illustration/subject/content inside` | ë‚´ë¶€ ì¼ëŸ¬ìŠ¤íŠ¸/ì£¼ì œ/ë‚´ìš©ì€ **ë¬´ì‹œ** | âœ… ì›ë³¸ ë‚´ìš© ì œê±° |
| `replace with new topic` | ìƒˆë¡œìš´ ì£¼ì œë¡œ **êµì²´** | âœ… ìƒˆë¡œìš´ ë‚´ìš© ìƒì„± |

#### ìƒ‰ìƒ ë³€ê²½ í”„ë¡¬í”„íŠ¸ (copyMode = false)

```typescript
const FRAME_FROM_REFERENCE_RECOLOR = `
[FRAME LAYOUT]
Keep the frame/layout/text placement from reference image as much as possible.
Adjust overall color tone to match the requested background color.
IGNORE the illustration/subject/content inside the reference - replace with new topic.
`;
```

---

## í”„ë ˆì„ ë³µì œ ë©”ì»¤ë‹ˆì¦˜

### ì™„ì „ ë³µì œ vs ìƒ‰ìƒ ë³€ê²½ ë¹„êµ

| í•­ëª© | ì™„ì „ ë³µì œ (copy) | ìƒ‰ìƒ ë³€ê²½ (recolor) |
|------|------------------|---------------------|
| **í”„ë ˆì„ ëª¨ì–‘** | âœ… ë™ì¼ | âœ… ìœ ì§€ |
| **í…Œë‘ë¦¬ ìƒ‰ìƒ** | âœ… ë™ì¼ | ğŸ¨ ì¡°ì • ê°€ëŠ¥ |
| **í…ìŠ¤íŠ¸ ë°°ì¹˜** | âœ… ë™ì¼ | âœ… ìœ ì§€ |
| **ë°°ê²½ ìƒ‰ìƒ** | âœ… ë™ì¼ | ğŸ¨ ì¡°ì • ê°€ëŠ¥ |
| **ë‚´ë¶€ ì¼ëŸ¬ìŠ¤íŠ¸** | ğŸ”„ ìƒˆë¡œìš´ ë‚´ìš© | ğŸ”„ ìƒˆë¡œìš´ ë‚´ìš© |
| **í”„ë¡¬í”„íŠ¸** | `FRAME_FROM_REFERENCE_COPY` | `FRAME_FROM_REFERENCE_RECOLOR` |

### Gemini AIì˜ ë™ì‘ ì›ë¦¬

Gemini AIëŠ” **ì°¸ê³  ì´ë¯¸ì§€ + í”„ë¡¬í”„íŠ¸**ë¥¼ í•¨ê»˜ ë°›ìœ¼ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì²˜ë¦¬í•©ë‹ˆë‹¤:

#### 1. ì°¸ê³  ì´ë¯¸ì§€ ë¶„ì„ ë‹¨ê³„

```
[Gemini AIê°€ ì¸ì‹í•˜ëŠ” ê²ƒ]
- ë ˆì´ì•„ì›ƒ êµ¬ì¡° (í…ìŠ¤íŠ¸ ìœ„ì¹˜, í¬ê¸°, ì •ë ¬)
- í”„ë ˆì„ ë””ìì¸ (í…Œë‘ë¦¬, ë‘¥ê·¼ ëª¨ì„œë¦¬, ìƒ‰ìƒ)
- í…ìŠ¤íŠ¸ ê³„ì¸µ êµ¬ì¡° (ë¶€ì œ, ë©”ì¸ì œëª©, ì„¤ëª…)
- ì¼ëŸ¬ìŠ¤íŠ¸ ìœ„ì¹˜ ë° í¬ê¸°
```

#### 2. í”„ë¡¬í”„íŠ¸ í•´ì„ ë‹¨ê³„

```
"Copy EXACTLY the frame/layout"
  â†’ ë¶„ì„í•œ êµ¬ì¡°ë¥¼ ê·¸ëŒ€ë¡œ ìœ ì§€í•´ì•¼ í•¨

"IGNORE the content inside"
  â†’ ì¼ëŸ¬ìŠ¤íŠ¸ì™€ í…ìŠ¤íŠ¸ ë‚´ìš©ì€ ë²„ë¦¼

"replace with new topic"
  â†’ í”„ë¡¬í”„íŠ¸ì—ì„œ ë°›ì€ ìƒˆë¡œìš´ ë‚´ìš©ìœ¼ë¡œ êµì²´
```

#### 3. ìµœì¢… ì´ë¯¸ì§€ ìƒì„±

```
ì°¸ê³  ì´ë¯¸ì§€ì˜ ë ˆì´ì•„ì›ƒ â†’ 100% ìœ ì§€
ì°¸ê³  ì´ë¯¸ì§€ì˜ ë‚´ìš© â†’ 100% êµì²´
```

---

## ì‹¤ì œ ë™ì‘ ì˜ˆì‹œ

### ì…ë ¥ (ì°¸ê³  ì´ë¯¸ì§€)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ë³´ë¼ìƒ‰ í…Œë‘ë¦¬ (#787fff)     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                         â”‚ â”‚
â”‚ â”‚   [ë¶€ì œ]                â”‚ â”‚
â”‚ â”‚   ê·¼ìœ¡í†µì´ ìƒê¸°ëŠ”        â”‚ â”‚
â”‚ â”‚                         â”‚ â”‚
â”‚ â”‚   [ë©”ì¸ì œëª©]            â”‚ â”‚
â”‚ â”‚   5ê°€ì§€ ì´ìœ             â”‚ â”‚
â”‚ â”‚                         â”‚ â”‚
â”‚ â”‚   [ì¼ëŸ¬ìŠ¤íŠ¸]            â”‚ â”‚
â”‚ â”‚   ê·¼ìœ¡ í•´ë¶€ë„           â”‚ â”‚
â”‚ â”‚                         â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì²˜ë¦¬ ê³¼ì •

```typescript
// ì‚¬ìš©ì ì…ë ¥
const newContent = {
  subtitle: "í—ˆë¦¬ê°€ ì•„í”ˆ",
  mainTitle: "3ê°€ì§€ ì›ì¸",
  description: "ì²™ì¶” ê±´ê°• ì²´í¬"
};

// generateSingleImage í˜¸ì¶œ
const newImage = await generateSingleImage(
  `1:1 ì¹´ë“œë‰´ìŠ¤, "${newContent.subtitle}" "${newContent.mainTitle}"`,
  'illustration',
  '1:1',
  customStylePrompt,
  cardRegenRefImage,  // ìœ„ì˜ ì°¸ê³  ì´ë¯¸ì§€
  true                // copyMode = true (ì™„ì „ ë³µì œ)
);
```

### ì¶œë ¥ (ìƒì„±ëœ ì´ë¯¸ì§€)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ë³´ë¼ìƒ‰ í…Œë‘ë¦¬ (#787fff)     â”‚ âœ… ë™ì¼
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                         â”‚ â”‚
â”‚ â”‚   [ë¶€ì œ]                â”‚ â”‚ âœ… ê°™ì€ ìœ„ì¹˜
â”‚ â”‚   í—ˆë¦¬ê°€ ì•„í”ˆ           â”‚ â”‚ ğŸ”„ ìƒˆë¡œìš´ ë‚´ìš©
â”‚ â”‚                         â”‚ â”‚
â”‚ â”‚   [ë©”ì¸ì œëª©]            â”‚ â”‚ âœ… ê°™ì€ í¬ê¸°
â”‚ â”‚   3ê°€ì§€ ì›ì¸            â”‚ â”‚ ğŸ”„ ìƒˆë¡œìš´ ë‚´ìš©
â”‚ â”‚                         â”‚ â”‚
â”‚ â”‚   [ì¼ëŸ¬ìŠ¤íŠ¸]            â”‚ â”‚ âœ… ê°™ì€ ìœ„ì¹˜
â”‚ â”‚   í—ˆë¦¬ ì²™ì¶” í•´ë¶€ë„      â”‚ â”‚ ğŸ”„ ìƒˆë¡œìš´ ë‚´ìš©
â”‚ â”‚                         â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ì „ì²´ ë°ì´í„° íë¦„

### 1. ì‚¬ìš©ì ì…ë ¥

```typescript
// ì‚¬ìš©ìê°€ ì œê³µí•˜ëŠ” ë°ì´í„°
const userInput = {
  referenceImage: 'data:image/png;base64,iVBORw0KG...',  // ì°¸ê³  ì´ë¯¸ì§€
  copyMode: true,                                        // ë³µì œ ëª¨ë“œ
  newContent: {
    subtitle: "í—ˆë¦¬ê°€ ì•„í”ˆ",
    mainTitle: "3ê°€ì§€ ì›ì¸",
    description: "ì²™ì¶” ê±´ê°• ì²´í¬"
  }
};
```

### 2. generateSingleImage í•¨ìˆ˜ ì²˜ë¦¬

```typescript
// src/services/geminiService.ts (Line 1197-1346)

export const generateSingleImage = async (
  promptText: string,
  style: ImageStyle,
  aspectRatio: string,
  customStylePrompt?: string,
  referenceImage?: string,
  copyMode?: boolean
): Promise<string> => {
  
  // 1) í”„ë ˆì„ ë¸”ë¡ ìƒì„±
  const frameBlock = buildFrameBlock(referenceImage, copyMode);
  // â†’ "Copy EXACTLY the frame/layout..." ë°˜í™˜
  
  // 2) ìŠ¤íƒ€ì¼ ë¸”ë¡ ìƒì„±
  const styleBlock = buildStyleBlock(style, customStylePrompt);
  // â†’ "3D ë Œë” ì¼ëŸ¬ìŠ¤íŠ¸, Blender ìŠ¤íƒ€ì¼..." ë°˜í™˜
  
  // 3) ìµœì¢… í”„ë¡¬í”„íŠ¸ ì¡°ë¦½
  const finalPrompt = `
ğŸš¨ RENDER THIS EXACT KOREAN TEXT IN THE IMAGE ğŸš¨

[TEXT HIERARCHY - MUST FOLLOW EXACTLY!]
â€» MAIN TITLE (BIG, BOLD, CENTER): "3ê°€ì§€ ì›ì¸"
â€» SUBTITLE (small, above main title): "í—ˆë¦¬ê°€ ì•„í”ˆ"
â€» DESCRIPTION (small, below main title): "ì²™ì¶” ê±´ê°• ì²´í¬"

Generate a 1:1 square social media card with the Korean text above.

${frameBlock}
${styleBlock}

[DESIGN]
- 1:1 square, background: #E8F4FD gradient
- Border color: #787fff
- Korean text rendered with clean readable font
  `.trim();
  
  // 4) ì°¸ê³  ì´ë¯¸ì§€ë¥¼ Gemini API í˜•ì‹ìœ¼ë¡œ ë³€í™˜
  const refImagePart = referenceImage?.startsWith('data:')
    ? (() => {
        const [meta, base64] = referenceImage.split(',');
        const mimeType = (meta.match(/data:(.*?);base64/) || [])[1] || 'image/png';
        return { inlineData: { data: base64, mimeType } };
      })()
    : null;
  
  // 5) Gemini API í˜¸ì¶œ
  const contents = refImagePart 
    ? [refImagePart, { text: finalPrompt }]  // ì°¸ê³  ì´ë¯¸ì§€ + í”„ë¡¬í”„íŠ¸
    : [{ text: finalPrompt }];                // í”„ë¡¬í”„íŠ¸ë§Œ
  
  const response = await ai.models.generateContent({
    model: 'gemini-3-pro-image-preview',
    contents: contents
  });
  
  return response.imageUrl;  // ìƒì„±ëœ ì´ë¯¸ì§€ ë°˜í™˜
};
```

### 3. Gemini AI ì²˜ë¦¬

```
[Gemini AI 3 Pro Image Preview]

ì…ë ¥:
  1. ì°¸ê³  ì´ë¯¸ì§€ (base64)
  2. í”„ë¡¬í”„íŠ¸ (frameBlock + styleBlock + í…ìŠ¤íŠ¸ ë‚´ìš©)

ì²˜ë¦¬:
  1. ì°¸ê³  ì´ë¯¸ì§€ ë¶„ì„
     - ë ˆì´ì•„ì›ƒ êµ¬ì¡° íŒŒì•…
     - í”„ë ˆì„ ë””ìì¸ ì¸ì‹
     - í…ìŠ¤íŠ¸ ë°°ì¹˜ ìœ„ì¹˜ ê¸°ì–µ
  
  2. í”„ë¡¬í”„íŠ¸ í•´ì„
     - "Copy EXACTLY the frame/layout" â†’ êµ¬ì¡° ìœ ì§€ ê²°ì •
     - "IGNORE the content inside" â†’ ë‚´ìš© ì œê±° ê²°ì •
     - ìƒˆë¡œìš´ í…ìŠ¤íŠ¸ ë‚´ìš© íŒŒì‹±
  
  3. ì´ë¯¸ì§€ ìƒì„±
     - ì°¸ê³  ì´ë¯¸ì§€ì˜ ë ˆì´ì•„ì›ƒ ì ìš©
     - ìƒˆë¡œìš´ í…ìŠ¤íŠ¸ ë Œë”ë§
     - ìƒˆë¡œìš´ ì¼ëŸ¬ìŠ¤íŠ¸ ìƒì„±

ì¶œë ¥:
  base64 ì´ë¯¸ì§€ URL
```

### 4. ê²°ê³¼ ë°˜í™˜ ë° í‘œì‹œ

```typescript
// src/components/ResultPreview.tsx (Line 838-850)

if (newImage) {
  // DOM ì—…ë°ì´íŠ¸ - ì´ë¯¸ì§€ êµì²´
  const newCardHtml = `
    <div class="card-slide">
      <img src="${newImage}" alt="${imagePromptToUse}" />
    </div>`;
  
  cardsInHtml[cardRegenIndex].replaceWith(newCard);
  setLocalHtml(tempDiv.innerHTML);
  
  alert(`âœ… ${cardRegenIndex + 1}ë²ˆ ì¹´ë“œê°€ ì¬ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!`);
}
```

---

## í•µì‹¬ ì •ë¦¬

### 5ê°€ì§€ í•µì‹¬ í¬ì¸íŠ¸

#### 1ï¸âƒ£ ì°¸ê³  ì´ë¯¸ì§€ ì „ë‹¬

```typescript
generateSingleImage(
  promptText,
  style,
  '1:1',
  customStylePrompt,
  referenceImage,  // â­ 5ë²ˆì§¸ íŒŒë¼ë¯¸í„°
  copyMode
);
```

#### 2ï¸âƒ£ ë³µì œ ëª¨ë“œ ì§€ì •

```typescript
generateSingleImage(
  promptText,
  style,
  '1:1',
  customStylePrompt,
  referenceImage,
  copyMode  // â­ 6ë²ˆì§¸ íŒŒë¼ë¯¸í„° (true = ì™„ì „ë³µì œ, false = ìƒ‰ìƒë³€ê²½)
);
```

#### 3ï¸âƒ£ í”„ë¡¬í”„íŠ¸ ì‘ì„± (í•µì‹¬!)

```
[FRAME LAYOUT]
Copy EXACTLY the frame/layout/text placement from the reference image.
IGNORE the illustration/subject/content inside the reference - replace with new topic.
```

**í•µì‹¬ ë¬¸êµ¬**:
- âœ… `"Copy EXACTLY the frame/layout"` - ì •í™•í•œ ë³µì œ ì§€ì‹œ
- âœ… `"IGNORE the content inside"` - ë‚´ìš©ì€ ë¬´ì‹œ
- âœ… `"replace with new topic"` - ìƒˆë¡œìš´ ì£¼ì œë¡œ êµì²´

#### 4ï¸âƒ£ Gemini API í˜¸ì¶œ

```typescript
const contents = [
  refImagePart,           // ì°¸ê³  ì´ë¯¸ì§€ (base64)
  { text: finalPrompt }   // í”„ë¡¬í”„íŠ¸
];

await ai.models.generateContent({
  model: 'gemini-3-pro-image-preview',
  contents: contents
});
```

#### 5ï¸âƒ£ ê²°ê³¼

```
ê°™ì€ í”„ë ˆì„ + ë‹¤ë¥¸ ë‚´ìš© = ì™„ë²½í•œ ë³µì œë³¸!
```

---

## ì¥ì  ë° í™œìš©

### ì´ ë°©ì‹ì˜ ì¥ì 

| ì¥ì  | ì„¤ëª… | íš¨ê³¼ |
|------|------|------|
| âœ… **ì¼ê´€ëœ ë¸Œëœë”©** | ëª¨ë“  ì¹´ë“œê°€ ê°™ì€ ë””ìì¸ | ë¸Œëœë“œ ì •ì²´ì„± ê°•í™” |
| âœ… **ì‹œê°„ ì ˆì•½** | ë§¤ë²ˆ ë ˆì´ì•„ì›ƒ ì„¤ê³„ ë¶ˆí•„ìš” | ì œì‘ ì‹œê°„ 80% ë‹¨ì¶• |
| âœ… **í’ˆì§ˆ ë³´ì¥** | ê²€ì¦ëœ ë””ìì¸ ì¬ì‚¬ìš© | í’ˆì§ˆ í¸ì°¨ ì œê±° |
| âœ… **ìœ ì—°ì„±** | ë‚´ìš©ë§Œ ë¹ ë¥´ê²Œ êµì²´ ê°€ëŠ¥ | ëŒ€ëŸ‰ ì œì‘ ê°€ëŠ¥ |
| âœ… **ë¹„ìš© íš¨ìœ¨** | ë””ìì´ë„ˆ ì—†ì´ ì¼ê´€ëœ ë””ìì¸ | ì¸ê±´ë¹„ ì ˆê° |

### ì‹¤ì œ ì‚¬ìš© ì‚¬ë¡€

#### ë³‘ì› ì¹´ë“œë‰´ìŠ¤ ì‹œë¦¬ì¦ˆ ì œì‘

```
1ì£¼ì°¨: "ê·¼ìœ¡í†µì´ ìƒê¸°ëŠ” 5ê°€ì§€ ì´ìœ "
2ì£¼ì°¨: "í—ˆë¦¬ê°€ ì•„í”ˆ 3ê°€ì§€ ì›ì¸"
3ì£¼ì°¨: "ì–´ê¹¨ í†µì¦ ì™„í™” 4ê°€ì§€ ë°©ë²•"
4ì£¼ì°¨: "ë¬´ë¦ ê±´ê°• ì§€í‚¤ëŠ” 5ê°€ì§€ ìŠµê´€"

â†’ ëª¨ë“  ì¹´ë“œê°€ ê°™ì€ í”„ë ˆì„, ë‹¤ë¥¸ ë‚´ìš©
â†’ ë¸Œëœë“œ ì¼ê´€ì„± ìœ ì§€ + ë¹ ë¥¸ ì œì‘
```

#### ì‹œë¦¬ì¦ˆë¬¼ ëŒ€ëŸ‰ ì œì‘

```typescript
// 10ê°œ ì¹´ë“œë¥¼ ê°™ì€ í”„ë ˆì„ìœ¼ë¡œ ìë™ ìƒì„±
const topics = [
  { subtitle: "ê·¼ìœ¡í†µì´ ìƒê¸°ëŠ”", mainTitle: "5ê°€ì§€ ì´ìœ " },
  { subtitle: "í—ˆë¦¬ê°€ ì•„í”ˆ", mainTitle: "3ê°€ì§€ ì›ì¸" },
  { subtitle: "ì–´ê¹¨ í†µì¦ ì™„í™”", mainTitle: "4ê°€ì§€ ë°©ë²•" },
  // ... 7ê°œ ë”
];

for (const topic of topics) {
  const image = await generateSingleImage(
    `1:1 ì¹´ë“œë‰´ìŠ¤, "${topic.subtitle}" "${topic.mainTitle}"`,
    'illustration',
    '1:1',
    customStylePrompt,
    referenceImage,  // ì²« ë²ˆì§¸ ì¹´ë“œë¥¼ ì°¸ê³  ì´ë¯¸ì§€ë¡œ ì‚¬ìš©
    true             // ì™„ì „ ë³µì œ ëª¨ë“œ
  );
  
  cards.push(image);
}

// ê²°ê³¼: 10ê°œì˜ ì¼ê´€ëœ ë””ìì¸ ì¹´ë“œ
```

### í™•ì¥ ê°€ëŠ¥ì„±

1. **ë‹¤êµ­ì–´ ì§€ì›**: ê°™ì€ í”„ë ˆì„ì— ì˜ì–´/ì¤‘êµ­ì–´ ë²„ì „ ì œì‘
2. **A/B í…ŒìŠ¤íŠ¸**: ê°™ì€ í”„ë ˆì„ì— ë‹¤ì–‘í•œ ë¬¸êµ¬ í…ŒìŠ¤íŠ¸
3. **ì‹œì¦Œë³„ ë³€í˜•**: í”„ë ˆì„ ìƒ‰ìƒë§Œ ë³€ê²½ (recolor ëª¨ë“œ)
4. **ë¸Œëœë“œë³„ í…œí”Œë¦¿**: ë³‘ì›/í´ë¦¬ë‹‰/ì•½êµ­ë³„ ì „ìš© í”„ë ˆì„

---

## ì½”ë“œ íŒŒì¼ ìœ„ì¹˜

### ì£¼ìš” íŒŒì¼

| íŒŒì¼ | ê²½ë¡œ | í•µì‹¬ ë‚´ìš© |
|------|------|----------|
| ResultPreview.tsx | `src/components/ResultPreview.tsx` | ì¹´ë“œ ì¬ìƒì„± UI ë° í˜¸ì¶œ ë¡œì§ |
| geminiService.ts | `src/services/geminiService.ts` | í”„ë ˆì„ ë³µì œ í”„ë¡¬í”„íŠ¸ ë° API í˜¸ì¶œ |

### í•µì‹¬ í•¨ìˆ˜ ìœ„ì¹˜

| í•¨ìˆ˜ | íŒŒì¼ | ë¼ì¸ | ì„¤ëª… |
|------|------|------|------|
| `handleCardRegenerate()` | ResultPreview.tsx | ~790 | ì¹´ë“œ ì¬ìƒì„± ì‹œì‘ì  |
| `generateSingleImage()` | geminiService.ts | 1197 | ì´ë¯¸ì§€ ìƒì„± ë©”ì¸ í•¨ìˆ˜ |
| `buildFrameBlock()` | geminiService.ts | 517 | í”„ë ˆì„ í”„ë¡¬í”„íŠ¸ ìƒì„± |
| `FRAME_FROM_REFERENCE_COPY` | geminiService.ts | 390 | ì™„ì „ ë³µì œ í”„ë¡¬í”„íŠ¸ ìƒìˆ˜ |
| `FRAME_FROM_REFERENCE_RECOLOR` | geminiService.ts | 398 | ìƒ‰ìƒ ë³€ê²½ í”„ë¡¬í”„íŠ¸ ìƒìˆ˜ |

---

## ê¸°ìˆ  ìŠ¤íƒ

- **í”„ë¡ íŠ¸ì—”ë“œ**: React 18 + TypeScript
- **AI ëª¨ë¸**: Google Gemini 3 Pro Image Preview
- **ì´ë¯¸ì§€ ì²˜ë¦¬**: base64 encoding/decoding
- **ìƒíƒœ ê´€ë¦¬**: React useState/useEffect

---

## ë¼ì´ì„ ìŠ¤ ë° í¬ë ˆë”§

**ê°œë°œ**: Hospital AI Development Team  
**ê¸°ìˆ **: Google Gemini AI  
**ë²„ì „**: 1.0.0  
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2026-01-21

---

## ë¬¸ì˜

ê¸°ìˆ  ë¬¸ì˜ ë˜ëŠ” í˜‘ì—… ì œì•ˆ:
- GitHub: [Hospital-AI Repository](https://github.com/storydarugi-coder/Hospital-AI)

---

**âœ¨ ì´ ë¬¸ì„œë¥¼ í†µí•´ ì¹´ë“œë‰´ìŠ¤ í”„ë ˆì„ ì™„ì „ ë³µì œ ì‹œìŠ¤í…œì„ ì™„ë²½íˆ ì´í•´í•˜ê³  í™œìš©í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤!**
