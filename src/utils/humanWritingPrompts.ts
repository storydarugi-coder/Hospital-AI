/**
 * ì‚¬ëŒê°™ì€ ê¸€ì“°ê¸° í”„ë¡¬í”„íŠ¸
 * AI ëƒ„ìƒˆë¥¼ ì œê±°í•˜ê³  ìì—°ìŠ¤ëŸ¬ìš´ ê¸€ì“°ê¸° ìœ ë„
 */

/**
 * ê¸°ë³¸ ì‚¬ëŒê°™ì€ ê¸€ì“°ê¸° ê·œì¹™
 */
export const HUMAN_WRITING_RULES = `
[AI í‹° ì œê±° ê·œì¹™]
âŒ í”¼í•´ì•¼ í•  í‘œí˜„:
- "~ì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤"
- "~ë¼ê³  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"
- "~ê²ƒìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŠµë‹ˆë‹¤"
- "ë‹¤ì–‘í•œ", "íš¨ê³¼ì ì¸", "ì¤‘ìš”í•œ" ë‚¨ë°œ
- ê³¼ë„í•œ ì´ëª¨ì§€ ğŸš«
- "ì—¬ëŸ¬ë¶„", "ì˜¤ëŠ˜ì€" ë“± í‹€ì— ë°•íŒ ì„œë‘

âœ… ìì—°ìŠ¤ëŸ¬ìš´ í‘œí˜„:
- ì§§ì€ ë¬¸ì¥ê³¼ ê¸´ ë¬¸ì¥ ìì—°ìŠ¤ëŸ½ê²Œ ì„ê¸°
- í•µì‹¬ì„ ë¨¼ì €, ë¶€ì—°ì„¤ëª…ì€ ë‚˜ì¤‘ì—
- êµ¬ì²´ì  ìˆ«ìì™€ ì˜ˆì‹œ ì‚¬ìš©
- ë°˜ë§/ì¡´ëŒ“ë§ ì¼ê´€ì„± ìœ ì§€
`;

/**
 * í†¤ë³„ ì‚¬ëŒê°™ì€ ê¸€ì“°ê¸° í”„ë¡¬í”„íŠ¸
 */
export const HUMAN_TONE_PROMPTS = {
  empathy: `
ê³µê°í˜• ê¸€ì“°ê¸°:
- "ì´ëŸ° ê²½í—˜ ìˆìœ¼ì‹œì£ ?" ê°™ì€ ê³µê° ìœ ë„
- ë…ìì˜ ìƒí™©ì„ ë¨¼ì € ì–¸ê¸‰
- ê±±ì •â†’í•´ê²°ì±… ìˆœì„œ
ì˜ˆ: "ë¬´ë¦ì´ ì•„í”Œ ë•Œë§ˆë‹¤ ê³„ë‹¨ì´ ë‘ë µìŠµë‹ˆë‹¤. ê´€ì ˆì—¼ì¼ê¹Œìš”?"
`,

  professional: `
ì „ë¬¸í˜• ê¸€ì“°ê¸°:
- ì˜í•™ ìš©ì–´ëŠ” ( ) ì„¤ëª… ì¶”ê°€
- í†µê³„ëŠ” ì¶œì²˜ì™€ í•¨ê»˜
- ë‹¨ì •ì  í‘œí˜„ í”¼í•˜ê¸°
ì˜ˆ: "í‡´í–‰ì„±ê´€ì ˆì—¼(ì—°ê³¨ì´ ë‹³ì•„ ìƒê¸°ëŠ” ì§ˆí™˜)ì€ 50ëŒ€ ì´ìƒì—ì„œ í”í•©ë‹ˆë‹¤. (ì¶œì²˜: ê±´ê°•ë³´í—˜ì‹¬ì‚¬í‰ê°€ì›)"
`,

  simple: `
ì‰¬ìš´ ê¸€ì“°ê¸°:
- ì „ë¬¸ìš©ì–´ â†’ ì‰¬ìš´ ë§
- í•œ ë¬¸ì¥ì— í•œ ê°€ì§€ ë‚´ìš©
- ëŠ¥ë™íƒœ ìš°ì„ 
ì˜ˆ: "ì•½ì„ ë¨¹ìœ¼ë©´" (O) vs "ì•½ì„ ë³µìš©í•˜ì‹œë©´" (X)
`,

  informative: `
ì •ë³´í˜• ê¸€ì“°ê¸°:
- í•µì‹¬ ë¨¼ì €, ê·¼ê±° ë‚˜ì¤‘
- ë²ˆí˜¸/ë¶ˆë¦¿ìœ¼ë¡œ êµ¬ì¡°í™”
- "ì™œ?"ì— ëŒ€í•œ ë‹µë³€ í¬í•¨
ì˜ˆ: "1. í˜ˆì••ì•½ì€ ì•„ì¹¨ì— ë¨¹ìŠµë‹ˆë‹¤. â†’ 2. ì´ìœ : í˜ˆì••ì´ ì˜¤ì „ì— ë†’ê¸° ë•Œë¬¸"
`
};

/**
 * ì˜ë£Œê´‘ê³ ë²• ì¤€ìˆ˜í•˜ë©´ì„œ ì‚¬ëŒë‹µê²Œ ì“°ê¸°
 */
export const MEDICAL_LAW_HUMAN_PROMPT = `
[ì˜ë£Œê´‘ê³ ë²• + ìì—°ìŠ¤ëŸ¬ìš´ í‘œí˜„]

âŒ ê³¼ì¥ í‘œí˜„ â†’ âœ… ì‚¬ì‹¤ì  í‘œí˜„
- "ì™„ì¹˜" â†’ "ì¦ìƒ ê°œì„ " ë˜ëŠ” "ê´€ë¦¬"
- "ìµœê³ ì˜ ì¹˜ë£Œ" â†’ "íš¨ê³¼ì ì¸ ì¹˜ë£Œ ë°©ë²• ì¤‘ í•˜ë‚˜"
- "ì¦‰ê°ì  íš¨ê³¼" â†’ "ì¼ì • ì‹œê°„ í›„ íš¨ê³¼"
- "100% ì•ˆì „" â†’ "ì•ˆì „ì„±ì´ ì…ì¦ëœ" (ì¶œì²˜ í•„ìˆ˜)

âŒ AI ìŠ¤íƒ€ì¼ â†’ âœ… ì‚¬ëŒ ìŠ¤íƒ€ì¼
- "ë‹¹ë‡¨ë³‘ì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤" (X)
- "ë‹¹ë‡¨ë³‘, í˜ˆë‹¹ë§Œ ê´€ë¦¬í•˜ë©´ ë ê¹Œìš”?" (O)

- "ë‹¤ì–‘í•œ í•©ë³‘ì¦ì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤" (X)
- "ì‹ ì¥, ëˆˆ, ì‹ ê²½ ì†ìƒìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤" (O)
`;

/**
 * ë¬¸ë‹¨ êµ¬ì¡° ê°€ì´ë“œ (ì‚¬ëŒê°™ì€ íë¦„)
 */
export const PARAGRAPH_STRUCTURE_GUIDE = `
[ìì—°ìŠ¤ëŸ¬ìš´ ë¬¸ë‹¨ êµ¬ì¡°]

ì„œë‘ (1-2ë¬¸ì¥):
- ë…ì ìƒí™© ê³µê° ë˜ëŠ” ì§ˆë¬¸ìœ¼ë¡œ ì‹œì‘
- ì˜ˆ: "í—ˆë¦¬ í†µì¦ì´ 3ê°œì›” ì´ìƒ ì§€ì†ëœë‹¤ë©´?"

ë³¸ë¬¸ (3-5ë¬¸ì¥):
- ì§§ì€ ë¬¸ì¥ â†’ ê¸´ ë¬¸ì¥ â†’ ì§§ì€ ë¬¸ì¥ ë¦¬ë“¬
- í•µì‹¬ ì •ë³´ â†’ ë¶€ì—° ì„¤ëª… ìˆœì„œ
- í†µê³„/ìˆ˜ì¹˜ëŠ” ê´„í˜¸ ì•ˆì— ì¶œì²˜

ë§ˆë¬´ë¦¬ (1-2ë¬¸ì¥):
- í–‰ë™ ìœ ë„ (CTA) ë˜ëŠ” ìš”ì•½
- ì˜ë£Œê´‘ê³ ë²• ì£¼ì˜: "ë³‘ì› ë°©ë¬¸" ëŒ€ì‹  "ì „ë¬¸ì˜ ìƒë‹´"
`;

/**
 * Few-shot ì˜ˆì‹œ (ì¢‹ì€ ê¸€ vs ë‚˜ìœ ê¸€)
 */
export const FEW_SHOT_EXAMPLES = `
[ë‚˜ìœ ì˜ˆì‹œ - AI í‹°ë‚¨]
ë‹¹ë‡¨ë³‘ì€ í˜„ëŒ€ì¸ì—ê²Œ í”í•œ ì§ˆë³‘ì…ë‹ˆë‹¤. ë‹¹ë‡¨ë³‘ì— ëŒ€í•´ ìì„¸íˆ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.
ë‹¤ì–‘í•œ ì¦ìƒì´ ë‚˜íƒ€ë‚  ìˆ˜ ìˆìœ¼ë©°, ì ì ˆí•œ ê´€ë¦¬ê°€ ì¤‘ìš”í•©ë‹ˆë‹¤.

[ì¢‹ì€ ì˜ˆì‹œ - ìì—°ìŠ¤ëŸ¬ì›€]
ê°ˆì¦ì´ ì‹¬í•˜ê³  í™”ì¥ì‹¤ì„ ìì£¼ ê°„ë‹¤ë©´ ë‹¹ë‡¨ë³‘ì„ ì˜ì‹¬í•´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
í˜ˆë‹¹ì´ ë†’ì•„ì§€ë©´ ìš°ë¦¬ ëª¸ì€ ì†Œë³€ìœ¼ë¡œ ë‹¹ì„ ë°°ì¶œí•˜ë ¤ê³  í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. (ì¶œì²˜: ì§ˆë³‘ê´€ë¦¬ì²­)
---
[ë‚˜ìœ ì˜ˆì‹œ - ì˜ë£Œê´‘ê³ ë²• ìœ„ë°˜]
ìš°ë¦¬ ë³‘ì›ì˜ ìµœì²¨ë‹¨ ì¹˜ë£Œë¡œ ë‹¹ë‡¨ë¥¼ ì™„ì¹˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!
100% ì•ˆì „í•˜ê³  íš¨ê³¼ê°€ ì¦‰ê° ë‚˜íƒ€ë‚©ë‹ˆë‹¤.

[ì¢‹ì€ ì˜ˆì‹œ - ë²• ì¤€ìˆ˜]
ë‹¹ë‡¨ë³‘ì€ ì™„ì¹˜ë³´ë‹¤ëŠ” ê¾¸ì¤€í•œ ê´€ë¦¬ê°€ ì¤‘ìš”í•©ë‹ˆë‹¤.
í˜ˆë‹¹ ì¡°ì ˆ, ì‹ì´ìš”ë²•, ìš´ë™ìœ¼ë¡œ í•©ë³‘ì¦ì„ ì˜ˆë°©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ì¶œì²˜: ëŒ€í•œë‹¹ë‡¨ë³‘í•™íšŒ)
`;

/**
 * ì¹´í…Œê³ ë¦¬ë³„ ë§ì¶¤ í”„ë¡¬í”„íŠ¸
 */
export const CATEGORY_SPECIFIC_PROMPTS = {
  internal_medicine: `ë‚´ê³¼: ì¦ìƒâ†’ì›ì¸â†’ê´€ë¦¬ ìˆœì„œ. ì¼ìƒìƒí™œ íŒ í¬í•¨`,
  orthopedics: `ì •í˜•ì™¸ê³¼: í†µì¦ ë¶€ìœ„ êµ¬ì²´ì  ë¬˜ì‚¬. ìš´ë™ë²• í¬í•¨`,
  dermatology: `í”¼ë¶€ê³¼: ì‹œê°ì  ë¬˜ì‚¬ ìì œ. ìƒí™œìŠµê´€ ì¤‘ì‹¬`,
  pediatrics: `ì†Œì•„ê³¼: ë³´í˜¸ì ê´€ì . ë¶ˆì•ˆ í•´ì†Œ ë¨¼ì €`,
  psychiatry: `ì •ì‹ ê±´ê°•ì˜í•™ê³¼: ë‚™ì¸ ì œê±°. ì¼ìƒ ì–¸ì–´ ì‚¬ìš©`,
  ophthalmology: `ì•ˆê³¼: ì¦ìƒ êµ¬ì²´í™”. ì˜ˆë°©ë²• ê°•ì¡°`,
  dentistry: `ì¹˜ê³¼: í†µì¦ ê³µê°. ì¹˜ë£Œ ê³¼ì • ì„¤ëª…`,
  oriental_medicine: `í•œì˜ì›: ì²´ì§ˆ ì–¸ê¸‰ ìì œ. ê³¼í•™ì  ê·¼ê±° ì œì‹œ`
};

/**
 * í”„ë¡¬í”„íŠ¸ ìƒì„± í•¨ìˆ˜
 */
export function generateHumanWritingPrompt(
  category?: string,
  tone: keyof typeof HUMAN_TONE_PROMPTS = 'empathy'
): string {
  const tonePrompt = HUMAN_TONE_PROMPTS[tone];
  const categoryPrompt = category && category in CATEGORY_SPECIFIC_PROMPTS
    ? CATEGORY_SPECIFIC_PROMPTS[category as keyof typeof CATEGORY_SPECIFIC_PROMPTS]
    : '';

  return `
${HUMAN_WRITING_RULES}
${tonePrompt}
${MEDICAL_LAW_HUMAN_PROMPT}
${PARAGRAPH_STRUCTURE_GUIDE}
${categoryPrompt}

[ì°¸ê³  ì˜ˆì‹œ]
${FEW_SHOT_EXAMPLES}
`.trim();
}

/**
 * AI ëƒ„ìƒˆ ê°ì§€ í•¨ìˆ˜
 */
export function detectAiSmell(text: string): {
  detected: boolean;
  patterns: string[];
  score: number; // 0-100, ë†’ì„ìˆ˜ë¡ AI ëƒ„ìƒˆ ê°•í•¨
} {
  const aiPatterns = [
    { pattern: /ì—\s*ëŒ€í•´\s*ì•Œì•„ë³´[ê² ìŠµë‹ˆë‹¤|ì]/g, name: '~ì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤' },
    { pattern: /ë¼ê³ \s*í• \s*ìˆ˜\s*ìˆìŠµë‹ˆë‹¤/g, name: '~ë¼ê³  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤' },
    { pattern: /ê²ƒìœ¼ë¡œ\s*ë‚˜íƒ€ë‚¬ìŠµë‹ˆë‹¤/g, name: '~ê²ƒìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŠµë‹ˆë‹¤' },
    { pattern: /ë‹¤ì–‘í•œ/g, name: 'ë‹¤ì–‘í•œ (ê³¼ë‹¤ ì‚¬ìš©)' },
    { pattern: /ì—¬ëŸ¬ë¶„/g, name: 'ì—¬ëŸ¬ë¶„ (ê³¼ë‹¤ ì‚¬ìš©)' },
    { pattern: /ì˜¤ëŠ˜ì€/g, name: 'ì˜¤ëŠ˜ì€ (í‹€ì— ë°•íŒ ì„œë‘)' },
  ];

  const detected: string[] = [];
  let totalMatches = 0;

  for (const { pattern, name } of aiPatterns) {
    const matches = text.match(pattern);
    if (matches && matches.length > 0) {
      detected.push(`${name} (${matches.length}íšŒ)`);
      totalMatches += matches.length;
    }
  }

  // ì ìˆ˜ ê³„ì‚° (í…ìŠ¤íŠ¸ ê¸¸ì´ ëŒ€ë¹„)
  const textLength = text.length;
  const score = Math.min(100, Math.round((totalMatches / textLength) * 1000));

  return {
    detected: detected.length > 0,
    patterns: detected,
    score
  };
}
