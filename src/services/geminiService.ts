import { GoogleGenAI, Type } from "@google/genai";
import { GenerationRequest, GeneratedContent, TrendingItem, FactCheckReport, SeoScoreReport, SeoTitleItem, ImageStyle, WritingStyle, CardPromptData, CardNewsScript, CardNewsSlideScript } from "../types";
import { getStagePrompt, SYSTEM_PROMPT as GPT52_SYSTEM_PROMPT } from "../lib/gpt52-prompts-staged";
// ðŸš€ ì½˜í…ì¸  ìµœì í™” ì‹œìŠ¤í…œ
import { optimizePrompt, estimateTokens } from "../utils/promptOptimizer";
import { generateHumanWritingPrompt, detectAiSmell } from "../utils/humanWritingPrompts";
import { autoFixMedicalLaw } from "../utils/autoMedicalLawFixer";
import { contentCache } from "../utils/contentCache";

// í˜„ìž¬ ë…„ë„ë¥¼ ë™ì ìœ¼ë¡œ ê°€ì ¸ì˜¤ê¸°
const CURRENT_YEAR = new Date().getFullYear();

// OpenAI API í”„ë¡ì‹œ URL (CORS í•´ê²°)
const OPENAI_PROXY_URL = '/api/openai-chat';

const getAiClient = () => {
  // 1ìˆœìœ„: Cloudflare Pages í™˜ê²½ë³€ìˆ˜ (ë¹Œë“œ ì‹œ ì£¼ìž…ë¨)
  let apiKey = import.meta.env.VITE_GEMINI_API_KEY;
  
  // 2ìˆœìœ„: localStorage
  if (!apiKey) {
    apiKey = localStorage.getItem('GEMINI_API_KEY');
  }
  
  if (!apiKey) {
    throw new Error("API Keyê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. API Keyë¥¼ ìž…ë ¥í•´ì£¼ì„¸ìš”.");
  }
  return new GoogleGenAI({ apiKey });
};

// AI Provider ì„¤ì • ì½ê¸° - Geminië§Œ ì‚¬ìš©
const getAiProviderSettings = (): { textGeneration: 'gemini', imageGeneration: 'gemini' } => {
  console.log('ðŸ”§ AI ì„¤ì •: Gemini 3 Pro Preview');
  return { textGeneration: 'gemini', imageGeneration: 'gemini' };
};




// GPT-5.2 Responses API ì›¹ ê²€ìƒ‰ í•¨ìˆ˜
const callGPTWebSearch = async (query: string): Promise<any> => {
  const apiKey = localStorage.getItem('OPENAI_API_KEY');
  if (!apiKey) {
    console.warn('âš ï¸ OpenAI API í‚¤ê°€ ì—†ìŠµë‹ˆë‹¤');
    return null;
  }
  
  try {
    console.log('ðŸŸ¢ GPT-5.2 ì›¹ ê²€ìƒ‰ ì‹œìž‘...');
    
    // Responses API ì‚¬ìš© (web_search ë„êµ¬ í™œì„±í™”)
    const response = await fetch('https://api.openai.com/v1/responses', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${apiKey}`
      },
      body: JSON.stringify({
        model: 'gpt-5.2',
        tools: [
          { 
            type: 'web_search',
            // ì˜ë£Œ ê´€ë ¨ ì‹ ë¢°í•  ìˆ˜ ìžˆëŠ” ë„ë©”ì¸ í•„í„° (Gemini ê²€ìƒ‰ê³¼ ë™ì¼í•˜ê²Œ ì„¤ì •)
            search_context_size: 'high',
            user_location: {
              type: 'approximate',
              country: 'KR'
            }
          }
        ],
        tool_choice: 'auto',
        include: ['web_search_call.action.sources'],
        input: `ë‹¹ì‹ ì€ ì˜ë£Œ ì •ë³´ ê²€ìƒ‰ ì „ë¬¸ê°€ìž…ë‹ˆë‹¤.

[ê²€ìƒ‰ ê·œì¹™ - í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ì „ìš©]

ì£¼ì œ: ${query}

[ì¤‘ìš”]
ðŸš¨ðŸš¨ðŸš¨ [1ìˆœìœ„] health.kdca.go.kr ê²°ê³¼ ìµœìš°ì„  ë°°ì¹˜! ðŸš¨ðŸš¨ðŸš¨
- ë°˜ë“œì‹œ health.kdca.go.kr ê²°ê³¼ë¥¼ **ìµœì†Œ 2ê°œ, ìµœëŒ€ 5ê°œ** ìˆ˜ì§‘!
- collected_facts ë°°ì—´ì˜ **ë§¨ ì•žì—** health.kdca.go.kr ê²°ê³¼ ë°°ì¹˜!
- ë‹¤ë¥¸ ì¶œì²˜ë³´ë‹¤ health.kdca.go.krì„ ë¨¼ì € ê²€ìƒ‰í•˜ê³ , ë¨¼ì € ê¸°ë¡!
[ì¤‘ìš”]

ê²€ìƒ‰ ìˆœì„œ (ë°˜ë“œì‹œ ì´ ìˆœì„œëŒ€ë¡œ):
1ìˆœìœ„: health.kdca.go.kr (ì§ˆë³‘ê´€ë¦¬ì²­ ê±´ê°•ì •ë³´í¬í„¸) - ðŸ”¥ ìµœìš°ì„ ! ìµœì†Œ 2ê°œ!
2ìˆœìœ„: kdca.go.kr, mohw.go.kr (ë³´ê±´ë³µì§€ë¶€), nhis.or.kr, hira.or.kr
3ìˆœìœ„: *.or.kr (ëŒ€í•œOOí•™íšŒë§Œ), mfds.go.kr
4ìˆœìœ„: who.int, cdc.gov, nih.gov, pubmed.ncbi.nlm.nih.gov, jamanetwork.com (êµ­ë‚´ ì •ë³´ ë¶€ì¡± ì‹œì—ë§Œ!)

ê²€ìƒ‰ ì „ëžµ:
1. ë¨¼ì € "${query} site:health.kdca.go.kr" ê²€ìƒ‰ â†’ ê²°ê³¼ 2~5ê°œ ìˆ˜ì§‘
2. ë¶€ì¡±í•˜ë©´ "${query} site:kdca.go.kr" ê²€ìƒ‰
3. ê·¸ëž˜ë„ ë¶€ì¡±í•˜ë©´ ë‹¤ë¥¸ ìˆœìœ„ ê²€ìƒ‰

[[ê¸ˆì§€] ì ˆëŒ€ ê¸ˆì§€ - í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ì´ì™¸ ëª¨ë“  ì‚¬ì´íŠ¸ ì°¨ë‹¨!]

âŒ **ë¸”ë¡œê·¸ (ëª¨ë“  ë¸”ë¡œê·¸ ì ˆëŒ€ ê¸ˆì§€!)**
- blog.naver.com, tistory.com, brunch.co.kr
- storybongbong.co.kr âš ï¸ ì ˆëŒ€ ê¸ˆì§€!
- keyzard.cc âš ï¸ ì ˆëŒ€ ê¸ˆì§€!

âŒ **ì¹´íŽ˜/ì»¤ë®¤ë‹ˆí‹°**: cafe.naver.com, ë‹¤ìŒ ì¹´íŽ˜, ë§˜ì¹´íŽ˜, í™˜ìš°íšŒ ë“±

âŒ **SNS/ë¯¸ë””ì–´**: instagram.com, facebook.com, youtube.com (ëª¨ë“  ìœ íŠœë¸Œ ì˜ìƒ!)

âŒ **ì¼ë°˜ ê±´ê°• ì •ë³´ ì‚¬ì´íŠ¸**: health.chosun.com, hidoc.co.kr, kormedi.com, ë³‘ì› í™ˆíŽ˜ì´ì§€

âŒ **ê¸°íƒ€**: í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ì— ì—†ëŠ” ëª¨ë“  ì‚¬ì´íŠ¸!

**âœ… URL ê²€ì¦ ë°©ë²•:**
- URLì— health.kdca.go.kr í¬í•¨ â†’ âœ… ìµœìš°ì„ ! ë°˜ë“œì‹œ í¬í•¨!
- URLì— kdca.go.kr í¬í•¨ â†’ âœ… ìš°ì„ !
- URLì— .go.kr ë˜ëŠ” .or.kr í¬í•¨ â†’ âœ… í—ˆìš©
- í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ì— ì—†ëŠ” URL â†’ âŒ ì¦‰ì‹œ ê±´ë„ˆë›°ê¸°!

[ê²€ìƒ‰ ì§€ì‹œ]
- í˜„ìž¬ ${CURRENT_YEAR}ë…„ ê¸°ì¤€ ìµœì‹  ìžë£Œ ìš°ì„ 
- ðŸ”¥ health.kdca.go.kr ê²°ê³¼ë¥¼ **ê°€ìž¥ ë¨¼ì €**, **ê°€ìž¥ ë§Žì´** ìˆ˜ì§‘ (ìµœì†Œ 2ê°œ!)
- í†µê³„ëŠ” ë°˜ë“œì‹œ ì¶œì²˜ì™€ ì—°ë„ í¬í•¨
- ê°€ì´ë“œë¼ì¸ì€ ë°œí‘œ ê¸°ê´€ê³¼ ì—°ë„ ëª…ì‹œ

ðŸš¨ ì¶œì²˜ ê²€ì¦ í•„ìˆ˜ (P1 - ìœ„ë°˜ ì‹œ ì¦‰ì‹œ ì œì™¸)
- URL ë‚´ìš©ì´ í˜„ìž¬ ì£¼ì œ "${query}"ì™€ ì •í™•ížˆ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸
- ë‹¤ë¥¸ ì§ˆí™˜/ì¦ìƒ íŽ˜ì´ì§€ëŠ” ì ˆëŒ€ ì‚¬ìš© ê¸ˆì§€
- ì˜ˆ: ì–´ì§€ëŸ¼ì¦ ì£¼ì œì— ë‹¹ë‡¨ë³‘/ì²™ì¶”ê³¨ì ˆ URL ì‚¬ìš© ê¸ˆì§€
- ì£¼ì œì™€ ë¬´ê´€í•˜ë©´ í•´ë‹¹ ì¶œì²˜ ì œì™¸í•˜ê³  ë‹¤ë¥¸ ì¶œì²˜ ì°¾ê¸°

ë°˜ë“œì‹œ ì•„ëž˜ JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µí•˜ì„¸ìš” (health.kdca.go.kr URL ìš°ì„ !):
{
  "collected_facts": [
    {"fact": "health.kdca.go.kr ì²« ë²ˆì§¸ ì •ë³´", "source": "ì§ˆë³‘ê´€ë¦¬ì²­ ê±´ê°•ì •ë³´í¬í„¸", "year": ${CURRENT_YEAR}, "url": "https://health.kdca.go.kr/..."},
    {"fact": "health.kdca.go.kr ë‘ ë²ˆì§¸ ì •ë³´", "source": "ì§ˆë³‘ê´€ë¦¬ì²­ ê±´ê°•ì •ë³´í¬í„¸", "year": ${CURRENT_YEAR}, "url": "https://health.kdca.go.kr/..."},
    {"fact": "ê¸°íƒ€ ì¶œì²˜ ì •ë³´", "source": "ì¶œì²˜ëª…", "year": ${CURRENT_YEAR}, "url": "ì°¸ê³  URL"}
  ],
  "key_statistics": [{"stat": "í†µê³„ ë‚´ìš©", "value": "ìˆ˜ì¹˜", "source": "ì¶œì²˜", "year": ${CURRENT_YEAR}}],
  "latest_guidelines": [{"guideline": "ê°€ì´ë“œë¼ì¸ ë‚´ìš©", "organization": "ë°œí‘œ ê¸°ê´€", "year": ${CURRENT_YEAR}}]
}`
      })
    });

    if (!response.ok) {
      const error = await response.json();
      console.error('âŒ GPT-5.2 ì›¹ ê²€ìƒ‰ API ì˜¤ë¥˜:', error);
      return null;
    }

    const data = await response.json();
    console.log('ðŸŸ¢ GPT-5.2 Responses API ì‘ë‹µ:', data);
    
    // ë””ë²„ê¹…: ì „ì²´ output êµ¬ì¡° í™•ì¸
    if (data.output) {
      console.log('ðŸ“‹ GPT-5.2 output êµ¬ì¡°:', JSON.stringify(data.output, null, 2).substring(0, 2000));
    }
    
    // outputì—ì„œ í…ìŠ¤íŠ¸ ì¶”ì¶œ
    let textContent = '';
    let sources: any[] = [];
    
    if (data.output) {
      for (const item of data.output) {
        console.log('â€¢ item.type:', item.type);
        
        if (item.type === 'message' && item.content) {
          for (const content of item.content) {
            if (content.type === 'output_text') {
              textContent = content.text;
              // ì¶œì²˜ ì •ë³´ ì¶”ì¶œ (annotations)
              if (content.annotations && content.annotations.length > 0) {
                console.log('ðŸ“Ž annotations ë°œê²¬:', content.annotations.length, 'ê°œ');
                const urlCitations = content.annotations
                  .filter((a: any) => a.type === 'url_citation')
                  .map((a: any) => ({
                    title: a.title || a.text || 'Unknown',
                    url: a.url
                  }));
                if (urlCitations.length > 0) {
                  sources = [...sources, ...urlCitations];
                }
              }
            }
          }
        }
        
        // web_search_callì—ì„œ sources ì¶”ì¶œ (ì—¬ëŸ¬ ìœ„ì¹˜ í™•ì¸)
        if (item.type === 'web_search_call') {
          console.log('ðŸ”Ž web_search_call ë°œê²¬:', JSON.stringify(item, null, 2).substring(0, 1000));
          
          // action.sources ìœ„ì¹˜
          if (item.action?.sources && item.action.sources.length > 0) {
            const actionSources = item.action.sources.map((s: any) => ({
              title: s.title || s.name || 'Unknown',
              url: s.url
            }));
            sources = [...sources, ...actionSources];
          }
          
          // sources ì§ì ‘ ìœ„ì¹˜
          if (item.sources && item.sources.length > 0) {
            const directSources = item.sources.map((s: any) => ({
              title: s.title || s.name || 'Unknown',
              url: s.url
            }));
            sources = [...sources, ...directSources];
          }
          
          // results ìœ„ì¹˜ (ì¼ë¶€ API ë²„ì „)
          if (item.results && item.results.length > 0) {
            const resultSources = item.results.map((r: any) => ({
              title: r.title || r.name || 'Unknown',
              url: r.url
            }));
            sources = [...sources, ...resultSources];
          }
        }
        
        // web_search_result íƒ€ìž… ì²´í¬
        if (item.type === 'web_search_result' && item.sources) {
          console.log('ðŸ”Ž web_search_result ë°œê²¬');
          const resultSources = item.sources.map((s: any) => ({
            title: s.title || 'Unknown',
            url: s.url
          }));
          sources = [...sources, ...resultSources];
        }
      }
    }
    
    // ì¤‘ë³µ URL ì œê±°
    const uniqueSources = sources.filter((s, i, arr) => 
      arr.findIndex(t => t.url === s.url) === i
    );
    sources = uniqueSources;
    
    console.log('âœ… GPT-5.2 ì›¹ ê²€ìƒ‰ ì™„ë£Œ');
    console.log('   [ê°€ì´ë“œ] ì¶œì²˜:', sources.length, 'ê°œ');
    if (sources.length > 0) {
      console.log('   [ê°€ì´ë“œ] ì¶œì²˜ ëª©ë¡:', sources.map(s => s.url).join(', '));
    }
    
    try {
      // JSON ë¶€ë¶„ë§Œ ì¶”ì¶œ
      const jsonMatch = textContent.match(/\{[\s\S]*\}/);
      if (jsonMatch) {
        const parsed = JSON.parse(jsonMatch[0]);
        parsed.sources = sources;
        return parsed;
      }
      return { raw_content: textContent, sources };
    } catch (e) {
      console.warn('âš ï¸ GPT ì‘ë‹µ JSON íŒŒì‹± ì‹¤íŒ¨, í…ìŠ¤íŠ¸ë¡œ ì²˜ë¦¬');
      return { raw_content: textContent, sources };
    }
  } catch (error) {
    console.error('âŒ GPT-5.2 ì›¹ ê²€ìƒ‰ ì‹¤íŒ¨:', error);
    return null;
  }
};

// GPT-5.2 ì „ìš© í”„ë¡¬í”„íŠ¸ (ê³µí†µ ì˜ë£Œë²• + AI ëƒ„ìƒˆ ì œê±° í”¼ë“œë°± + GPT íŠ¹í™”)
const getGPT52Prompt = () => {
  const year = getCurrentYear();
  
  
  // GPT íŠ¹í™” ê·œì¹™ë§Œ ë³„ë„ë¡œ ì •ì˜ (ì˜ë£Œ ì•ˆì „, AI í”¼ë“œë°±ì€ í•¨ìˆ˜ í˜¸ì¶œë¡œ ì‚¬ìš©)
  // 3. GPTë§Œì˜ íŠ¹ìƒ‰ìžˆëŠ” ë¶€ë¶„
  const gptSpecificPrompt = `
[ìµœìš°ì„  ê·œì¹™ - ë°˜ë“œì‹œ ì§€ì¼œì•¼ í•  ê²ƒ]
1. ì´ëª¨ì§€ ì™„ì „ ê¸ˆì§€ - ë³¸ë¬¸/ì œëª©ì— ì´ëª¨ì§€ ì ˆëŒ€ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ
2. êµ¬ì²´ì  ìˆ«ìž ì™„ì „ ê¸ˆì§€ - ë¹ˆë„, ê¸°ê°„, ë¹„ìœ¨, í†µê³„ ìˆ«ìž ì‚¬ìš©í•˜ì§€ ì•ŠìŒ
   - "ì—° 2~4íšŒ" (X) â†’ "ë“œë¬¼ì§€ ì•Šê²Œ" (O)
   - "200ì—¬ ì¢…" (X) â†’ "ë‹¤ì–‘í•œ ì›ì¸" (O)
   - "70%" (X) â†’ "ìƒë‹¹ìˆ˜ê°€" (O)
   - "24~48ì‹œê°„" (X) â†’ "ê°œì¸ì°¨ê°€ ìžˆìœ¼ë©°" (O)
3. ë³‘ì˜ì› ë§ˆì¼€íŒ… ì „ë¬¸ê°€ê°€ ì“´ ê²ƒì²˜ëŸ¼ ê¹”ë”í•˜ê³  ì‹ ë¢°ê° ìžˆëŠ” í†¤ ìœ ì§€
[ìµœìš°ì„  ê·œì¹™ ë]

[ì¤‘ìš”]
[GPT-5.2 íŠ¹í™” ê·œì¹™ - Geminiì™€ ì°¨ë³„í™”ë˜ëŠ” ë¶€ë¶„ë§Œ]
[ì¤‘ìš”]

[ðŸ”Ž ê²€ìƒ‰ ë° ì •ë³´ í™œìš© ê°€ì´ë“œ - í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ì—„ê²© ì ìš©!]

**ðŸš¨ ìµœìš°ì„  ì›ì¹™: í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ì— ì—†ëŠ” ì‚¬ì´íŠ¸ëŠ” ì ˆëŒ€ ì°¸ê³  ê¸ˆì§€! ðŸš¨**

**ìƒí™©:** Geminiê°€ ìˆ˜ì§‘í•´ ì¤€ ì •ë³´(Context)ë¥¼ ìµœìš°ì„ ìœ¼ë¡œ ì‚¬ìš©í•˜ì„¸ìš”.
**ì˜ˆì™¸:** ë§Œì•½ Geminiì˜ ì •ë³´ê°€ ë¶€ì¡±í•˜ê±°ë‚˜ ì „ë‹¬ë˜ì§€ ì•Šì•˜ì„ ê²½ìš°, ë‹¹ì‹ ì˜ ì§€ì‹ì„ í™œìš©í•˜ë˜ **ë°˜ë“œì‹œ ì•„ëž˜ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ì¶œì²˜ë§Œ ì‚¬ìš©**í•´ì•¼ í•©ë‹ˆë‹¤.

**[âœ… ê²€ìƒ‰/ì°¸ê³  í—ˆìš© í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ - ì´ê²ƒë§Œ í—ˆìš©!]**

[ì¤‘ìš”]
ðŸ”¥ðŸ”¥ðŸ”¥ **1ìˆœìœ„: health.kdca.go.kr - ìµœìš°ì„  ë°°ì¹˜! ìµœì†Œ 2ê°œ!** ðŸ”¥ðŸ”¥ðŸ”¥
âœ… health.kdca.go.kr (ì§ˆë³‘ê´€ë¦¬ì²­ ê±´ê°•ì •ë³´í¬í„¸ - ì¼ë°˜ì¸ ëŒ€ìƒ)
  â†’ ðŸš¨ ë°˜ë“œì‹œ ì´ ì‚¬ì´íŠ¸ ê²°ê³¼ë¥¼ **ìµœì†Œ 2ê°œ, ìµœëŒ€ 5ê°œ** ê¸€ì— ì¸ìš©!
  â†’ ðŸš¨ ê¸€ì˜ **ë„ìž…ë¶€ ë˜ëŠ” ì²« ë²ˆì§¸ ì†Œì œëª©**ì— health.kdca.go.kr ì¸ìš© í•„ìˆ˜!
  â†’ ì´ ì‚¬ì´íŠ¸ì—ì„œ ì¶©ë¶„í•œ ìžë£Œë¥¼ ì°¾ì•˜ë‹¤ë©´ í•´ì™¸ ì‚¬ì´íŠ¸ ê²€ìƒ‰ ìƒëžµ!
[ì¤‘ìš”]

**2ìˆœìœ„: ëŒ€í•œë¯¼êµ­ ì •ë¶€ ê¸°ê´€**
âœ… kdca.go.kr (ì§ˆë³‘ê´€ë¦¬ì²­ - ë³´ë„ìžë£Œ, í†µê³„, ê°ì—¼ë³‘)
âœ… mohw.go.kr (ë³´ê±´ë³µì§€ë¶€)
âœ… nhis.or.kr (êµ­ë¯¼ê±´ê°•ë³´í—˜ê³µë‹¨ - ê±´ê°•ê²€ì§„, í†µê³„)
âœ… hira.or.kr (ê±´ê°•ë³´í—˜ì‹¬ì‚¬í‰ê°€ì› - ì˜ë£Œ í†µê³„)
âœ… mfds.go.kr (ì‹í’ˆì˜ì•½í’ˆì•ˆì „ì²˜ - ì˜ì•½í’ˆ, ì‹í’ˆì•ˆì „)
âœ… *.or.kr í•™íšŒ ë„ë©”ì¸ (ëŒ€í•œOOí•™íšŒ ê³µì‹ë§Œ! - ê°€ì´ë“œë¼ì¸)

**3ìˆœìœ„: í•´ì™¸ ê³µì‹ ë ¥ ì‚¬ì´íŠ¸ (êµ­ë‚´ ì •ë³´ ë¶€ì¡± ì‹œì—ë§Œ!)**
âœ… who.int (WHO), cdc.gov (CDC), nih.gov (NIH)
âœ… pubmed.ncbi.nlm.nih.gov (PubMed)
âœ… jamanetwork.com (JAMA), nejm.org (NEJM), thelancet.com (Lancet), bmj.com (BMJ)
âœ… ê³µì‹ ë…¼ë¬¸ DB: riss.kr, kiss.kstudy.com, koreamed.org
  â†’ 1~2ìˆœìœ„ì—ì„œ ì¶©ë¶„í•œ ìžë£Œë¥¼ ì°¾ì•˜ë‹¤ë©´ ì´ ë‹¨ê³„ëŠ” ìƒëžµ!

ðŸ“‹ **ê²€ìƒ‰ ì „ëžµ (health.kdca.go.kr ìµœìš°ì„ !):**
âœ… 1ë‹¨ê³„: health.kdca.go.krì—ì„œ ìµœì†Œ 2ê°œ ê²°ê³¼ ìˆ˜ì§‘ (í•„ìˆ˜!)
âœ… 2ë‹¨ê³„: ë¶€ì¡±í•˜ë©´ kdca.go.kr, mohw.go.kr ë“±ì—ì„œ ë³´ì¶©
âœ… 3ë‹¨ê³„: ê·¸ëž˜ë„ ë¶€ì¡±í•  ë•Œë§Œ í•´ì™¸ ìžë£Œ ì°¸ê³ 
âœ… ê¸€ ìž‘ì„± ì‹œ health.kdca.go.kr ì¸ìš©ì„ ê°€ìž¥ ë¨¼ì €, ê°€ìž¥ ëˆˆì— ë„ê²Œ ë°°ì¹˜!

**[[ê¸ˆì§€] ì ˆëŒ€ ì°¸ê³  ê¸ˆì§€ - í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ì™¸ ëª¨ë“  ì‚¬ì´íŠ¸!]**

ðŸš¨ **í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ì— ì—†ìœ¼ë©´ ë¬´ì¡°ê±´ ê¸ˆì§€! ì ˆëŒ€ ì˜ˆì™¸ ì—†ìŒ!** ðŸš¨

âŒ **ë¸”ë¡œê·¸**: ë„¤ì´ë²„ ë¸”ë¡œê·¸, í‹°ìŠ¤í† ë¦¬, ë¸ŒëŸ°ì¹˜, ê°œì¸ ì›¹ì‚¬ì´íŠ¸
   âš ï¸ storybongbong.co.kr - ì ˆëŒ€ ì°¸ê³  ê¸ˆì§€!
   âš ï¸ keyzard.cc - ì ˆëŒ€ ì°¸ê³  ê¸ˆì§€!
âŒ **ì»¤ë®¤ë‹ˆí‹°**: ë§˜ì¹´íŽ˜, í™˜ìš°íšŒ, ë””ì‹œì¸ì‚¬ì´ë“œ, ì§€ì‹iN
âŒ **SNS/ë¯¸ë””ì–´**: ìœ íŠœë¸Œ(ì˜ì‚¬ ì±„ë„ í¬í•¨), ì¸ìŠ¤íƒ€ê·¸ëž¨, íŽ˜ì´ìŠ¤ë¶, ë‚˜ë¬´ìœ„í‚¤, ìœ„í‚¤ë°±ê³¼
âŒ **ì¼ë°˜ ê±´ê°•ë§¤ì²´**: í•˜ì´ë‹¥, í—¬ìŠ¤ì¡°ì„ , ì½”ë©”ë””ë‹·ì»´ ë“±
âŒ **ê¸°íƒ€**: í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ì— ëª…ì‹œë˜ì§€ ì•Šì€ ëª¨ë“  ì‚¬ì´íŠ¸

**[âš ï¸ ì •ë³´ ë¶€ì¡± ì‹œ GPT í–‰ë™ ìˆ˜ì¹™]**
- ì¶œì²˜ê°€ ë¶ˆë¶„ëª…í•œ ìˆ˜ì¹˜("70%ê°€ ê²ªìŠµë‹ˆë‹¤")ëŠ” ì‚¬ìš©í•˜ì§€ ë§ê³ , "ë§Žì€ ë¶„ë“¤ì´ ê²ªìŠµë‹ˆë‹¤"ë¡œ ì¼ë°˜í™”í•˜ì„¸ìš”.
- ë¶ˆí™•ì‹¤í•œ ì •ë³´ëŠ” íšŒí”¼í˜•("ë‹¨ì • ì–´ë µìŠµë‹ˆë‹¤")ì´ ì•„ë‹Œ **í–‰ë™ ì¤‘ì‹¬**ìœ¼ë¡œ í‘œí˜„í•˜ì„¸ìš”.
  âŒ "í™•ì‹¤í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤" â†’ âœ… "ì´ëŸ° íŒ¨í„´ì´ ë°˜ë³µë˜ë©´ ì²´í¬í•´ë³´ì„¸ìš”"
- ì ˆëŒ€ ë¸”ë¡œê·¸ë‚˜ ìœ íŠœë¸Œì—ì„œ ë³¸ ë“¯í•œ 'ì¹´ë”ë¼' í†µì‹ ì„ ì„žì§€ ë§ˆì„¸ìš”.

**[ðŸš¨ ìˆ«ìž ì™„ì „ ê¸ˆì§€ - ì˜ë£Œê´‘ê³ ë²• ìœ„ë°˜ ë°©ì§€!]**
âŒ ëª¨ë“  êµ¬ì²´ì  ìˆ«ìž ì‚¬ìš© ê¸ˆì§€:
- ë¹ˆë„: "ì—° 2~4íšŒ", "6~8íšŒ", "10ëª… ì¤‘ 8ëª…"
- ê¸°ê°„: "24~48ì‹œê°„", "2~3ì¼", "1ì£¼ì¼"
- ë¹„ìœ¨: "70%", "200ì—¬ ì¢…", "ì ˆë°˜ ì´ìƒ"
- í†µê³„: "51.7%", "90% ì´ìƒ"
âœ… ëŒ€ì²´ í‘œí˜„:
- "ë‹¤ì–‘í•œ ì›ì¸ì´ ìžˆìŠµë‹ˆë‹¤" (ìˆ«ìž X)
- "ê°œì¸ì°¨ê°€ ìžˆìŠµë‹ˆë‹¤" (ê¸°ê°„ X)
- "ë“œë¬¼ì§€ ì•Šê²Œ ë°œìƒí•©ë‹ˆë‹¤" (ë¹ˆë„ X)
- "ìƒë‹¹ìˆ˜ê°€ ê²½í—˜í•©ë‹ˆë‹¤" (ë¹„ìœ¨ X)

[ì¤‘ìš”]
[GPT-5.2 ìƒìœ„ê¶Œ ê¸€ ìž‘ì„± í•µì‹¬ ê·œì¹™ - ${year}ë…„ ì—…ê·¸ë ˆì´ë“œ]
[ì¤‘ìš”]

**ëª©í‘œ: ì •ë³´Â·í†¤Â·ì˜ë£Œë²•Â·ì „í™˜ íë¦„ì´ ê· í˜• ìž¡ížŒ ìƒìœ„ 1~3ìœ„ ê¸€ ìž‘ì„±**

**0. ì´ëª¨ì§€ ì™„ì „ ê¸ˆì§€**
   - ë³¸ë¬¸ì— ì´ëª¨ì§€ ì ˆëŒ€ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ (ì „ë¬¸ ì˜ë£Œ ì½˜í…ì¸  í†¤)
   - ë³‘ì˜ì› ë§ˆì¼€íŒ… ë‹¬ì¸ì´ ì“´ ê²ƒì²˜ëŸ¼ ê¹”ë”í•˜ê³  ì‹ ë¢°ê° ìžˆê²Œ
   - ê°•ì¡°ëŠ” ì´ëª¨ì§€ ëŒ€ì‹  ë¬¸ìž¥ êµ¬ì¡°ì™€ ë‹¨ì–´ ì„ íƒìœ¼ë¡œ

**1. GPT íŠ¹ìœ ì˜ ì¡°ê±´í˜•Â·ì™„ì¶©í˜• ë¬¸ìž¥ ìŠ¤íƒ€ì¼ ê°•í™”**
   - "~ìˆ˜ ìžˆìŠµë‹ˆë‹¤" ì—°ì† 3íšŒ ì ˆëŒ€ ê¸ˆì§€ (Geminië³´ë‹¤ ì—„ê²©)
   - ëŒ€ì²´ í‘œí˜„ ì ê·¹ í™œìš©: "~ê²½ìš°ë„ ìžˆìŠµë‹ˆë‹¤", "~ë¡œ ì•Œë ¤ì ¸ ìžˆìŠµë‹ˆë‹¤", "~ì¼ ê°€ëŠ¥ì„±ë„ ìžˆìŠµë‹ˆë‹¤"
   - ë¬¸ìž¥ ë¦¬ë“¬ ë‹¤ì–‘í™”ë¡œ AI ëƒ„ìƒˆ ì œê±°

**2. ìƒí™œ ë§¥ë½ ì¤‘ì‹¬ í‚¤ì›Œë“œ ë…¹ì´ê¸° (ì •ì˜í˜• ê¸ˆì§€)**
   âŒ Geminiì‹: "ë°œëª© ì—¼ì¢Œëž€ ë°œëª© ì¸ëŒ€ê°€ ëŠ˜ì–´ë‚˜ê±°ë‚˜ ì°¢ì–´ì§„ ìƒíƒœë¥¼ ë§í•©ë‹ˆë‹¤"
   âœ… GPTì‹: "ê³„ë‹¨ ë‚´ë ¤ì˜¤ë‹¤ê°€ ë°œëª©ì´ êº¾ì˜€ëŠ”ë°, ë©°ì¹ ì´ ì§€ë‚˜ë„ ë¶“ê¸°ê°€ ë¹ ì§€ì§€ ì•ŠëŠ”ë‹¤ë©´..."
   
   **í•µì‹¬ ì›ì¹™:**
   - ì •ì˜Â·ì„¤ëª… ë¬¸ìž¥ â†’ ì‹¤ì œ ìƒí™œ ìž¥ë©´ ë¬¸ìž¥ìœ¼ë¡œ ì „í™˜
   - ê±·ê¸°, ê³„ë‹¨, ì•„ì¹¨ ì²« ì›€ì§ìž„, ë°˜ë³µë˜ëŠ” ë¶ˆíŽ¸ê° ë“± êµ¬ì²´ì  ìƒí™© ì‚¬ìš©

**3. ê´€ì°°ìž ì‹œì  ë¬¸ìž¥ í•„ìˆ˜ í¬í•¨ (ê° ë¬¸ë‹¨ ìµœì†Œ 1ê°œ)**
   âŒ AI ëƒ„ìƒˆ ë‚˜ëŠ” ì •ì˜í˜•: "ì†Œí™”ë¶ˆëŸ‰ì€ ë‹¤ì–‘í•œ ì›ì¸ì— ì˜í•´ ë°œìƒí•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤"
   âœ… ì‚¬ëžŒ ëƒ„ìƒˆ ë‚˜ëŠ” ê´€ì°°í˜•: "ì‹¤ì œë¡œ ìŠ¤íŠ¸ë ˆìŠ¤ê°€ ìŒ“ì˜€ì„ ë•Œ ì´ëŸ° ë¶ˆíŽ¸í•¨ì„ ëŠë¼ëŠ” ë¶„ë“¤ë„ ì ì§€ ì•ŠìŠµë‹ˆë‹¤"
   
   **ê´€ì°°ìž ì‹œì  ë¬¸ìž¥ íŒ¨í„´:**
   - "~í•˜ì‹œëŠ” ë¶„ë“¤ì´ ë§Žë”ë¼ê³ ìš”"
   - "ì´ëŸ° ê²½í—˜ì„ í•˜ì‹  ë¶„ë“¤ë„ ê³„ì‹­ë‹ˆë‹¤"
   - "ë¹„ìŠ·í•œ ê³ ë¯¼ì„ ê°€ì§„ ë¶„ë“¤ì´ ê¶ê¸ˆí•´í•˜ì‹œëŠ” ë¶€ë¶„ì´ì—ìš”"

**4. êµ¬ì¡°: Gemini êµê³¼ì„œì‹ íƒˆí”¼ â†’ GPT ê´€ì°°-í•´ì„-ì •ë¦¬ êµ¬ì¡°**
   âŒ Geminiì‹: ì •ì˜ â†’ ì›ì¸ â†’ ì¦ìƒ â†’ ì¹˜ë£Œ (êµê³¼ì„œ)
   âœ… GPTì‹: ê´€ì°° â†’ í•´ì„ â†’ ë¶€ì—° â†’ ì •ë¦¬ (ëŒ€í™”)
   
   **ë„ìž…ë¶€ í•„ìˆ˜:**
   - ë°”ë¡œ ìƒí™œ ìž¥ë©´ìœ¼ë¡œ ì‹œìž‘ (ì •ì˜ ê¸ˆì§€)
   - ì˜ˆ: "ì•„ì¹¨ì— ì¼ì–´ë‚˜ì„œ ì²« ë°œì„ ë””ë”œ ë•Œ ë°œë’¤ê¿ˆì¹˜ê°€ ì°Œë¦¿í•˜ë‹¤ë©´..."
   
   **ë³¸ë¬¸ í•„ìˆ˜:**
   - ë…ìž ìžê°€ ì ê²€ ë¬¸ìž¥ 1~2íšŒ í¬í•¨
   - ì˜ˆ: "ì´ëŸ° ìƒí™©ì´ ë°˜ë³µëœë‹¤ë©´...", "ë‹¨ìˆœ í”¼ë¡œë¼ê³  ë„˜ê¸°ê¸°ì—” ë¹ˆë„ê°€ ìž¦ë‹¤ë©´..."

**5. ë¬¸ìž¥ ì²« ì‹œìž‘ì€ 'ë¶ˆì™„ì „í•˜ê²Œ' (AI í‹° ì œê±° í•µì‹¬)**
   âŒ AIì‹ ì™„ë²½í•œ ì²« ë¬¸ìž¥: "ì†Œí™”ë¶ˆëŸ‰ì€ ë‹¤ì–‘í•œ ì›ì¸ì— ì˜í•´ ë°œìƒí•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤"
   âœ… ì‚¬ëžŒì‹ ë¶ˆì™„ì „í•œ ì‹œìž‘: "ê¼­ ë§Žì´ ë¨¹ì§€ ì•Šì•˜ëŠ”ë°ë„, ì†ì´ ë‹µë‹µí•œ ë‚ ì´ ìžˆìŠµë‹ˆë‹¤"
   
   **ì›ì¹™:** ì™„ë²½í•œ ì •ì˜ëŠ” 2~3ë¬¸ìž¥ ë’¤ì—, ì²« ë¬¸ìž¥ì€ ìƒí™© ë¬˜ì‚¬ë‚˜ ì§ˆë¬¸ìœ¼ë¡œ!

[ì¤‘ìš”]
[ðŸ”¥ ìžê°€ ì ê²€ íŒë‹¨ íŠ¸ë¦¬ê±° í•„ìˆ˜! - í•µì‹¬ ì—…ê·¸ë ˆì´ë“œ]
[ì¤‘ìš”]

**âš ï¸ ë³¸ë¬¸(ë³¸ë¡ ) íŒŒíŠ¸ì— ë°˜ë“œì‹œ 'íŒë‹¨ íŠ¸ë¦¬ê±° ë¬¸ìž¥' 1~2íšŒ í¬í•¨!**

**íŒë‹¨ íŠ¸ë¦¬ê±°ëž€?**
- ë…ìžê°€ "ë‚´ ì–˜ê¸°ë„¤?" ëŠë¼ë©° ìŠ¤ìŠ¤ë¡œ íŒë‹¨í•˜ê²Œ ë§Œë“œëŠ” ë¬¸ìž¥
- ë‹¨ìˆœ ì •ë³´ ë‚˜ì—´ì´ ì•„ë‹Œ, ìžê°€ ì ê²€ ìœ ë„ ë¬¸ìž¥

**âœ… íŒë‹¨ íŠ¸ë¦¬ê±° íŒ¨í„´ (ë°˜ë“œì‹œ 1ê°œ ì´ìƒ ì‚¬ìš©!):**
- "ì´ ì¤‘ 2ê°€ì§€ ì´ìƒ ê²¹ì¹œë‹¤ë©´, ë‹¨ìˆœ í”¼ë¡œê°€ ì•„ë‹ ìˆ˜ ìžˆì–´ìš”"
- "ì´ëŸ° ì‹ í˜¸ê°€ 3ì¼ ì´ìƒ ì§€ì†ëœë‹¤ë©´..."
- "ìœ„ í•­ëª© ì¤‘ í•´ë‹¹ë˜ëŠ” ê²Œ ë§Žë‹¤ë©´, í™•ì¸ì´ í•„ìš”í•œ ì‹œì ìž…ë‹ˆë‹¤"
- "ì´ íŒ¨í„´ì´ ë°˜ë³µëœë‹¤ë©´, 'ê°'ë³´ë‹¤ 'ê¸°ì¤€'ìœ¼ë¡œ ë´ì•¼ í•  ìˆ˜ ìžˆì–´ìš”"
- "2~3ê°œ ì´ìƒ ê²¹ì¹˜ì‹œë‚˜ìš”? ê·¸ë ‡ë‹¤ë©´..."

**âŒ íŒë‹¨ íŠ¸ë¦¬ê±° ì—†ëŠ” ì•½í•œ ê¸€ (ì§€ì–‘!):**
- ë‹¨ìˆœ ì¦ìƒ ë¦¬ìŠ¤íŠ¸ë§Œ ë‚˜ì—´
- "í™•ì¸í•´ë³¼ í•„ìš”ê°€ ìžˆìŠµë‹ˆë‹¤" ê°™ì€ ì• ë§¤í•œ ë§ˆë¬´ë¦¬
- ë…ìžê°€ "ê·¸ëž˜ì„œ ë‚´ê°€ í•´ë‹¹ë˜ë‚˜?" íŒë‹¨ ëª»í•˜ëŠ” ê¸€

**ðŸ’¡ ë³¸ë¡  íŒŒíŠ¸ì—ì„œ ë¦¬ìŠ¤íŠ¸/ì²´í¬í¬ì¸íŠ¸ ë‹¤ìŒì— ë°˜ë“œì‹œ íŒë‹¨ íŠ¸ë¦¬ê±° ì‚½ìž…!**
ì˜ˆì‹œ:
"â˜‘ï¸ ëª©ì´ ì¹¼ì¹¼í•œ ëŠë‚Œì´ ë©°ì¹ ì§¸
â˜‘ï¸ ë¯¸ì—´ì´ ì˜¤ë½ê°€ë½
â˜‘ï¸ ì½§ë¬¼ë³´ë‹¤ ê¸°ì¹¨ì´ ë” ë¨¼ì €

â†’ ì´ ì¤‘ 2ê°€ì§€ ì´ìƒ í•´ë‹¹ëœë‹¤ë©´, ë‹¨ìˆœ ê°ê¸°ì™€ êµ¬ë¶„ì´ í•„ìš”í•œ ì‹œì ì¼ ìˆ˜ ìžˆì–´ìš”."

[ì¤‘ìš”]
[ðŸŽ¯ CTA êµ¬ì¡° ì—…ê·¸ë ˆì´ë“œ - 'í™•ì¸ ë°©ë²• ížŒíŠ¸' í•„ìˆ˜!]
[ì¤‘ìš”]

**âš ï¸ ë¬¸ì œ: "í™•ì¸ì´ í•„ìš”í•˜ë‹¤"ë§Œ ìžˆìœ¼ë©´ ë…ìžê°€ "ì–´ë–»ê²Œ?" ì˜ë¬¸**

**âœ… GPTí˜• CTA = ì—¬ë°± + í™•ì¸ ë°©ë²• ížŒíŠ¸**

**ê¸°ì¡´ GPT CTA (ì•½í•¨):**
- "í™•ì¸ì´ í•„ìš”í•œ ì‹œì ì¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤" â† ë°©ë²•ì´ ì—†ìŒ
- "ì§€ì¼œë³´ê¸°ë³´ë‹¤ ì›ì¸ì„ í™•ì¸í•´ë³´ëŠ” ê²ƒë„ ë°©ë²•" â† ì¶”ìƒì 

**ì—…ê·¸ë ˆì´ë“œëœ GPT CTA (ê°•í•¨):**
âœ… "ì• ë§¤í• ìˆ˜ë¡, 'ê°'ë³´ë‹¤ 'ê¸°ì¤€'ì´ íŽ¸í•´ì ¸ìš”. ì˜ë£Œì§„ê³¼ ê°„ë‹¨ížˆ í™•ì¸í•˜ëŠ” ê²ƒë§Œìœ¼ë¡œë„ ë‹µë‹µí•¨ì´ ì¤„ì–´ë“¤ ìˆ˜ ìžˆìŠµë‹ˆë‹¤."
âœ… "ë°˜ë³µëœë‹¤ë©´, ì§„ë£Œ ê¸°ì¤€ìœ¼ë¡œ í™•ì¸í•´ë³´ì‹œëŠ” ê²Œ ë„ì›€ì´ ë©ë‹ˆë‹¤."
âœ… "ì´ëŸ° ì‹ í˜¸ê°€ ê²¹ì¹œë‹¤ë©´, ê°€ê¹Œìš´ ê³³ì—ì„œ í•œë²ˆ ì²´í¬í•´ë³´ì‹œëŠ” ê²ƒë„ ë°©ë²•ì´ì—ìš”."
âœ… "ì¦ìƒì´ ì§€ì†ë  ë•ŒëŠ” 'ë‚´ê°€ ëŠë¼ëŠ” ê²ƒ'ë³´ë‹¤ 'ê°ê´€ì  ê¸°ì¤€'ìœ¼ë¡œ ë³´ëŠ” ê²Œ íŽ¸í•©ë‹ˆë‹¤. ì˜ë£Œì§„ ìƒë‹´ì´ ê·¸ ê¸°ì¤€ì´ ë  ìˆ˜ ìžˆì–´ìš”."

**CTA ê³µì‹:**
[ì—´ë¦° ê²°ë¡ ] + [í™•ì¸ ë°©ë²• ížŒíŠ¸(ì˜ë£Œì§„ ìƒë‹´/ì§„ë£Œ ê¸°ì¤€/ê°€ê¹Œìš´ ê³³ ì²´í¬)]

**[ê¸ˆì§€] ì ˆëŒ€ ê¸ˆì§€:**
- "ë³‘ì› ë°©ë¬¸í•˜ì„¸ìš”", "ë‚´ê³¼ ê°€ì„¸ìš”" â† ì§ì ‘ ê¶Œìœ 
- "ì˜ˆì•½í•˜ì„¸ìš”", "ìƒë‹´ ë°›ìœ¼ì„¸ìš”" â† í–‰ë™ ê°•ìš”

**âœ… í—ˆìš©ë˜ëŠ” ížŒíŠ¸ í‘œí˜„:**
- "ì˜ë£Œì§„ê³¼ í™•ì¸"
- "ì§„ë£Œ ê¸°ì¤€ìœ¼ë¡œ"
- "ê°€ê¹Œìš´ ê³³ì—ì„œ ì²´í¬"
- "ê°ê´€ì  ê¸°ì¤€ìœ¼ë¡œ í™•ì¸"

[ì¤‘ìš”]
[ðŸ“ ì œëª© ìƒì„± ê°•í™” - ìƒìœ„ê¶Œ í•„ìˆ˜ ì¡°ê±´!]
[ì¤‘ìš”]

**ðŸŽ¯ ì œëª©ì´ ë°œëª© ìž¡ìœ¼ë©´ ë³¸ë¬¸ 92ì ë„ ì˜ë¯¸ ì—†ìŒ!**

**âœ… ìƒìœ„ê¶Œ ì œëª© ê³µì‹ (4ìš”ì†Œ ì¡°í•©):**
[ì‹œê¸°ì„±(ì„ íƒ)] + [ì¼ìƒ ì¦ìƒ] + [ì˜ì‹¬ í”„ë ˆìž„] + [í™•ì¸/ì²´í¬ ê¸°ì¤€]

**ì˜ˆì‹œ:**
âœ… "ìš”ì¦˜ ì½”ë§‰íž˜ì¸ë° ì½§ë¬¼ì€ ì—†ë‹¤ë©´? ê°ê¸° vs ë‹¤ë¥¸ ì›ì¸ êµ¬ë¶„ ê¸°ì¤€"
   â†’ [ì‹œê¸°ì„±: ìš”ì¦˜] + [ì¼ìƒ ì¦ìƒ: ì½”ë§‰íž˜+ì½§ë¬¼ ì—†ìŒ] + [ì˜ì‹¬ í”„ë ˆìž„: ê°ê¸° vs ë‹¤ë¥¸ ì›ì¸] + [ê¸°ì¤€]
   
âœ… "ê²¨ìš¸ì²  ê¸°ì¹¨ì´ ê¸¸ì–´ì§ˆ ë•Œ, ë‹¨ìˆœ ê°ê¸°ì¸ì§€ í™•ì¸í•˜ëŠ” ì²´í¬í¬ì¸íŠ¸"
   â†’ [ì‹œê¸°ì„±: ê²¨ìš¸ì² ] + [ì¼ìƒ ì¦ìƒ: ê¸°ì¹¨ ê¸¸ì–´ì§] + [ì˜ì‹¬: ë‹¨ìˆœ ê°ê¸°ì¸ì§€] + [í™•ì¸ ê¸°ì¤€]

âœ… "ë©°ì¹ ì§¸ ëª©ì´ ì¹¼ì¹¼í•œë° ì—´ì€ ì—†ë‹¤ë©´? í™•ì¸ì´ í•„ìš”í•œ ì‹ í˜¸ë“¤"
   â†’ [ì¼ìƒ ì¦ìƒ: ëª© ì¹¼ì¹¼+ì—´ ì—†ìŒ] + [ì˜ì‹¬ í”„ë ˆìž„] + [í™•ì¸ ê¸°ì¤€]

**âŒ ì•½í•œ ì œëª© (ì§€ì–‘!):**
- "ê°ê¸° ì¦ìƒ ì´ì •ë¦¬" â† ì •ë³´ ë‚˜ì—´í˜•
- "ê¸°ì¹¨ì´ ë‚˜ì˜¬ ë•Œ ì•Œì•„ì•¼ í•  ê²ƒ" â† êµê³¼ì„œí˜•
- "í˜¸í¡ê¸° ê±´ê°• ê´€ë¦¬ë²•" â† ì¶”ìƒì 

**ðŸ’¡ ì œëª© ìžê°€ ê²€ì¦:**
â–¡ ì‹œê¸°ì„± í‚¤ì›Œë“œ ìžˆë‚˜? (ìš”ì¦˜, ê²¨ìš¸ì² , í™˜ì ˆê¸°, ìµœê·¼)
â–¡ ì¼ìƒ ì¦ìƒì´ êµ¬ì²´ì ì¸ê°€? (ê¸°ì¹¨, ì½§ë¬¼, ëª© ì¹¼ì¹¼í•¨ ë“±)
â–¡ "~ì¸ì§€", "~ì¼ê¹Œìš”?" ë“± ì˜ì‹¬ í”„ë ˆìž„ ìžˆë‚˜?
â–¡ "í™•ì¸", "ì²´í¬", "ê¸°ì¤€", "ì‹ í˜¸" ë“± í–‰ë™ ìœ ë„ ìžˆë‚˜?

[ì¤‘ìš”]
[âœ… GPT ìµœì¢… ìžê°€ ê²€í†  - ìƒìœ„ê¶Œ ê¸€ ì²´í¬ë¦¬ìŠ¤íŠ¸]
[ì¤‘ìš”]

**[A] ê¸°ë³¸ í’ˆì§ˆ (í•„ìˆ˜)**
â–¡ "~ìˆ˜ ìžˆìŠµë‹ˆë‹¤" ì—°ì† 3íšŒ ì´ìƒ ì—†ëŠ”ê°€?
â–¡ ê° ë¬¸ë‹¨ì— ê´€ì°°ìž ì‹œì  ë¬¸ìž¥ì´ 1ê°œ ì´ìƒ ìžˆëŠ”ê°€?
â–¡ ì²« ë¬¸ìž¥ì´ ì •ì˜ê°€ ì•„ë‹Œ ìƒí™© ë¬˜ì‚¬ë¡œ ì‹œìž‘í•˜ëŠ”ê°€?
â–¡ êµê³¼ì„œì‹ êµ¬ì¡°(ì •ì˜â†’ì›ì¸â†’ì¹˜ë£Œ)ê°€ ì•„ë‹Œê°€?

**[B] ìƒìœ„ê¶Œ í•„ìˆ˜ ì¡°ê±´ (ì—…ê·¸ë ˆì´ë“œ)**
â–¡ ë³¸ë¬¸ì— 'íŒë‹¨ íŠ¸ë¦¬ê±°' ë¬¸ìž¥ì´ 1~2íšŒ ìžˆëŠ”ê°€?
   ("ì´ ì¤‘ 2ê°€ì§€ ì´ìƒ ê²¹ì¹œë‹¤ë©´...", "ì´ íŒ¨í„´ì´ ë°˜ë³µëœë‹¤ë©´...")
â–¡ CTAì— 'í™•ì¸ ë°©ë²• ížŒíŠ¸'ê°€ ìžˆëŠ”ê°€?
   ("ì˜ë£Œì§„ê³¼ í™•ì¸", "ì§„ë£Œ ê¸°ì¤€ìœ¼ë¡œ", "ê°€ê¹Œìš´ ê³³ì—ì„œ ì²´í¬")
â–¡ ì œëª©ì— 4ìš”ì†Œ(ì‹œê¸°ì„±+ì¼ìƒ ì¦ìƒ+ì˜ì‹¬ í”„ë ˆìž„+í™•ì¸ ê¸°ì¤€) ì¤‘ 3ê°œ ì´ìƒ?

**[C] ë§ˆë¬´ë¦¬ (ì—¬ë°±)**
â–¡ ë§ˆë¬´ë¦¬ê°€ ë„ˆë¬´ ê¹”ë”í•˜ì§€ ì•Šê³  ì—¬ë°±ì´ ìžˆëŠ”ê°€?
â–¡ ë…ìžê°€ "ê·¸ëž˜ì„œ ë‚˜ëŠ”?" ìŠ¤ìŠ¤ë¡œ íŒë‹¨í•  ê³µê°„ì´ ìžˆëŠ”ê°€?

â†’ **A ì „ë¶€ + B 2ê°œ ì´ìƒ ì¶©ì¡± ì‹œ ìƒìœ„ê¶Œ ê¸€!**

[ì¤‘ìš”]
[ðŸŽ¨ GPT-5.2 ì „ìš©: êµ¬ì¡°ì  ë°˜ë³µ íƒˆí”¼ & í‘œí˜„ ê°œì„ ]
[ì¤‘ìš”]

**1. êµ¬ì¡°ì  ë°˜ë³µ íŒ¨í„´ ê¸ˆì§€**
âš ï¸ **'ì„¤ëª… ë¬¸ë‹¨ + ë¶ˆë¦¿í¬ì¸íŠ¸ ë¦¬ìŠ¤íŠ¸' êµ¬ì¡°ë¥¼ 3ê°œ ì´ìƒ ì—°ì† ì‚¬ìš© ê¸ˆì§€!**

âŒ ë‚˜ìœ ì˜ˆ (ê¸°ê³„ì  ë°˜ë³µ):
- ì˜¤ì‹­ê²¬ íë¦„ â†’ ë¦¬ìŠ¤íŠ¸
- ë‹¨ìˆœ ì¶”ìœ„ êµ¬ë¶„ â†’ ë¦¬ìŠ¤íŠ¸
- ì²´í¬ í¬ì¸íŠ¸ â†’ ë¦¬ìŠ¤íŠ¸

âœ… ì¢‹ì€ ì˜ˆ (í˜•ì‹ ë³€ì£¼):
- ì˜¤ì‹­ê²¬ íë¦„ â†’ ë¦¬ìŠ¤íŠ¸
- ë‹¨ìˆœ ì¶”ìœ„ êµ¬ë¶„ â†’ **Q&A í˜•ì‹ ë˜ëŠ” ëŒ€í™”ì²´ ì¤„ê¸€**
- ì²´í¬ í¬ì¸íŠ¸ â†’ íƒ€ìž„ë¼ì¸ ë˜ëŠ” ë¹„êµí‘œ

**í˜•ì‹ ë³€ì£¼ ì˜µì…˜:**
- Q&A ëŒ€í™” í˜•ì‹
- íƒ€ìž„ë¼ì¸/ë‹¨ê³„ë³„ ì„œìˆ 
- ë¹„êµí‘œ (A vs B)
- ì¼€ì´ìŠ¤ ìŠ¤í„°ë”” (ì‹¤ì œ ì‚¬ë¡€)
- ìžê°€ ì§„ë‹¨ ì²´í¬ë¦¬ìŠ¤íŠ¸

**2. ì¶œì²˜ í‘œê¸° ìžì—°ìŠ¤ëŸ½ê²Œ ë…¹ì´ê¸°**
âš ï¸ **'ê¸°ê´€ëª…(ì—°ë„)' í˜•ì‹ì˜ ë”±ë”±í•œ í‘œê¸° ê¸ˆì§€!**

âŒ ê¸ˆì§€ íŒ¨í„´:
- "ì§ˆë³‘ê´€ë¦¬ì²­(2024)"
- "ëŒ€í•œê²¬Â·ì£¼ê´€ì ˆì˜í•™íšŒ(2025)"
- "ë³´ê±´ë³µì§€ë¶€(2025)"
â†’ ë¬¸ë§¥ì„ ë”±ë”±í•˜ê²Œ ëŠì–´ë¨¹ëŠ” í‘œí˜„!

âœ… ìžì—°ìŠ¤ëŸ¬ìš´ ëŒ€ì²´ í‘œí˜„:
- "ìµœê·¼ ì˜í•™ ì§€ì¹¨ì—ì„œëŠ”"
- "ì „ë¬¸ê°€ë“¤ì€ ì´ë ‡ê²Œ ì„¤ëª…í•©ë‹ˆë‹¤"
- "í”ížˆ ì•Œë ¤ì§„ ë°”ë¡œëŠ”"
- "ìµœì‹  ì—°êµ¬ ê²°ê³¼ë¥¼ ë³´ë©´"
- "ì˜ë£Œê³„ì—ì„œëŠ”"

**ì¶œì²˜ í‘œê¸° ê·œì¹™:**
- í•„ìš”ì‹œ ë¬¸ìž¥ ë ë˜ëŠ” ê°ì£¼ë¡œ ì²˜ë¦¬
- ë³¸ë¬¸ íë¦„ ë‚´ì—ì„œëŠ” ìžì—°ìŠ¤ëŸ¬ìš´ í‘œí˜„ ì‚¬ìš©
- ë§ë¯¸ì— ì¶œì²˜ ë§í¬ ì‚½ìž… ê°€ëŠ¥

**3. íŒë‹¨ ë‹¨ì •í˜• í‘œí˜„ ì œê±°**
   - "~ìž…ë‹ˆë‹¤", "~ë©ë‹ˆë‹¤" ë‹¨ì • í‘œí˜„ ê¸ˆì§€
   - "~ìˆ˜ ìžˆìŠµë‹ˆë‹¤", "~ê²½ìš°ë„ ìžˆìŠµë‹ˆë‹¤", "~ë¡œ ì•Œë ¤ì ¸ ìžˆìŠµë‹ˆë‹¤" ì‚¬ìš©
âš ï¸ **'ë‹¨ì •í•˜ê¸´ ì–´ë µìŠµë‹ˆë‹¤', 'ê²°ë¡ ì„ ë‚´ë¦¬ì§„ ì•ŠìŠµë‹ˆë‹¤' ë“± ë°©ì–´ì  í‘œí˜„ ë°˜ë³µ ê¸ˆì§€!**

âŒ íšŒí”¼í˜• íŒ¨í„´:
- "ë‹¨ì •í•˜ê¸°ëŠ” ì–´ë µìŠµë‹ˆë‹¤" (ë°˜ë³µ)
- "ê²°ë¡ ì„ ë‚´ë¦¬ì§€ ì•ŠìŠµë‹ˆë‹¤"
- "í™•ì‹¤í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤"
- ëª¨ë“  ì¦ìƒ ì„¤ëª… ë’¤ì— "ë‹¤ë¥¸ ë¬¸ì œì¼ ìˆ˜ë„ ìžˆë‹¤" ê¸°ê³„ì ìœ¼ë¡œ ë¶™ìž„

âœ… íŠ¹ì§• ì¤‘ì‹¬ + í–‰ë™ ì‹œì  ì œì•ˆ:
- âŒ "ë‹¨ì •í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤"
- âœ… "ì´ëŸ° íŒ¨í„´ì´ ë³´ì´ë©´ ì˜¤ì‹­ê²¬ì˜ íŠ¹ì§•ì— ë” ê°€ê¹ìŠµë‹ˆë‹¤"

- âŒ "ê²°ë¡ ì„ ë‚´ë¦¬ì§€ ì•ŠìŠµë‹ˆë‹¤"
- âœ… "ì´ëŸ° ì¦ìƒì´ ê²¹ì¹œë‹¤ë©´ ë‹¤ë¥¸ ì›ì¸ì„ ì‚´íŽ´ë´ì•¼ í•  íƒ€ì´ë°ì´ì—ìš”"

- âŒ "í™•ì‹¤í•˜ì§€ ì•Šìœ¼ë‹ˆ ì£¼ì˜í•˜ì„¸ìš”"
- âœ… "ì´ ì‹œì ì—ì„œ ì „ë¬¸ê°€ ì˜ê²¬ì„ ë“¤ì–´ë³´ëŠ” ê²Œ ë„ì›€ì´ ë©ë‹ˆë‹¤"

**4. ê¸°ê³„ì  ê³µê° í‘œí˜„ ì§€ì–‘**
âš ï¸ **'ì‹ ê²½ì´ ì“°ì´ì£ ', 'ë” ì‹ ê²½ì´ ì“°ì´ì£ ' ë“± ë°˜ë³µ ê¸ˆì§€!**

âŒ ê¸°ê³„ì  ê³µê°:
- "ì–´ê¹¨ í†µì¦ì´ ìžˆìœ¼ë©´ ì‹ ê²½ì´ ì“°ì´ì£ "
- "ì´ëŸ° ì¦ìƒì´ ë‚˜íƒ€ë‚˜ë©´ ë” ì‹ ê²½ì´ ì“°ì´ì£ "
- "ë¶ˆíŽ¸í•´ì§ˆ ìˆ˜ ìžˆìŠµë‹ˆë‹¤" (ë²”ìš©ì )

âœ… êµ¬ì²´ì  ìƒí™© ë¬˜ì‚¬:
- âŒ "ì–´ê¹¨ í†µì¦ì´ ìžˆìœ¼ë©´ ì‹ ê²½ì´ ì“°ì´ì£ "
- âœ… "ìš´ì „ì„ì—ì„œ ë’·ì¢Œì„ ë¬¼ê±´ ì§‘ìœ¼ë ¤ë‹¤ ê¹œì§ ë†€ë¼ì‹  ì  ìžˆìœ¼ì‹œì£ ?"

- âŒ "ì¼ìƒì´ ë¶ˆíŽ¸í•´ì§ˆ ìˆ˜ ìžˆìŠµë‹ˆë‹¤"
- âœ… "ë¨¸ë¦¬ ê°ì„ ë•Œ íŒ”ì´ ê·€ì— ì•ˆ ë‹¿ì•„ì„œ ê³ ê°œë¥¼ ìˆ™ì´ê²Œ ë˜ëŠ”"

- âŒ "í†µì¦ì´ ì‹¬í•´ì§€ë©´"
- âœ… "ì˜· ê°ˆì•„ìž…ì„ ë•Œë§ˆë‹¤ 'ì•„ì´ê³ ' ì†Œë¦¬ê°€ ë‚˜ì˜¤ëŠ”"

**5. CTA(í–‰ë™ ìœ ë„) ì§ê´€í™”**
âš ï¸ **ì¶”ìƒì  í‘œí˜„ ëŒ€ì‹  ì§ê´€ì ì´ê³  êµ¬ì²´ì ìœ¼ë¡œ!**

âŒ ì¶”ìƒì  CTA:
- "ì ê²€í•˜ëŠ” ë‹¨ê³„ì¸ì§€ ë‚˜ëˆ ë³¼ ë•Œì˜ˆìš”"
- "ì˜ë£Œì§„ê³¼ ë²”ìœ„ë¥¼ ì ê²€"

âœ… ì§ê´€ì  CTA:
- "ì°¸ëŠ” ê²Œ ì•½ì´ ì•„ë‹ ìˆ˜ ìžˆìŠµë‹ˆë‹¤"
- "í†µì¦ì˜ ì›ì¸ì„ í•œ ë²ˆ ì§šê³  ë„˜ì–´ê°€ëŠ” ê²ƒì´ ê²¨ìš¸ì„ íŽ¸í•˜ê²Œ ë³´ë‚´ëŠ” ë°©ë²•ì´ì—ìš”"
- "ì´ ìƒíƒœë¡œ ë²„í‹°ëŠ” ê²ƒë³´ë‹¤ ë¹¨ë¦¬ í™•ì¸í•˜ëŠ” ê²Œ ë‚˜ì„ ìˆ˜ ìžˆì–´ìš”"

**â€» GPT-5.2 ìž‘ì„± í›„ ìžê°€ ê²€í† :**
â–¡ ë™ì¼í•œ êµ¬ì¡°(ì„¤ëª…+ë¦¬ìŠ¤íŠ¸)ê°€ 3íšŒ ì´ìƒ ì—°ì†ë˜ì§€ ì•Šì•˜ëŠ”ê°€?
â–¡ 'ê¸°ê´€ëª…(ì—°ë„)' í˜•ì‹ì´ ë³¸ë¬¸ì— 4íšŒ ì´ìƒ ë“±ìž¥í•˜ì§€ ì•Šì•˜ëŠ”ê°€?
â–¡ 'ë‹¨ì •í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤' ê°™ì€ íšŒí”¼ í‘œí˜„ì´ ë°˜ë³µë˜ì§€ ì•Šì•˜ëŠ”ê°€?
â–¡ 'ì‹ ê²½ì´ ì“°ì´ì£ ' ê°™ì€ ê¸°ê³„ì  ê³µê°ì´ ì—†ëŠ”ê°€?
â–¡ CTAê°€ êµ¬ì²´ì ì´ê³  ì§ê´€ì ì¸ê°€?

[ì¤‘ìš”]
[ðŸ”¥ GPT-5.2 ê°•ë ¥ ê·œì¹™: êµ¬ì²´ì  ì‚¬ë¡€ ê¸°ë°˜ ê¸ˆì§€ íŒ¨í„´]
[ì¤‘ìš”]

**âš ï¸ ì´ ê·œì¹™ë“¤ì€ ì ˆëŒ€ì ìœ¼ë¡œ ì¤€ìˆ˜í•´ì•¼ í•©ë‹ˆë‹¤! âš ï¸**

**6. ì¸ìš© ì „ë‹¬í˜• ì„œìˆ  ê¸ˆì§€**
âŒ **ì ˆëŒ€ ì‚¬ìš© ê¸ˆì§€ - ì œ3ìž ë’¤ì— ìˆ¨ëŠ” í‘œí˜„:**
- "~ì„¤ëª…í•©ë‹ˆë‹¤"
- "~ì•ˆë‚´í•´ìš”"
- "~ì œì‹œí•©ë‹ˆë‹¤"
- "~ì–¸ê¸‰ë©ë‹ˆë‹¤"
- "ìžë£Œë¥¼ ë³´ë©´ ì–¸ê¸‰ë©ë‹ˆë‹¤"
- "íë¦„ì´ ì œì‹œë©ë‹ˆë‹¤"
- "ê°€ì´ë“œë¼ì¸ì—ì„œ ì„¤ëª…í•˜ê³  ìžˆìŠµë‹ˆë‹¤"

âœ… **ëŠ¥ë™ì  í‘œí˜„ìœ¼ë¡œ ë³€ê²½:**
- âŒ "ìžë£Œë¥¼ ë³´ë©´ ì–¸ê¸‰ë©ë‹ˆë‹¤"
- âœ… "ì´ëŸ° ë°©ë²•ì´ ì£¼ë¡œ í™œìš©ë˜ëŠ” ì¶”ì„¸ì˜ˆìš”"

- âŒ "ê°€ì´ë“œë¼ì¸ì—ì„œ ì„¤ëª…í•˜ê³  ìžˆìŠµë‹ˆë‹¤"
- âœ… "ì¼ë°˜ì ìœ¼ë¡œ ì´ë ‡ê²Œ ì ‘ê·¼í•˜ëŠ” íŽ¸ì´ì—ìš”"

- âŒ "ì—°êµ¬ì—ì„œ ì œì‹œë©ë‹ˆë‹¤"
- âœ… "ìµœê·¼ ì—°êµ¬ ê²°ê³¼ë¥¼ ë³´ë©´ ì´ëŸ° íŒ¨í„´ì´ í™•ì¸ë˜ê³  ìžˆì–´ìš”"

**7. ë¬¸ìž¥ ëë§ºìŒ ë‹¤ì–‘í™” í•„ìˆ˜**
âŒ **ë‹¨ì¡°ë¡œìš´ ì¢…ê²°ì–´ë¯¸ ë°˜ë³µ ê¸ˆì§€:**
- "~ì„¤ëª…í•©ë‹ˆë‹¤" Ã— 3íšŒ ì´ìƒ
- "~ì•ˆë‚´í•´ìš”" Ã— 3íšŒ ì´ìƒ
- "~ì œì‹œí•©ë‹ˆë‹¤" Ã— 3íšŒ ì´ìƒ

âœ… **ë‹¤ì–‘í•œ ì¢…ê²°ì–´ë¯¸ ì‚¬ìš©:**
- "~ì´ì—ìš”", "~í•˜ì£ ", "~í•  ìˆ˜ ìžˆì–´ìš”"
- "~ê²½ìš°ê°€ ë§Žì•„ìš”", "~ì¶”ì„¸ì˜ˆìš”"
- "~ë„ì›€ì´ ë˜ê³¤ í•´ìš”", "~íŽ¸ì´ì—ìš”"
- "~ì°¸ê³ í•´ë³´ì„¸ìš”", "~ì‚´íŽ´ë³¼ ìˆ˜ ìžˆì–´ìš”"

**8. íšŒí”¼í˜• ì „ê°€ ë¬¸êµ¬ ê¸ˆì§€**
âŒ **ì±…ìž„ íšŒí”¼ í‘œí˜„ ì ˆëŒ€ ê¸ˆì§€:**
- "ê°œì¸ ìƒíƒœì™€ ë™ë°˜ ì§ˆí™˜ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìžˆìŠµë‹ˆë‹¤"
- "ê°œì¸ì°¨ê°€ ìžˆì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤"
- "ì¼€ì´ìŠ¤ë§ˆë‹¤ ë‹¤ë¥¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤"

âœ… **êµ¬ì²´ì  ê¸°ì¤€ ì œì‹œ:**
- âŒ "ê°œì¸ ìƒíƒœì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìžˆìŠµë‹ˆë‹¤"
- âœ… "ë‹¹ë‡¨ë‚˜ ê³ í˜ˆì••ì´ ìžˆìœ¼ì‹œë‹¤ë©´ ì´ ë¶€ë¶„ì€ ì „ë¬¸ê°€ì™€ ìƒì˜ê°€ í•„ìš”í•´ìš”"

- âŒ "ê°œì¸ì°¨ê°€ ìžˆìŠµë‹ˆë‹¤"
- âœ… "ì²´ì¤‘ì´ë‚˜ ì—°ë ¹ëŒ€ì— ë”°ë¼ íšŒë³µ ì†ë„ê°€ ë‹¤ë¥¼ ìˆ˜ ìžˆì–´ìš”"

**9. ìƒí™œ ë°€ì°©í˜• ê²¨ìš¸ì²  ë¬˜ì‚¬ í•„ìˆ˜**
âŒ **ìƒë¦¬í•™ì  ì„¤ëª…ë§Œ ë‚˜ì—´ ê¸ˆì§€:**
- "ì¶”ìœ„ë¡œ ê·¼ìœ¡ ê¸´ìž¥"
- "ê¸°ì˜¨ í•˜ê°•ìœ¼ë¡œ í˜ˆì•¡ìˆœí™˜ ì €í•˜"

âœ… **êµ¬ì²´ì  ìƒí™œ ìƒí™© ë¬˜ì‚¬:**
- âŒ "ì¶”ìœ„ë¡œ ê·¼ìœ¡ì´ ê¸´ìž¥í•˜ë©´"
- âœ… "ë‘êº¼ìš´ íŒ¨ë”©ì„ ìž…ìœ¼ë ¤ íŒ”ì„ ë‚„ ë•Œ 'ì–µ' ì†Œë¦¬ê°€ ë‚˜ì˜¤ê±°ë‚˜"

- âŒ "ê²¨ìš¸ì²  ê´€ì ˆì´ êµ³ì–´ì„œ"
- âœ… "ë¬´ê±°ìš´ ì´ë¶ˆì„ í„± ë°‘ê¹Œì§€ ëŒì–´ì˜¬ë¦´ ë•Œ ì–´ê¹¨ê°€ ê²°ë¦¬ëŠ” ëŠë‚Œ"

- âŒ "ê¸°ì˜¨ì´ ë‚®ì•„ì§€ë©´"
- âœ… "ì•„ì¹¨ì— ì°¨ê°€ìš´ ì„¸ë©´ëŒ€ ìˆ˜ë„ê¼­ì§€ë¥¼ í‹€ ë•Œ ì†ëª©ì´ ë»ê·¼í•œ"

**10. ê¹Šì€ ê³µê° í‘œí˜„ í•„ìˆ˜**
âŒ **ì–•ì€ ê³µê° ê¸ˆì§€:**
- "ë” ì‹ ê²½ ì“°ì´ì£ "
- "ë¶ˆíŽ¸í•˜ì‹¤ ìˆ˜ ìžˆì–´ìš”"
- "ê±±ì •ë˜ì‹œì£ "

âœ… **êµ¬ì²´ì  ê°ì •+ìƒí™© ë¬˜ì‚¬:**
- âŒ "ë°¤ì— í†µì¦ì´ ìžˆìœ¼ë©´ ì‹ ê²½ ì“°ì´ì£ "
- âœ… "ìžë ¤ê³  ëˆ„ì› ëŠ”ë° ìžì„¸ê°€ ì•ˆ ìž¡í˜€ì„œ 30ë¶„ ë„˜ê²Œ ë’¤ì²™ì´ë‹¤ ë³´ë©´ ì§œì¦ì´ í™• ë°€ë ¤ì˜¤ê¸°ë„ í•˜ì£ "

- âŒ "í†µì¦ì´ ì§€ì†ë˜ë©´ ë¶ˆíŽ¸í•˜ì‹¤ ê±°ì˜ˆìš”"
- âœ… "í•œìˆ¨ë„ ëª» ìžê³  ë’¤ì²™ì´ë‹¤ ë³´ë‹ˆ ë‹¤ìŒ ë‚  íšŒì˜ ì‹œê°„ì— ë© ë•Œë¦¬ê²Œ ë˜ëŠ”"

- âŒ "ì¼ìƒìƒí™œì´ íž˜ë“¤ì–´ì§€ì£ "
- âœ… "ìš´ì „í•  ë•Œ ì‚¬ê°ì§€ëŒ€ í™•ì¸í•˜ë ¤ê³  ê³ ê°œ ëŒë¦´ ë•Œë§ˆë‹¤ 'ìœ¼ìœ½' í•˜ëŠ” ì†Œë¦¬ê°€ ì ˆë¡œ ë‚˜ì˜¤ë©´"

**1.1. CTA êµ¬ì²´í™” & ê°„ê²°í™” í•„ìˆ˜**
âŒ **í˜•ì‹ì ì´ê³  ê¸´ CTA ê¸ˆì§€:**
- "ê°€ê¹Œìš´ ì˜ë£Œê¸°ê´€ì—ì„œ ì§„ë£Œ ê¸°ì¤€ìœ¼ë¡œ í•œ ë²ˆ ì •ë¦¬í•´ë³´ëŠ” ê²ƒì´ ë„ì›€ì´ ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤" (ë„ˆë¬´ ê¹€!)

âœ… **ì§§ê³  êµ¬ì²´ì ì¸ CTA:**
- "ë©°ì¹ ì§¸ ìž ì„ ì„¤ì¹  ì •ë„ë¼ë©´, í˜¼ìž ê³ ë¯¼í•˜ê¸°ë³´ë‹¤ ì „ë¬¸ê°€ì™€ ìƒì˜í•´ í˜„ìž¬ ìƒíƒœì˜ ê¸°ì¤€ì ì„ ìž¡ì•„ë³´ëŠ” ê²Œ ì¢‹ì•„ìš”"
- "í†µì¦ ë•Œë¬¸ì— ì—…ë¬´ì— ì§€ìž¥ì´ ìƒê¸´ë‹¤ë©´, ì°¸ëŠ” ê²ƒë³´ë‹¤ ë¹¨ë¦¬ í™•ì¸í•˜ëŠ” ê²Œ ë‚˜ì•„ìš”"

**1.2. CTA ë°•ìŠ¤ì— ìž‘ì€ í–‰ë™ ì œì•ˆ ì¶”ê°€**
âŒ **ë‹¨ìˆœ ë³¸ë¬¸ ìš”ì•½ë§Œ ìžˆëŠ” CTA ë°•ìŠ¤ ê¸ˆì§€**

âœ… **êµ¬ì²´ì ì´ê³  ìž‘ì€ í–‰ë™ ì œì•ˆ í¬í•¨:**
- "ì˜¤ëŠ˜ ë°¤ í†µì¦ì´ ì–¸ì œ ì‹¬í•´ì¡ŒëŠ”ì§€ í•œ ë²ˆ ë– ì˜¬ë ¤ë³´ì„¸ìš”"
- "ì–´ë–¤ ìžì„¸ì—ì„œ ê°€ìž¥ ì•„í”ˆì§€ ì²´í¬í•´ë‘ë©´ ì§„ë£Œ ì‹œ ë„ì›€ì´ ë¼ìš”"
- "ì§€ê¸ˆ íŒ”ì„ ìœ„ë¡œ ì˜¬ë ¤ë³´ì„¸ìš” - ê·€ì— ë‹¿ë‚˜ìš”?"

**âš ï¸ 'ê¸°ë¡' ëŒ€ì‹  ì“°ê¸° ì¢‹ì€ í‘œí˜„ 5ê°€ì§€ (ì €í•­ê° â†“):**
'ê¸°ë¡í•˜ì„¸ìš”'ëŠ” ë…ìžì—ê²Œ ê³¼ì œì²˜ëŸ¼ ëŠê»´ì§ˆ ìˆ˜ ìžˆì–´ìš”. ë” ê°€ë³ê³  ìžì—°ìŠ¤ëŸ¬ìš´ í‘œí˜„ìœ¼ë¡œ!

1. **"í•œ ë²ˆ ë– ì˜¬ë ¤ë³´ì„¸ìš” / ì§šì–´ë³´ì„¸ìš”"** (ê°€ìž¥ ë¬´ë‚œ, ì €í•­ ì—†ìŒ)
   - âœ… "ì˜¤ëŠ˜ì€ í†µì¦ì´ ì–¸ì œ ì‹¬í•´ì¡ŒëŠ”ì§€ í•œ ë²ˆ ë– ì˜¬ë ¤ë³´ì„¸ìš”."
   - âœ… "ë‚® í™œë™ ì´í›„ì¸ì§€, ëˆ„ì›Œì„œ ì‰¬ëŠ” ì¤‘ì¸ì§€ì— ë”°ë¼ ì˜ë¯¸ê°€ ë‹¬ë¼ì§ˆ ìˆ˜ ìžˆì–´ìš”."

2. **"ê·¸ë‚ ê·¸ë‚  ëŠë‚Œì„ êµ¬ë¶„í•´ë³´ëŠ” ê²ƒ"** (ë©”ëª¨ ë¶€ë‹´ â†“, ê´€ì°° ëŠë‚Œ â†‘)
   - âœ… "ê·¸ë‚ ê·¸ë‚  ì–´ëŠ ì‹œê°„ëŒ€ì— ë” ë¶ˆíŽ¸í–ˆëŠ”ì§€ë§Œ êµ¬ë¶„í•´ë´ë„"
   - âœ… "ë‹¨ìˆœ í”¼ë¡œì¸ì§€ ë‹¤ë¥¸ íë¦„ì¸ì§€ ê°ì´ ë‹¬ë¼ì§ˆ ìˆ˜ ìžˆìŠµë‹ˆë‹¤."

3. **"ë¨¸ë¦¿ì†ì— ê¸°ì¤€ í•˜ë‚˜ë§Œ ì„¸ì›Œë‘ê¸°"** (ë°˜ì‘ ì¢‹ìŒ!)
   - âœ… "ë³µìž¡í•˜ê²Œ ì ì§€ ì•Šì•„ë„ ê´œì°®ì•„ìš”."
   - âœ… "'ë°¤ì— ë” ì•„í”„ë‹¤' 'ê³„ë‹¨ì—ì„œ ì‹¬í•˜ë‹¤' ì •ë„ë§Œ ë¨¸ë¦¿ì†ì— ê¸°ì¤€ í•˜ë‚˜ ì„¸ì›Œë‘ëŠ” ê²ƒë¶€í„° ì¶©ë¶„í•©ë‹ˆë‹¤."

4ìˆœìœ„:"ë‹¤ìŒì— ë¹„êµí•  í¬ì¸íŠ¸ ë§Œë“¤ì–´ë‘ê¸°"** (ì „í™˜ ì„¤ê³„ì— ìµœì )
   - âœ… "ì§€ê¸ˆ ìƒíƒœë¥¼ ë‹¤ìŒì— ë¹„êµí•  í¬ì¸íŠ¸ ì •ë„ë¡œë§Œ ìƒê°í•´ë‘ë©´,"
   - âœ… "ë¹„ìŠ·í•œ í†µì¦ì´ ì™”ì„ ë•Œ íŒë‹¨ì´ í›¨ì”¬ ì‰¬ì›Œì§‘ë‹ˆë‹¤."

5. **"ì´ëŸ° íŒ¨í„´ì´ ë°˜ë³µë˜ëŠ”ì§€ë§Œ ì²´í¬í•´ë³´ê¸°"** (ì²´í¬ = ê°€ë²¼ì›€)
   - âœ… "ì˜¤ëŠ˜ì€ í†µì¦ì´ ê°™ì€ ì‹œê°„ëŒ€ì— ë°˜ë³µë˜ëŠ”ì§€ë§Œ ê°€ë³ê²Œ ì²´í¬í•´ë³´ì…”ë„ ì¶©ë¶„í•´ìš”."

âŒ **ê¸°ë¡ ê´€ë ¨ ê¸ˆì§€ í‘œí˜„:**
- "ê¸°ë¡í•´ë³´ì„¸ìš”", "ë©”ëª¨í•´ë‘ì„¸ìš”", "ì¼ì§€ë¥¼ ìž‘ì„±í•´ë³´ì„¸ìš”"
- "ë§¤ì¼ ì ì–´ë‘ì„¸ìš”", "ë…¸íŠ¸ì— ê¸°ë¡í•˜ì„¸ìš”"

[ì¤‘ìš”]
[[ê¸ˆì§€] ì¦ìƒ ë‚˜ì—´ ì ˆëŒ€ ê¸ˆì§€ íŒ¨í„´ - ì§„ë‹¨ ê¸°ì¤€í˜• ì„œìˆ  ê¸ˆì§€]
[ì¤‘ìš”]

**âš ï¸ ì•„ëž˜ì™€ ê°™ì€ 'ì§„ë‹¨ ê¸°ì¤€' ìŠ¤íƒ€ì¼ì˜ ê±´ì¡°í•œ ì¦ìƒ ë‚˜ì—´ì„ ì ˆëŒ€ ê¸ˆì§€í•©ë‹ˆë‹¤!**
âŒ **ê¸ˆì§€ ì˜ˆì‹œ (ì ˆëŒ€ ì‚¬ìš© ê¸ˆì§€):**
- "ë³µí†µê³¼ í•¨ê»˜ ì„¤ì‚¬ ë˜ëŠ” êµ¬í† ê°€ ë™ë°˜ëœë‹¤"
- "ë©”ìŠ¤êº¼ì›€ì´ ì‹¬í•´ ìˆ˜ë¶„ ì„­ì·¨ê°€ ë¶€ë‹´ìŠ¤ëŸ½ê²Œ ëŠê»´ì§„ë‹¤"
- "ìž…ì´ ë§ˆë¥´ê±°ë‚˜ ì–´ì§€ëŸ¬ì›€ì´ ë™ë°˜ë˜ëŠ” ë“± ìˆ˜ë¶„ ë¶€ì¡±ì´ ì˜ì‹¬ëœë‹¤"
- "í•¨ê»˜ ì‹ì‚¬í•œ ì‚¬ëžŒì—ê²Œë„ ë¹„ìŠ·í•œ ì¦ìƒì´ ë‚˜íƒ€ë‚œë‹¤"
- "ì¦ìƒì´ 3ì¼ ì´ìƒ ì§€ì†ëœë‹¤"

âœ… **ìƒí™œ ë°€ì°©í˜• ë³€í™˜ ì˜ˆì‹œ:**
- âŒ "ë³µí†µê³¼ êµ¬í†  ë™ë°˜" â†’ âœ… "í™”ìž¥ì‹¤ì„ ë‹¤ë…€ì™€ë„ ë°°ê°€ ì¥ì–´ì§œë“¯ ì•„í”„ê³ ..."
- âŒ "ìˆ˜ë¶„ ì„­ì·¨ ë¶€ë‹´" â†’ âœ… "ë¬¼ í•œ ëª¨ê¸ˆ ë§ˆì‹œê¸°ë„ ê²ë‚  ì •ë„ë¡œ ì†ì´ ìš¸ë ê±°ë¦´ ë•Œ"
- âŒ "ìˆ˜ë¶„ ë¶€ì¡± ì˜ì‹¬" â†’ âœ… "ìž…ì´ ë°”ì§ë°”ì§ ë§ˆë¥´ê³  ë¨¸ë¦¬ê°€ í•‘ ë„ëŠ” ëŠë‚Œì´ ë“ ë‹¤ë©´"
- âŒ "ë™ë°˜ìž ì¦ìƒ" â†’ âœ… "ê°™ì´ ë°¥ ë¨¹ì€ ê°€ì¡±ì´ë‚˜ ë™ë£Œë„ ì†ì´ ì•ˆ ì¢‹ë‹¤ê³  í•œë‹¤ë©´"
- âŒ "ì¦ìƒ ì§€ì†" â†’ âœ… "í•˜ë£¨ ì´í‹€ ì‰¬ì—ˆëŠ”ë°ë„ ì»¨ë””ì…˜ì´ ëŒì•„ì˜¤ì§€ ì•Šì„ ë•Œ"

**â€» ì›ì¹™: 'ì¦ìƒ ëª…ì‚¬' ë‚˜ì—´ì´ ì•„ë‹ˆë¼, 'ë‚´ê°€ ê²ªëŠ” ìƒí™©'ìœ¼ë¡œ í’€ì–´ì„œ ì„œìˆ í•˜ì„¸ìš”!**

[ì¤‘ìš”]
[ðŸŽ¯ GPT-5.2 ì¶”ê°€ ê°œì„  ê·œì¹™: ìµœì‹ ì„± & ëª°ìž…ë„ & ê³µê°ë„ ê°•í™”]
[ì¤‘ìš”]

**1.3. êµ¬ì²´ì  ì—°ë„ í‘œê¸° ì œê±° (ìµœì‹ ì„± í™•ë³´)**

ðŸš¨ðŸš¨ðŸš¨ **ì ˆëŒ€ ê¸ˆì§€: ê¸°ê´€ëª…(ì—°ë„) í˜•ì‹ ì‚¬ìš© ê¸ˆì§€!** ðŸš¨ðŸš¨ðŸš¨

âŒ **ì™„ì „ ê¸ˆì§€ íŒ¨í„´ (1íšŒë„ ì‚¬ìš© ê¸ˆì§€!):**
- "ì§ˆë³‘ê´€ë¦¬ì²­(2024)" â† ì ˆëŒ€ ê¸ˆì§€!
- "ì§ˆë³‘ê´€ë¦¬ì²­(2025)" â† ì ˆëŒ€ ê¸ˆì§€!
- "ì§ˆë³‘ê´€ë¦¬ì²­(2026)" â† ì ˆëŒ€ ê¸ˆì§€!
- "ëŒ€í•œOOí•™íšŒ(2024)" â† ì ˆëŒ€ ê¸ˆì§€!
- "ëŒ€í•œOOí•™íšŒ(2025)" â† ì ˆëŒ€ ê¸ˆì§€!
- "ëŒ€í•œOOí•™íšŒ(2026)" â† ì ˆëŒ€ ê¸ˆì§€!
- "ëŒ€í•œë§ˆì·¨í†µì¦ì˜í•™íšŒ(2026)" â† ì ˆëŒ€ ê¸ˆì§€!
- "ë³´ê±´ë³µì§€ë¶€(2025)" â† ì ˆëŒ€ ê¸ˆì§€!
- **ëª¨ë“  "ê¸°ê´€ëª…(ì—°ë„)" í˜•ì‹ ì ˆëŒ€ ê¸ˆì§€!**

âœ… **ë°˜ë“œì‹œ ì´ë ‡ê²Œ ìž‘ì„±:**
- âŒ "ì§ˆë³‘ê´€ë¦¬ì²­(2024)ì— ë”°ë¥´ë©´"
- âœ… "ìµœê·¼ ì§€ì¹¨ì— ë”°ë¥´ë©´"
- âœ… "ìµœì‹  ì—°êµ¬ì—ì„œëŠ”"
- âœ… "ìµœê·¼ í†µê³„ì—ì„œëŠ”"
- âœ… "ì˜ë£Œê³„ì—ì„œëŠ”"
- âœ… "ì „ë¬¸ê°€ë“¤ì€"

âš ï¸ **ì¤‘ìš”:** ì—°ë„ê°€ í•„ìš”í•˜ë©´ ë¬¸ìž¥ ë‚´ì— ìžì—°ìŠ¤ëŸ½ê²Œ í¬í•¨
- âœ… "2026ë…„ ìµœê·¼ ìžë£Œë¥¼ ë³´ë©´"
- âœ… "ì˜¬í•´ ë°œí‘œëœ ì—°êµ¬ì— ë”°ë¥´ë©´"

**1.4. ì§ˆë¬¸í˜• ë„ìž…ìœ¼ë¡œ ë¦¬ë“¬ê° ë¶€ì—¬**
âŒ **ë‹¨ì¡°ë¡œìš´ ì„œìˆ í˜• ì‹œìž‘:**
- "í‡´í–‰ì„±ê´€ì ˆì—¼ì€ ì—°ê³¨ì´ ë‹³ì•„ì„œ..."
- "ê²¨ìš¸ì² ì—ëŠ” ê´€ì ˆì´ êµ³ì–´ì„œ..."

âœ… **ì§ˆë¬¸í˜•ìœ¼ë¡œ ë…ìž ì°¸ì—¬ ìœ ë„:**
- "í˜¹ì‹œ ì´ëŸ° ëŠë‚Œ ë°›ìœ¼ì‹  ì  ì—†ë‚˜ìš”?"
- "ìžê³  ì¼ì–´ë‚˜ë©´ ë¬´ë¦Žì´ ì™œ êµ³ì„ê¹Œìš”?"
- "ì´ê²Œ ë³‘ì›ì„ ê°€ì•¼ í• ì§€, íŒŒìŠ¤ ë¶™ì´ê³  ë§ì•„ì•¼ í• ì§€ ì°¸ ê³ ë¯¼ë˜ì‹œì£ ?"

**ì ìš© ìœ„ì¹˜:**
- 3ë¬¸ë‹¨ ì‹œìž‘ ë¶€ë¶„
- ì†Œì œëª© (ì´ëª¨ì§€ ì œê±° + ì§ˆë¬¸í˜• ì „í™˜)

**1.5. ë…ìž ìž…ìž¥ ì„œìˆ  (ì •ë³´ ì „ë‹¬ â†’ ê³µê° ìš°ì„ )**
âŒ **ê¸°ê´€ ì •ë³´ ë‚˜ì—´í˜•:**
- "êµ­ê°€ê±´ê°•ì •ë³´í¬í„¸ì—ì„œëŠ” ~ ì •ë¦¬í•˜ê³  ìžˆì–´ìš”"
- "ì§ˆë³‘ê´€ë¦¬ì²­ì—ì„œ ì œì‹œí•œ ë°”ì— ë”°ë¥´ë©´"

âœ… **ë…ìž ì‹¬ë¦¬/ê²½í—˜ ì¤‘ì‹¬:**
- âŒ "êµ­ê°€ê±´ê°•ì •ë³´í¬í„¸ì—ì„œëŠ” ~ ì •ë¦¬í•˜ê³  ìžˆì–´ìš”"
- âœ… "ë³´í†µ ë¬´ë¦Žì´ ë»£ë»£í•´ì§€ë©´ ëœì»¥ ê²ë¶€í„° ë‚˜ê¸° ë§ˆë ¨ì´ì£ "

- âŒ "ê°€ì´ë“œë¼ì¸ì—ì„œ ì–¸ê¸‰ë¼ìš”"
- âœ… "ì´ëŸ° ì¦ìƒì´ ë°˜ë³µë˜ë©´ ì£¼ì˜ ê¹Šê²Œ ì‚´íŽ´ë³¼ í•„ìš”ê°€ ìžˆì–´ìš”"

**1.6. ê²¨ìš¸ì²  ìƒí™© êµ¬ì²´í™” (ì¼ë°˜ì  â†’ ë””í…Œì¼)**
âŒ **ë­‰ëš±ê·¸ë¦° í‘œí˜„:**
- "ë°¤ì— ì¡°ìš©í•´ì§€ë©´"
- "ì¶”ìš¸ ë•Œ"
- "ê¸°ì˜¨ì´ ë‚®ì•„ì§€ë©´"

âœ… **êµ¬ì²´ì  ê²¨ìš¸ ìƒí™©:**
- âŒ "ë°¤ì— ì¡°ìš©í•´ì§€ë©´"
- âœ… "ë‚œë°© í…íŠ¸ ì•ˆì—ì„œë„ ë¬´ë¦Žë§Œ ì‹œë ¤ì›Œì„œ ì´ë¶ˆì„ ê±·ì–´ì°¨ê²Œ ë  ë•Œ"

- âŒ "ì¶”ìš¸ ë•Œ í†µì¦ì´ ì‹¬í•´ì§€ë©´"
- âœ… "ìžë‹¤ê°€ í™”ìž¥ì‹¤ ê°€ë ¤ê³  ì¼ì–´ì„¤ ë•Œ ë¬´ë¦Žì´ 'ëšëš' ì†Œë¦¬ ë‚˜ëŠ”"

**1.7. ì •ì˜ íŒŒíŠ¸ ìƒëžµ â†’ ì¦ìƒë¶€í„° ì‹œìž‘ (ëª°ìž…ë„ í–¥ìƒ)**
âŒ **êµê³¼ì„œì‹ ì •ì˜ ë‚˜ì—´:**
- "í‡´í–‰ì„±ê´€ì ˆì—¼ì€ ê´€ì ˆ ì—°ê³¨ì´ ì†ìƒë˜ì–´..."
- "ë¥˜ë§ˆí‹°ìŠ¤ê´€ì ˆì—¼ì€ ìžê°€ë©´ì—­ì§ˆí™˜ìœ¼ë¡œ..."

âœ… **ì¦ìƒ/ê²½í—˜ë¶€í„° ì§ìž…:**
- 2ë¬¸ë‹¨ ì •ì˜ íŒŒíŠ¸ ê³¼ê°ížˆ ìƒëžµ
- ë°”ë¡œ "ë¬´ë¦Žì´ ì•„ì¹¨ë§ˆë‹¤ ë»£ë»£í•œ ì´ìœ ëŠ”..." ê°™ì€ ì¦ìƒ ì´ì•¼ê¸°ë¡œ ì‹œìž‘

**1.8. ìƒí™œ ë¶ˆíŽ¸í•¨ ê¹Šì´ ìžˆëŠ” ê³µê° (í‘œë©´ â†’ ì‹¬ì¸µ)**
âŒ **ê±´ì¡°í•œ ìƒí™© ì„¤ëª…:**
- "ë¬´ë¦Ž ìƒíƒœë¥¼ í•œ ë²ˆ ì ê²€í•´ì•¼ í•˜ëŠ” ì‹ í˜¸ì¸ì§€ ì• ë§¤í•˜ë‹¤ëŠ” ì ì´ì—ìš”"
- "í†µì¦ì´ ì§€ì†ë˜ë©´ ë¶ˆíŽ¸í•  ìˆ˜ ìžˆì–´ìš”"

âœ… **ë…ìž ë§ˆìŒ ì½ê¸° + ìƒí™œ ì˜í–¥:**
- âŒ "ì• ë§¤í•˜ë‹¤ëŠ” ì ì´ì—ìš”"
- âœ… "ì´ê²Œ ë³‘ì›ì„ ê°€ì•¼ í• ì§€, íŒŒìŠ¤ ë¶™ì´ê³  ë§ì•„ì•¼ í• ì§€ ì°¸ ê³ ë¯¼ë˜ì‹œì£ ?"

- âŒ "í†µì¦ì´ ì§€ì†ë˜ë©´ ë¶ˆíŽ¸í•´ìš”"
- âœ… "í†µì¦ ë•Œë¬¸ì— ë°¤ìƒˆ ë’¤ì²™ì´ë‹¤ ì•„ì¹¨ì— ê°œìš´í•˜ì§€ ì•Šì€ ê·¸ ê¸°ë¶„"

- âŒ "ì¼ìƒìƒí™œì— ì§€ìž¥ì´..."
- âœ… "ë°¤ìƒˆ í•œìˆ¨ë„ ëª» ìžê³  ë’¤ì²™ì´ë‹ˆê¹Œ ë‹¤ìŒ ë‚  íšŒì˜ ì‹œê°„ì— ë©í•˜ê²Œ ì•‰ì•„ìžˆê²Œ ë˜ëŠ”"

**1.9. ì†Œì œëª© ì´ëª¨ì§€ ì œê±° + êµ¬ì–´ì²´ ì§ˆë¬¸í˜•**
âŒ **êµê³¼ì„œí˜• ì†Œì œëª©:**
- "í‡´í–‰ì„±ê´€ì ˆì—¼, ì–´ë–¤ íë¦„ìœ¼ë¡œ ì§„í–‰ë ê¹Œìš”?"
- "âš ï¸ ì£¼ì˜í•´ì•¼ í•  ì¦ìƒë“¤"

âœ… **êµ¬ì–´ì²´ ì§ˆë¬¸í˜• (ì´ëª¨ì§€ ì œê±°):**
- "ìžê³  ì¼ì–´ë‚˜ë©´ ë¬´ë¦Žì´ ì™œ êµ³ì„ê¹Œìš”?"
- "ì´ëŸ° ì¦ìƒì´ ë°˜ë³µë˜ë©´ ìœ„í—˜ ì‹ í˜¸ì¼ê¹Œ?"

[ì¤‘ìš”]
[ðŸ·ï¸ ì†Œì œëª© í•„ìˆ˜ ê·œì¹™ - ë¸”ë¡œê·¸íƒ­ ìž¥ê¸° ë…¸ì¶œìš©!]
[ì¤‘ìš”]

**âš ï¸ ë¸”ë¡œê·¸íƒ­ì— ìœ ë¦¬í•œ 'ì‚¬ëžŒ ë§íˆ¬ ì†Œì œëª©'ì„ ìž‘ì„±í•˜ì„¸ìš”!**

**[ì ˆëŒ€ ê¸ˆì§€ - ì˜í•™ ë°±ê³¼/ë³‘ì› í™ˆíŽ˜ì´ì§€ ìŠ¤íƒ€ì¼]**
âŒ "~ì´ëž€?", "~ì˜ ì •ì˜", "~ëž€ ë¬´ì—‡ì¸ê°€"
âŒ "ì£¼ìš” ì¦ìƒ", "ì›ì¸", "ê´€ë¦¬", "ì¹˜ë£Œ", "ì˜ˆë°©"
âŒ ì§ˆí™˜ëª…ìœ¼ë¡œ ëë‚˜ëŠ” ì†Œì œëª© (ì˜ˆ: "ì˜¤ì‹­ê²¬")
âŒ ê°™ì€ í•µì‹¬ ë‹¨ì–´ ë°˜ë³µ ì‚¬ìš© (3ê°œ ì´ìƒ ì†Œì œëª©ì— ê°™ì€ ë‹¨ì–´)
âŒ ì§ˆë¬¸í˜• ì†Œì œëª© ("~ì¸ê°€ìš”?", "~ì¼ê¹Œìš”?")
âŒ ì„¤ëª…í˜• ì†Œì œëª© ("~ìž…ë‹ˆë‹¤", "~ë©ë‹ˆë‹¤")

**[ê¶Œìž¥ - ìƒí™œ ìž¥ë©´ ì¤‘ì‹¬ í‘œí˜„]**
âœ… 'ì´ëŸ´ ë•Œ', 'ì´ëŸ° ë°¤ì—', 'ì´ ê³¼ì •ì—ì„œ', 'ì´í›„ì— ë‚˜íƒ€ë‚˜ëŠ”'
âœ… 'ë©°ì¹ ì§¸', 'ì•„ì¹¨ë§ˆë‹¤', 'ìžë‹¤ê°€', 'ì˜· ìž…ì„ ë•Œ'
âœ… ì‹œê°„/ìƒí™© ë°°ê²½ì„ ë‹´ì€ í‘œí˜„

**[ì¢‹ì€ ì†Œì œëª© ì˜ˆì‹œ]**
âŒ "ì˜¤ì‹­ê²¬ì˜ ì£¼ìš” ì¦ìƒ" â†’ âœ… "íŒ” ì˜¬ë¦¬ê¸°ê°€ ê°‘ìžê¸° íž˜ë“¤ì–´ì¡Œì„ ë•Œ"
âŒ "ì–´ê¹¨ í†µì¦ì˜ ì›ì¸" â†’ âœ… "ë°¤ì— ìœ ë… ë” ì•„í”ˆ ì´ìœ "
âŒ "ì˜¤ì‹­ê²¬ ê´€ë¦¬ ë°©ë²•" â†’ âœ… "ë»£ë»£í•¨ì´ ì´ì–´ì§€ëŠ” ê³¼ì •ì—ì„œ"
âŒ "í†µì¦ ì™„í™” ì¹˜ë£Œ" â†’ âœ… "ì˜· ê°ˆì•„ìž…ì„ ë•Œë§ˆë‹¤ 'ì•„ì´ê³ ' ì†Œë¦¬ê°€ ë‚˜ì˜¬ ë•Œ"
âŒ "íšŒë³µ ê³¼ì •" â†’ âœ… "ë©°ì¹ ì´ ì§€ë‚˜ë„ ë‚˜ì•„ì§€ì§€ ì•ŠëŠ”ë‹¤ë©´"

**[ì†Œì œëª© ìž‘ì„± ì›ì¹™]**
1. ì •ë³´ ì •ë¦¬ê°€ ì•„ë‹ˆë¼ 'ìƒí™© ì„¤ëª…'ì²˜ëŸ¼ ëŠê»´ì§ˆ ê²ƒ
2. ì†Œì œëª© í•˜ë‚˜ë‹¹ í•µì‹¬ ì¦ìƒ ë‹¨ì–´ 1íšŒ ì´í•˜
3. ì†Œì œëª©ì„ ì½ì—ˆì„ ë•Œ "ê²½í—˜ ì´ì•¼ê¸°"ì²˜ëŸ¼ ëŠê»´ì§ˆ ê²ƒ
4. ì¹¼ëŸ¼Â·ì—ì„¸ì´ ë§íˆ¬ë¡œ ìž‘ì„± (êµê³¼ì„œ/ë³‘ì› ì•ˆë‚´ë¬¸ âŒ)
5. 5~7ê°œ ì†Œì œëª© ì¤‘ 2ê°œ ì´ìƒì€ ì‹œê°„/ìƒí™© ë°°ê²½ í¬í•¨

**[ì†Œì œëª© ìžê°€ ê²€ì¦]**
â–¡ "~ì´ëž€?", "ì •ì˜", "ì›ì¸", "ì¦ìƒ", "ì¹˜ë£Œ", "ì˜ˆë°©" í¬í•¨ ì•ˆ ë¨?
â–¡ ì§ˆí™˜ëª…ìœ¼ë¡œ ëë‚˜ì§€ ì•ŠìŒ?
â–¡ ê°™ì€ ë‹¨ì–´ê°€ 3ê°œ ì´ìƒ ì†Œì œëª©ì— ë°˜ë³µë˜ì§€ ì•ŠìŒ?
â–¡ ì½ì—ˆì„ ë•Œ ì˜í•™ ë°±ê³¼ê°€ ì•„ë‹ˆë¼ ì¹¼ëŸ¼ì²˜ëŸ¼ ëŠê»´ì§€ëŠ”ê°€?

[ì¤‘ìš”]
[âœ… GPT-5.2 ìµœì¢… ê°•ë ¥ ì²´í¬ë¦¬ìŠ¤íŠ¸ - í•˜ë‚˜ë¼ë„ ìœ„ë°˜ ì‹œ ìž¬ìž‘ì„±!]
[ì¤‘ìš”]

**[í•„ìˆ˜ ì¤€ìˆ˜ í•­ëª© - ì ˆëŒ€ ê·œì¹™!]**
â–¡ ë³¸ë¬¸ì— 'ì„¤ëª…í•©ë‹ˆë‹¤', 'ì•ˆë‚´í•´ìš”', 'ì œì‹œí•©ë‹ˆë‹¤', 'ì–¸ê¸‰ë©ë‹ˆë‹¤' ê°™ì€ ì „ë‹¬í˜• í‘œí˜„ 3íšŒ ì´ìƒ ì‚¬ìš© ê¸ˆì§€
â–¡ ë™ì¼í•œ ë¬¸ìž¥ ëë§ºìŒ íŒ¨í„´ì´ 3íšŒ ì´ìƒ ì—°ì†ë˜ì§€ ì•ŠìŒ
â–¡ 'ê¸°ê´€ëª…(ì—°ë„)' í˜•ì‹ ì‚¬ìš© ê¸ˆì§€ (ì˜ˆ: ì§ˆë³‘ê´€ë¦¬ì²­(2024) âŒ)
â–¡ 'ê°œì¸ ìƒíƒœì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìžˆìŠµë‹ˆë‹¤' ê°™ì€ íšŒí”¼í˜• ë¬¸êµ¬ ì‚¬ìš© ê¸ˆì§€
â–¡ ê²¨ìš¸ì²  ìƒí™©ì„ ìƒë¦¬í•™ì  ì„¤ëª… ëŒ€ì‹  êµ¬ì²´ì  ìƒí™œ ìž¥ë©´ìœ¼ë¡œ ë¬˜ì‚¬
â–¡ 'ì‹ ê²½ ì“°ì´ì£ ' ê°™ì€ ì–•ì€ ê³µê° ëŒ€ì‹  êµ¬ì²´ì  ê°ì •+ìƒí™© ë¬˜ì‚¬
â–¡ CTA ë¬¸êµ¬ê°€ í•œ ë¬¸ìž¥ 50ìž ì´ë‚´ë¡œ ê°„ê²°í•¨
â–¡ CTA ë°•ìŠ¤ì— êµ¬ì²´ì ì¸ ìž‘ì€ í–‰ë™ ì œì•ˆ í¬í•¨
â–¡ ì†Œì œëª©ì— "ì›ì¸/ì¦ìƒ/ì¹˜ë£Œ/ì˜ˆë°©/ê´€ë¦¬/ì •ì˜" ë‹¨ì–´ ì—†ìŒ (ë¸”ë¡œê·¸íƒ­ í•„ìˆ˜!)
â–¡ ì†Œì œëª©ì´ ìƒí™œ ìž¥ë©´ ì¤‘ì‹¬ì´ë©° ì˜í•™ ë°±ê³¼ì²˜ëŸ¼ ë³´ì´ì§€ ì•ŠìŒ

**â†’ 10ê°œ í•­ëª© ì „ë¶€ OKì—¬ì•¼ í•©ê²©! í•˜ë‚˜ë¼ë„ ìœ„ë°˜ ì‹œ ì „ë©´ ìˆ˜ì •!**

[ì¤‘ìš”]
`;

  // ê³µí†µ ê¸€ì“°ê¸° ê·œì¹™ ì¶”ê°€ (Geminiì™€ ë™ì¼í•˜ê²Œ ì ìš©)
  let commonWritingRules = '';
  try {
    commonWritingRules = getWritingStyleCommonRules();
    console.log('âœ… GPT-5.2 ê³µí†µ ê¸€ì“°ê¸° í”„ë¡¬í”„íŠ¸ ë¡œë“œ ì„±ê³µ');
    console.log(`   ðŸ“ ê³µí†µ ê·œì¹™ ê¸¸ì´: ${commonWritingRules.length}ìž`);
    
    // ì£¼ìš” ì„¹ì…˜ í¬í•¨ ì—¬ë¶€ í™•ì¸
    const sections = [
      { name: 'íŒë‹¨ ë‹¨ì •í˜• ê¸€ì“°ê¸° ê¸ˆì§€', pattern: /íŒë‹¨ ë‹¨ì •í˜•/ },
      { name: 'í˜„ìž¥ê° ê°•í™”', pattern: /í˜„ìž¥ê° ê°•í™”/ },
      { name: 'ê·¹ì  í‘œí˜„ ê¸ˆì§€', pattern: /ê·¹ì  í‘œí˜„ ê¸ˆì§€/ },
      { name: 'AI ëƒ„ìƒˆ ì œê±°', pattern: /AI ëƒ„ìƒˆ ì œê±°/ },
      { name: 'SEO ìµœì í™”', pattern: /SEO ìµœì í™”/ }
    ];
    
    const includedSections = sections.filter(s => s.pattern.test(commonWritingRules));
    console.log(`   ðŸ“‹ í¬í•¨ëœ ì„¹ì…˜ (${includedSections.length}/${sections.length}):`, includedSections.map(s => s.name).join(', '));
    
    if (includedSections.length < sections.length) {
      const missingSections = sections.filter(s => !s.pattern.test(commonWritingRules));
      console.warn(`   âš ï¸ ëˆ„ë½ëœ ì„¹ì…˜:`, missingSections.map(s => s.name).join(', '));
    }
  } catch (error) {
    console.error('âŒ GPT-5.2 ê³µí†µ ê¸€ì“°ê¸° í”„ë¡¬í”„íŠ¸ ë¡œë“œ ì‹¤íŒ¨:', error);
    console.error('   - ì—ëŸ¬ ìƒì„¸:', error instanceof Error ? error.message : String(error));
    // í”„ë¡¬í”„íŠ¸ ë¡œë“œ ì‹¤íŒ¨ ì‹œ ì—ëŸ¬ ë°œìƒ
    throw new Error(`GPT-5.2 ê³µí†µ ê¸€ì“°ê¸° ê·œì¹™ ë¡œë“œ ì‹¤íŒ¨: ${error instanceof Error ? error.message : String(error)}`);
  }

  // ìµœì¢… í”„ë¡¬í”„íŠ¸ ì¡°í•©: ì˜ë£Œ ì•ˆì „ + AI í”¼ë“œë°± + GPT íŠ¹í™” + ê³µí†µ ê¸€ì“°ê¸°
  const medicalSafetyPrompt = getMedicalSafetyPrompt();
  const aiFeedbackRules = getAIFeedbackPrompt();
  const finalPrompt = medicalSafetyPrompt + aiFeedbackRules + gptSpecificPrompt + commonWritingRules;
  
  // ìµœì¢… í”„ë¡¬í”„íŠ¸ êµ¬ì„± ì •ë³´ ì¶œë ¥
  console.log('ðŸ“¦ GPT-5.2 ìµœì¢… í”„ë¡¬í”„íŠ¸ êµ¬ì„±:');
  console.log(`   - ì˜ë£Œ ì•ˆì „ í”„ë¡¬í”„íŠ¸: ${medicalSafetyPrompt.length}ìž`);
  console.log(`   - AI í”¼ë“œë°± ê·œì¹™: ${aiFeedbackRules.length}ìž`);
  console.log(`   - GPT íŠ¹í™” ê·œì¹™: ${gptSpecificPrompt.length}ìž`);
  console.log(`   - ê³µí†µ ê¸€ì“°ê¸° ê·œì¹™: ${commonWritingRules.length}ìž`);
  console.log(`   - ðŸ“ ì´ ê¸¸ì´: ${finalPrompt.length}ìž (ì•½ ${Math.round(finalPrompt.length / 4)} í† í°)`);
  
  return finalPrompt;
};

/**
 * ðŸš€ GPT-5.2 ë‹¨ê³„ë³„ í”„ë¡¬í”„íŠ¸ ì²˜ë¦¬ í•¨ìˆ˜
 * 
 * ë¬¸ì œ: í”„ë¡¬í”„íŠ¸ê°€ ë„ˆë¬´ ê¸¸ì–´ì„œ GPT-5.2ê°€ í—·ê°ˆë¦¬ê±°ë‚˜ í† í° ì œí•œ ì´ˆê³¼
 * í•´ê²°: 4ë‹¨ê³„ë¡œ ë‚˜ëˆ„ì–´ ìˆœì°¨ì ìœ¼ë¡œ ì²˜ë¦¬
 * 
 * 1ë‹¨ê³„: ê¸€ ìƒì„± (ê¸°ë³¸ ê·œì¹™)
 * 2ë‹¨ê³„: AI ëƒ„ìƒˆ ì œê±°
 * 3ë‹¨ê³„: SEO ìµœì í™”
 * 4ë‹¨ê³„: ì˜ë£Œë²• ê²€ì¦
 */
const callOpenAI_Staged = async (
  initialPrompt: string, 
  contextData: string,
  textLength: number = 2000,
  onProgress?: (msg: string) => void
): Promise<string> => {
  const apiKey = getOpenAIKey();
  if (!apiKey) {
    throw new Error('OpenAI API í‚¤ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
  }

  const safeProgress = onProgress || ((msg: string) => console.log('ðŸ“', msg));
  let currentContent = '';

  // 1ë‹¨ê³„: ê¸€ ìƒì„± (ê¸°ë³¸ ê·œì¹™ë§Œ ì ìš©)
  try {
    safeProgress('ðŸ“ [1/4ë‹¨ê³„] ê¸°ë³¸ ì½˜í…ì¸  ìƒì„± ì¤‘...');
    console.log('ðŸ”µ [1ë‹¨ê³„] ê¸€ ìƒì„± ì‹œìž‘');
    
    const stage1Prompt = getStagePrompt(1, textLength);
    const stage1SystemPrompt = `${stage1Prompt}\n\n${contextData}`;
    
    console.log(`â€¢ [1ë‹¨ê³„] System Prompt ê¸¸ì´: ${stage1SystemPrompt.length}ìž`);
    console.log(`â€¢ [1ë‹¨ê³„] User Prompt ê¸¸ì´: ${initialPrompt.length}ìž`);
    
    const response1 = await fetch(OPENAI_PROXY_URL, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'X-OpenAI-Key': apiKey
      },
      body: JSON.stringify({
        model: 'gpt-5.2',
        messages: [
          { role: 'system', content: `${stage1SystemPrompt}\n\në°˜ë“œì‹œ ìœ íš¨í•œ JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µí•˜ì„¸ìš”.` },
          { role: 'user', content: `${initialPrompt}\n\n(ì‘ë‹µì€ ë°˜ë“œì‹œ JSON í˜•ì‹ìœ¼ë¡œ í•´ì£¼ì„¸ìš”)` }
        ],
        response_format: { type: 'json_object' },
        temperature: 0.85
      })
    });

    // ì‘ë‹µ í…ìŠ¤íŠ¸ ë¨¼ì € ì½ê¸° (JSON íŒŒì‹± ì‹¤íŒ¨ ëŒ€ë¹„)
    const responseText = await response1.text();
    console.log(`â€¢ [1ë‹¨ê³„] ì‘ë‹µ ìƒíƒœ: ${response1.status}`);
    console.log(`â€¢ [1ë‹¨ê³„] ì‘ë‹µ ê¸¸ì´: ${responseText.length}ìž`);
    
    if (!response1.ok) {
      // ì—ëŸ¬ ì‘ë‹µ íŒŒì‹± ì‹œë„
      try {
        const error = JSON.parse(responseText);
        console.error('âŒ [1ë‹¨ê³„] API ì˜¤ë¥˜:', error);
        throw new Error(`[1ë‹¨ê³„] GPT-5.2 API ì˜¤ë¥˜: ${error?.error?.message || JSON.stringify(error)}`);
      } catch (parseError) {
        console.error('âŒ [1ë‹¨ê³„] ì‘ë‹µ íŒŒì‹± ì‹¤íŒ¨:', responseText.substring(0, 500));
        throw new Error(`[1ë‹¨ê³„] API ì˜¤ë¥˜ (${response1.status}): ${responseText.substring(0, 200)}`);
      }
    }

    // JSON íŒŒì‹±
    let data1;
    try {
      data1 = JSON.parse(responseText);
    } catch (parseError) {
      console.error('âŒ [1ë‹¨ê³„] JSON íŒŒì‹± ì˜¤ë¥˜');
      console.error('   - ì‘ë‹µ ë¯¸ë¦¬ë³´ê¸°:', responseText.substring(0, 500));
      throw new Error(`[1ë‹¨ê³„] JSON íŒŒì‹± ì˜¤ë¥˜: ${parseError instanceof Error ? parseError.message : 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'}. ì‘ë‹µ: ${responseText.substring(0, 100)}`);
    }
    
    currentContent = data1.choices[0]?.message?.content || '{}';
    console.log('âœ… [1ë‹¨ê³„] ê¸€ ìƒì„± ì™„ë£Œ');
    safeProgress('âœ… [1/4ë‹¨ê³„] ê¸°ë³¸ ì½˜í…ì¸  ìƒì„± ì™„ë£Œ');

  } catch (error) {
    console.error('âŒ [1ë‹¨ê³„] ì˜¤ë¥˜:', error);
    // ë” ìƒì„¸í•œ ì—ëŸ¬ ë©”ì‹œì§€ ì œê³µ
    if (error instanceof Error) {
      throw new Error(`[1ë‹¨ê³„ ì½˜í…ì¸  ìƒì„± ì‹¤íŒ¨] ${error.message}`);
    }
    throw error;
  }

  // 2ë‹¨ê³„: AI ëƒ„ìƒˆ ì œê±°
  try {
    safeProgress('ðŸ§¹ [2/4ë‹¨ê³„] AI ëƒ„ìƒˆ ì œê±° ì¤‘...');
    console.log('ðŸ”µ [2ë‹¨ê³„] AI ëƒ„ìƒˆ ì œê±° ì‹œìž‘');
    
    const stage2Prompt = getStagePrompt(2, textLength);
    const stage2SystemPrompt = `${stage2Prompt}\n\nì•„ëž˜ëŠ” 1ë‹¨ê³„ì—ì„œ ìƒì„±ëœ ì´ˆì•ˆìž…ë‹ˆë‹¤. AI ëƒ„ìƒˆë¥¼ ì œê±°í•˜ê³  ìžì—°ìŠ¤ëŸ½ê²Œ ìˆ˜ì •í•´ì£¼ì„¸ìš”.`;
    
    const response2 = await fetch(OPENAI_PROXY_URL, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'X-OpenAI-Key': apiKey
      },
      body: JSON.stringify({
        model: 'gpt-5.2',
        messages: [
          { role: 'system', content: `${stage2SystemPrompt}\n\në°˜ë“œì‹œ ìœ íš¨í•œ JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µí•˜ì„¸ìš”.` },
          { role: 'user', content: `${currentContent}\n\n(ì‘ë‹µì€ ë°˜ë“œì‹œ JSON í˜•ì‹ìœ¼ë¡œ í•´ì£¼ì„¸ìš”)` }
        ],
        response_format: { type: 'json_object' },
        temperature: 0.7
      })
    });

    const responseText2 = await response2.text();
    if (!response2.ok) {
      console.warn('âš ï¸ [2ë‹¨ê³„] API ì˜¤ë¥˜, 1ë‹¨ê³„ ê²°ê³¼ ìœ ì§€');
      console.warn('   - ìƒíƒœ:', response2.status);
      console.warn('   - ì‘ë‹µ:', responseText2.substring(0, 200));
    } else {
      try {
        const data2 = JSON.parse(responseText2);
        currentContent = data2.choices[0]?.message?.content || currentContent;
        console.log('âœ… [2ë‹¨ê³„] AI ëƒ„ìƒˆ ì œê±° ì™„ë£Œ');
      } catch (parseError) {
        console.warn('âš ï¸ [2ë‹¨ê³„] JSON íŒŒì‹± ì˜¤ë¥˜, 1ë‹¨ê³„ ê²°ê³¼ ìœ ì§€');
        console.warn('   - ì‘ë‹µ:', responseText2.substring(0, 200));
      }
    }
    
    safeProgress('âœ… [2/4ë‹¨ê³„] AI ëƒ„ìƒˆ ì œê±° ì™„ë£Œ');

  } catch (error) {
    console.warn('âš ï¸ [2ë‹¨ê³„] ì˜¤ë¥˜, 1ë‹¨ê³„ ê²°ê³¼ ìœ ì§€:', error);
  }

  // 3ë‹¨ê³„: SEO ìµœì í™”
  try {
    safeProgress('â€¢ [3/4ë‹¨ê³„] SEO ìµœì í™” ì¤‘...');
    console.log('ðŸ”µ [3ë‹¨ê³„] SEO ìµœì í™” ì‹œìž‘');
    
    const stage3Prompt = getStagePrompt(3);
    const stage3SystemPrompt = `${stage3Prompt}\n\nì•„ëž˜ëŠ” 2ë‹¨ê³„ê¹Œì§€ ìˆ˜ì •ëœ ê¸€ìž…ë‹ˆë‹¤. SEOë¥¼ ìµœì í™”í•´ì£¼ì„¸ìš”.`;
    
    const response3 = await fetch(OPENAI_PROXY_URL, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'X-OpenAI-Key': apiKey
      },
      body: JSON.stringify({
        model: 'gpt-5.2',
        messages: [
          { role: 'system', content: `${stage3SystemPrompt}\n\në°˜ë“œì‹œ ìœ íš¨í•œ JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µí•˜ì„¸ìš”.` },
          { role: 'user', content: `${currentContent}\n\n(ì‘ë‹µì€ ë°˜ë“œì‹œ JSON í˜•ì‹ìœ¼ë¡œ í•´ì£¼ì„¸ìš”)` }
        ],
        response_format: { type: 'json_object' },
        temperature: 0.4
      })
    });

    const responseText3 = await response3.text();
    if (!response3.ok) {
      console.warn('âš ï¸ [3ë‹¨ê³„] API ì˜¤ë¥˜, 2ë‹¨ê³„ ê²°ê³¼ ìœ ì§€');
      console.warn('   - ìƒíƒœ:', response3.status);
      console.warn('   - ì‘ë‹µ:', responseText3.substring(0, 200));
    } else {
      try {
        const data3 = JSON.parse(responseText3);
        const stage3Content = data3.choices[0]?.message?.content || currentContent;
        
        // â„¹ï¸ SEO ì ìˆ˜ ì²´í¬ (ì°¸ê³ ìš©, ìž¬ìƒì„± ì•ˆ í•¨)
        const extractSeoScore = (content: string): number => {
          try {
            const parsed = JSON.parse(content);
            return parsed?.seo_improvements?.estimated_score || 
                   parsed?.fact_check?.seo_score || 
                   parsed?.seo_score || 
                   90; // ê¸°ë³¸ê°’
          } catch {
            return 90; // íŒŒì‹± ì‹¤íŒ¨ì‹œ ê¸°ë³¸ê°’
          }
        };
        
        const currentSeoScore = extractSeoScore(stage3Content);
        console.log(`ðŸ“Š [3ë‹¨ê³„] SEO ì ìˆ˜: ${currentSeoScore}ì  (ì°¸ê³ ìš©)`);
        safeProgress(`ðŸ“Š [3ë‹¨ê³„] SEO ì ìˆ˜: ${currentSeoScore}ì `);
        
        currentContent = stage3Content;
      } catch (parseError) {
        console.warn('âš ï¸ [3ë‹¨ê³„] JSON íŒŒì‹± ì˜¤ë¥˜, 2ë‹¨ê³„ ê²°ê³¼ ìœ ì§€');
        console.warn('   - ì‘ë‹µ:', responseText3.substring(0, 200));
      }
    }
    
    safeProgress('âœ… [3/4ë‹¨ê³„] SEO ìµœì í™” ì™„ë£Œ');

  } catch (error) {
    console.warn('âš ï¸ [3ë‹¨ê³„] ì˜¤ë¥˜, 2ë‹¨ê³„ ê²°ê³¼ ìœ ì§€:', error);
  }

  // 4ë‹¨ê³„: ì˜ë£Œë²• ê²€ì¦
  try {
    safeProgress('âš–ï¸ [4/4ë‹¨ê³„] ì˜ë£Œë²• ê²€ì¦ ì¤‘...');
    console.log('ðŸ”µ [4ë‹¨ê³„] ì˜ë£Œë²• ê²€ì¦ ì‹œìž‘');
    
    const stage4Prompt = getStagePrompt(4);
    const stage4SystemPrompt = `${stage4Prompt}\n\nì•„ëž˜ëŠ” 3ë‹¨ê³„ê¹Œì§€ ìˆ˜ì •ëœ ê¸€ìž…ë‹ˆë‹¤. ì˜ë£Œë²•ì„ 100% ì¤€ìˆ˜í•˜ë„ë¡ ê²€ì¦í•˜ê³  ìˆ˜ì •í•´ì£¼ì„¸ìš”.`;
    
    const response4 = await fetch(OPENAI_PROXY_URL, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'X-OpenAI-Key': apiKey
      },
      body: JSON.stringify({
        model: 'gpt-5.2',
        messages: [
          { role: 'system', content: `${stage4SystemPrompt}\n\në°˜ë“œì‹œ ìœ íš¨í•œ JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µí•˜ì„¸ìš”.` },
          { role: 'user', content: `${currentContent}\n\n(ì‘ë‹µì€ ë°˜ë“œì‹œ JSON í˜•ì‹ìœ¼ë¡œ í•´ì£¼ì„¸ìš”)` }
        ],
        response_format: { type: 'json_object' },
        temperature: 0.2
      })
    });

    const responseText4 = await response4.text();
    if (!response4.ok) {
      console.warn('âš ï¸ [4ë‹¨ê³„] API ì˜¤ë¥˜, 3ë‹¨ê³„ ê²°ê³¼ ìœ ì§€');
      console.warn('   - ìƒíƒœ:', response4.status);
      console.warn('   - ì‘ë‹µ:', responseText4.substring(0, 200));
    } else {
      try {
        const data4 = JSON.parse(responseText4);
        currentContent = data4.choices[0]?.message?.content || currentContent;
        console.log('âœ… [4ë‹¨ê³„] ì˜ë£Œë²• ê²€ì¦ ì™„ë£Œ');
      } catch (parseError) {
        console.warn('âš ï¸ [4ë‹¨ê³„] JSON íŒŒì‹± ì˜¤ë¥˜, 3ë‹¨ê³„ ê²°ê³¼ ìœ ì§€');
        console.warn('   - ì‘ë‹µ:', responseText4.substring(0, 200));
      }
    }
    
    safeProgress('âœ… [4/4ë‹¨ê³„] ì˜ë£Œë²• ê²€ì¦ ì™„ë£Œ ðŸŽ‰');

  } catch (error) {
    console.warn('âš ï¸ [4ë‹¨ê³„] ì˜¤ë¥˜, 3ë‹¨ê³„ ê²°ê³¼ ìœ ì§€:', error);
  }



  console.log('ðŸŽ‰ ë‹¨ê³„ë³„ ì²˜ë¦¬ ì™„ë£Œ! ìµœì¢… ê²°ê³¼ ë°˜í™˜');
  return currentContent;
};

// OpenAI API í˜¸ì¶œ í•¨ìˆ˜ (GPT-5.2 -> Gemini-3-Pro-Preview í´ë°±)
const callOpenAI = async (prompt: string, systemPrompt?: string): Promise<string> => {
  try {
    console.log('ðŸ”µ callOpenAI ì‹œìž‘');
    const apiKey = getOpenAIKey();
    
    if (!apiKey) {
      console.error('âŒ OpenAI API í‚¤ê°€ ì—†ìŠµë‹ˆë‹¤!');
      throw new Error('OpenAI API í‚¤ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. LocalStorageì—ì„œ OPENAI_API_KEYë¥¼ í™•ì¸í•˜ì„¸ìš”.');
    }
    
    // ðŸš€ GPT-5.2 ì‹œë„
    try {
      console.log(`ðŸ”µ API í‚¤ í™•ì¸ ì™„ë£Œ, ëª¨ë¸ 'gpt-5.2' ìš”ì²­ ì „ì†¡ ì¤‘...`);
      console.log(`â€¢ System Prompt ê¸¸ì´: ${systemPrompt?.length || 0}ìž`);
      console.log(`â€¢ User Prompt ê¸¸ì´: ${prompt?.length || 0}ìž`);
      
      // OpenAI json_object ëª¨ë“œ ì‚¬ìš© ì‹œ í”„ë¡¬í”„íŠ¸ì— "json" ë‹¨ì–´ í•„ìˆ˜
      const jsonSystemPrompt = systemPrompt 
        ? `${systemPrompt}\n\në°˜ë“œì‹œ ìœ íš¨í•œ JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µí•˜ì„¸ìš”.`
        : 'ë°˜ë“œì‹œ ìœ íš¨í•œ JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µí•˜ì„¸ìš”.';
      const jsonUserPrompt = prompt.includes('json') || prompt.includes('JSON') 
        ? prompt 
        : `${prompt}\n\n(ì‘ë‹µì€ ë°˜ë“œì‹œ JSON í˜•ì‹ìœ¼ë¡œ í•´ì£¼ì„¸ìš”)`;
      
      const response = await fetch(OPENAI_PROXY_URL, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'X-OpenAI-Key': apiKey
        },
        body: JSON.stringify({
          model: 'gpt-5.2',
          messages: [
            { role: 'system', content: jsonSystemPrompt },
            { role: 'user', content: jsonUserPrompt }
          ],
          response_format: { type: 'json_object' },
          temperature: 0.7
        })
      });

      console.log(`ðŸ”µ OpenAI (gpt-5.2) ì‘ë‹µ ìƒíƒœ:`, response.status, response.statusText);

      if (response.ok) {
        const data = await response.json() as { choices: Array<{ message: { content: string } }> };
        const content = data.choices[0]?.message?.content || '{}';
        console.log(`âœ… OpenAI ì‘ë‹µ ì„±ê³µ (gpt-5.2)`);
        console.log(`ðŸ“¦ ì‘ë‹µ ë‚´ìš© ê¸¸ì´: ${content.length}ìž`);
        console.log(`ðŸ“¦ ì‘ë‹µ ë¯¸ë¦¬ë³´ê¸°: ${content.substring(0, 200)}...`);
        
        // JSON íŒŒì‹± í…ŒìŠ¤íŠ¸
        try {
          const parsed = JSON.parse(content);
          console.log(`âœ… JSON íŒŒì‹± ì„±ê³µ`);
          console.log(`ðŸ“‹ ì‘ë‹µ í•„ë“œ:`, Object.keys(parsed));
          
          // contentHtml ë˜ëŠ” content í•„ë“œ í™•ì¸
          if (!parsed.contentHtml && !parsed.content) {
            console.error(`âŒ ê²½ê³ : contentHtml ë˜ëŠ” content í•„ë“œê°€ ì‘ë‹µì— ì—†ìŠµë‹ˆë‹¤!`);
            console.error(`   - ì‹¤ì œ í•„ë“œ:`, Object.keys(parsed));
          }
        } catch (parseError) {
          console.error(`âŒ JSON íŒŒì‹± ì‹¤íŒ¨:`, parseError);
          console.error(`   - ì‘ë‹µ ë‚´ìš©:`, content.substring(0, 500));
        }
        
        return content;
      }
      
      const error = await response.json();
      console.error(`âŒ GPT-5.2 API ì˜¤ë¥˜:`, error);
      console.error(`   - ìƒíƒœ ì½”ë“œ: ${response.status} ${response.statusText}`);
      console.error(`   - ì—ëŸ¬ ë©”ì‹œì§€: ${error?.error?.message || 'Unknown error'}`);
      console.error(`   - ì—ëŸ¬ íƒ€ìž…: ${error?.error?.type || 'Unknown type'}`);
      console.error(`   - ì—ëŸ¬ ì½”ë“œ: ${error?.error?.code || 'Unknown code'}`);
      console.error(`   - System Prompt ê¸¸ì´: ${systemPrompt?.length || 0}ìž`);
      console.error(`   - User Prompt ê¸¸ì´: ${prompt?.length || 0}ìž`);
      
      // í”„ë¡¬í”„íŠ¸ê°€ ë„ˆë¬´ ê¸¸ ê²½ìš° íŠ¹ë³„ ê²½ê³ 
      const totalLength = (systemPrompt?.length || 0) + (prompt?.length || 0);
      if (totalLength > 100000) {
        console.warn(`âš ï¸ í”„ë¡¬í”„íŠ¸ ê¸¸ì´ê°€ ë§¤ìš° ê¹ë‹ˆë‹¤ (${totalLength}ìž). í† í° ì œí•œ ì´ˆê³¼ ê°€ëŠ¥ì„± ìžˆìŒ!`);
      }
      
      console.log('ðŸ”„ Gemini-3-Pro-Previewë¡œ í´ë°±í•©ë‹ˆë‹¤...');
    } catch (e) {
      console.error(`âŒ GPT-5.2 ë„¤íŠ¸ì›Œí¬/ì²˜ë¦¬ ì˜¤ë¥˜:`, e);
      console.error(`   - ì—ëŸ¬ íƒ€ìž…: ${e instanceof Error ? e.constructor.name : typeof e}`);
      console.error(`   - ì—ëŸ¬ ë©”ì‹œì§€: ${e instanceof Error ? e.message : String(e)}`);
      if (e instanceof Error && e.stack) {
        console.error(`   - ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤:`, e.stack);
      }
      console.log('ðŸ”„ Gemini-3-Pro-Previewë¡œ í´ë°±í•©ë‹ˆë‹¤...');
    }

    // ðŸ”„ GPT-5.2 ì‹¤íŒ¨ ì‹œ Gemini-3-Pro-Previewë¡œ í´ë°±
    console.log('ðŸŸ¢ Gemini-3-Pro-Preview í˜¸ì¶œ ì‹œìž‘...');
    const ai = getAiClient();
    const fullPrompt = systemPrompt ? `${systemPrompt}\n\n${prompt}` : prompt;
    
    const response = await ai.models.generateContent({
      model: 'gemini-3-pro-preview',
      contents: fullPrompt,
      config: {
        temperature: 0.7,
        responseMimeType: 'application/json',
        thinkingMode: true // Think ëª¨ë“œ í™œì„±í™” (ê¸€ì“°ê¸° í’ˆì§ˆ í–¥ìƒ)
      }
    });
    
    const text = response.text || '{}';
    console.log(`âœ… Gemini-3-Pro-Preview ì‘ë‹µ ì„±ê³µ`);
    console.log(`ðŸ“¦ ì‘ë‹µ ë‚´ìš© ê¸¸ì´: ${text.length}ìž`);
    console.log(`ðŸ“¦ ì‘ë‹µ ë¯¸ë¦¬ë³´ê¸°: ${text.substring(0, 200)}...`);
    
    // JSON íŒŒì‹± í…ŒìŠ¤íŠ¸
    try {
      const parsed = JSON.parse(text);
      console.log(`âœ… JSON íŒŒì‹± ì„±ê³µ`);
      console.log(`ðŸ“‹ ì‘ë‹µ í•„ë“œ:`, Object.keys(parsed));
      
      // contentHtml ë˜ëŠ” content í•„ë“œ í™•ì¸
      if (!parsed.contentHtml && !parsed.content) {
        console.error(`âŒ ê²½ê³ : contentHtml ë˜ëŠ” content í•„ë“œê°€ ì‘ë‹µì— ì—†ìŠµë‹ˆë‹¤!`);
        console.error(`   - ì‹¤ì œ í•„ë“œ:`, Object.keys(parsed));
      }
    } catch (parseError) {
      console.error(`âŒ JSON íŒŒì‹± ì‹¤íŒ¨:`, parseError);
      console.error(`   - ì‘ë‹µ ë‚´ìš©:`, text.substring(0, 500));
    }
    
    return text;

  } catch (error) {
    console.error('âŒ callOpenAI ì „ì²´ ì—ëŸ¬:', error);
    console.error('   - ì—ëŸ¬ íƒ€ìž…:', error instanceof Error ? error.constructor.name : typeof error);
    console.error('   - ì—ëŸ¬ ë©”ì‹œì§€:', error instanceof Error ? error.message : String(error));
    if (error instanceof Error && error.stack) {
      console.error('   - ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤:', error.stack);
    }
    throw error;
  }
};

// í˜„ìž¬ ì—°ë„ë¥¼ ë™ì ìœ¼ë¡œ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜
const getCurrentYear = () => new Date().getFullYear();

// ì˜ë£Œê´‘ê³ ë²• í”„ë¡¬í”„íŠ¸ë¥¼ ë™ì ìœ¼ë¡œ ìƒì„±í•˜ëŠ” í•¨ìˆ˜
const getMedicalSafetyPrompt = () => {
  const year = getCurrentYear();
  return `
ë‹¹ì‹ ì€ ëŒ€í•œë¯¼êµ­ ì˜ë£Œê´‘ê³ ë²•Â·í‘œì‹œê´‘ê³ ë²•Â·ë„¤ì´ë²„ ê²€ìƒ‰ ì •ì±…ì„ ì™„ë²½ížˆ ìˆ™ì§€í•œ 'ë„¤ì´ë²„ ê³µì‹ ë³‘ì› ë¸”ë¡œê·¸' ì „ë¬¸ ì—ë””í„°ìž…ë‹ˆë‹¤.

[ìµœìš°ì„  ê¸ˆì§€ ê·œì¹™ - ë³¸ë¬¸/ì œëª©ì— ì ˆëŒ€ ì‚¬ìš© ê¸ˆì§€!]
1. ì´ëª¨ì§€ ì™„ì „ ê¸ˆì§€ - ì „ë¬¸ ì˜ë£Œ ì½˜í…ì¸  í†¤ ìœ ì§€
2. êµ¬ì²´ì  ìˆ«ìž ì™„ì „ ê¸ˆì§€:
   - ë¹ˆë„ ìˆ«ìž: "ì—° 2~4íšŒ", "6~8íšŒ", "10ëª… ì¤‘ 8ëª…" ë“± ê¸ˆì§€
   - ê¸°ê°„ ìˆ«ìž: "24~48ì‹œê°„", "2~3ì¼", "1ì£¼ì¼" ë“± ê¸ˆì§€
   - ë¹„ìœ¨/í†µê³„: "70%", "200ì—¬ ì¢…", "51.7%" ë“± ê¸ˆì§€
   - ëŒ€ì²´ í‘œí˜„: "ë“œë¬¼ì§€ ì•Šê²Œ", "ë‹¤ì–‘í•œ", "ê°œì¸ì°¨ê°€ ìžˆìœ¼ë©°", "ìƒë‹¹ìˆ˜ê°€"
[ìµœìš°ì„  ê¸ˆì§€ ê·œì¹™ ë]

[ì¤‘ìš”]
[í•µì‹¬ ì›ì¹™ 5ê°€ì§€ - ë°˜ë“œì‹œ ì•”ê¸°!]
[ì¤‘ìš”]

1. 'ê°€ëŠ¥ì„±Â·íŒë‹¨Â·ì²´í¬'ëŠ” ì œëª©ë¿ ì•„ë‹ˆë¼ ë³¸ë¬¸ì—ì„œë„ ëˆ„ì ë˜ë©´ ìœ„í—˜!
2. ë³‘ëª…ì€ ì •ì˜í•˜ì§€ ë§ê³ , ë§¥ë½ ì†ì—ì„œë§Œ ë“±ìž¥ì‹œì¼œë¼!
3. ìˆ«ìžÂ·ê¸°ê°„Â·íšŒë³µì€ í•­ìƒ 'ê°œì¸ì°¨'ë¡œ íë ¤ë¼! (êµ¬ì²´ì  ìˆ«ìž ê¸ˆì§€!)
4. ì¢…ê²°ì–´ë¯¸ë¥¼ ë‹¤ì–‘í•˜ê²Œ ì‚¬ìš©í•˜ì—¬ AI ëƒ„ìƒˆ ì œê±°! (ë‹¨ì¡°ë¡œìš´ ë°˜ë³µ ê¸ˆì§€)
5. 'í™˜ìž', 'ë‚´ì›' í‘œí˜„ ì§€ì–‘ - ë…ìž ì¤‘ì‹¬ í‘œí˜„ ì‚¬ìš©!

---
ðŸš« [1. ê°€ëŠ¥ì„±Â·íŒë‹¨ ë°˜ë³µ êµ¬ì¡° ê¸ˆì§€] - ê°€ìž¥ í° ë¦¬ìŠ¤í¬!
---

âŒ ìœ„í—˜í•œ ë¬¸ìž¥ íŒ¨í„´:
"OO ê°ì—¼ ê°€ëŠ¥ì„±ì„ í•˜ë‚˜ì˜ ì›ì¸ìœ¼ë¡œ ê³ ë ¤í•´ë³¼ ìˆ˜ ìžˆëŠ” ìƒí™©"
â†’ 'ê°ì—¼ ê°€ëŠ¥ì„±' + 'ì›ì¸ ê³ ë ¤' = ì§ˆë³‘ ì¶”ì •Â·íŒë‹¨ ìœ ë„!
â†’ ë„¤ì´ë²„ ì˜ë£Œê´‘ê³  í•„í„°ì—ì„œ ì˜ì‹¬Â·ê°€ëŠ¥ì„± ë°˜ë³µ = ê´‘ê³  ì‹ í˜¸ë¡œ ëˆ„ì !

âœ… ì•ˆì „í•œ ëŒ€ì²´ í‘œí˜„:
"ì´ì²˜ëŸ¼ ê²¨ìš¸ì² ì— ê¸‰ì„± ìœ„ìž¥ê´€ ì¦ìƒì´ ê²¹ì³ ë‚˜íƒ€ë‚˜ëŠ” ê²½ìš°, ì›ì¸ì„ ë‘˜ëŸ¬ì‹¼ ë‹¤ì–‘í•œ ìƒí™©ì´ í•¨ê»˜ ì–¸ê¸‰ë˜ê³¤ í•©ë‹ˆë‹¤."
â†’ ë³‘ëª…ì€ ê²°ë¡ ì—ì„œ ë¹ ì§€ê³ , 'ê°€ëŠ¥ì„±' â†’ 'ì–¸ê¸‰ë˜ëŠ” ìƒí™©'ìœ¼ë¡œ ì™„ì¶©

ðŸš¨ðŸš¨ðŸš¨ **ì ˆëŒ€ ê¸ˆì§€ ë‹¨ì–´ (1íšŒë„ ì‚¬ìš© ê¸ˆì§€!):** ðŸš¨ðŸš¨ðŸš¨
âŒ ì˜ì‹¬ (ì ˆëŒ€ ê¸ˆì§€!)
âŒ ê°€ëŠ¥ì„± (ì ˆëŒ€ ê¸ˆì§€!)
âŒ íŒë‹¨ (ì ˆëŒ€ ê¸ˆì§€!)
âŒ ì§„ë‹¨ (ì ˆëŒ€ ê¸ˆì§€!)
âŒ ì²´í¬ (ì ˆëŒ€ ê¸ˆì§€!)
âŒ êµ¬ë¶„ (ì ˆëŒ€ ê¸ˆì§€!)
âŒ ì°¨ì´ (ì ˆëŒ€ ê¸ˆì§€!)
âŒ ì—¬ë¶€ (ì ˆëŒ€ ê¸ˆì§€!)

âœ… **ì•ˆì „í•œ ëŒ€ì²´ í‘œí˜„:**
- "ì˜ì‹¬" â†’ "ì‚´íŽ´ë³¼ í•„ìš”ê°€ ìžˆëŠ”", "í™•ì¸í•´ë³¼ ë§Œí•œ", "ì£¼ì˜ê°€ í•„ìš”í•œ"
- "ê°€ëŠ¥ì„±" â†’ "ê²½ìš°ê°€ ìžˆë‹¤", "ìƒí™©ì´ ìžˆë‹¤", "ì–¸ê¸‰ë˜ê³¤ í•œë‹¤"
- "íŒë‹¨" â†’ "í™•ì¸", "íŒŒì•…", "ì‚´íŽ´ë³´ê¸°"
- "ì§„ë‹¨" â†’ "í™•ì¸", "ê²€ì‚¬"
- "ì²´í¬" â†’ "í™•ì¸", "ì‚´íŽ´ë³´ê¸°"
- "êµ¬ë¶„" â†’ "ì‚´íŽ´ë³´ê¸°", "ë¹„êµ"

---
ðŸš« [2. ì •ì˜í˜• ë¬¸ë‹¨ ê¸ˆì§€] - ë³‘ì› í™ˆíŽ˜ì´ì§€ ì „í˜• íŒ¨í„´!
---

âŒ ìœ„í—˜í•œ ì†Œì œëª©:
"OOëž€ ë¬´ì—‡ì¸ê°€ìš”?", "OOì˜ ì •ì˜", "OOì´ëž€"

âŒ ìœ„í—˜í•œ ë³¸ë¬¸:
"OOë°”ì´ëŸ¬ìŠ¤ëŠ” ê¸‰ì„± ìœ„ìž¥ì—¼ì„ ì¼ìœ¼í‚¤ëŠ” ì „ì—¼ì„±ì´ ê°•í•œ ë°”ì´ëŸ¬ìŠ¤ ì¤‘ í•˜ë‚˜ë¡œâ€¦"

âš ï¸ ì™œ ìœ„í—˜í•œê°€:
ë³‘Â·ì˜ì› ë¸”ë¡œê·¸ì—ì„œ 'â—‹â—‹ëž€ ë¬´ì—‡ì¸ê°€'ëŠ” ì˜ë£Œì •ë³´ ì œê³µ + ê´‘ê³  í˜¼í•©ìœ¼ë¡œ ìžì£¼ ì§€ì ë¨!
ì§ˆí™˜ ì •ì˜ â†’ ì¦ìƒ â†’ ê´€ë¦¬ë²•ì˜ ì •ì„ êµ¬ì¡° = ë³‘ì› í™ˆíŽ˜ì´ì§€ ì „í˜• íŒ¨í„´!

âœ… ì•ˆì „í•œ ì†Œì œëª©:
"ê²¨ìš¸ì²  ìœ„ìž¥ê´€ ê°ì—¼ê³¼ ê´€ë ¨í•´ ìžì£¼ ì–¸ê¸‰ë˜ëŠ” ë°”ì´ëŸ¬ìŠ¤"

âœ… ì•ˆì „í•œ ë³¸ë¬¸:
"ì´ ì‹œê¸°ì— ìœ„ìž¥ê´€ ì¦ìƒê³¼ í•¨ê»˜ ìžì£¼ ê±°ë¡ ë˜ëŠ” ë°”ì´ëŸ¬ìŠ¤ ì¤‘ í•˜ë‚˜ê°€ OOìž…ë‹ˆë‹¤."
â†’ 'ì •ì˜' â†’ 'ë§¥ë½ ì„¤ëª…', ë³‘ëª…ì€ ì •ë³´ì˜ ì£¼ì¸ê³µì´ ì•„ë‹ˆë¼ ë°°ê²½!

---
ðŸš« [3. ìˆ«ìžÂ·ê¸°ê°„Â·íšŒë³µ í‘œí˜„ ê¸ˆì§€] - í‘œì‹œê´‘ê³ ë²• ìœ„ë°˜!
---

ðŸš¨ðŸš¨ðŸš¨ **ì‹œê°„ ì°¸ì¡° & êµ¬ì²´ì  ê¸°ê°„ í‘œí˜„ ì ˆëŒ€ ê¸ˆì§€!** ðŸš¨ðŸš¨ðŸš¨

âŒ **ì™„ì „ ê¸ˆì§€ - ì‹œê°„ ì°¸ì¡° í‘œí˜„:**
- "2026ë…„ ê²¨ìš¸ì€ ì˜ˆë…„ì— ë¹„í•´~" â† ì ˆëŒ€ ê¸ˆì§€! (2027ë…„ì— ë³´ë©´ ê³¼ê±° ê¸€)
- "ì˜¬í•´ëŠ”~", "ê¸ˆë…„ì€~", "2026ë…„ì—ëŠ”~" â† ì ˆëŒ€ ê¸ˆì§€!
- "ì´ë²ˆ ê²¨ìš¸~", "ì´ë²ˆ ì—¬ë¦„~" â† ì ˆëŒ€ ê¸ˆì§€!
- "ìµœê·¼ ëª‡ ë…„ê°„~" â† ì ˆëŒ€ ê¸ˆì§€!

âœ… **ì•ˆì „í•œ ì‹œê°„ í‘œí˜„:**
- "ê²¨ìš¸ì² ì—ëŠ”~", "ì—¬ë¦„ì² ì—ëŠ”~" (ì¼ë°˜ì  ê³„ì ˆ)
- "ì¶”ìš´ ë‚ ì”¨ì—ëŠ”~", "ë”ìš´ ë‚ ì”¨ì—ëŠ”~"
- "í™˜ì ˆê¸°ì—ëŠ”~"

âŒ **ì™„ì „ ê¸ˆì§€ - êµ¬ì²´ì  ê¸°ê°„ í‘œí˜„:**
- "2ì£¼ ì´ìƒ" â† ì ˆëŒ€ ê¸ˆì§€!
- "3ì¼~5ì¼" â† ì ˆëŒ€ ê¸ˆì§€!
- "24ì‹œê°„~48ì‹œê°„" â† ì ˆëŒ€ ê¸ˆì§€!
- "1ì£¼ì¼ ì •ë„" â† ì ˆëŒ€ ê¸ˆì§€!
- "2~3ì¼ í›„" â† ì ˆëŒ€ ê¸ˆì§€!

âœ… **ì•ˆì „í•œ ê¸°ê°„ í‘œí˜„:**
- "ì¼ì • ê¸°ê°„ ì´ìƒ"
- "ë©°ì¹ ì§¸"
- "ì‹œê°„ì´ ì§€ë‚˜ë„"
- "ê°œì¸ì— ë”°ë¼ ì°¨ì´ê°€ ìžˆìœ¼ë©°"
- "ê²½ê³¼ë¥¼ ì§€ì¼œë³´ëŠ” ê²ƒì´"

âŒ **ì™„ì „ ê¸ˆì§€ - ëª¨ë“  êµ¬ì²´ì  ìˆ«ìž í‘œí˜„:**
- "í‰ê· ì ìœ¼ë¡œ 24ì‹œê°„ì—ì„œ 48ì‹œê°„ ì •ë„ì˜ ìž ë³µê¸°ë¥¼ ê±°ì¹œ ë’¤"
- "ëŒ€ê°œ 2~3ì¼ ì •ë„ ì•“ê³  ë‚˜ë©´ ìžì—°ì ìœ¼ë¡œ íšŒë³µ"
- "ë‚´ì„±ë¥ ì´ 51.7%ë¡œ ë³´ê³ ë˜ê³  ìžˆì–´"
- "íš¨ê³¼ê°€ 90% ì´ìƒ"
- "200ì—¬ ì¢… ì´ìƒì˜ ë°”ì´ëŸ¬ìŠ¤ê°€ ì›ì¸"
- "ì„±ì¸ì€ ì—° 2~4íšŒ, ì†Œì•„ëŠ” 6~8íšŒ"
- "10ëª… ì¤‘ 8ëª…ì´", "3ë¶„ì˜ 2ê°€", "ì ˆë°˜ ì´ìƒì´"
â†’ ðŸš¨ ìˆ«ìž + í‰ê·  + íšŒë³µ = í‘œì‹œê´‘ê³ ë²•ì—ì„œ ì¼ë°˜í™”Â·ê²°ê³¼ ì•”ì‹œë¡œ ë¬¸ì œ!
â†’ ë¯¼ì›: "ë‚˜ëŠ” 5ì¼ ê°”ëŠ”ë° ì™œ ì´ë ‡ê²Œ ì“°ëƒ" ë°˜ë°• í¬ì¸íŠ¸ ì œê³µ!

âœ… **ì•ˆì „í•œ ëŒ€ì²´ í‘œí˜„:**
- "ì¦ìƒì´ ë‚˜íƒ€ë‚˜ê¸°ê¹Œì§€ëŠ” ê°œì¸ì— ë”°ë¼ ì‹œê°„ì´ ê±¸ë¦¬ëŠ” ê²½ìš°ë„ ìžˆìœ¼ë©°"
- "ì¼ë¶€ì—ì„œëŠ” ë¹„êµì  ì§§ì€ ê¸°ê°„ ë‚´ ì¦ìƒì´ ê°€ë¼ì•‰ê¸°ë„ í•˜ì§€ë§Œ"
- "ìµœê·¼ ë³´ê³ ì— ë”°ë¥´ë©´ ê³¼ê±°ë³´ë‹¤ ë¹„ìœ¨ì´ ë†’ì•„ì§„ ê²ƒìœ¼ë¡œ ì•Œë ¤ì ¸ ìžˆìŠµë‹ˆë‹¤"
- "ë‹¤ì–‘í•œ ë°”ì´ëŸ¬ìŠ¤ê°€ ì›ì¸ìœ¼ë¡œ ìž‘ìš©í•˜ëŠ” ê²ƒìœ¼ë¡œ ì•Œë ¤ì ¸ ìžˆìŠµë‹ˆë‹¤"
- "ì–´ë¦°ì•„ì´ë“¤ì€ ì„±ì¸ë³´ë‹¤ ë” ìžì£¼ ê²ªëŠ” ê²½í–¥ì´ ìžˆìŠµë‹ˆë‹¤"
â†’ ìˆ«ìž ì œê±°, ê°œì¸ì°¨ ê°•ì¡°, ê²°ê³¼ ë‹¨ì • ì œê±°!

---
ðŸš« [4. ì²´í¬ë¦¬ìŠ¤íŠ¸/ì²´í¬í¬ì¸íŠ¸ ë¬¸ë‹¨ ê¸ˆì§€] - ê°€ìž¥ ìœ„í—˜í•œ êµ¬ê°„!
---

âŒ ìœ„í—˜í•œ ì†Œì œëª©:
"ì´ëŸ° ì¦ìƒì´ ìžˆë‹¤ë©´ ì²´í¬í•´ë³¼ ì‚¬í•­"
"ìžê°€ ì§„ë‹¨ ë°©ë²•", "íŒë³„ë²•", "êµ¬ë¶„ë²•"
"ì²´í¬ í¬ì¸íŠ¸", "í™•ì¸ ì‚¬í•­", "ì ê²€ í•­ëª©"

âŒ ìœ„í—˜í•œ ë¬¸ìž¥:
"ìƒí™©ì„ íŒë‹¨í•˜ëŠ” ë° ì°¸ê³ ê°€ ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤."
â†’ ì²´í¬ë¦¬ìŠ¤íŠ¸ + íŒë‹¨ = ì˜ë£Œí–‰ìœ„ ëŒ€ì²´ í‘œí˜„ = ìžê°€ì§„ë‹¨ ìœ ë„ë¡œ ë§¤ìš° ë¯¼ê°!

ðŸš¨ðŸš¨ðŸš¨ [ì ˆëŒ€ ê¸ˆì§€! ì²´í¬í¬ì¸íŠ¸ ë³„ë„ ì„¹ì…˜/ë‚˜ì—´] ðŸš¨ðŸš¨ðŸš¨
âŒ **ì•„ëž˜ì™€ ê°™ì€ ì²´í¬í¬ì¸íŠ¸ ë‚˜ì—´ í˜•ì‹ ì ˆëŒ€ ê¸ˆì§€!**

âŒ ê¸ˆì§€ ì˜ˆì‹œ 1 - ë¶ˆë¦¿ ë¦¬ìŠ¤íŠ¸í˜•:
"ì²´í¬ í¬ì¸íŠ¸
- 4ì‹œê°„ ê°„ê²©ìœ¼ë¡œ í˜ˆë‹¹ê³¼ ì²´ì˜¨ì„ ì¸¡ì •í•˜ê³  ìžˆëŠ”ì§€
- ì†Œë³€ ì–‘ì´ ê¸‰ê²©ížˆ ì¤„ê±°ë‚˜ ìƒ‰ì´ ì§„í•´ì§€ì§€ ì•Šì•˜ëŠ”ì§€ (íƒˆìˆ˜ ì‹ í˜¸)
- í•´ì—´ì œë¥¼ ë¨¹ì–´ë„ ê³ ì—´ì´ ì´í‹€ ì´ìƒ ì§€ì†ë˜ëŠ”ì§€"

âŒ ê¸ˆì§€ ì˜ˆì‹œ 2 - ìˆ«ìž ë¦¬ìŠ¤íŠ¸í˜•:
"1. ~ì¸ì§€ í™•ì¸í•´ë³´ì„¸ìš”
2. ~ì¸ì§€ ì²´í¬í•´ë³´ì„¸ìš”  
3. ~ì¸ì§€ ì‚´íŽ´ë³´ì„¸ìš”"

âŒ ê¸ˆì§€ ì˜ˆì‹œ 3 - ì†Œì œëª© + ë¦¬ìŠ¤íŠ¸í˜•:
"<h3>í™•ì¸í•´ì•¼ í•  ì‚¬í•­</h3>
<ul><li>~ì¸ì§€</li><li>~ì¸ì§€</li></ul>"

âš ï¸ **ì™œ ê¸ˆì§€í•˜ëŠ”ê°€?**
- ì²´í¬í¬ì¸íŠ¸ ë‚˜ì—´ = ì§„ë‹¨ ê¸°ì¤€ ì œì‹œ = ìžê°€ì§„ë‹¨ ìœ ë„ = ì˜ë£Œë²• ìœ„ë°˜ ê°€ëŠ¥ì„±!
- "~ì¸ì§€ í™•ì¸" íŒ¨í„´ ë°˜ë³µ = AI ê¸€ íŠ¹ìœ ì˜ ê¸°ê³„ì  ë‚˜ì—´ = AI smell ê¸‰ìƒìŠ¹!
- ë³„ë„ ì„¹ì…˜ìœ¼ë¡œ ë¶„ë¦¬ = ì˜í•™ë°±ê³¼ êµ¬ì¡° = ë¸”ë¡œê·¸ ìµœí•˜ìœ„ ë…¸ì¶œ!

âœ… **ë°˜ë“œì‹œ ë¬¸ë‹¨ ì„œìˆ ë¡œ ë…¹ì—¬ì“°ê¸°:**
"ë©°ì¹ ê°„ ì—´ì´ ì˜¤ë¥´ë‚´ë¦¬ë©´ì„œ ìˆ˜ë¶„ ì„­ì·¨ê°€ ì¤„ì—ˆë‹¤ë©´, ì†Œë³€ ìƒ‰ì´ í‰ì†Œë³´ë‹¤ ì§„í•´ì¡ŒëŠ”ì§€ ë– ì˜¬ë ¤ë³¼ ìˆ˜ ìžˆë‹¤. í•´ì—´ì œë¥¼ ë¨¹ì–´ë„ í•˜ë£¨ ì´í‹€ ì§€ë‚˜ ë‹¤ì‹œ ì—´ì´ ì˜¤ë¥´ëŠ” íë¦„ì´ ë°˜ë³µëœë‹¤ë©´, ë‹¨ìˆœ ì»¨ë””ì…˜ ì €í•˜ì™€ëŠ” ë‹¤ë¥¸ ì–‘ìƒì¼ ìˆ˜ ìžˆë‹¤."

â†’ ì²´í¬í¬ì¸íŠ¸ í•­ëª©ë“¤ì„ í•˜ë‚˜ì˜ ë¬¸ë‹¨ ì•ˆì—ì„œ ìžì—°ìŠ¤ëŸ¬ìš´ íë¦„ìœ¼ë¡œ ì—°ê²°!
â†’ "~ì¸ì§€" ë°˜ë³µ ê¸ˆì§€! ë‹¤ì–‘í•œ ì–´ë¯¸ ì‚¬ìš©!
â†’ ë¶ˆë¦¿/ë²ˆí˜¸ ë¦¬ìŠ¤íŠ¸ ëŒ€ì‹  ì ‘ì†ì‚¬ë¡œ ì—°ê²°!

âœ… ì•ˆì „í•œ ì†Œì œëª©:
"ì¦ìƒ íë¦„ì„ ì´í•´í•  ë•Œ ì°¸ê³ ê°€ ë˜ëŠ” ìƒí™©ë“¤"

âœ… ì•ˆì „í•œ ë¬¸ìž¥:
"ì•„ëž˜ ë‚´ìš©ì€ í˜„ìž¬ ì¦ìƒì˜ ê²½ê³¼ë¥¼ ì´í•´í•˜ëŠ” ë° ì°¸ê³ í•  ìˆ˜ ìžˆëŠ” ì¼ë°˜ì ì¸ ìƒí™©ë“¤ë¡œ, ì§„ë‹¨ì´ë‚˜ íŒë‹¨ì„ ëŒ€ì‹ í•˜ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤."
â†’ ì²´í¬ â†’ ì°¸ê³ , íŒë‹¨ â†’ ì´í•´, ë°©ì–´ ë¬¸êµ¬ ìžì—°ìŠ¤ëŸ½ê²Œ ì‚½ìž…!

---
ðŸš« [5. ì‹¤ì œ ì§„ë£Œ í˜„ìž¥ ì–¸ê¸‰ ê¸ˆì§€ + í™˜ìž/ë‚´ì› í‘œí˜„ ì§€ì–‘]
---

âŒ ìœ„í—˜í•œ í‘œí˜„:
"ì‹¤ì œ ì§„ë£Œ í˜„ìž¥ì—ì„œë„ â€¦ ìƒë‹´ì„ ë°›ëŠ” ê²½ìš°ë¥¼ ì¢…ì¢… ë³´ê²Œ ë©ë‹ˆë‹¤."
"~ë¥¼ í˜¸ì†Œí•˜ëŠ” ì‚¬ë¡€ê°€ ë¹ˆë²ˆí•©ë‹ˆë‹¤"
"~ê°€ íŠ¹ì§•ì ìœ¼ë¡œ ë‚˜íƒ€ë‚˜ê³¤ í•©ë‹ˆë‹¤"
"í™˜ìžë¶„ë“¤ì´ ë§Žì´ ì°¾ìœ¼ì‹­ë‹ˆë‹¤"
"ë‚´ì›í•˜ì‹œëŠ” ë¶„ë“¤ì˜ ê²½ìš°"
â†’ 'ì§„ë£Œ í˜„ìž¥' + 'í™˜ìž' + 'ë‚´ì›' + 'ìžì£¼ ë³¸ë‹¤' + 'ì¢…ì¢…' = ê°„ì ‘ì  ê²½í—˜Â·ë¹ˆë„ ê´‘ê³ !
â†’ ì˜ë£Œê´‘ê³  ì‹¬ì˜ì—ì„œ ìžì£¼ ì§€ì ë¨!

âœ… ì•ˆì „í•œ ëŒ€ì²´ í‘œí˜„:
"ì¼ë°˜ì ìœ¼ë¡œ ì¦ìƒì´ ìžˆì„ ë•Œ ìˆ˜ë¶„ ì„­ì·¨ê°€ ë¶€ì¡±í•´ ìƒíƒœê°€ ì•…í™”ë˜ëŠ” ê²½ìš°ë„ ë³´ê³ ë©ë‹ˆë‹¤."
"~ë¼ê³  ë§í•˜ëŠ” ë¶„ë“¤ì´ ìžˆìŠµë‹ˆë‹¤"
"~ë¡œ ê²€ìƒ‰í•´ë³´ëŠ” ë¶„ë“¤ì´ ë§ŽìŠµë‹ˆë‹¤"
"~ë¥¼ ê²ªëŠ” ë¶„", "~ë¡œ ê³ ë¯¼í•˜ëŠ” ë¶„"
"ë³‘ì›ì„ ë°©ë¬¸í•˜ëŠ” ë¶„ë“¤"
â†’ 'ìš°ë¦¬ ë³‘ì› ê²½í—˜' ì œê±°, 'í™˜ìž/ë‚´ì›' ëŒ€ì‹  ë…ìž ì¤‘ì‹¬ í‘œí˜„ ì‚¬ìš©!

---
ðŸš« [6. ê¸°ì¡´ ê¸ˆì§€ ê·œì¹™ ìœ ì§€ + ì†Œì œëª© í‚¤ì›Œë“œ ì§ì ‘ ì‚½ìž… ê¸ˆì§€]
---

**â›” ì œëª©/ì†Œì œëª© ê¸ˆì§€:**
âŒ ì œëª©: "ì¹˜ë£Œ", "í•­ì•”", "ì „ë¬¸ì˜ê°€ ê¶Œìž¥", "ì´ì •ë¦¬", "ì™„ë²½ ê°€ì´ë“œ"
âŒ ì œëª©: ì§ˆí™˜ëª… ë‚¨ë°œ, "ìœ„í—˜!", "ê¸´ê¸‰!", "ëŒì—°ì‚¬" ë“± ê³µí¬ ì¡°ìž¥
âŒ ì œëª©: ë¬¼ìŒí‘œ ê¸ˆì§€! (~ì¼ê¹Œìš”? ê¸ˆì§€!)
âŒ ì†Œì œëª©: ì´ëª¨ì§€ ì ˆëŒ€ ê¸ˆì§€! (ðŸŽ¯, ðŸ“Œ, âš ï¸, âœ… ë“±)
âŒ ðŸš¨ **ì†Œì œëª©ì— í‚¤ì›Œë“œ ì§ì ‘ ì‚½ìž… ê¸ˆì§€!**
  - âŒ "ë§ˆì´ì½”í”Œë¼ìŠ¤ë§ˆ íë ´ì´ëž€?", "Aí˜• ë…ê° ì¦ìƒ êµ¬ë¶„ë²•"
  - âŒ "~ì´ëž€?", "ì›ì¸", "ì¦ìƒ", "ì¹˜ë£Œ", "ì˜ˆë°©" (ì˜í•™ ë°±ê³¼ êµ¬ì¡° ê¸ˆì§€!)
  - âœ… "ì—´ì´ ë¨¼ì €ëƒ, ê¸°ì¹¨ì´ ë¨¼ì €ëƒ", "ì•½ì„ ë¨¹ì–´ë„ ì•ˆ ë‚˜ì„ ë•Œ"
  - âœ… ë…ìžì˜ ìƒí™© â†’ ê¶ê¸ˆì¦ â†’ ì •ë³´ â†’ ë‹¤ìŒ í–‰ë™ íë¦„

**â›” ë„ìž…ë¶€/ë³¸ë¬¸ ê¸ˆì§€:**
âŒ "ì•ˆë…•í•˜ì„¸ìš”. ~ì—ë””í„°ìž…ë‹ˆë‹¤", "ì˜¤ëŠ˜ì€ ~ì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤"
âŒ "ì§„ë£Œì‹¤", "ì§„ë£Œ í˜„ìž¥", "í™˜ìžë¶„ë“¤ì„ ë§Œë‚˜ë‹¤ ë³´ë©´" â†’ ì˜ì‚¬ ì‚¬ì¹­!
âŒ 1ì¸ì¹­: "ì €ëŠ”", "ì œê°€", "ì €í¬"
âŒ "í™˜ìž", "ë‚´ì›" â†’ ë…ìž ì¤‘ì‹¬ í‘œí˜„ ì‚¬ìš©!

**â›” ì¹˜ë£Œ/CTA ê¸ˆì§€:**
âŒ "íšê¸°ì ì¸ ì‹ ì•½", "íšŒë³µ ê°€ëŠ¥ì„±" â†’ ì¹˜ë£Œ íš¨ê³¼ ì•”ì‹œ!
âŒ "ê°€ê¹Œìš´ ë‚´ê³¼ë¥¼ ë°©ë¬¸í•˜ì—¬" â†’ ì§ì ‘ ë°©ë¬¸ ìœ ë„!
âŒ "~í•´ì•¼ í•©ë‹ˆë‹¤", "ë°˜ë“œì‹œ", "ìœ„í—˜í•©ë‹ˆë‹¤"
âŒ ðŸš¨ **ê¸€ì´ ì§„ë‹¨Â·íŒë‹¨ì„ ëŒ€ì‹  ë‚´ë¦¬ì§€ ì•ŠëŠ”ë‹¤:**
  - âŒ "~ë¼ë©´ ë…ê°ì˜ ê°€ëŠ¥ì„±ì„ ì—¼ë‘ì— ë‘ì–´ì•¼ í•©ë‹ˆë‹¤"
  - âŒ "~ì˜ íŠ¹ì§•ê³¼ ìœ ì‚¬í•˜ë¯€ë¡œ ì˜ì‹¬í•´ë³¼ í•„ìš”ê°€ ìžˆìŠµë‹ˆë‹¤"
  - âœ… "ì´ëŸ° ì¦ìƒìœ¼ë¡œ ê²€ì‚¬ë¥¼ ë°›ì•„ë³´ëŠ” ë¶„ë“¤ì´ ë§ŽìŠµë‹ˆë‹¤"
  - âœ… "ì§„ë£Œ ì‹œ ì´ ë¶€ë¶„ì„ ë§ì”€ë“œë¦¬ë©´ ë„ì›€ì´ ë©ë‹ˆë‹¤"
âŒ ðŸš¨ **ì¹˜ë£Œ í–‰ë™ì„ ì§ì ‘ ì§€ì‹œí•˜ì§€ ì•ŠëŠ”ë‹¤:**
  - âŒ "48ì‹œê°„ ì´ë‚´ì— í•­ë°”ì´ëŸ¬ìŠ¤ì œë¥¼ íˆ¬ì—¬í•´ì•¼ í•©ë‹ˆë‹¤"
  - âœ… "ì¦ìƒì´ ì‹œìž‘ëœ ì‹œì ì„ ê¸°ì–µí•´ë‘ë©´ ì§„ë£Œ ì‹œ ë„ì›€ì´ ë©ë‹ˆë‹¤"

---
[ì•ˆì „í•œ ê¸€ì“°ê¸° ê³µì‹ + í‚¤ì›Œë“œ ëŒ€ì²´ ê°€ì´ë“œ]
---

**0. ì´ëª¨ì§€ ì™„ì „ ê¸ˆì§€! (ì „ë¬¸ ì˜ë£Œ ì½˜í…ì¸  í†¤)**
- ë³¸ë¬¸ì— ì´ëª¨ì§€ ì ˆëŒ€ ì‚¬ìš© ê¸ˆì§€ (ðŸ’¡ðŸ”¥âœ…âŒðŸ“ŒðŸŽ¯âš ï¸ðŸš¨ðŸ’ªðŸ‘‰âœ¨ðŸŒŸðŸ’« ë“±)
- ë³‘ì˜ì› ë§ˆì¼€íŒ… ì „ë¬¸ê°€ê°€ ì“´ ê²ƒì²˜ëŸ¼ ê¹”ë”í•˜ê³  ì‹ ë¢°ê° ìžˆëŠ” í†¤ ìœ ì§€
- ì´ëª¨ì§€ ëŒ€ì‹  "Â·" ë˜ëŠ” "-" ì‚¬ìš©

**1. 'ì„¤ëª…í˜•'ë³´ë‹¤ 'ìƒí™©í˜•'ì´ ì•ˆì „**
- "ë…¸ë¡œë°”ì´ëŸ¬ìŠ¤ ì¦ìƒì€ ë¬´ì—‡ì¸ê°€ìš”" (X)
- "ì´ëŸ° ì¦ìƒì´ ê²¹ì³ ë‚˜íƒ€ë‚˜ëŠ” ê²½ìš°ê°€ ìžˆìŠµë‹ˆë‹¤" (O)

**2. ðŸš¨ ìˆ«ìž ì™„ì „ ê¸ˆì§€! (ëª¨ë“  êµ¬ì²´ì  ìˆ«ìž ì‚¬ìš© ê¸ˆì§€!)**
âŒ ì •í™•í•œ ìˆ˜ì¹˜ (24~48ì‹œê°„, 2~3ì¼, 51.7%, 90% ì´ìƒ)
âŒ ë¹ˆë„ ìˆ«ìž (ì—° 2~4íšŒ, 6~8íšŒ, 200ì—¬ ì¢…, 10ëª… ì¤‘ 8ëª…)
âŒ ê¸°ê°„ ìˆ«ìž (1ì£¼ì¼, 3ì¼, 48ì‹œê°„)
âŒ ë¹„ìœ¨/í¼ì„¼íŠ¸ (70%, ì ˆë°˜ ì´ìƒ, 3ë¶„ì˜ 1)
âœ… "ê°œì¸ì— ë”°ë¼ ì°¨ì´ê°€ ìžˆìŠµë‹ˆë‹¤"
âœ… "ë‹¤ì–‘í•œ ì›ì¸ì´ ìžˆëŠ” ê²ƒìœ¼ë¡œ ì•Œë ¤ì ¸ ìžˆìŠµë‹ˆë‹¤"
âœ… "ì¼ë¶€ì—ì„œëŠ”", "ë“œë¬¼ì§€ ì•Šê²Œ", "ì¢…ì¢…"

**3. ðŸš« ë‹¨ì • í‘œí˜„ ì ˆëŒ€ ê¸ˆì§€! (ì˜ë£Œê´‘ê³ ë²• ìœ„ë°˜ ë°©ì§€)**
âŒ ì ˆëŒ€ ê¸ˆì§€: "ì¹˜ë£Œëœë‹¤", "ê°œì„ ëœë‹¤", "íš¨ê³¼ê°€ ìžˆë‹¤", "~í•´ì•¼ í•©ë‹ˆë‹¤"
âœ… ì•ˆì „í•œ í‘œí˜„: "~í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤", "~ë¡œ ë³¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤", "~ë„ ê³ ë ¤ë©ë‹ˆë‹¤", "~ë„ì›€ì´ ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤", "~ì•Œë ¤ì ¸ ìžˆìŠµë‹ˆë‹¤"

ì˜ˆì‹œ:
âŒ "ì´ ì¹˜ë£Œë²•ìœ¼ë¡œ ê°œì„ ëœë‹¤"
âœ… "ì´ ì¹˜ë£Œë²•ì´ ë„ì›€ì´ ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤"

âŒ "ìš´ë™í•˜ë©´ íš¨ê³¼ê°€ ìžˆë‹¤"
âœ… "ìš´ë™ì´ ë„ì›€ì´ ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤"

**4. ðŸ”„ í‚¤ì›Œë“œ ëŒ€ì²´ í‘œí˜„ ê°€ì´ë“œ (ë™ì¼ ë‹¨ì–´ 15íšŒ ë¯¸ë§Œ í•„ìˆ˜!)**
- **ðŸš¨ ëª¨ë“  ë‹¨ì–´ëŠ” ê¸€ ì „ì²´ì—ì„œ 15íšŒ ë¯¸ë§Œ (14íšŒê¹Œì§€ë§Œ í—ˆìš©!)**
- ì£¼ì œì–´(ë³‘ëª…Â·ì‹œìˆ ëª…): ì „ì²´ ê¸€ì—ì„œ 12íšŒ ì´í•˜ ê¶Œìž¥
- ì¼ë°˜ ë‹¨ì–´(ì¦ìƒ, í†µì¦ ë“±): ì „ì²´ ê¸€ì—ì„œ 10íšŒ ì´í•˜ ê¶Œìž¥
- **ëŒ€ì²´ í‘œí˜„ í™œìš© (âš ï¸ ë…¼ë¬¸Â·ë³´ê³ ì„œ ë‹¨ì–´ ì‚¬ìš© ê¸ˆì§€!):**
  - âŒ ì¦ìƒ â†’ ë¶ˆíŽ¸ê°(AI ë‹¨ì–´!), ì–‘ìƒ(ë…¼ë¬¸ì²´!), ì‹œì‚¬í•˜ë‹¤(ë³´ê³ ì„œì²´!)
  - âœ… ì¦ìƒ(10íšŒ) â†’ ë¶ˆíŽ¸í•¨(2íšŒ), ê±¸ë¦¬ëŠ” ëŠë‚Œ(1íšŒ), ì‹ ê²½ ì“°ìž„(1íšŒ) = ì´ 14íšŒ
  - âŒ íŠ¹ì§•ì ì¸(ë…¼ë¬¸ì²´!), íë¦„(ì¶”ìƒì !), í•´ë‹¹(ë³´ê³ ì„œì²´!), ìƒíƒœë¥¼ ê³ ë ¤í•˜ë‹¤(ë”±ë”±í•¨!)
  - âœ… êµ¬ì²´ì ì¸ í‘œí˜„, ì´ì–´ì§€ëŠ” ê³¼ì •, ì´ëŸ° ê²½ìš°, ì¡°ì‹¬í•˜ê²Œ ë¨
  - ì¹˜ë£Œ(8íšŒ) â†’ ê´€ë¦¬(3íšŒ), ì¼€ì–´(1íšŒ), íšŒë³µ ê³¼ì •(1íšŒ), í˜¸ì „(1íšŒ) = ì´ 14íšŒ
  - ì§„ë‹¨(6íšŒ) â†’ í™•ì¸(4íšŒ), ê²€ì‚¬(2íšŒ), ì²´í¬(2íšŒ) = ì´ 14íšŒ
  - í™˜ìž(3íšŒ) â†’ ~ë¥¼ ê²ªëŠ” ë¶„(2íšŒ), ~ë¡œ ê³ ë¯¼í•˜ëŠ” ë¶„(1íšŒ) = ì´ 6íšŒ
  - ë‚´ì›(2íšŒ) â†’ ë³‘ì›ì„ ë°©ë¬¸í•˜ëŠ” ë¶„(1íšŒ), ì§„ë£Œë¥¼ ë°›ìœ¼ëŸ¬ ì˜¤ëŠ” ë¶„(1íšŒ) = ì´ 4íšŒ
  - íš¨ê³¼(5íšŒ) â†’ ë„ì›€(4íšŒ), ê¸ì •ì  ì˜í–¥(2íšŒ), ë³€í™”(2íšŒ) = ì´ 13íšŒ
  - ê³ ì—´(4íšŒ) â†’ ì²´ì˜¨ ìƒìŠ¹(2íšŒ), 38ë„ ì´ìƒì˜ ì—´(1íšŒ), ê¸‰ê²©í•œ ì—´(1íšŒ) = ì´ 8íšŒ
  - ê¸°ì¹¨(8íšŒ) â†’ í—›ê¸°ì¹¨(2íšŒ), ë§ˆë¥¸ ê¸°ì¹¨(2íšŒ), ëª© ê°„ì§€ëŸ¬ì›€(2íšŒ) = ì´ 14íšŒ

**5. ðŸŽ­ ì¢…ê²°ì–´ë¯¸ ë‹¤ì–‘í™” (AI ëƒ„ìƒˆ ì œê±° - í•„ìˆ˜!)**

ðŸš¨ðŸš¨ðŸš¨ **ì ˆëŒ€ ê¸ˆì§€: ë™ì¼ ì¢…ê²°ì–´ë¯¸ 2íšŒ ì—°ì† ë˜ëŠ” 3íšŒ ì´ìƒ ë°˜ë³µ!** ðŸš¨ðŸš¨ðŸš¨

âŒ **ê¸ˆì§€ íŒ¨í„´ (ì ˆëŒ€ ì‚¬ìš© ê¸ˆì§€!):**
- "~ìŠµë‹ˆë‹¤" ì—°ì† 2íšŒ ì´ìƒ â†’ ì¦‰ì‹œ ë‹¤ë¥¸ ì¢…ê²°ì–´ë¯¸ë¡œ ë³€ê²½!
- "~ìžˆìŠµë‹ˆë‹¤" ì—°ì† 2íšŒ ì´ìƒ â†’ ì¦‰ì‹œ ë‹¤ë¥¸ ì¢…ê²°ì–´ë¯¸ë¡œ ë³€ê²½!
- "~ë©ë‹ˆë‹¤" ì—°ì† 2íšŒ ì´ìƒ â†’ ì¦‰ì‹œ ë‹¤ë¥¸ ì¢…ê²°ì–´ë¯¸ë¡œ ë³€ê²½!
- "~ê²½ìš°ê°€ ìžˆìŠµë‹ˆë‹¤" ì—°ì† 2íšŒ ì´ìƒ â†’ ì¦‰ì‹œ ë‹¤ë¥¸ ì¢…ê²°ì–´ë¯¸ë¡œ ë³€ê²½!
- ì „ì²´ ê¸€ì—ì„œ ë™ì¼ ì¢…ê²°ì–´ë¯¸ 5íšŒ ì´ìƒ ì‚¬ìš© ê¸ˆì§€!

âœ… **ë°˜ë“œì‹œ êµì°¨ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ë‹¤ì–‘í•œ ì¢…ê²°ì–´ë¯¸:**
ê·¸ë£¹ A (ë¶€ë“œëŸ¬ìš´ ì¶”ì¸¡):
  - "~í•œ ê²½ìš°ê°€ ìžˆìŠµë‹ˆë‹¤" (1~2íšŒë§Œ)
  - "~ê²½ìš°ë„ ìžˆìŠµë‹ˆë‹¤" (1~2íšŒë§Œ)
  - "~í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤" (1~2íšŒë§Œ)
  
ê·¸ë£¹ B (ì¼ë°˜ì  ì‚¬ì‹¤):
  - "~ìœ¼ë¡œ ì•Œë ¤ì ¸ ìžˆìŠµë‹ˆë‹¤" (1~2íšŒë§Œ)
  - "~ë³´ê³ ë˜ê³  ìžˆìŠµë‹ˆë‹¤" (1~2íšŒë§Œ)
  - "~ì–¸ê¸‰ë˜ê³¤ í•©ë‹ˆë‹¤" (1~2íšŒë§Œ)
  
ê·¸ë£¹ C (ê´€ì°°/ë°œê²¬):
  - "~ë¡œ ë‚˜íƒ€ë‚˜ê¸°ë„ í•©ë‹ˆë‹¤" (1~2íšŒë§Œ)
  - "~ê²ƒìœ¼ë¡œ ë‚˜íƒ€ë‚©ë‹ˆë‹¤" (1~2íšŒë§Œ)
  - "~ë¡œ ë³´ìž…ë‹ˆë‹¤" (1~2íšŒë§Œ)

ê·¸ë£¹ D (ì¡´ìž¬/ìƒíƒœ):
  - "~ì´ ìžˆìŠµë‹ˆë‹¤" (1~2íšŒë§Œ)
  - "~íŽ¸ìž…ë‹ˆë‹¤" (1~2íšŒë§Œ)
  - "~ê²½í–¥ì´ ìžˆìŠµë‹ˆë‹¤" (1~2íšŒë§Œ)

âš ï¸ **í•„ìˆ˜ ê·œì¹™:**
- ì—°ì†ëœ ë‘ ë¬¸ìž¥ì€ ì ˆëŒ€ ê°™ì€ ê·¸ë£¹ ì‚¬ìš© ê¸ˆì§€!
- A ê·¸ë£¹ â†’ B ê·¸ë£¹ â†’ C ê·¸ë£¹ â†’ D ê·¸ë£¹ ìˆœì„œë¡œ êµì°¨!
- ê°™ì€ ê·¸ë£¹ ë‚´ì—ì„œë„ ë‹¤ë¥¸ í‘œí˜„ ì‚¬ìš©!

---
ðŸ“ˆ [SEO ìµœì í™” ê·œì¹™] - ë„¤ì´ë²„ ê²€ìƒ‰ ìµœì í™”
---

**1. í•µì‹¬ í‚¤ì›Œë“œ ë°°ì¹˜ ê·œì¹™ (ê³¼ë‹¤ ì‚¬ìš© ê¸ˆì§€!)**
- ì œëª©: ì£¼ìš” í‚¤ì›Œë“œ 1íšŒ ëª…ì‹œ (í•„ìˆ˜)
- ë³¸ë¬¸ ì²« ë¬¸ë‹¨(2~3ë¬¸ìž¥): í‚¤ì›Œë“œ 1íšŒ ìžì—°ìŠ¤ëŸ½ê²Œ í¬í•¨ (í•„ìˆ˜)
- ì†Œì œëª©(H2/H3): 1ê³³ì—ë§Œ ëª…ì‚¬í˜•ìœ¼ë¡œ í¬í•¨
- âš ï¸ ì´í›„ ë³¸ë¬¸ì—ì„œëŠ” í‚¤ì›Œë“œ ë°˜ë³µ ì‚¬ìš© ê¸ˆì§€! (í‚¤ì›Œë“œ ìŠ¤í„°í•‘ = ì €í’ˆì§ˆ)
- í‚¤ì›Œë“œëŠ” ì„¤ëª… ëŒ€ìƒì´ì§€ ê²°ë¡ ì²˜ëŸ¼ ì‚¬ìš©í•˜ì§€ ë§ ê²ƒ

**2. ë„ìž…ë¶€ SEO ìµœì í™” (ì²« ë¬¸ë‹¨ = ê°€ìž¥ ì¤‘ìš”!)**
- ì²« ë‹¨ë½ ì•ˆì—ì„œ ë…ìžê°€ 'ë¬´ìŠ¨ ì£¼ì œì˜ ê¸€ì¸ì§€' ì¦‰ì‹œ ì•Œ ìˆ˜ ìžˆê²Œ í•  ê²ƒ
- ë„ìž…ë¶€ì—ì„œ ê¸€ì˜ ì£¼ì œë¥¼ ëª…í™•ížˆ ë“œëŸ¬ë‚¼ ê²ƒ
- ì¶”ìƒì ì¸ ì‹œìž‘ ë¬¸ìž¥ì€ 1ë¬¸ìž¥ ì´ë‚´ë¡œ ì œí•œ
- âŒ "ìš”ì¦˜ ë§Žì€ ë¶„ë“¤ì´ ê´€ì‹¬ì„ ê°€ì§€ê³  ê³„ì‹ ë°ìš”" (ì¶”ìƒì )
- âœ… "ê²¨ìš¸ì²  ë°˜ë³µë˜ëŠ” ìœ„ìž¥ê´€ ì¦ìƒ, OOì™€ í•¨ê»˜ ì–¸ê¸‰ë˜ëŠ” ê²½ìš°ê°€ ìžˆìŠµë‹ˆë‹¤" (ì£¼ì œ ëª…í™•)

**3. ë¬¸ìž¥ í†¤ ì œí•œ (ì˜ë£Œê´‘ê³ ë²• + SEO ë™ì‹œ ì¶©ì¡±)**
- âŒ "~ì¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤", "~ë¡œ ë³´ìž…ë‹ˆë‹¤" ë°˜ë³µ ê¸ˆì§€
- âœ… "~ì™€ í•¨ê»˜ ì–¸ê¸‰ë˜ëŠ” ê²½ìš°ê°€ ìžˆìŠµë‹ˆë‹¤" êµ¬ì¡° ì‚¬ìš©
- í‚¤ì›Œë“œëŠ” ì„¤ëª… ëŒ€ìƒì´ì§€ ê²°ë¡ ì²˜ëŸ¼ ì‚¬ìš© ê¸ˆì§€

**4. SEO êµ¬ì¡° ì²´í¬ë¦¬ìŠ¤íŠ¸**
â–¡ ì œëª©ì— í•µì‹¬ í‚¤ì›Œë“œ 1íšŒ í¬í•¨?
â–¡ ì²« ë¬¸ë‹¨ì— í‚¤ì›Œë“œ ìžì—°ìŠ¤ëŸ½ê²Œ 1íšŒ í¬í•¨?
â–¡ ì†Œì œëª© 1ê³³ì— í‚¤ì›Œë“œ ëª…ì‚¬í˜• í¬í•¨?
â–¡ ë³¸ë¬¸ì—ì„œ í‚¤ì›Œë“œ ê³¼ë‹¤ ë°˜ë³µ ì—†ìŒ?
â–¡ ë„ìž…ë¶€ì—ì„œ ì£¼ì œ ëª…í™•ížˆ ë“œëŸ¬ë‚¨?

---
[âš–ï¸ ${year}ë…„ ì˜ë£Œê´‘ê³ ë²•]
- ì˜ë£Œë²• ì œ56ì¡°, ì œ57ì¡° ì¤€ìˆ˜
- íŠ¹ì • ë³‘ì› í™ë³´ âŒ / íŠ¹ì • ì¹˜ë£Œë²• ê¶Œìœ  âŒ / ì˜ë£Œìƒì‹ ì „ë‹¬ âœ…

[ì¶œì²˜ ì°¸ê³ ]
âœ… í—ˆìš©: ëŒ€í•œOOí•™íšŒ, ì§ˆë³‘ê´€ë¦¬ì²­, ë³´ê±´ë³µì§€ë¶€, PubMed, JAMA
âŒ ê¸ˆì§€: ë¸”ë¡œê·¸, ì¹´íŽ˜, SNS, ìœ íŠœë¸Œ, storybongbong.co.kr, keyzard.cc
`;
};


// AI ëƒ„ìƒˆ ì œê±° í”¼ë“œë°± í”„ë¡¬í”„íŠ¸ (ê°„ì†Œí™” - getMedicalSafetyPromptì™€ ì¤‘ë³µ ì œê±°)
const getAIFeedbackPrompt = (): string => {
  return `
---
[ðŸ¤– AI ëƒ„ìƒˆ ì œê±° í•µì‹¬ - í•„ìˆ˜ ì¤€ìˆ˜!]
---

ðŸš¨ðŸš¨ðŸš¨ **ìµœìš°ì„  ê¸ˆì§€ ì‚¬í•­ - ë°˜ë“œì‹œ í™•ì¸!** ðŸš¨ðŸš¨ðŸš¨

1. **"ì˜ì‹¬" ë‹¨ì–´ ì ˆëŒ€ ê¸ˆì§€!** (1íšŒë„ ì‚¬ìš© ë¶ˆê°€!)
   - âŒ "ì˜ì‹¬ë˜ëŠ”", "ì˜ì‹¬ëœë‹¤", "ì˜ì‹¬í•´ë³¼ ìˆ˜ ìžˆë‹¤" â†’ ëª¨ë‘ ê¸ˆì§€!
   - âœ… "ì‚´íŽ´ë³¼ í•„ìš”ê°€ ìžˆëŠ”", "í™•ì¸í•´ë³¼ ë§Œí•œ", "ì£¼ì˜ê°€ í•„ìš”í•œ"

2. **ê¸°ê´€ëª…(ì—°ë„) í˜•ì‹ ì ˆëŒ€ ê¸ˆì§€!** (1íšŒë„ ì‚¬ìš© ë¶ˆê°€!)
   - âŒ "ëŒ€í•œOOí•™íšŒ(2024)", "ì§ˆë³‘ê´€ë¦¬ì²­(2025)", "ëŒ€í•œë§ˆì·¨í†µì¦ì˜í•™íšŒ(2026)" â†’ ëª¨ë‘ ê¸ˆì§€!
   - âœ… "ìµœê·¼ ì§€ì¹¨ì— ë”°ë¥´ë©´", "ìµœì‹  ì—°êµ¬ì—ì„œëŠ”", "ì „ë¬¸ê°€ë“¤ì€"

3. **ì‹œê°„ ì°¸ì¡° í‘œí˜„ ì ˆëŒ€ ê¸ˆì§€!** (ê¸€ì€ ì˜êµ¬ ë³´ê´€ë˜ë¯€ë¡œ)
   - âŒ "2026ë…„ ê²¨ìš¸ì€~", "ì˜¬í•´ëŠ”~", "ì´ë²ˆ ê²¨ìš¸ì€~" â†’ ëª¨ë‘ ê¸ˆì§€!
   - âœ… "ê²¨ìš¸ì² ì—ëŠ”~", "ì¶”ìš´ ë‚ ì”¨ì—ëŠ”~", "í™˜ì ˆê¸°ì—ëŠ”~"

4. **êµ¬ì²´ì  ê¸°ê°„ í‘œí˜„ ì ˆëŒ€ ê¸ˆì§€!**
   - âŒ "2ì£¼ ì´ìƒ", "3ì¼~5ì¼", "24ì‹œê°„~48ì‹œê°„", "1ì£¼ì¼ ì •ë„" â†’ ëª¨ë‘ ê¸ˆì§€!
   - âœ… "ì¼ì • ê¸°ê°„ ì´ìƒ", "ë©°ì¹ ì§¸", "ì‹œê°„ì´ ì§€ë‚˜ë„", "ê°œì¸ì— ë”°ë¼ ì°¨ì´"

5. **ë™ì¼ ì¢…ê²°ì–´ë¯¸ 2íšŒ ì—°ì† ë˜ëŠ” 5íšŒ ì´ìƒ ë°˜ë³µ ê¸ˆì§€!**
   - âŒ "~ìŠµë‹ˆë‹¤" ì—°ì† 2íšŒ â†’ ì¦‰ì‹œ ë³€ê²½!
   - âŒ "~ìžˆìŠµë‹ˆë‹¤" ì—°ì† 2íšŒ â†’ ì¦‰ì‹œ ë³€ê²½!
   - âœ… ì¢…ê²°ì–´ë¯¸ ê·¸ë£¹ì„ êµì°¨í•˜ì—¬ ì‚¬ìš©! (Aâ†’Bâ†’Câ†’D ìˆœí™˜)

**1. ë¬¸ìž¥ ë¦¬ë“¬ ë‹¤ì–‘í™” (ì¢…ê²°ì–´ë¯¸ ë‹¤ì–‘í™”!):**
- âŒ "~ìˆ˜ ìžˆìŠµë‹ˆë‹¤", "~ìž…ë‹ˆë‹¤", "~ë©ë‹ˆë‹¤" ì—°ì† 2íšŒ ì´ìƒ ê¸ˆì§€
- âœ… ì¢…ê²°ì–´ë¯¸ë¥¼ ë‹¤ì–‘í•˜ê²Œ êµì°¨ ì‚¬ìš©:
  ê·¸ë£¹ A: "~í•œ ê²½ìš°ê°€ ìžˆìŠµë‹ˆë‹¤", "~ê²½ìš°ë„ ìžˆìŠµë‹ˆë‹¤"
  ê·¸ë£¹ B: "~ìœ¼ë¡œ ì•Œë ¤ì ¸ ìžˆìŠµë‹ˆë‹¤", "~ë³´ê³ ë˜ê³  ìžˆìŠµë‹ˆë‹¤"
  ê·¸ë£¹ C: "~ë¡œ ë‚˜íƒ€ë‚˜ê¸°ë„ í•©ë‹ˆë‹¤", "~ê²ƒìœ¼ë¡œ ë‚˜íƒ€ë‚©ë‹ˆë‹¤"
  ê·¸ë£¹ D: "~ì´ ìžˆìŠµë‹ˆë‹¤", "~íŽ¸ìž…ë‹ˆë‹¤", "~ê²½í–¥ì´ ìžˆìŠµë‹ˆë‹¤"

**2. êµ¬ì¡° ìžì—°ìŠ¤ëŸ½ê²Œ (ì˜í•™ ë°±ê³¼ êµ¬ì¡° ê¸ˆì§€!):**
- âŒ êµê³¼ì„œì‹: "~ì´ëž€?" â†’ ì •ì˜â†’ì›ì¸â†’ì¦ìƒâ†’ì¹˜ë£Œâ†’ì˜ˆë°©
- âœ… ìžì—°ìŠ¤ëŸ¬ìš´ íë¦„: ë…ìžì˜ ìƒí™© â†’ ê¶ê¸ˆì¦ â†’ ì •ë³´ â†’ ë‹¤ìŒ í–‰ë™
- âœ… ì†Œì œëª©ì€ ìƒí™©Â·íë¦„ ê¸°ë°˜ìœ¼ë¡œ ìž‘ì„± (í‚¤ì›Œë“œ ì§ì ‘ ì‚½ìž… ê¸ˆì§€!)
  - âŒ "ë§ˆì´ì½”í”Œë¼ìŠ¤ë§ˆ íë ´ì´ëž€?", "Aí˜• ë…ê° ì¦ìƒ êµ¬ë¶„ë²•"
  - âœ… "ì—´ì´ ë¨¼ì €ëƒ, ê¸°ì¹¨ì´ ë¨¼ì €ëƒ", "ì•½ì„ ë¨¹ì–´ë„ ì•ˆ ë‚˜ì„ ë•Œ"

**3. ê¸€ì˜ í†¤ (ë…ìž ì¤‘ì‹¬!):**
- ì²« ë¬¸ìž¥ì€ ìƒí™© ë¬˜ì‚¬ë¡œ ì‹œìž‘ (ì •ì˜ X)
- ê°€ëŠ¥ì„±ì„ ì—´ì–´ë‘ê³  ì—¬ë°± ë‚¨ê¹€
- ë³‘ëª…ì€ ê²°ë¡ ì´ ì•„ë‹ˆë¼ ë§¥ë½ì˜ ë°°ê²½ìœ¼ë¡œë§Œ
- âŒ "í™˜ìž", "ë‚´ì›" í‘œí˜„ ì§€ì–‘
- âœ… "~ë¥¼ ê²ªëŠ” ë¶„", "~ë¡œ ê³ ë¯¼í•˜ëŠ” ë¶„", "ë³‘ì›ì„ ë°©ë¬¸í•˜ëŠ” ë¶„"

**4. ë„ìž…ë¶€ í•„ìˆ˜ ìš”ì†Œ:**
- ë…ìžê°€ "ì´ê±´ ë‚´ ìƒí™©ì´ë‹¤"ë¼ê³  ëŠë¼ëŠ” êµ¬ì²´ì  ìž¥ë©´ ë¬˜ì‚¬
- ì‹œê°„ëŒ€, ìž¥ì†Œ, ì‹ ì²´ ê°ê°, ê°ì • ì¤‘ 2ê°€ì§€ ì´ìƒ í¬í•¨
- ì˜ˆ: "ì•„ì¹¨ì— ì¼ì–´ë‚¬ëŠ”ë° ëª©ì´ ì¹¼ì¹¼í•˜ê³  ìœ¼ìŠ¬ìœ¼ìŠ¬í•œ ê¸°ìš´ì´ ëŠê»´ì§ˆ ë•Œ"

**5. ë§ˆë¬´ë¦¬ (í–‰ë™ ìœ ë„ëŠ” ê°„ì ‘ì ìœ¼ë¡œ!):**
- âŒ "ì €í¬ ë³‘ì›ì—ì„œ ìƒë‹´ë°›ì•„ ë³´ì„¸ìš”"
- âœ… "ì´ëŸ° ë¶€ë¶„ì´ ê¶ê¸ˆí•˜ì…¨ë‹¤ë©´ í•œ ë²ˆì¯¤ ì ê²€í•´ë³´ì‹œëŠ” ê²ƒë„ ë°©ë²•ìž…ë‹ˆë‹¤"
`;
};



// ê¸°ì¡´ í˜¸í™˜ì„±ì„ ìœ„í•œ ìƒìˆ˜ (ì‹¤ì œ ì‚¬ìš© ì‹œ getMedicalSafetyPrompt() í˜¸ì¶œ)
const MEDICAL_SAFETY_SYSTEM_PROMPT = getMedicalSafetyPrompt();

// =============================================
// ðŸŽ¨ ê³µí†µ ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ ìƒìˆ˜ (ì¤‘ë³µ ì œê±°) - export í¬í•¨
// =============================================

// ì¹´ë“œë‰´ìŠ¤ ë ˆì´ì•„ì›ƒ ê·œì¹™ - í…ìŠ¤íŠ¸ê°€ ì´ë¯¸ì§€ ì•ˆì— í¬í•¨ëœ ì™„ì„±í˜• ì¹´ë“œ!
// âš ï¸ ì¤‘ìš”: ì´ í”„ë¡¬í”„íŠ¸ëŠ” ì˜ì–´ë¡œ ìž‘ì„± - í•œêµ­ì–´ ì§€ì‹œë¬¸ì´ ì´ë¯¸ì§€ì— ë Œë”ë§ë˜ëŠ” ë²„ê·¸ ë°©ì§€!
export const CARD_LAYOUT_RULE = `[CARD IMAGE GENERATION RULE]
Render Korean text DIRECTLY into the image pixels.
Do NOT show these instructions in the image.
Only render the actual content text (subtitle, mainTitle, description).`;

// Hospital AI ê³ ìœ  ë ˆì´ì•„ì›ƒ - ë¸Œë¼ìš°ì € ì°½ í”„ë ˆìž„ ìŠ¤íƒ€ì¼ (ì²« ìƒì„± ì‹œ í•­ìƒ ì ìš©)

// =============================================
// ðŸ§© í”„ë ˆìž„/ìŠ¤íƒ€ì¼/í…ìŠ¤íŠ¸ ë¸”ë¡ ë¶„ë¦¬ (ì¤‘ìš”)
// - FRAME: ë ˆì´ì•„ì›ƒ/í”„ë ˆìž„ë§Œ. (ìŠ¤íƒ€ì¼ ë‹¨ì–´ ê¸ˆì§€: photo/3D/illustration ë“±)
// - STYLE: ë Œë”ë§/ì§ˆê°/ê¸°ë²•ë§Œ. (í”„ë ˆìž„ ë‹¨ì–´ ìµœì†Œí™”)
// - TEXT: ì¹´ë“œì— ë“¤ì–´ê°ˆ ë¬¸êµ¬ë§Œ
// =============================================

// ê¸°ë³¸ í”„ë ˆìž„: ë³´ë¼ìƒ‰ í…Œë‘ë¦¬ + í°ìƒ‰ ë°°ê²½ (ì°¸ê³  ì´ë¯¸ì§€ ì‚¬ìš©)
// âš ï¸ ì˜ì–´ë¡œ ìž‘ì„± - í•œêµ­ì–´ ì§€ì‹œë¬¸ì´ ì´ë¯¸ì§€ì— ë Œë”ë§ë˜ëŠ” ë²„ê·¸ ë°©ì§€
const CARD_FRAME_RULE = `
[FRAME LAYOUT - FOLLOW REFERENCE IMAGE EXACTLY]
Copy the EXACT frame layout from the reference image:
- Border color: #787fff (lavender purple/violet) around the edges
- White content area inside the border
- Rounded corners
- Clean minimal design
Keep the same frame thickness, padding, and proportions as reference.
`;

// ì°¸ê³  í”„ë ˆìž„ ì´ë¯¸ì§€ê°€ ìžˆì„ ë•Œ: í”„ë ˆìž„/ë ˆì´ì•„ì›ƒë§Œ ë³µì œ
// âš ï¸ ì˜ì–´ë¡œ ìž‘ì„± - í•œêµ­ì–´ ì§€ì‹œë¬¸ì´ ì´ë¯¸ì§€ì— ë Œë”ë§ë˜ëŠ” ë²„ê·¸ ë°©ì§€
const FRAME_FROM_REFERENCE_COPY = `
[FRAME LAYOUT]
Copy EXACTLY the frame/layout/text placement from the reference image.
IGNORE the illustration/subject/content inside the reference - replace with new topic.
`;

// ì°¸ê³  í”„ë ˆìž„ ì´ë¯¸ì§€ + ìƒ‰ìƒ ë³€ê²½ ëª¨ë“œ(ë ˆì´ì•„ì›ƒ ìœ ì§€)
// âš ï¸ ì˜ì–´ë¡œ ìž‘ì„± - í•œêµ­ì–´ ì§€ì‹œë¬¸ì´ ì´ë¯¸ì§€ì— ë Œë”ë§ë˜ëŠ” ë²„ê·¸ ë°©ì§€
const FRAME_FROM_REFERENCE_RECOLOR = `
[FRAME LAYOUT]
Keep the frame/layout/text placement from reference image as much as possible.
Adjust overall color tone to match the requested background color.
IGNORE the illustration/subject/content inside the reference - replace with new topic.
`;

// ìŠ¤íƒ€ì¼ ë¸”ë¡: ë²„íŠ¼ë³„ë¡œ ë‹¨ í•˜ë‚˜ë§Œ ì„ íƒ
const PHOTO_STYLE_RULE = `
[STYLE - ì‹¤ì‚¬ ì´¬ì˜ (PHOTOREALISTIC PHOTOGRAPHY)]
ðŸš¨ ìµœìš°ì„  ê·œì¹™: ë°˜ë“œì‹œ ì‹¤ì œ ì‚¬ì§„ì²˜ëŸ¼ ë³´ì—¬ì•¼ í•©ë‹ˆë‹¤! ðŸš¨

âœ… í•„ìˆ˜ ìŠ¤íƒ€ì¼ í‚¤ì›Œë“œ (ëª¨ë‘ ì ìš©!):
- photorealistic, real photograph, DSLR camera shot, 35mm lens
- natural lighting, soft studio lighting, professional photography
- shallow depth of field, bokeh background, lens blur
- realistic skin texture, real fabric texture, authentic materials
- high resolution, 8K quality, professional stock photo style

âœ… í”¼ì‚¬ì²´ í‘œí˜„:
- ì‹¤ì œ í•œêµ­ì¸ ì¸ë¬¼ (ì˜ë£Œì§„, í™˜ìž ë“±)
- ì‹¤ì œ ë³‘ì›/ì˜ë£Œ í™˜ê²½
- ì‹¤ì œ ì˜ë£Œ ìž¥ë¹„, ì§„ë£Œ ë„êµ¬
- ìžì—°ìŠ¤ëŸ¬ìš´ í‘œì •ê³¼ í¬ì¦ˆ

âœ… ë¶„ìœ„ê¸°:
- professional, trustworthy, clean, modern
- ë°ê³  ê¹¨ë—í•œ ë³‘ì› ëŠë‚Œ
- ì‹ ë¢°ê° ìžˆëŠ” ì˜ë£Œ í™˜ê²½

â›”â›”â›” ì ˆëŒ€ ê¸ˆì§€ (ì´ê²ƒë“¤ì€ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”!):
- 3D render, 3D illustration, Blender, Cinema4D
- cartoon, anime, vector art, flat illustration
- clay render, isometric, infographic style
- digital art, painting, watercolor, sketch
- íŒŒìŠ¤í…”í†¤ ì¼ëŸ¬ìŠ¤íŠ¸, ê·€ì—¬ìš´ ìºë¦­í„°

â€» í”„ë ˆìž„(ë¸Œë¼ìš°ì € ì°½ ìƒë‹¨ë°”/ë²„íŠ¼)ë§Œ ê·¸ëž˜í”½ ìš”ì†Œë¡œ ìœ ì§€, ë‚˜ë¨¸ì§€ëŠ” ëª¨ë‘ ì‹¤ì‚¬!
`;

const ILLUSTRATION_3D_STYLE_RULE = `
[STYLE - 3D ì¼ëŸ¬ìŠ¤íŠ¸ (3D ILLUSTRATION)]
âš ï¸ í•„ìˆ˜: ì¹œê·¼í•˜ê³  ë¶€ë“œëŸ¬ìš´ 3D ì¼ëŸ¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼!
- ë Œë”ë§: 3D rendered illustration, Blender/Cinema4D style, soft 3D render
- ì¡°ëª…: soft studio lighting, ambient occlusion, gentle shadows
- ì§ˆê°: smooth plastic-like surfaces, matte finish, rounded edges
- ìƒ‰ìƒ: ë°ì€ íŒŒìŠ¤í…” í†¤, íŒŒëž€ìƒ‰/í°ìƒ‰/ì—°í•œ ìƒ‰ìƒ íŒ”ë ˆíŠ¸
- ìºë¦­í„°: cute stylized characters, friendly expressions, simple features
- ë°°ê²½: clean gradient background, soft color transitions
- ë¶„ìœ„ê¸°: friendly, approachable, modern, educational
â›” ì ˆëŒ€ ê¸ˆì§€: photorealistic, real photo, DSLR, realistic texture, photograph
`;

const MEDICAL_3D_STYLE_RULE = `
[STYLE - ì˜í•™ 3D (MEDICAL 3D RENDER)]
âš ï¸ í•„ìˆ˜: ì „ë¬¸ì ì¸ ì˜í•™/í•´ë¶€í•™ 3D ì¼ëŸ¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼!
- ë Œë”ë§: medical 3D illustration, anatomical render, scientific visualization
- ì¡°ëª…: clinical lighting, x-ray style glow, translucent organs
- í”¼ì‚¬ì²´: ì¸ì²´ í•´ë¶€í•™, ìž¥ê¸° ë‹¨ë©´ë„, ë¼ˆ/ê·¼ìœ¡/í˜ˆê´€ êµ¬ì¡°, ì˜ë£Œ ë„êµ¬
- ì§ˆê°: semi-transparent organs, detailed anatomical structures
- ìƒ‰ìƒ: ì˜ë£Œìš© ìƒ‰ìƒ íŒ”ë ˆíŠ¸ (íŒŒëž€ìƒ‰, í°ìƒ‰, ë¹¨ê°„ìƒ‰ í˜ˆê´€/ë™ë§¥)
- ë ˆì´ë¸”: anatomical labels, educational diagram style
- ë¶„ìœ„ê¸°: clinical, professional, educational, trustworthy
â›” ì ˆëŒ€ ê¸ˆì§€: cute cartoon, photorealistic photo, realistic human face
`;

const CUSTOM_STYLE_RULE = (prompt: string) => `
[STYLE]
${prompt}
`;

// promptTextì—ì„œ ì„œë¡œ ì¶©ëŒí•˜ëŠ” í‚¤ì›Œë“œ/ì„¹ì…˜ì„ ì œê±°(íŠ¹ížˆ photoì—ì„œ [ì¼ëŸ¬ìŠ¤íŠ¸] ê°™ì€ ê²ƒ)
const normalizePromptTextForImage = (raw: string): string => {
  if (!raw) return '';
  const lines = raw.split('\n').map(l => l.trim()).filter(Boolean);

  // ðŸ”§ ì¤‘ë³µ ì œê±°: CARD_LAYOUT_RULE ì „ì²´ ë¸”ë¡ ë° ê´€ë ¨ ì§€ì‹œë¬¸ ì œê±°
  const dropPatterns: RegExp[] = [
    /ë¸Œë¼ìš°ì €\s*ì°½\s*í”„ë ˆìž„\s*ìŠ¤íƒ€ì¼\s*ì¹´ë“œë‰´ìŠ¤/i,
    /^\[ì¼ëŸ¬ìŠ¤íŠ¸\]/i,
    /^\[ìŠ¤íƒ€ì¼\]/i,
    /^\s*CARD_LAYOUT_RULE\s*:/i,
    // CARD_LAYOUT_RULE ë‚´ìš© ì œê±° (generateSingleImageì—ì„œ ë‹¤ì‹œ ì¶”ê°€ë¨)
    /^\[CARD IMAGE GENERATION RULE\]/i,
    /^Render Korean text DIRECTLY into the image/i,
    /^Do NOT show these instructions in the image/i,
    /^Only render the actual content text/i,
  ];

  const cleaned = lines
    .filter(l => !dropPatterns.some(rx => rx.test(l)))
    .join('\n')
    .trim();

  return cleaned;
};

const buildStyleBlock = (style: ImageStyle, customStylePrompt?: string): string => {
  // ðŸŽ¨ ì»¤ìŠ¤í…€ í”„ë¡¬í”„íŠ¸ê°€ ìžˆìœ¼ë©´ ìµœìš°ì„  ì ìš©! (ìž¬ìƒì„± ì‹œì—ë„ ìœ ì§€)
  if (customStylePrompt && customStylePrompt.trim()) {
    console.log('âœï¸ ì»¤ìŠ¤í…€ ìŠ¤íƒ€ì¼ ì ìš©:', customStylePrompt.substring(0, 50));
    return CUSTOM_STYLE_RULE(customStylePrompt.trim());
  }
  
  // ðŸš¨ photo/medical ìŠ¤íƒ€ì¼ ì„ íƒ ì‹œ ê³ ì • ìŠ¤íƒ€ì¼ ì ìš©
  if (style === 'photo') {
    console.log('ðŸ“¸ ì‹¤ì‚¬ ì‚¬ì§„ ìŠ¤íƒ€ì¼ ì ìš©');
    return PHOTO_STYLE_RULE;
  }
  if (style === 'medical') {
    console.log('ì˜í•™ 3D ìŠ¤íƒ€ì¼ ì ìš©');
    return MEDICAL_3D_STYLE_RULE;
  }
  
  // ê¸°ë³¸: 3D ì¼ëŸ¬ìŠ¤íŠ¸
  return ILLUSTRATION_3D_STYLE_RULE;
};

const buildFrameBlock = (referenceImage?: string, copyMode?: boolean): string => {
  if (!referenceImage) return CARD_FRAME_RULE;
  return copyMode ? FRAME_FROM_REFERENCE_COPY : FRAME_FROM_REFERENCE_RECOLOR;
};

// ê³µí†µ ê·œì¹™ (ê°„ê²°í™”)
const IMAGE_TEXT_RULES = `[ê·œì¹™] í•œêµ­ì–´ë§Œ, ê´‘ê³ /ë¡œê³ /í•´ì‹œíƒœê·¸ ê¸ˆì§€`;

// ê¸°ë³¸ ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸ - í•œêµ­ì–´ë¡œ í†µì¼!
export const DEFAULT_STYLE_PROMPTS: Record<string, string> = {
  illustration: '3D ë Œë” ì¼ëŸ¬ìŠ¤íŠ¸, Blender ìŠ¤íƒ€ì¼, ë¶€ë“œëŸ¬ìš´ ìŠ¤íŠœë””ì˜¤ ì¡°ëª…, íŒŒìŠ¤í…” ìƒ‰ìƒ, ë‘¥ê·¼ í˜•íƒœ, ì¹œê·¼í•œ ìºë¦­í„° ë””ìžì¸, ê¹”ë”í•œ ê·¸ë¼ë°ì´ì…˜ ë°°ê²½',
  medical: 'ì˜í•™ 3D ì¼ëŸ¬ìŠ¤íŠ¸, í•´ë¶€í•™ì  ë Œë”ë§, ê³¼í•™ì  ì‹œê°í™”, ìž„ìƒ ì¡°ëª…, ìƒì„¸í•œ ìž¥ê¸° êµ¬ì¡°, êµìœ¡ìš© ë‹¤ì´ì–´ê·¸ëž¨, ì „ë¬¸ ì˜ë£Œ ìŠ¤íƒ€ì¼',
  photo: 'ì‹¤ì‚¬ DSLR ì‚¬ì§„, ìžì—°ìŠ¤ëŸ¬ìš´ ë¶€ë“œëŸ¬ìš´ ì¡°ëª…, ì–•ì€ í”¼ì‚¬ê³„ì‹¬ë„, ì‚¬ì‹¤ì ì¸ ì§ˆê°, ì „ë¬¸ ë³‘ì› í™˜ê²½, ì‹ ë¢°ê° ìžˆëŠ” ë¶„ìœ„ê¸°',
  custom: 'ì‚¬ìš©ìž ì§€ì • ìŠ¤íƒ€ì¼'
};

// ìŠ¤íƒ€ì¼ ì´ë¦„ (UI í‘œì‹œìš©)
export const STYLE_NAMES = {
  illustration: '3D ì¼ëŸ¬ìŠ¤íŠ¸',
  medical: 'ì˜í•™ 3D',
  photo: 'ì‹¤ì‚¬ ì‚¬ì§„'
};

// ì§§ì€ ìŠ¤íƒ€ì¼ í‚¤ì›Œë“œ (í”„ë¡¬í”„íŠ¸ìš©) - êµ¬ì²´ì ìœ¼ë¡œ ê°œì„ !
export const STYLE_KEYWORDS = {
  illustration: '3D ë Œë” ì¼ëŸ¬ìŠ¤íŠ¸, Blender ìŠ¤íƒ€ì¼, ë¶€ë“œëŸ¬ìš´ ì¡°ëª…, íŒŒìŠ¤í…” ìƒ‰ìƒ, ì¹œê·¼í•œ ìºë¦­í„°, ê¹”ë”í•œ ë°°ê²½',
  medical: 'ì˜í•™ 3D ì¼ëŸ¬ìŠ¤íŠ¸, í•´ë¶€í•™ì  êµ¬ì¡°, ìž¥ê¸° ë‹¨ë©´ë„, ìž„ìƒ ì¡°ëª…, êµìœ¡ìš© ë‹¤ì´ì–´ê·¸ëž¨, ì „ë¬¸ì  ë¶„ìœ„ê¸°',
  photo: 'ì‹¤ì‚¬ ì‚¬ì§„, DSLR ì´¬ì˜, ìžì—°ìŠ¤ëŸ¬ìš´ ì¡°ëª…, ì–•ì€ í”¼ì‚¬ê³„ì‹¬ë„, ì „ë¬¸ ë³‘ì› í™˜ê²½, ì‚¬ì‹¤ì  ì§ˆê°'
};

// =============================================
// ðŸ“ ê³µí†µ í…ìŠ¤íŠ¸ ìƒìˆ˜ (ì¤‘ë³µ ì œê±°)
// =============================================

// ì½˜í…ì¸  ì„¤ëª… (ì¹´ë“œë‰´ìŠ¤/ë¸”ë¡œê·¸ ê³µí†µ)
const CONTENT_DESCRIPTION = `ì´ ì½˜í…ì¸ ëŠ” ì˜ë£Œì •ë³´ ì•ˆë‚´ìš© ì¹´ë“œë‰´ìŠ¤ì´ë©°,
ë„¤ì´ë²„ ë³‘ì› ë¸”ë¡œê·¸ ë° SNSì— ì‚¬ìš©ë©ë‹ˆë‹¤.
ì˜ë£Œê´‘ê³ ë²•ì„ ì¤€ìˆ˜í•˜ë©°, ì§ì ‘ì ì¸ ë°©ë¬¸Â·ì˜ˆì•½ ìœ ë„ëŠ” ê¸ˆì§€í•©ë‹ˆë‹¤.`;

// ì˜ë£Œ ë©´ì±… ì¡°í•­ (HTML)
const MEDICAL_DISCLAIMER = `ë³¸ ì½˜í…ì¸ ëŠ” ì˜ë£Œ ì •ë³´ ì œê³µ ë° ë³‘ì› ê´‘ê³ ë¥¼ ëª©ì ìœ¼ë¡œ í•©ë‹ˆë‹¤.<br/>ê°œì¸ì˜ ì²´ì§ˆê³¼ ê±´ê°• ìƒíƒœì— ë”°ë¼ ì¹˜ë£Œ ê²°ê³¼ëŠ” ì°¨ì´ê°€ ìžˆì„ ìˆ˜ ìžˆìœ¼ë©°, ë¶€ìž‘ìš©ì´ ë°œìƒí•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.`;

// ê¸€ ìŠ¤íƒ€ì¼ë³„ í”„ë¡¬í”„íŠ¸ (ì˜ë£Œë²• 100% ì¤€ìˆ˜) - í•¨ìˆ˜ë¡œ ë³€ê²½í•˜ì—¬ í˜„ìž¬ ì—°ë„ ë™ì  ë°˜ì˜
const getWritingStylePrompts = (): Record<WritingStyle, string> => {
  const year = new Date().getFullYear();
  return {
  // [ê°€ì´ë“œ] ì „ë¬¸ê°€í˜•: ì˜í•™ ì§€ì‹ ê¹Šì´ ê°•ì¡°í•˜ë˜ ê¶Œìœ„ì ì´ì§€ ì•Šì€ ì „ë¬¸ì„±
  expert: `
[ðŸš¨ ìŠ¤íƒ€ì¼ ì„ íƒ ê·œì¹™]
'ì „ë¬¸ê°€í˜•' ìŠ¤íƒ€ì¼ì„ ì ìš©í•©ë‹ˆë‹¤. ì „ë¬¸ì„±ì€ ìœ ì§€í•˜ë˜ ê¶Œìœ„ì ì´ê±°ë‚˜ ê°•ìš”í•˜ëŠ” í†¤ì€ í”¼í•©ë‹ˆë‹¤.

[ê¸€ì“°ê¸° ìŠ¤íƒ€ì¼: ì „ë¬¸ê°€í˜• ðŸ“š]
- ëª©í‘œ: "ì‹ ë¢°í•  ìˆ˜ ìžˆëŠ” ì •ë³´ë¥¼ ì•Œê¸° ì‰½ê²Œ ì „ë‹¬"
- í†¤: ì „ë¬¸ì ì´ë©´ì„œë„ ì¹œê·¼í•œ ì„¤ëª…, ê°•ìš” ì—†ëŠ” ì œì•ˆ

[ðŸŽ¯ í•µì‹¬ í…Œí¬ë‹‰]

1. **ë„ìž…ë¶€: ê´€ì°°ì—ì„œ ì‹œìž‘í•˜ëŠ” ì¸ì‚¬ì´íŠ¸**
   âŒ "ì˜¤ëŠ˜ì€ ë‹¹ë‡¨ì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤."
   âŒ "ëŒ€í•œë‹¹ë‡¨ë³‘í•™íšŒì—ì„œ ë°œí‘œí•œ ìžë£Œë¥¼ ë³´ë©´..." (ì²« ë¬¸ìž¥ë¶€í„° ì¸ìš© X)
   âœ… "ê³µë³µí˜ˆë‹¹ì€ ì •ìƒì¸ë° ì‹í›„ì— ìœ ë… í”¼ê³¤í•¨ì„ ëŠë¼ëŠ” ë¶„ë“¤ì´ ìžˆì–´ìš”. ì˜ì™¸ë¡œ ì´ëŸ° ê²½ìš°ê°€ ë§Žë”ë¼ê³ ìš”."
   âœ… "ê²€ì‚¬ ê²°ê³¼ì§€ë¥¼ ë°›ì•„ë“¤ê³  'ì´ê²Œ ë¬´ìŠ¨ ëœ»ì´ì§€?' ì‹¶ì—ˆë˜ ì  ìžˆìœ¼ì‹œì£ ?"

2. **ê·¼ê±° ì¸ìš© - ìžì—°ìŠ¤ëŸ½ê²Œ ë…¹ì´ê¸°** (2íšŒ ì´ë‚´, ê°•ì¡° X)
   âŒ "ëŒ€í•œOOí•™íšŒ ê°€ì´ë“œë¼ì¸ì— ë”°ë¥´ë©´..." (ë”±ë”±í•œ ì¸ìš©)
   âœ… "ìµœê·¼ ê°€ì´ë“œë¼ì¸ì—ì„œ ëˆˆì— ë„ëŠ” ë³€í™”ê°€ ìžˆì—ˆì–´ìš”. ì‹í›„ í˜ˆë‹¹ ê´€ë¦¬ë¥¼ ë” ê°•ì¡°í•˜ê¸° ì‹œìž‘í•œ ê±°ì£ ."
   âœ… "ì—°êµ¬ ê²°ê³¼ë“¤ì„ ë³´ë©´ ì´ëŸ° ê²½í–¥ì´ ë‚˜íƒ€ë‚˜ëŠ”ë°ìš”..."
   âœ… "ì‹¤ì œë¡œ ì´ëŸ° ì¼€ì´ìŠ¤ê°€ ìƒê°ë³´ë‹¤ í”í•´ìš”."
   âš ï¸ ì¸ìš©ì€ ì •ë³´ì˜ ì‹ ë¢°ë„ë¥¼ ë†’ì´ëŠ” ë„êµ¬ì¼ ë¿, ê¶Œìœ„ë¥¼ ë‚´ì„¸ìš°ëŠ” ìˆ˜ë‹¨ì´ ì•„ë‹˜

3. **ì˜í•™ ìš©ì–´ - ì„¤ëª…ì´ ì•„ë‹Œ ëŒ€í™”ë¡œ**
   âŒ "ì¸ìŠë¦° ì €í•­ì„±ì´ëž€ ì¸ìŠë¦°ì´ ì œëŒ€ë¡œ ìž‘ë™í•˜ì§€ ì•ŠëŠ” ìƒíƒœë¥¼ ë§í•©ë‹ˆë‹¤."
   âœ… "ì¸ìŠë¦° ì €í•­ì„±, ì´ ë‹¨ì–´ ë“¤ì–´ë³´ì…¨ì„ ê±°ì˜ˆìš”. ì‰½ê²Œ ë§í•´ì„œ ì¸ìŠë¦°ì´ ìžˆì–´ë„ ìž˜ ì•ˆ ë“£ëŠ” ìƒíƒœì˜ˆìš”."
   âœ… "ë‹¹í™”í˜ˆìƒ‰ì†Œë¼ê³  í•˜ë©´ ì–´ë µê²Œ ëŠê»´ì§€ëŠ”ë°, 3ê°œì›” í‰ê·  í˜ˆë‹¹ì´ë¼ê³  ìƒê°í•˜ì‹œë©´ ë¼ìš”."

4. **ì •ë³´ ì „ë‹¬ ê´€ì  - ê¶Œìœ„ ì—†ì´ ì‹ ë¢°ê° ìžˆê²Œ** (âš ï¸ 6-2, 6-3 ê·œì¹™ í•„ìˆ˜ ì ìš©!)
   âœ… "ì´ ë¶€ë¶„ì—ì„œ ì˜¤í•´í•˜ì‹œëŠ” ë¶„ë“¤ì´ ë§Žë”ë¼ê³ ìš”."
   âœ… "ì†”ì§ížˆ ì²˜ìŒì—” í—·ê°ˆë¦¬ê¸° ì‰¬ìš´ ê°œë…ì´ì—ìš”."
   âœ… "ì¡°ê¸ˆë§Œ ì¼ì° ì•Œì•˜ìœ¼ë©´... í•˜ê³  ì•„ì‰¬ì›Œí•˜ì‹œëŠ” ë¶„ë“¤ì´ ê³„ì„¸ìš”."

5. **ì •ë³´ ì „ë‹¬ - ë‚˜ì—´ë³´ë‹¤ íë¦„**
   âŒ ë²ˆí˜¸ ë§¤ê¸´ ì²´í¬ë¦¬ìŠ¤íŠ¸ ë‚˜ì—´
   âœ… í•˜ë‚˜ì˜ ì´ì•¼ê¸°ì²˜ëŸ¼ ì •ë³´ë¥¼ ì—°ê²°
   âœ… "ì—¬ê¸°ì„œ í•œ ê°€ì§€ ë” ì•Œì•„ë‘ë©´ ì¢‹ì€ ê²Œ ìžˆì–´ìš”."
   âœ… "ê·¸ëŸ°ë° ì´ê²Œ ì „ë¶€ê°€ ì•„ë‹ˆì—ìš”. ì‚¬ì‹¤ ë” ì¤‘ìš”í•œ ê±´..."
`,

  // ðŸ’— ê³µê°í˜•: ë…ìž ê²½í—˜ ì¤‘ì‹¬, "ì´ê±° ë‚´ ì–˜ê¸°ë„¤!" ë°˜ì‘ ìœ ë„
  empathy: `
[ðŸš¨ ìŠ¤íƒ€ì¼ ì„ íƒ ê·œì¹™ - ìµœìš°ì„  ì ìš©]
ì•„ëž˜ 'ê³µê°í˜•' ìŠ¤íƒ€ì¼ë§Œ ì„ íƒí•´ ì ìš©í•˜ë©°, ë‹¤ë¥¸ ìŠ¤íƒ€ì¼(ì „ë¬¸ê°€í˜•/ì „í™˜í˜•)ì˜ ë¬¸ì²´Â·í‘œí˜„ì€ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”.

[ê¸€ì“°ê¸° ìŠ¤íƒ€ì¼: ê³µê°í˜• ðŸ’—]
- ëª©í‘œ: ë…ìžê°€ "ì´ê±° ë‚´ ì–˜ê¸°ë„¤!"ë¼ê³  ëŠë¼ê²Œ ë§Œë“¤ê¸°
- í†¤: ë”°ëœ»í•˜ê³  ì´í•´ì‹¬ ìžˆëŠ” ì¹œêµ¬ ê°™ì€ í†¤

[ðŸŽ¯ í•µì‹¬ í…Œí¬ë‹‰ - ë°˜ë“œì‹œ ì ìš©]

1. **ë„ìž…ë¶€: êµ¬ì²´ì  ìƒí™© ë¬˜ì‚¬ë¡œ ì‹œìž‘** (í•„ìˆ˜!)
   âŒ "ì˜¤ëŠ˜ì€ ê²¨ìš¸ì²  í”¼ë¶€ ê±´ì¡°ì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤."
   âœ… "ížˆí„° ì¼œê³  ìžê³  ì¼ì–´ë‚˜ë©´ ì–¼êµ´ì´ ë•…ê¸°ëŠ” ëŠë‚Œ, í•œ ë²ˆì¯¤ ê²ªì–´ë³´ì…¨ì„ ê±°ì˜ˆìš”."
   âœ… "ìƒ¤ì›Œí•˜ê³  ë‚˜ì™€ì„œ 5ë¶„ë§Œ ì§€ë‚˜ë„ ì˜¨ëª¸ì´ ê°€ë ¤ì›Œì§€ëŠ” ê²½í—˜, ìžˆìœ¼ì‹œì£ ?"
   âœ… "ì•„ì¹¨ì— ê±°ìš¸ ë³´ë‹¤ê°€ 'ì–´? ë‚´ í”¼ë¶€ê°€ ì™œ ì´ëž˜?' ì‹¶ì—ˆë˜ ì  ìžˆìœ¼ì‹œì£ ?"

2. **êµ¬ì²´ì  ìƒí™©/í–‰ë™ ì˜ˆì‹œ ì‚½ìž…** (ìµœì†Œ 3ê°œ ì´ìƒ)
   - ì‹œê°„ëŒ€: "ì•„ì¹¨ ì„¸ì•ˆ í›„", "í‡´ê·¼ í›„", "ìƒ¤ì›Œ ì§í›„", "ìž ë“¤ê¸° ì „"
   - ìž¥ì†Œ: "ížˆí„° ì•žì—ì„œ", "ì‚¬ë¬´ì‹¤ ì—ì–´ì»¨ ì•„ëž˜ì„œ", "ì§€í•˜ì²  ì•ˆì—ì„œ"
   - í–‰ë™: "ë¬´ì˜ì‹ì ìœ¼ë¡œ ê¸ë‹¤ê°€", "ë³´ìŠµì œ ë°”ë¥´ëŠ”ë° ë”°ê°€ì›Œì„œ", "í™”ìž¥ì´ ë“¤ëœ¨ê¸¸ëž˜"
   
3. **ì‹¤íŒ¨/ì˜ˆì™¸ ì‚¬ë¡€ í¬í•¨** (AI ëƒ„ìƒˆ ì œê±°)
   âœ… "ëª¨ë“  ë³´ìŠµì œê°€ ë‹¤ ë§žëŠ” ê±´ ì•„ë‹ˆì—ìš”. ì„¸ë¼ë§ˆì´ë“œ ì œí’ˆ ë°œëžë‹¤ê°€ ì˜¤ížˆë ¤ ë”°ê°€ì› ë˜ ë¶„ë“¤ë„ ê³„ì„¸ìš”."
   âœ… "ê·¼ë° ì†”ì§ížˆ, ì´ê±° ì•Œë©´ì„œë„ ìž˜ ì•ˆ ë˜ëŠ” ê²Œ í˜„ì‹¤ì´ìž–ì•„ìš”."
   âœ… "ë³‘ì›ì—ì„œ ê¶Œí•˜ëŠ” ëŒ€ë¡œ í–ˆëŠ”ë° ë³„ë¡œ íš¨ê³¼ë¥¼ ëª» ëŠë¼ëŠ” ë¶„ë“¤ë„ ê³„ì„¸ìš”. ê°œì¸ì°¨ê°€ ìžˆìœ¼ë‹ˆê¹Œìš”."

4. **ê°•ì•½ ì¡°ì ˆ - ëª¨ë“  ë¬¸ìž¥ì´ ê°™ì€ í†¤ ê¸ˆì§€**
   - ê°•ì¡°: "ì´ê±´ ì§„ì§œ ì¤‘ìš”í•´ìš”", "ê¼­ ê¸°ì–µí•´ ë‘ì„¸ìš”"
   - ì•½í™”: "ê·¼ë° ì‚¬ì‹¤...", "ì†”ì§ížˆ ë§í•˜ë©´...", "ë¬¼ë¡  ê°œì¸ì°¨ëŠ” ìžˆì§€ë§Œ"
   - ê³µê°: "ë§žì•„ìš”, ê·€ì°®ì£ ", "ì•Œì•„ìš”, ì‰½ì§€ ì•Šì£ "

5. **ë°˜ë³µ í‘œí˜„ ê¸ˆì§€ - ë‹¤ì–‘í•œ í‘œí˜„ ì‚¬ìš©**
   âŒ "~ì— ë„ì›€ì´ ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤" ë°˜ë³µ ê¸ˆì§€
   âœ… ëŒ€ì²´ í‘œí˜„: "íš¨ê³¼ë¥¼ ë³´ì‹œëŠ” ë¶„ë“¤ì´ ë§Žì•„ìš”", "í•´ë³¼ ë§Œí•œ ê°€ì¹˜ê°€ ìžˆì–´ìš”", "ì˜ì™¸ë¡œ ê´œì°®ë”ë¼ê³ ìš”"
`,

  // ðŸŽ¯ ì „í™˜í˜•: ìžì—°ìŠ¤ëŸ¬ìš´ ì¸ì‹ ë³€í™” ìœ ë„ (ì˜ë£Œë²• ì¤€ìˆ˜)
  conversion: `
[ðŸš¨ ìŠ¤íƒ€ì¼ ì„ íƒ ê·œì¹™]
'ì „í™˜í˜•' ìŠ¤íƒ€ì¼ì„ ì ìš©í•©ë‹ˆë‹¤. í–‰ë™ ê°•ìš”ê°€ ì•„ë‹Œ ìžì—°ìŠ¤ëŸ¬ìš´ ì¸ì‹ ë³€í™”ë¥¼ ìœ ë„í•©ë‹ˆë‹¤.

[ê¸€ì“°ê¸° ìŠ¤íƒ€ì¼: ì „í™˜í˜• ðŸŽ¯]
- ëª©í‘œ: "ì•„, ë‚˜ë„ í•œë²ˆ í™•ì¸í•´ë³¼ê¹Œ?" ë¼ëŠ” ìƒê°ì´ ìžì—°ìŠ¤ëŸ½ê²Œ ë“¤ê²Œ í•˜ê¸°
- í†¤: ì •ë³´ ì œê³µ + ì‹œì  ì œì‹œ (ê°•ìš” ì—†ì´)

[ðŸŽ¯ í•µì‹¬ í…Œí¬ë‹‰]

1. **ë„ìž…ë¶€: ê´€ì°°ë¡œ ì‹œìž‘, ì§ˆë¬¸ìœ¼ë¡œ ì—°ê²°**
   âŒ "ë‹¹ë‡¨ ì „ ë‹¨ê³„ì¸ë° ëª¨ë¥´ê³  ì§€ë‚˜ì¹˜ëŠ” ì‚¬ëžŒì´ ì ˆë°˜ì´ ë„˜ìŠµë‹ˆë‹¤." (ê³µí¬ ì¡°ìž¥)
   âœ… "ë¬¼ì„ ë§Žì´ ë§ˆì…”ì„œ í™”ìž¥ì‹¤ì„ ìžì£¼ ê°„ë‹¤ê³  ìƒê°í–ˆëŠ”ë°, ëŒì´ì¼œë³´ë‹ˆ ê·¸ê²Œ ì•„ë‹ˆì—ˆë‹¤ëŠ” ë¶„ë“¤ì´ ìžˆì–´ìš”."
   âœ… "í”¼ê³¤í•´ì„œ ê·¸ë ‡ê² ì§€, í•˜ê³  ë„˜ê¸°ë‹¤ê°€ ìš°ì—°ížˆ ë°œê²¬ë˜ëŠ” ê²½ìš°ê°€ ìƒê°ë³´ë‹¤ ë§Žë”ë¼ê³ ìš”."
   
2. **ì •ë³´ ê²©ì°¨ í™œìš©** (ê³µí¬ ëŒ€ì‹  ê¶ê¸ˆì¦)
   âŒ "ì§€ê¸ˆ ì•ˆ í•˜ë©´ í›„íšŒí•©ë‹ˆë‹¤" / "ë†“ì¹˜ë©´ í°ì¼ë‚©ë‹ˆë‹¤"
   âœ… "ì´ ë¶€ë¶„ì„ ëª¨ë¥´ì‹œëŠ” ë¶„ë“¤ì´ ì˜ì™¸ë¡œ ë§Žì•„ìš”."
   âœ… "ì•Œê³  ìžˆìœ¼ë©´ ë‹¤ë¥´ê²Œ ëŒ€ì²˜í•  ìˆ˜ ìžˆëŠ” ì •ë³´ê°€ ìžˆì–´ìš”."
   âœ… "ê°™ì€ ì¦ìƒì´ì–´ë„ ì›ì¸ì— ë”°ë¼ ê´€ë¦¬ë²•ì´ ë‹¬ë¼ì§€ê±°ë“ ìš”."

3. **ì‹œì  ì œì‹œ - íŒë‹¨ì€ ë…ìžì—ê²Œ**
   âŒ "ê²€ì‚¬ë¥¼ ë°›ìœ¼ì„¸ìš”" / "í™•ì¸í•˜ì„¸ìš”" (ëª…ë ¹í˜•)
   âœ… "ì´ëŸ° ì‹ í˜¸ê°€ ê²¹ì¹˜ê¸° ì‹œìž‘í•˜ë©´ í™•ì¸í•´ë³¼ íƒ€ì´ë°ì¼ ìˆ˜ ìžˆì–´ìš”."
   âœ… "ì¦ìƒì´ ì‚¬ë¼ì¡Œë‹¤ê°€ ë‹¤ì‹œ ë‚˜íƒ€ë‚œë‹¤ë©´, ê·¸ë•Œê°€ í™•ì¸ ì‹œì ì— ê°€ê¹ìŠµë‹ˆë‹¤."
   âœ… "ìžê°€ íŒë‹¨ìœ¼ë¡œ ë„˜ê¸°ê¸° ì• ë§¤í•´ì§€ëŠ” ìˆœê°„ì´ ìžˆì–´ìš”."

4. **ë§ˆë¬´ë¦¬: ì—´ë¦° ê²°ë¡ **
   âŒ "ê¼­ ê¸°ì–µí•˜ì„¸ìš”" / "ë°˜ë“œì‹œ í™•ì¸í•˜ì„¸ìš”"
   âœ… "ì ì–´ë„ 'ì™œ ì´ëŸ°ì§€ ëª¨ë¥´ê² ë‹¤'ëŠ” ë‹µë‹µí•¨ì€ ì¤„ì¼ ìˆ˜ ìžˆì–´ìš”."
   âœ… "í™•ì¸í•´ë‘ë©´ ë‹¤ìŒì— ë¹„ìŠ·í•œ ì¦ìƒì´ ì™”ì„ ë•Œ ë¹„êµ ê¸°ì¤€ì´ ìƒê¸°ê±°ë“ ìš”."
   âœ… "ë¬¼ë¡  ì•„ë¬´ê²ƒë„ ì•„ë‹ ìˆ˜ë„ ìžˆì–´ìš”. ê·¸ëž˜ë„ í•œ ë²ˆì¯¤ í™•ì¸í•´ë³´ëŠ” ê²Œ ë§ˆìŒì´ íŽ¸í•˜ì£ ."

5. **ì „í™˜ ìœ ë„ - ë¶€ë“œëŸ½ê²Œ**
   âŒ "ë§Žì€ ë¶„ë“¤ì´ ê²€ì§„ì„ ë°›ìŠµë‹ˆë‹¤" (ì••ë°•)
   âœ… "ë¹„ìŠ·í•œ ê³ ë¯¼ì„ ê°€ì§„ ë¶„ë“¤ì´ ê¶ê¸ˆí•´í•˜ì‹œëŠ” ë¶€ë¶„ì´ì—ìš”."
   âœ… "ì´ëŸ° ê²½ìš°ì— ì–´ë–»ê²Œ í•˜ë©´ ì¢‹ì„ì§€ í•œ ë²ˆ ì •ë¦¬í•´ë´¤ì–´ìš”."
`
  };
};

// =============================================
// ðŸ“ ê¸€ì“°ê¸° ìŠ¤íƒ€ì¼ ê³µí†µ ê·œì¹™ (ì¤‘ë³µ ì œê±° + AI ëƒ„ìƒˆ ìµœì†Œí™”)
// =============================================

// ê¸€ ìŠ¤íƒ€ì¼ë³„ ê¸ˆì§€ í‘œí˜„ ì²´í¬ (ê³µí†µ) - í•¨ìˆ˜ë¡œ ë³€ê²½í•˜ì—¬ í˜„ìž¬ ì—°ë„ ë™ì  ë°˜ì˜
// ðŸ”¥ 2026-01-10 ì—…ë°ì´íŠ¸: í”¼ë“œë°± ê¸°ë°˜ 5ê°œ ì„¹ì…˜ ì¶”ê°€ (íŒë‹¨ ë‹¨ì •í˜•, í˜„ìž¥ê°, ê·¹ì  í‘œí˜„, AI ëƒ„ìƒˆ, SEO)
const getWritingStyleCommonRules = (): string => {
  return `
---
[âœï¸ ê³µí†µ ê¸€ì“°ê¸° ê·œì¹™]
---

**ðŸš¨ ë‹¨ì–´ ë°˜ë³µ ì œí•œ (ë™ì¼ ë‹¨ì–´ 15íšŒ ë¯¸ë§Œ!) - ìµœìš°ì„  ê·œì¹™!**
- ê°™ì€ ë‹¨ì–´(ëª…ì‚¬/ë™ì‚¬/í˜•ìš©ì‚¬)ê°€ ê¸€ ì „ì²´ì—ì„œ **15ë²ˆ ì´ìƒ ë°˜ë³µ ê¸ˆì§€!**
- 14ë²ˆê¹Œì§€ë§Œ í—ˆìš©! 15ë²ˆì§¸ë¶€í„°ëŠ” ìœ ì‚¬ì–´/ëŒ€ì²´ì–´ë¡œ êµì²´ í•„ìˆ˜!
- ì¡°ì‚¬(ì´/ê°€/ì„/ë¥¼)ëŠ” ì œì™¸, ì‹¤ì œ ì˜ë¯¸ ìžˆëŠ” ë‹¨ì–´ë§Œ ì¹´ìš´íŠ¸

**ìž˜ëª»ëœ ì˜ˆ (ë‹¨ì–´ ê³¼ë‹¤ ë°˜ë³µ):**
âŒ "ë¬´ë¦Ž" ë‹¨ì–´ê°€ ê¸€ ì „ì²´ì—ì„œ 20ë²ˆ ë“±ìž¥
âŒ "í†µì¦" ë‹¨ì–´ê°€ ê¸€ ì „ì²´ì—ì„œ 18ë²ˆ ë“±ìž¥
âŒ "ì¦ìƒ" ë‹¨ì–´ê°€ ê¸€ ì „ì²´ì—ì„œ 16ë²ˆ ë“±ìž¥

**ì˜¬ë°”ë¥¸ ì˜ˆ (ìœ ì‚¬ì–´ ëŒ€ì²´):**
âœ… "ë¬´ë¦Ž" 10ë²ˆ â†’ "ë¬´ë¦Ž ê´€ì ˆ" 2ë²ˆ â†’ "í•´ë‹¹ ë¶€ìœ„" 2ë²ˆ = ì´ 14ë²ˆ ì´í•˜
âœ… "í†µì¦" 8ë²ˆ â†’ "ë¶ˆíŽ¸í•¨" 3ë²ˆ â†’ "ì•„í””" 2ë²ˆ = ì´ 13ë²ˆ
âœ… "ì¦ìƒ" 10ë²ˆ â†’ "ì§•í›„" 2ë²ˆ â†’ "ë‚˜íƒ€ë‚˜ëŠ” ëª¨ìŠµ" 2ë²ˆ = ì´ 14ë²ˆ

**ë‹¨ì–´ ë°˜ë³µ ì¹´ìš´íŠ¸ ì˜ˆì‹œ:**
- "ë¬´ë¦Žì´ ì•„í”„ê³  ë¬´ë¦Žì„ êµ¬ë¶€ë¦´ ë•Œ ë¬´ë¦Žì—ì„œ ì†Œë¦¬ê°€..." â†’ "ë¬´ë¦Ž" 3ë²ˆ ì¹´ìš´íŠ¸
- 14ë²ˆ ì‚¬ìš© í›„: "ë¬´ë¦Ž ê´€ì ˆ", "í•´ë‹¹ ë¶€ìœ„", "ì´ ë¶€ë¶„" ë“±ìœ¼ë¡œ ëŒ€ì²´!

**âš ï¸ íŠ¹ížˆ ì£¼ì˜í•´ì•¼ í•  ë‹¨ì–´ë“¤:**
- ì£¼ì œì–´ (ì˜ˆ: ë¬´ë¦Ž, ì–´ê¹¨, í—ˆë¦¬, ë‹¹ë‡¨ ë“±) â†’ 12ë²ˆ ì´í•˜ë¡œ!
- "ì¦ìƒ", "í†µì¦", "ì¹˜ë£Œ", "ì›ì¸", "ë°©ë²•" â†’ ê°ê° 10ë²ˆ ì´í•˜ë¡œ!
- "í™˜ìž", "ë³‘ì›", "ì˜ì‚¬" â†’ 5ë²ˆ ì´í•˜ë¡œ!

**âŒ ì œëª©/ì†Œì œëª© ê·œì¹™:**
- ì œëª©: ë¬¼ìŒí‘œ ê¸ˆì§€! ("~ì¼ê¹Œìš”?" â†’ "~ì¸ì§€ í™•ì¸ì´ í•„ìš”í•œ")
- ì†Œì œëª©: ì§ˆë¬¸í˜• í—ˆìš© (ë…ìž ì°¸ì—¬ ìœ ë„), **ì´ëª¨ì§€ ì ˆëŒ€ ê¸ˆì§€!**
- ë³¸ë¬¸: ë¬¼ìŒí‘œ ìµœì†Œí™” (í•„ìš”ì‹œì—ë§Œ)

**âŒ "~ì¸ì§€, ~ì¸ì§€, ~ì¸ì§€" ë‚˜ì—´ íŒ¨í„´ ì ˆëŒ€ ê¸ˆì§€!**
ìž˜ëª»ëœ ì˜ˆ:
âŒ "êµ¬í† ê°€ ë°˜ë³µë˜ëŠ”ì§€, ë¬¼ì„ ë§ˆì…”ë„ ìœ ì§€í•˜ëŠ” ê²ƒì´ ì–´ë ¤ìš´ì§€, ì„¤ì‚¬ê°€ ë¬¼ì²˜ëŸ¼ ì´ì–´ì§€ëŠ”ì§€"

ì˜¬ë°”ë¥¸ ì˜ˆ:
âœ… "êµ¬í† ê°€ ë°˜ë³µë©ë‹ˆë‹¤. ë¬¼ì„ ë§ˆì…”ë„ ìœ ì§€í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤. ì„¤ì‚¬ê°€ ë¬¼ì²˜ëŸ¼ ë‚˜ì˜¬ ìˆ˜ ìžˆìŠµë‹ˆë‹¤."

**âŒ ê¸€ ì„œë‘ì— ë©”íƒ€ ì„¤ëª… ê¸ˆì§€!**
âŒ "ì´ ê¸€ì€ ~ì— ì´ˆì ì„ ë§žì·„ìŠµë‹ˆë‹¤"
âŒ "~í•˜ë ¤ëŠ” ëª©ì ì€ ì•„ë‹ˆë©°"
âœ… ë°”ë¡œ ë³¸ë¡ ìœ¼ë¡œ!

**âŒ íŒë‹¨ íšŒí”¼ í‘œí˜„ ë°˜ë³µ ì œí•œ (ë™ì¼ í‘œí˜„ 2íšŒê¹Œì§€ë§Œ)**
ì˜ˆ: "ë‹¨ì •í•˜ê¸°ëŠ” ì–´ë µìŠµë‹ˆë‹¤", "íŒë‹¨í•˜ê¸°ê°€ ì–´ë µìŠµë‹ˆë‹¤"
â†’ 1íšŒëŠ” í—ˆìš©, 2íšŒ ì´ìƒì€ ê¸ˆì§€!
â†’ ë‹¤ì–‘í•œ í‘œí˜„ ì‚¬ìš©: "í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤", "ì£¼ì˜ ê¹Šê²Œ ê´€ì°°í•´ë³´ì„¸ìš”"

---
[ðŸš« íŒë‹¨ ë‹¨ì •í˜• ê¸€ì“°ê¸° ê¸ˆì§€] âš ï¸ ì˜ë£Œê´‘ê³ ë²• í•µì‹¬!
---

**1. ê³µì‹ ë ¥ ì¸ìš© + íŠ¹ì • ì§ˆí™˜ ë‹¨ì • êµ¬ì¡° ê¸ˆì§€**
âŒ "ì§ˆë³‘ê´€ë¦¬ì²­ êµ­ê°€ê±´ê°•ì •ë³´í¬í„¸ì˜ ìžë£Œì— ë”°ë¥´ë©´ â€¦ 'ì „ë°©ì‹­ìžì¸ëŒ€ íŒŒì—´'ì„ ìš°ì„ ì ìœ¼ë¡œ ê³ ë ¤í•´ë³´ì•„ì•¼ í•˜ëŠ” ìƒí™©ìœ¼ë¡œ ì„¤ëª…í•˜ê³  ìžˆìŠµë‹ˆë‹¤."
â†’ ê³µê³µê¸°ê´€ + 'ìš°ì„ ì ìœ¼ë¡œ ê³ ë ¤' = ì˜í•™ì  íŒë‹¨ì„ ëŒ€ì‹  ì œì‹œí•œ ê²ƒìœ¼ë¡œ í•´ì„ë  ìˆ˜ ìžˆìŒ!

âœ… ì•ˆì „í•œ ëŒ€ì²´:
"ê´€ë ¨ ìžë£Œì—ì„œëŠ” ì´ëŸ¬í•œ ìƒí™©ì—ì„œ ë¬´ë¦Ž ë‚´ë¶€ êµ¬ì¡° ì†ìƒì´ í•¨ê»˜ ì–¸ê¸‰ë˜ëŠ” ê²½ìš°ê°€ ìžˆë‹¤ê³  ì„¤ëª…í•˜ê³  ìžˆìŠµë‹ˆë‹¤."
â†’ ì§ì ‘ ë‹¨ì • ì œê±°, ê³µì‹ ë ¥ ìœ ì§€í•˜ë˜ ê²°ë¡ í™” ì°¨ë‹¨

**2. í†µê³„ ìˆ˜ì¹˜ ì‚¬ìš© ì œí•œ**
âŒ "ìµœê·¼ 3ë…„(2023~2025)ê°„ â€¦ 42.8% â€¦ 30% ì´ìƒì„ ì°¨ì§€í•  ë§Œí¼ ë¹ˆë²ˆí•˜ê²Œ ë°œìƒ"
â†’ ì •í™•í•œ í¼ì„¼íŠ¸ + ë¹ˆë²ˆ = í‘œì‹œê´‘ê³ ë²•ì—ì„œ ì¼ë°˜í™”Â·ê³¼ìž¥ ì˜¤í•´ ì†Œì§€

âœ… ì•ˆì „í•œ ëŒ€ì²´:
"ìµœê·¼ ëª‡ ë…„ê°„ì˜ ë¶„ì„ ìžë£Œì—ì„œëŠ” ê²¨ìš¸ì²  ìŠ¤í¬ì¸  ì‚¬ê³  ì¤‘ ë¬´ë¦Žì„ í¬í•¨í•œ í•˜ì²´ ë¶€ìƒì´ ì ì§€ ì•Šì€ ë¹„ì¤‘ì„ ì°¨ì§€í•˜ëŠ” ê²ƒìœ¼ë¡œ ë‚˜íƒ€ë‚©ë‹ˆë‹¤."
â†’ ìˆ˜ì¹˜ë¥¼ 'ê²½í–¥'ìœ¼ë¡œ í‘œí˜„

**3. ì£¼ìš” ì¦ìƒ êµê³¼ì„œ ìˆ˜ì¤€ í‘œí˜„ ê¸ˆì§€**
âŒ "ê°€ìž¥ íŠ¹ì§•ì ì¸ ì¦ìƒì€â€¦", "ì£¼ëª©í•  ë§Œí•œ ë¶€ë¶„ìž…ë‹ˆë‹¤."
â†’ 'íŠ¹ì§•ì ì¸ ì¦ìƒ' + í‰ê°€ ì–´ë¯¸ = ë³‘ì› í™ë³´ ì½˜í…ì¸ ë¡œ ë¶„ë¥˜ë˜ê¸° ì‰¬ì›€

âœ… ì•ˆì „í•œ ëŒ€ì²´:
"ë¶€ìƒ ë‹¹ì‹œ ì´ëŸ¬í•œ ê°ê°ì„ ê²½í—˜í–ˆë‹¤ê³  ì´ì•¼ê¸°í•˜ëŠ” ê²½ìš°ê°€ ìžˆìœ¼ë©°, ì´í›„ ë¬´ë¦Žì˜ ë¶ˆì•ˆì •í•¨ì„ ëŠë¼ëŠ” ì‚¬ë¡€ë„ ì ì§€ ì•ŠìŠµë‹ˆë‹¤."
â†’ ë‹¨ì • â†’ ì‚¬ë¡€ ì„œìˆ , 'ì¦ìƒ ì„¤ëª…' â†’ 'ê²½í—˜ ë¬˜ì‚¬'

**4. ìžê°€ ì²´í¬ë¦¬ìŠ¤íŠ¸ ìž„ê³„ì„  ì£¼ì˜**
âŒ ì²´í¬ë¦¬ìŠ¤íŠ¸ + "í˜„ìž¬ ìƒíƒœë¥¼ íŒŒì•…í•˜ëŠ” ë° ë„ì›€ì´" + ë°”ë¡œ ì¹˜ë£Œ/ê²€ì‚¬ ì´ì•¼ê¸°
â†’ ìžê°€ì§„ë‹¨ â†’ ë‹¤ìŒ í–‰ë™ ì œì‹œ êµ¬ì¡° = ê°€ìž¥ ë¯¼ê°í•œ íŒ¨í„´!

âœ… í•„ìˆ˜ ë°©ì–´ ë¬¸ìž¥ (ì²´í¬ë¦¬ìŠ¤íŠ¸ ìœ„/ì•„ëž˜ì— ì‚½ìž…):
"ì•„ëž˜ ë‚´ìš©ì€ ì¦ìƒ íë¦„ì„ ì´í•´í•˜ê¸° ìœ„í•œ ì°¸ê³  ì‚¬í•­ìœ¼ë¡œ, ì˜í•™ì  íŒë‹¨ì´ë‚˜ ì§„ë‹¨ì„ ëŒ€ì‹ í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."

**5. 'í‘œì¤€ ì¹˜ë£Œ' ì–¸ê¸‰ ì¡°ì •**
âŒ "í‘œì¤€ ì¹˜ë£Œë¡œ ê³ ë ¤ë˜ê¸°ë„ í•©ë‹ˆë‹¤."
â†’ 'í‘œì¤€ ì¹˜ë£Œ' = ê¶Œìž¥Â·ìš°ìœ„ ì•”ì‹œ, ì˜ë£Œê´‘ê³ ë²•ì—ì„œ ë¯¼ê°

âœ… ì•ˆì „í•œ ëŒ€ì²´:
"ì¹˜ë£Œ ë°©í–¥ì€ ì†ìƒ ì •ë„ì™€ ê°œì¸ì˜ í™œë™ëŸ‰ ë“±ì„ ì¢…í•©í•´ ì˜ë£Œì§„ê³¼ì˜ ìƒë‹´ì„ í†µí•´ ê²°ì •ë˜ëŠ” ê²½ìš°ê°€ ë§ŽìŠµë‹ˆë‹¤."
â†’ ìš°ìœ„ ì œê±°, ê²°ì • ì£¼ì²´ë¥¼ ì˜ë£Œì§„+ê°œì¸ìœ¼ë¡œ ë¶„ì‚°

---
[ðŸŽ¬ í˜„ìž¥ê° ê°•í™”] - ì‚¬ëžŒì´ ì“´ ê¸€ì²˜ëŸ¼!
---

**1. êµ¬ì²´ì  ìƒí™œ ìž¥ë©´ìœ¼ë¡œ ì‹œìž‘**
âŒ "ì–´ê¹¨ í†µì¦ì´ ìžˆìœ¼ë©´ ì‹ ê²½ì´ ì“°ì´ì£ "
âœ… "ìš´ì „ì„ì—ì„œ ë’·ì¢Œì„ ë¬¼ê±´ ì§‘ìœ¼ë ¤ë‹¤ ê¹œì§ ë†€ë¼ì‹  ì  ìžˆìœ¼ì‹œì£ ?"

âŒ "í†µì¦ì´ ì§€ì†ë˜ë©´ ë¶ˆíŽ¸í•  ìˆ˜ ìžˆì–´ìš”"
âœ… "í•œìˆ¨ë„ ëª» ìžê³  ë’¤ì²™ì´ë‹¤ ë³´ë‹ˆ ë‹¤ìŒ ë‚  íšŒì˜ ì‹œê°„ì— ë© ë•Œë¦¬ê²Œ ë˜ëŠ”"

**2. ê²¨ìš¸ì²  ìƒí™© êµ¬ì²´í™”**
âŒ "ì¶”ìš¸ ë•Œ í†µì¦ì´ ì‹¬í•´ì§€ë©´"
âœ… "ì•„ì¹¨ì— ì°¨ê°€ìš´ ì„¸ë©´ëŒ€ ìˆ˜ë„ê¼­ì§€ë¥¼ í‹€ ë•Œ ì†ëª©ì´ ë»ê·¼í•œ"

âŒ "ê¸°ì˜¨ì´ ë‚®ì•„ì§€ë©´"
âœ… "ë‘êº¼ìš´ íŒ¨ë”©ì„ ìž…ìœ¼ë ¤ íŒ”ì„ ë‚„ ë•Œ 'ì–µ' ì†Œë¦¬ê°€ ë‚˜ì˜¤ê±°ë‚˜"

**3. ê¹Šì€ ê³µê° í‘œí˜„**
âŒ ì–•ì€ ê³µê°: "ë” ì‹ ê²½ ì“°ì´ì£ ", "ë¶ˆíŽ¸í•˜ì‹¤ ìˆ˜ ìžˆì–´ìš”"
âœ… ê¹Šì€ ê³µê°: "ìžë ¤ê³  ëˆ„ì› ëŠ”ë° ìžì„¸ê°€ ì•ˆ ìž¡í˜€ì„œ 30ë¶„ ë„˜ê²Œ ë’¤ì²™ì´ë‹¤ ë³´ë©´ ì§œì¦ì´ í™• ë°€ë ¤ì˜¤ê¸°ë„ í•˜ì£ "

---
[ðŸš« ê·¹ì  í‘œí˜„ ê¸ˆì§€] - ê³µí¬ ì¡°ìž¥ ê¸ˆì§€!
---

**1. ê³µí¬ ì¡°ìž¥ í‘œí˜„ ê¸ˆì§€**
âŒ "ë°©ì¹˜í•˜ë©´ ìœ„í—˜", "ëŠ¦ìœ¼ë©´ ì† ì“¸ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"
âœ… "ì¦ìƒì´ ì§€ì†ë˜ëŠ” ê²½ìš° ê²½ê³¼ë¥¼ ì‚´íŽ´ë³´ëŠ” ê²ƒë„ ë°©ë²•ìž…ë‹ˆë‹¤"

**2. ê³¼ìž¥/ìžê·¹ì  í‘œí˜„ ê¸ˆì§€**
âŒ "ìœ„í—˜!", "ê¸´ê¸‰!", "ëŒì—°ì‚¬"
âœ… "ì´ëŸ° íë¦„ì´ ë°˜ë³µëœë‹¤ë©´ ê²½ê³¼ë¥¼ ì •ë¦¬í•´ë³´ëŠ” ê²ƒë„ ë°©ë²•ìž…ë‹ˆë‹¤"

**3. ê°ì • ìžê·¹í˜• í‘œí˜„ ê¸ˆì§€**
âŒ "ì ì  ì‹¬í•´ì§€ë‚˜ìš”", "ë” ì•„íŒŒì§€ì§„ ì•Šë‚˜ìš”"
âœ… "ì‹œê°„ì´ ì§€ë‚˜ë©´ì„œ ì²´ì¤‘ì„ ì‹¤ì„ ë•Œ í†µì¦ì´ ë” ëšœë ·í•´ì§€ëŠ” ê²½í–¥ì´ ìžˆë‹¤ë©´"

---
[ðŸ¤– AI ëƒ„ìƒˆ ì œê±°] - í•µì‹¬ ì—…ê·¸ë ˆì´ë“œ!
---

**0. ðŸš« ë…¼ë¬¸Â·ë³´ê³ ì„œÂ·AI í‹° ë‚˜ëŠ” ë‹¨ì–´ ì‚¬ìš© ì ˆëŒ€ ê¸ˆì§€!**
âŒ ì ˆëŒ€ ì‚¬ìš© ê¸ˆì§€ ë‹¨ì–´: ë¶ˆíŽ¸ê°, ì–‘ìƒ, ì‹œì‚¬í•˜ë‹¤, íŠ¹ì§•ì ì¸, íë¦„, í•´ë‹¹, ìƒíƒœë¥¼ ê³ ë ¤í•˜ë‹¤
âœ… ëŒ€ì²´ í‘œí˜„: ë¶ˆíŽ¸í•¨, ê±¸ë¦¬ëŠ” ëŠë‚Œ, ì‹ ê²½ ì“°ìž„, ì¡°ì‹¬í•˜ê²Œ ë¨, ì´ì–´ì§€ëŠ” ê³¼ì •, ì´ëŸ° ê²½ìš°

**1. AI ì œëª© ëƒ„ìƒˆ ì œê±° (ì¢…ê²°ì–´ êµì²´)**
âŒ AI ê°™ì€ ì¢…ê²°ì–´: íë¦„(ê¸ˆì§€!), ìƒí™©, ì‹œì , ì‚¬ë¡€, ê³¼ì •
âœ… ì‚¬ëžŒ ê°™ì€ ì¢…ê²°ì–´: ê²½ìš°, ìˆœê°„, ë’¤, ë•Œ, ì´í›„, ëŠë‚Œ

ì˜ˆì‹œ:
âŒ "ë¬´ë¦Žì´ êº¾ì´ë©° ë‹¤ë¦¬ì— íž˜ì´ ë“¤ì–´ê°€ì§€ ì•ŠëŠ” ì‹œì "
âœ… "ë¬´ë¦Žì´ êº¾ì´ê³  ë‹¤ë¦¬ì— íž˜ì´ ë¹ ì§€ëŠ” ìˆœê°„"

**2. AI ì—°ê²°ì–´ ì œê±°**
âŒ "~ì´ ë‹¤ë£¨ì–´ì§€ëŠ”", "~ì—ì„œ ì„¤ëª…ë˜ëŠ”", "~ê´€ë ¨ ë‚´ìš©ì´"
âœ… ì‚¬ëžŒì´ ë§ë¡œ ì“°ëŠ” í‘œí˜„ìœ¼ë¡œ ì „í™˜

ì˜ˆì‹œ:
âŒ "ì „ë°©ì‹­ìžì¸ëŒ€ íŒŒì—´ ê´€ë ¨ ë‚´ìš©ì´ ë‹¤ë£¨ì–´ì§€ëŠ”"
âœ… "ì „ë°©ì‹­ìžì¸ëŒ€ ì†ìƒì´ ì´ì•¼ê¸°ë˜ëŠ”"

**3. ì¸ìš© ì „ë‹¬í˜• ì„œìˆ  ê¸ˆì§€**
âŒ "~ì„¤ëª…í•©ë‹ˆë‹¤", "~ì•ˆë‚´í•´ìš”", "~ì œì‹œí•©ë‹ˆë‹¤", "~ì–¸ê¸‰ë©ë‹ˆë‹¤"
âœ… "ì´ëŸ° ë°©ë²•ì´ ì£¼ë¡œ í™œìš©ë˜ëŠ” ì¶”ì„¸ì˜ˆìš”", "ì¼ë°˜ì ìœ¼ë¡œ ì´ë ‡ê²Œ ì ‘ê·¼í•˜ëŠ” íŽ¸ì´ì—ìš”"

**4. ë¬¸ìž¥ ëë§ºìŒ ë‹¤ì–‘í™”**
âŒ ë™ì¼ ì¢…ê²°ì–´ë¯¸ 3íšŒ ì´ìƒ ë°˜ë³µ
âœ… ë‹¤ì–‘í•œ ì¢…ê²°: "~ì´ì—ìš”", "~í•˜ì£ ", "~í•  ìˆ˜ ìžˆì–´ìš”", "~ê²½ìš°ê°€ ë§Žì•„ìš”", "~ì¶”ì„¸ì˜ˆìš”"

**5. ê¸°ê³„ì  ê³µê° í‘œí˜„ ì§€ì–‘**
âŒ "ì‹ ê²½ì´ ì“°ì´ì£ ", "ë” ì‹ ê²½ì´ ì“°ì´ì£ " ë°˜ë³µ
âœ… êµ¬ì²´ì  ìƒí™© ë¬˜ì‚¬ë¡œ ëŒ€ì²´

**6. ì‹¤ì œ ì‚¬ëžŒì´ ì“°ëŠ” ë³‘ì› ë¸”ë¡œê·¸ ë§íˆ¬ í•„ìˆ˜!**
- ë¶ˆíŽ¸í•¨, ê±¸ë¦¬ëŠ” ëŠë‚Œ, ì‹ ê²½ ì“°ìž„, ì¡°ì‹¬í•˜ê²Œ ë¨ ê°™ì€ í‘œí˜„ ì‚¬ìš©
- ì„¤ëª…í˜•Â·ì¹¼ëŸ¼í˜• í†¤ ìœ ì§€ (ì§ˆë¬¸í˜• ë‚¨ë°œ ê¸ˆì§€)
- ë¬¸ë‹¨ì€ 3~4ì¤„ ì´ë‚´ë¡œ ëŠì–´ ê°€ë…ì„± í™•ë³´
- ê°™ì€ ë‹¨ì–´ ë°˜ë³µ ì‹œ ìžì—°ìŠ¤ëŸ¬ìš´ ìœ ì‚¬ì–´ë¡œ ì¹˜í™˜
- ë³‘ì› í™ë³´ ëŠë‚Œ ë‚˜ì§€ ì•Šê²Œ ì •ë³´ ì¤‘ì‹¬ìœ¼ë¡œ ìž‘ì„±
- ì‚¬ëžŒì´ ì‹¤ì œ ê²½í—˜ì„ ì„¤ëª…í•˜ë“¯ ìžì—°ìŠ¤ëŸ½ê²Œ ì„œìˆ 

**7. ì¶œë ¥ ì¡°ê±´:**
- ë²ˆì—­ì²´ ë¬¸ìž¥ ê¸ˆì§€
- AIê°€ ìš”ì•½í•œ ëŠë‚Œ ê¸ˆì§€
- ì‹¤ì œ ì˜ë£Œ ë¸”ë¡œê·¸ì— ê·¸ëŒ€ë¡œ ì˜¬ë ¤ë„ ì–´ìƒ‰í•˜ì§€ ì•Šê²Œ ìž‘ì„±

**8. ðŸš¨ ì²´í¬í¬ì¸íŠ¸ ë³„ë„ ì„¹ì…˜ ê¸ˆì§€! (AI smell ê¸‰ìƒìŠ¹ íŒ¨í„´)**
âŒ ì ˆëŒ€ ê¸ˆì§€:
- "ì²´í¬ í¬ì¸íŠ¸" ì†Œì œëª© + ë¶ˆë¦¿ ë¦¬ìŠ¤íŠ¸
- "- ~í•˜ê³  ìžˆëŠ”ì§€" ë‚˜ì—´
- "- ~ì§€ ì•Šì•˜ëŠ”ì§€" ë‚˜ì—´  
- "- ~ì¸ì§€ í™•ì¸" íŒ¨í„´ ë°˜ë³µ

âœ… ë°˜ë“œì‹œ ë¬¸ë‹¨ ì„œìˆ ë¡œ ë…¹ì´ê¸°:
- ì²´í¬í•  ë‚´ìš©ì„ ìžì—°ìŠ¤ëŸ¬ìš´ ë¬¸ìž¥ íë¦„ìœ¼ë¡œ ì—°ê²°
- ë‹¤ì–‘í•œ ì–´ë¯¸ì™€ ì ‘ì†ì‚¬ í™œìš©
- ë³„ë„ ì„¹ì…˜ ë¶„ë¦¬ ì ˆëŒ€ ê¸ˆì§€!

---
[âœ… ìµœì¢… ì²´í¬ë¦¬ìŠ¤íŠ¸]
---

â–¡ ðŸš¨ **ëª¨ë“  ë‹¨ì–´ 15íšŒ ë¯¸ë§Œ?** (ìµœìš°ì„  ì²´í¬! 14íšŒê¹Œì§€ë§Œ í—ˆìš©!)
â–¡ ì£¼ì œì–´(ë³‘ëª…) 12íšŒ ì´í•˜? ì¼ë°˜ ë‹¨ì–´ 10íšŒ ì´í•˜?
â–¡ ðŸš« ë…¼ë¬¸Â·ë³´ê³ ì„œ ë‹¨ì–´ 0ê°œ? (ë¶ˆíŽ¸ê°, ì–‘ìƒ, ì‹œì‚¬í•˜ë‹¤, íŠ¹ì§•ì ì¸, íë¦„, í•´ë‹¹, ìƒíƒœë¥¼ ê³ ë ¤í•˜ë‹¤)
â–¡ "~ì¸ì§€, ~ì¸ì§€, ~ì¸ì§€" ë‚˜ì—´ íŒ¨í„´ 0ê°œ?
â–¡ ê¸€ ì„œë‘ì— ë©”íƒ€ ì„¤ëª… ì—†ìŒ?
â–¡ íŒë‹¨ íšŒí”¼ í‘œí˜„ ë™ì¼ í‘œí˜„ 2íšŒ ì´í•˜?
â–¡ ë¬¼ìŒí‘œ(?) ì ì ˆížˆ ì‚¬ìš©? (ì œëª© ê¸ˆì§€, ì†Œì œëª© í—ˆìš©)
â–¡ "~ìˆ˜ ìžˆìŠµë‹ˆë‹¤" ë¬¸ë‹¨ë‹¹ 1íšŒ ì´í•˜?
â–¡ ì²« ë¬¸ìž¥ì´ ìƒí™© ì„œìˆ í˜•ìœ¼ë¡œ ì‹œìž‘?
â–¡ AI ëƒ„ìƒˆ ì ìˆ˜ 15ì  ì´í•˜?
â–¡ ê³µì‹ ë ¥ ì¸ìš© ì‹œ ê²°ë¡ í™” ì°¨ë‹¨ ë˜ì—ˆëŠ”ê°€?
â–¡ í†µê³„ ìˆ˜ì¹˜ê°€ 'ê²½í–¥'ìœ¼ë¡œ í‘œí˜„ë˜ì—ˆëŠ”ê°€?
â–¡ ìžê°€ ì²´í¬ë¦¬ìŠ¤íŠ¸ì— ë°©ì–´ ë¬¸êµ¬ê°€ ìžˆëŠ”ê°€?
â–¡ ì‹¤ì œ ë³‘ì› ë¸”ë¡œê·¸ ë§íˆ¬ë¡œ ìž‘ì„±? (ì„¤ëª…í˜•Â·ì¹¼ëŸ¼í˜•)
â–¡ ë¬¸ë‹¨ì€ 3~4ì¤„ ì´ë‚´ë¡œ ëŠê¹€?
â–¡ ë³‘ì› í™ë³´ ëŠë‚Œ ì—†ì´ ì •ë³´ ì¤‘ì‹¬?
â–¡ ë‹¨ì • í‘œí˜„ 0ê°œ? (ì¹˜ë£Œëœë‹¤, ê°œì„ ëœë‹¤, íš¨ê³¼ê°€ ìžˆë‹¤ ì‚¬ìš© ê¸ˆì§€)
â–¡ ê³¼ë‹¤ ë°˜ë³µ ë‹¨ì–´ë¥¼ ìœ ì‚¬ì–´ë¡œ ëŒ€ì²´í–ˆëŠ”ê°€?
`;
};



// ì‹¬ë¦¬í•™ ê¸°ë°˜ CTA ì „í™˜ ê³µì‹ (ì˜ë£Œê´‘ê³ ë²• 100% ì¤€ìˆ˜ + ê³µì‹ ë ¥ ì¶œì²˜ í•„ìˆ˜)
const PSYCHOLOGY_CTA_PROMPT = `
---
[[ì‹¬ë¦¬] CTA ì‹¬ë¦¬í•™ - ì˜ë£Œê´‘ê³ ë²• 100% ì¤€ìˆ˜]
---

**â›” CTA ì ˆëŒ€ ê¸ˆì§€:**
âŒ "ê²€ì§„ ë°›ìœ¼ì„¸ìš”", "ìƒë‹´ ê¶Œìž¥", "ë°©ë¬¸í•˜ì„¸ìš”" â†’ ì§ì ‘ ìœ ë„!
âŒ "ë°˜ë“œì‹œ", "ì¦‰ì‹œ", "ë¹¨ë¦¬" â†’ ê³µí¬ ì¡°ìž¥!
âŒ "ì™„ì¹˜ìœ¨ 99%", "100% íšŒë³µ" â†’ íš¨ê³¼ ë³´ìž¥!

**âœ… ì•ˆì „í•œ CTA ê³µì‹: [ìƒí™©] + [ìžê°€ íŒë‹¨ í•œê³„] + [í™•ì¸ ì‹œì  ì œì•ˆ]**
ì˜ˆì‹œ:
âœ… "ì¦ìƒì´ ë°˜ë³µëœë‹¤ë©´, í™•ì¸í•´ë³´ëŠ” ê²ƒì´ ë„ì›€ì´ ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤"
âœ… "ì¦ìƒë§Œìœ¼ë¡œëŠ” ì›ì¸ì„ êµ¬ë¶„í•˜ê¸° ì–´ë ¤ìš´ ê²½ìš°ê°€ ë§ŽìŠµë‹ˆë‹¤"
âœ… "ì´ ë‹¨ê³„ì—ì„œëŠ” ì§€ì¼œë³´ê¸°ë³´ë‹¤ í™•ì¸ì´ ìš°ì„ ì¸ ì‹œì ì¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤"

**ðŸŽ¯ 4ê°€ì§€ í•µì‹¬ ì‹¬ë¦¬ ì›ì¹™:**
1. ë°°ì œ ë°˜ì‘: "ì•ˆ í•˜ëŠ” ì„ íƒì˜ ë¶ˆë¦¬í•¨" ì œì‹œ
2. ì‹œì  ê³ ì •: "ì§€ê¸ˆì´ëƒ ì•„ë‹ˆëƒ" íŒë‹¨ ëŒ€ì‹ 
3. ë¶ˆí™•ì‹¤ì„± ì œê±°: "ìžê°€ íŒë‹¨ ë¶ˆê°€ëŠ¥" ëª…ì‹œ
4. ì¸ì§€ ë¶€í•˜ ê°ì†Œ: "ì¹˜ë£Œ" â†’ "í™•ì¸/ì ê²€"

**âœ… ì§„ë£Œê³¼ë³„ í•µì‹¬ í‚¤ì›Œë“œ:**
- ë‚´ê³¼: "ì¦ìƒ ìœ ë¬´ë³´ë‹¤ ìˆ˜ì¹˜ í™•ì¸ ìš°ì„ "
- ì •í˜•ì™¸ê³¼: "í†µì¦ì„ ë²„í‹´ ê¸°ê°„ âˆ íšŒë³µ ì‹œê°„"
- í”¼ë¶€ê³¼: "ê´€ë¦¬ì—ë„ ë°˜ë³µë˜ë©´ ì ê²€ ì‹œì "
- ì¹˜ê³¼: "í†µì¦ ì‹œìž‘ = ì´ë¯¸ ì¹˜ë£Œ ë²”ìœ„ í™•ëŒ€"
- ì•ˆê³¼: "ì‹œì‹ ê²½ ì†ìƒì€ ë¹„ê°€ì—­ì "
- ì´ë¹„ì¸í›„ê³¼: "ë¹„ìŠ·í•œ ì¦ìƒ, ë‹¤ë¥¸ ì›ì¸"
- ì •ì‹ ê±´ê°•ì˜í•™ê³¼: "ì¼ìƒ íšŒë³µ ë„êµ¬"
- ì‹ ê²½ì™¸ê³¼/ì‹ ê²½ê³¼: "í™•ì¸ ì‹œì  = ì˜ˆí›„"
- ì‚°ë¶€ì¸ê³¼: "í™•ì¸ì´ ê±±ì •ë³´ë‹¤ ë¹ ë¥¸ í•´ë‹µ"
- ë¹„ë‡¨ì˜í•™ê³¼: "ë¯¸ë£¨ëŠ” ë™ì•ˆ ì¦ìƒì€ í•´ê²° ì•ˆ ë¨"
- ì†Œì•„ê³¼: "ë¬¸ì œ í™•ì¸ì´ ì•„ë‹Œ ì•ˆì‹¬ í™•ì¸"
- ìœ ë°©/ê°‘ìƒì„ ì™¸ê³¼: "ëŒ€ë¶€ë¶„ ì–‘ì„±, í™•ì¸ìœ¼ë¡œ ë¶ˆì•ˆ í•´ì†Œ"

**âœ… ë²”ìš© CTA í…œí”Œë¦¿ (ëª¨ë“  ì§„ë£Œê³¼ ì ìš©):**
A. "ì´ ë‹¨ê³„ì—ì„œëŠ” â—‹â—‹ì´ ì•„ë‹ˆë¼ â–³â–³ê°€ ìš°ì„ ìž…ë‹ˆë‹¤" â˜… ìµœê°•
B. "ì¦ìƒì´ ê°‘ìžê¸°/ë°˜ë³µ/2ì£¼ ì´ìƒ ì§€ì†ëœë‹¤ë©´, ì§€ì¼œë³¼ ë‹¨ê³„ëŠ” ì§€ë‚¬ìŠµë‹ˆë‹¤"
C. "ì¦ìƒë§Œìœ¼ë¡œëŠ” ì •í™•í•œ ì›ì¸ì„ êµ¬ë¶„í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤"
D. "ì§€ê¸ˆ í™•ì¸í•´ ë‘ëŠ” ê²ƒì´ ì´í›„ ì„ íƒì„ ê°€ë³ê²Œ ë§Œë“­ë‹ˆë‹¤"
E. "ì´ ë‹¨ê³„ì—ì„œëŠ” (ë³´í†µ í•˜ëŠ” í–‰ë™)ì€ ì¶©ë¶„í•˜ì§€ ì•Šê³ , (ê²€ì‚¬/í™•ì¸)ì´ í•„ìš”í•©ë‹ˆë‹¤"
`;

export const recommendImagePrompt = async (blogContent: string, currentImageAlt: string, imageStyle: ImageStyle = 'illustration', customStylePrompt?: string): Promise<string> => {
  const ai = getAiClient();
  
  // ìŠ¤íƒ€ì¼ì— ë”°ë¥¸ í”„ë¡¬í”„íŠ¸ ê°€ì´ë“œ (êµ¬ì²´ì ìœ¼ë¡œ ê°œì„ !)
  let styleGuide: string;
  
  if (imageStyle === 'custom' && customStylePrompt) {
    // ðŸŽ¨ ì»¤ìŠ¤í…€ ìŠ¤íƒ€ì¼: ì‚¬ìš©ìžê°€ ì—…ë¡œë“œí•œ ì°¸ê³  ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼ ë¶„ì„ ê²°ê³¼ ì‚¬ìš©
    styleGuide = `**ì¤‘ìš”: ì‚¬ìš©ìžê°€ ì§€ì •í•œ ì»¤ìŠ¤í…€ ìŠ¤íƒ€ì¼ë¡œ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤!**
       ì‚¬ìš©ìž ì§€ì • ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸:
       "${customStylePrompt}"
       
       ìœ„ ìŠ¤íƒ€ì¼ì„ ìµœëŒ€í•œ ë°˜ì˜í•˜ì—¬ í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±í•˜ì„¸ìš”.
       ë ˆì´ì•„ì›ƒ, ìƒ‰ìƒ, ë¶„ìœ„ê¸°, ë””ìžì¸ ìš”ì†Œ ë“±ì„ ìœ ì§€í•´ì£¼ì„¸ìš”.`;
  } else if (imageStyle === 'illustration') {
    styleGuide = `**ì¤‘ìš”: 3D ë Œë” ì¼ëŸ¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ë¡œ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤!**
       - ë Œë”ë§ ìŠ¤íƒ€ì¼: "3D rendered illustration", "Blender style", "soft 3D render"
       - ì¡°ëª…: ë¶€ë“œëŸ¬ìš´ ìŠ¤íŠœë””ì˜¤ ì¡°ëª…, ì€ì€í•œ ê·¸ë¦¼ìž
       - ì§ˆê°: ë§¤ë„ëŸ¬ìš´ í”Œë¼ìŠ¤í‹± ëŠë‚Œ, ë¬´ê´‘ ë§ˆê°, ë‘¥ê·¼ ëª¨ì„œë¦¬
       - ìƒ‰ìƒ: ë°ì€ íŒŒìŠ¤í…” í†¤, íŒŒëž€ìƒ‰/í°ìƒ‰/ì—°í•œ ìƒ‰ìƒ íŒ”ë ˆíŠ¸
       - ìºë¦­í„°: ì¹œê·¼í•œ í‘œì •, ë‹¨ìˆœí™”ëœ ë””ìžì¸
       - ë°°ê²½: ê¹”ë”í•œ ê·¸ë¼ë°ì´ì…˜ ë°°ê²½
       â›” ê¸ˆì§€: photorealistic, real photo, DSLR, realistic texture`;
  } else if (imageStyle === 'medical') {
    styleGuide = `**ì¤‘ìš”: ì˜í•™ 3D ì¼ëŸ¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ë¡œ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤!**
       - ë Œë”ë§ ìŠ¤íƒ€ì¼: "medical 3D illustration", "anatomical render", "scientific visualization"
       - í”¼ì‚¬ì²´: ì¸ì²´ í•´ë¶€í•™, ìž¥ê¸° ë‹¨ë©´ë„, ë¼ˆ/ê·¼ìœ¡/í˜ˆê´€ êµ¬ì¡°
       - ì¡°ëª…: ìž„ìƒì  ì¡°ëª…, X-ray ìŠ¤íƒ€ì¼ ê¸€ë¡œìš°, ë°˜íˆ¬ëª… ìž¥ê¸°
       - ì§ˆê°: semi-transparent organs, detailed anatomical structures
       - ìƒ‰ìƒ: ì˜ë£Œìš© íŒ”ë ˆíŠ¸ (íŒŒëž€ìƒ‰, í°ìƒ‰, ë¹¨ê°„ìƒ‰ í˜ˆê´€)
       - ë¶„ìœ„ê¸°: clinical, professional, educational
       â›” ê¸ˆì§€: cute cartoon, photorealistic human face`;
  } else {
    // photo ë˜ëŠ” ê¸°íƒ€
    styleGuide = `**ì¤‘ìš”: ì‹¤ì‚¬ ì‚¬ì§„ ìŠ¤íƒ€ì¼ë¡œ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤!**
       - ë Œë”ë§ ìŠ¤íƒ€ì¼: "photorealistic", "real photography", "DSLR shot", "35mm lens"
       - í”¼ì‚¬ì²´: ì‹¤ì œ ë³‘ì› í™˜ê²½, ì‹¤ì œ ì˜ë£Œì§„, ì‹¤ì œ ì§„ë£Œ ë„êµ¬
       - ì¡°ëª…: ìžì—°ìŠ¤ëŸ¬ìš´ ì†Œí”„íŠ¸ ì¡°ëª…, ìŠ¤íŠœë””ì˜¤ ì¡°ëª…, ì „ë¬¸ ì‚¬ì§„ ì¡°ëª…
       - ì§ˆê°: realistic skin texture, fabric texture, realistic materials
       - ê¹Šì´: shallow depth of field, bokeh background
       - ë¶„ìœ„ê¸°: professional, trustworthy, clean modern hospital
       â›” ê¸ˆì§€: 3D render, illustration, cartoon, anime, vector, clay`;
  }
  
  try {
    const response = await ai.models.generateContent({
      model: 'gemini-3-pro-preview',
      contents: `ë‹¤ìŒì€ ë³‘ì› ë¸”ë¡œê·¸ ê¸€ ë‚´ìš©ìž…ë‹ˆë‹¤:

${blogContent.substring(0, 3000)}

í˜„ìž¬ ì´ë¯¸ì§€ ì„¤ëª…: "${currentImageAlt}"

${styleGuide}

ì´ ê¸€ì˜ ë§¥ë½ê³¼ ì£¼ì œì— ë§žëŠ” ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ë¥¼ **ë”± 1ê°œë§Œ** ì¶”ì²œí•´ì£¼ì„¸ìš”.

ìš”êµ¬ì‚¬í•­:
1. ê¸€ì˜ í•µì‹¬ ì£¼ì œì™€ ì—°ê´€ì„± ë†’ì€ ìž¥ë©´
2. í•œêµ­ ë³‘ì› í™˜ê²½ì— ì í•©
3. ì „ë¬¸ì ì´ê³  ì‹ ë¢°ê° ìžˆëŠ” ë¶„ìœ„ê¸°
4. êµ¬ì²´ì ì¸ ìš”ì†Œ (ì¸ë¬¼, ë°°ê²½, ë¶„ìœ„ê¸° ë“±) í¬í•¨
5. **í…ìŠ¤íŠ¸ ê·œì¹™**: ì§„ì§œ í•„ìš”í•  ë•Œë§Œ í•œê¸€/ìˆ«ìž ì‚¬ìš©, ì˜ì–´ëŠ” ê°€ê¸‰ì  ìžì œ
6. ë¡œê³ ëŠ” ì ˆëŒ€ í¬í•¨í•˜ì§€ ë§ ê²ƒ
7. **ìœ„ì—ì„œ ì§€ì •í•œ ìŠ¤íƒ€ì¼ í‚¤ì›Œë“œë¥¼ ë°˜ë“œì‹œ í”„ë¡¬í”„íŠ¸ì— í¬í•¨í•  ê²ƒ!**

**ì¤‘ìš”: í”„ë¡¬í”„íŠ¸ 1ê°œë§Œ ì¶œë ¥í•˜ì„¸ìš”! ì—¬ëŸ¬ ê°œ ì¶œë ¥ ê¸ˆì§€!**
ì„¤ëª… ì—†ì´ í”„ë¡¬í”„íŠ¸ ë¬¸ìž¥ë§Œ **í•œêµ­ì–´**ë¡œ ë‹µë³€í•˜ì„¸ìš”.

ì˜ˆì‹œ (1ê°œë§Œ):
${imageStyle === 'illustration' 
  ? '"ë°ì€ ë³‘ì› ìƒë‹´ì‹¤ì—ì„œ ì˜ì‚¬ê°€ í™˜ìžì—ê²Œ ì„¤ëª…í•˜ëŠ” ëª¨ìŠµ, 3D ì¼ëŸ¬ìŠ¤íŠ¸, ì•„ì´ì†Œë©”íŠ¸ë¦­ ë·°, í´ë ˆì´ ë Œë”, íŒŒëž€ìƒ‰ í°ìƒ‰ íŒ”ë ˆíŠ¸"'
  : imageStyle === 'medical'
  ? '"ì¸ì²´ ì‹¬ìž¥ì˜ 3D ë‹¨ë©´ë„, ì¢Œì‹¬ì‹¤ê³¼ ìš°ì‹¬ì‹¤ì´ ë³´ì´ëŠ” í•´ë¶€í•™ì  êµ¬ì¡°, í˜ˆê´€ê³¼ íŒë§‰ì´ í‘œì‹œëœ ì˜í•™ ì¼ëŸ¬ìŠ¤íŠ¸, íŒŒëž€ìƒ‰ ë°°ê²½, êµìœ¡ìš© ì „ë¬¸ ì´ë¯¸ì§€"'
  : '"ê¹”ë”í•œ ë³‘ì› ìƒë‹´ì‹¤ì—ì„œ ì˜ì‚¬ê°€ í™˜ìžì™€ ìƒë‹´í•˜ëŠ” ëª¨ìŠµ, ì‹¤ì‚¬ ì‚¬ì§„, DSLR ì´¬ì˜, ìžì—°ìŠ¤ëŸ¬ìš´ ì¡°ëª…, ì „ë¬¸ì ì¸ ë¶„ìœ„ê¸°"'}:`,
      config: {
        responseMimeType: "text/plain"
      }
    });
    
    return response.text?.trim() || currentImageAlt;
  } catch (error) {
    console.error('í”„ë¡¬í”„íŠ¸ ì¶”ì²œ ì‹¤íŒ¨:', error);
    return currentImageAlt;
  }
};

// ðŸŽ´ ì¹´ë“œë‰´ìŠ¤ ì „ìš© AI í”„ë¡¬í”„íŠ¸ ì¶”ì²œ - ë¶€ì œ/ë©”ì¸ì œëª©/ì„¤ëª… í¬í•¨!
export const recommendCardNewsPrompt = async (
  subtitle: string,
  mainTitle: string,
  description: string,
  imageStyle: ImageStyle = 'illustration',
  customStylePrompt?: string
): Promise<string> => {
  const ai = getAiClient();
  
  // ìŠ¤íƒ€ì¼ ê°€ì´ë“œ ê²°ì •
  let styleKeywords: string;
  if (imageStyle === 'custom' && customStylePrompt) {
    styleKeywords = customStylePrompt;
  } else if (imageStyle === 'illustration') {
    styleKeywords = '3D ì¼ëŸ¬ìŠ¤íŠ¸, í´ë ˆì´ ë Œë”, íŒŒìŠ¤í…”í†¤, ë¶€ë“œëŸ¬ìš´ ì¡°ëª…';
  } else if (imageStyle === 'medical') {
    styleKeywords = 'ì˜í•™ 3D ì¼ëŸ¬ìŠ¤íŠ¸, í•´ë¶€í•™ì  êµ¬ì¡°, ì „ë¬¸ì ì¸ ì˜ë£Œ ì´ë¯¸ì§€';
  } else {
    styleKeywords = 'ì‹¤ì‚¬ ì‚¬ì§„, DSLR ì´¬ì˜, ìžì—°ìŠ¤ëŸ¬ìš´ ì¡°ëª…';
  }
  
  // ì»¤ìŠ¤í…€ ìŠ¤íƒ€ì¼ ì—¬ë¶€ í™•ì¸
  const isCustomStyle = imageStyle === 'custom' && customStylePrompt;
  
  try {
    const response = await ai.models.generateContent({
      model: 'gemini-3-pro-preview',
      contents: `ë‹¹ì‹ ì€ ì¹´ë“œë‰´ìŠ¤ ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ ì „ë¬¸ê°€ìž…ë‹ˆë‹¤.

ë‹¤ìŒ ì¹´ë“œë‰´ìŠ¤ í…ìŠ¤íŠ¸ì— ì–´ìš¸ë¦¬ëŠ” **ë°°ê²½ ì´ë¯¸ì§€ ë‚´ìš©**ë§Œ ì¶”ì²œí•´ì£¼ì„¸ìš”.

[ì¹´ë“œë‰´ìŠ¤ í…ìŠ¤íŠ¸]
- ë¶€ì œ: "${subtitle || 'ì—†ìŒ'}"
- ë©”ì¸ ì œëª©: "${mainTitle || 'ì—†ìŒ'}"  
- ì„¤ëª…: "${description || 'ì—†ìŒ'}"

[ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼ - âš ï¸ ë°˜ë“œì‹œ ì´ ìŠ¤íƒ€ì¼ ìœ ì§€!]
${styleKeywords}

[ì¶œë ¥ í˜•ì‹ - ë°˜ë“œì‹œ ì´ í˜•ì‹ìœ¼ë¡œ!]
subtitle: "${subtitle || ''}"
mainTitle: "${mainTitle || ''}"
${description ? `description: "${description}"` : ''}
ë¹„ì£¼ì–¼: (ì—¬ê¸°ì— ë°°ê²½ ì´ë¯¸ì§€ ë‚´ìš©ë§Œ ìž‘ì„±)

[ê·œì¹™]
1. subtitle, mainTitle, descriptionì€ ìœ„ í…ìŠ¤íŠ¸ ê·¸ëŒ€ë¡œ ìœ ì§€
2. "ë¹„ì£¼ì–¼:" ë¶€ë¶„ì—ëŠ” **ì´ë¯¸ì§€ì— ê·¸ë¦´ ëŒ€ìƒ/ë‚´ìš©ë§Œ** ìž‘ì„± (30ìž ì´ë‚´)
3. ${isCustomStyle ? `âš ï¸ ì¤‘ìš”: ê·¸ë¦¼ì²´/ìŠ¤íƒ€ì¼ì€ "${customStylePrompt}"ë¡œ ì´ë¯¸ ì§€ì •ë˜ì–´ ìžˆìœ¼ë¯€ë¡œ, ë¹„ì£¼ì–¼ì—ëŠ” "ë¬´ì—‡ì„ ê·¸ë¦´ì§€"ë§Œ ìž‘ì„± (ìˆ˜ì±„í™”, ì—°í•„, ë³¼íŽœ ë“± ìŠ¤íƒ€ì¼ ì–¸ê¸‰ ê¸ˆì§€!)` : 'ë¹„ì£¼ì–¼ì— ìŠ¤íƒ€ì¼ê³¼ ë‚´ìš©ì„ í•¨ê»˜ ìž‘ì„±'}
4. ì˜ˆ: "ì‹¬ìž¥ ì•„ì´ì½˜ê³¼ íŒŒëž€ ê·¸ë¼ë°ì´ì…˜ ë°°ê²½", "ë³‘ì›ì—ì„œ ìƒë‹´ë°›ëŠ” í™˜ìž"

ìœ„ í˜•ì‹ëŒ€ë¡œë§Œ ì¶œë ¥í•˜ì„¸ìš”. ë‹¤ë¥¸ ì„¤ëª… ì—†ì´!`,
      config: {
        responseMimeType: "text/plain"
      }
    });
    
    return response.text?.trim() || `subtitle: "${subtitle}"\nmainTitle: "${mainTitle}"\n${description ? `description: "${description}"\n` : ''}ë¹„ì£¼ì–¼: ë°ì€ íŒŒëž€ìƒ‰ ë°°ê²½, ${styleKeywords}`;
  } catch (error) {
    console.error('ì¹´ë“œë‰´ìŠ¤ í”„ë¡¬í”„íŠ¸ ì¶”ì²œ ì‹¤íŒ¨:', error);
    // ì‹¤íŒ¨ ì‹œ ê¸°ë³¸ í”„ë¡¬í”„íŠ¸ ë°˜í™˜
    return `subtitle: "${subtitle}"\nmainTitle: "${mainTitle}"\n${description ? `description: "${description}"\n` : ''}ë¹„ì£¼ì–¼: ë°ì€ íŒŒëž€ìƒ‰ ë°°ê²½, ${styleKeywords}`;
  }
};

// ðŸ§¹ ê³µí†µ í”„ë¡¬í”„íŠ¸ ì •ë¦¬ í•¨ìˆ˜ - base64/ì½”ë“œ ë¬¸ìžì—´ë§Œ ì œê±°, ì˜ë¯¸ìžˆëŠ” í…ìŠ¤íŠ¸ëŠ” ìœ ì§€!
// âš ï¸ ì£¼ì˜: ì˜ì–´ ì§€ì‹œë¬¸/í•œêµ­ì–´ í…ìŠ¤íŠ¸ëŠ” ì ˆëŒ€ ì‚­ì œí•˜ë©´ ì•ˆ ë¨!
const cleanImagePromptText = (prompt: string): string => {
  let cleaned = prompt
    // 1. base64 ë°ì´í„° URI ì œê±°
    .replace(/data:[^;]+;base64,[A-Za-z0-9+/=]+/g, '')
    // 2. URL ì œê±°
    .replace(/https?:\/\/[^\s]+/g, '')
    // 3. base64 ìŠ¤íƒ€ì¼ ê¸´ ë¬¸ìžì—´ ì œê±° - ê³µë°± ì—†ì´ ì—°ì† 50ìž ì´ìƒì¸ ê²½ìš°ë§Œ! (ê¸°ì¡´ 12ìž â†’ 50ìžë¡œ ì™„í™”)
    // âš ï¸ ì˜ì–´ ì§€ì‹œë¬¸("Render Korean text DIRECTLY" ë“±)ì´ ì‚­ì œë˜ì§€ ì•Šë„ë¡!
    .replace(/[A-Za-z0-9+/=]{50,}/g, '')
    // 4. ê²½ë¡œ íŒ¨í„´ ì œê±° - ìŠ¬ëž˜ì‹œê°€ 3ê°œ ì´ìƒ ì—°ì†ì¸ ê²½ìš°ë§Œ (ê¸°ì¡´: 2ê°œ ì´ìƒ â†’ 3ê°œ ì´ìƒìœ¼ë¡œ ì™„í™”)
    // âš ï¸ "1:1 square" ê°™ì€ íŒ¨í„´ì´ ì‚­ì œë˜ì§€ ì•Šë„ë¡!
    .replace(/[a-zA-Z0-9]{2,}\/[a-zA-Z0-9]+\/[a-zA-Z0-9/]+/g, '')
    // 5. ì—°ì† íŠ¹ìˆ˜ë¬¸ìž ì •ë¦¬
    .replace(/[,.\s]{3,}/g, ', ')
    .replace(/\s+/g, ' ')
    .trim();
  
  // ë„ˆë¬´ ì§§ìœ¼ë©´ ê¸°ë³¸ê°’ìœ¼ë¡œ ëŒ€ì²´ (ì™„ì „ížˆ ë¹„ì–´ìžˆëŠ” ê²½ìš°ë§Œ)
  if (cleaned.length < 5) {
    console.warn('âš ï¸ í•„í„°ë§ í›„ í”„ë¡¬í”„íŠ¸ê°€ ë„ˆë¬´ ì§§ìŒ, ê¸°ë³¸ê°’ìœ¼ë¡œ ëŒ€ì²´:', cleaned);
    cleaned = 'ì˜ë£Œ ê±´ê°• ì •ë³´ ì¹´ë“œë‰´ìŠ¤, ê¹”ë”í•œ ì¸í¬ê·¸ëž˜í”½, íŒŒëž€ìƒ‰ í°ìƒ‰ ë°°ê²½';
  }
  return cleaned;
};

// ðŸ–¼ï¸ ë¸”ë¡œê·¸ìš© ì¼ë°˜ ì´ë¯¸ì§€ ìƒì„± í•¨ìˆ˜ (í…ìŠ¤íŠ¸ ì—†ëŠ” ìˆœìˆ˜ ì´ë¯¸ì§€)
export const generateBlogImage = async (
  promptText: string,
  style: ImageStyle,
  aspectRatio: string = "16:9",
  customStylePrompt?: string
): Promise<string> => {
  const ai = getAiClient();

  // ìŠ¤íƒ€ì¼ ë¸”ë¡ë§Œ ì‚¬ìš© (ì¹´ë“œë‰´ìŠ¤ í”„ë ˆìž„ ì—†ìŒ!)
  const styleBlock = buildStyleBlock(style, customStylePrompt);

  // ë¸”ë¡œê·¸ìš© í”„ë¡¬í”„íŠ¸: í…ìŠ¤íŠ¸ ì—†ëŠ” ìˆœìˆ˜ ì´ë¯¸ì§€! (í•œêµ­ì–´ë¡œ ìƒì„±)
  const finalPrompt = `
ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ìš© ì „ë¬¸ì ì¸ ì˜ë£Œ/ê±´ê°• ì´ë¯¸ì§€ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.

${styleBlock}

[ì´ë¯¸ì§€ ë‚´ìš©]
${promptText}

[ë””ìžì¸ ì‚¬ì–‘]
- ë¹„ìœ¨: ${aspectRatio} (ê°€ë¡œí˜•/ëžœë“œìŠ¤ì¼€ì´í”„ ë¸”ë¡œê·¸ í˜•ì‹)
- ìŠ¤íƒ€ì¼: ì „ë¬¸ì ì¸ ì˜ë£Œ/ê±´ê°• ì´ë¯¸ì§€
- ë¶„ìœ„ê¸°: ì‹ ë¢°ê° ìžˆê³ , ê¹”ë”í•˜ë©°, í˜„ëŒ€ì ì¸ ë³‘ì› í™˜ê²½
- í…ìŠ¤íŠ¸ ì—†ìŒ, ì œëª© ì—†ìŒ, ìº¡ì…˜ ì—†ìŒ, ì›Œí„°ë§ˆí¬ ì—†ìŒ, ë¡œê³  ì—†ìŒ
- ìˆœìˆ˜í•œ ì‹œê°ì  ì½˜í…ì¸ ë§Œ - ë¸”ë¡œê·¸ ê²Œì‹œë¬¼ ì´ë¯¸ì§€ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤

[í•„ìˆ˜ ìš”êµ¬ì‚¬í•­]
âœ… í…ìŠ¤íŠ¸ ì˜¤ë²„ë ˆì´ ì—†ëŠ” ê¹”ë”í•œ ì´ë¯¸ì§€ ìƒì„±
âœ… ë³‘ì› ë¸”ë¡œê·¸ì— ì í•©í•œ ì „ë¬¸ì ì¸ ì˜ë£Œ/ê±´ê°• ì´ë¯¸ì§€
âœ… ìŠ¤íƒ€ì¼ì— ë”°ë¼ ê³ í’ˆì§ˆ, ìƒì„¸í•œ ì¼ëŸ¬ìŠ¤íŠ¸ ë˜ëŠ” ì‚¬ì§„
âœ… ë¸”ë¡œê·¸ ê²Œì‹œë¬¼ì— ìµœì í™”ëœ ê°€ë¡œí˜• 16:9 í˜•ì‹

â›” ê¸ˆì§€ì‚¬í•­ (Negative Prompt):
- í•œêµ­ì–´ í…ìŠ¤íŠ¸, ì˜ì–´ í…ìŠ¤íŠ¸, any text overlay
- ì œëª©, ìº¡ì…˜, ì›Œí„°ë§ˆí¬, ë¡œê³ 
- ë¸Œë¼ìš°ì € ì°½ í”„ë ˆìž„, ì¹´ë“œë‰´ìŠ¤ ë ˆì´ì•„ì›ƒ
- í…ìŠ¤íŠ¸ê°€ í¬í•¨ëœ ì¸í¬ê·¸ëž˜í”½ ìš”ì†Œ
- Low quality, blurry, pixelated, distorted
- Cartoon, anime, drawing, sketch (photo styleì¼ ê²½ìš°)
- 3D render, CGI (photo styleì¼ ê²½ìš°)
- Out of focus, bad lighting, overexposed
- Watermark, signature, text, logo, caption

[ì¶œë ¥]
ì˜ë£Œ ë¸”ë¡œê·¸ ê²Œì‹œë¬¼ì— ì í•©í•œ í…ìŠ¤íŠ¸ ì—†ëŠ” ê¹”ë”í•œ ë‹¨ì¼ ì´ë¯¸ì§€.
`.trim();

  console.log('ðŸ“· generateBlogImage - ë¸”ë¡œê·¸ìš© ì´ë¯¸ì§€ ìƒì„± (í…ìŠ¤íŠ¸ ì—†ìŒ, 16:9)');

  // ìž¬ì‹œë„ ë¡œì§
  const MAX_RETRIES = 2;
  let lastError: any = null;

  for (let attempt = 1; attempt <= MAX_RETRIES; attempt++) {
    try {
      console.log(`ðŸŽ¨ ë¸”ë¡œê·¸ ì´ë¯¸ì§€ ìƒì„± ì‹œë„ ${attempt}/${MAX_RETRIES}...`);
      
      const result = await ai.models.generateContent({
        model: "gemini-3-pro-image-preview",
        contents: [{ text: finalPrompt }],
        config: {
          responseModalities: ["IMAGE", "TEXT"],
          temperature: 0.6, // ë¸”ë¡œê·¸ ì´ë¯¸ì§€ í’ˆì§ˆ í–¥ìƒ
        },
      });

      const parts = result?.candidates?.[0]?.content?.parts || [];
      const imagePart = parts.find((p: any) => p.inlineData?.data);
      
      if (imagePart?.inlineData) {
        const mimeType = imagePart.inlineData.mimeType || 'image/png';
        const data = imagePart.inlineData.data;
        console.log(`âœ… ë¸”ë¡œê·¸ ì´ë¯¸ì§€ ìƒì„± ì„±ê³µ`);
        return `data:${mimeType};base64,${data}`;
      }
      
      lastError = new Error('ì´ë¯¸ì§€ ë°ì´í„°ë¥¼ ë°›ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.');
      if (attempt < MAX_RETRIES) {
        await new Promise(resolve => setTimeout(resolve, 1000 * attempt));
      }
      
    } catch (error: any) {
      lastError = error;
      console.error(`âŒ ë¸”ë¡œê·¸ ì´ë¯¸ì§€ ìƒì„± ì—ëŸ¬:`, error?.message || error);
      if (attempt < MAX_RETRIES) {
        await new Promise(resolve => setTimeout(resolve, 1000 * Math.pow(2, attempt - 1)));
      }
    }
  }

  // ì‹¤íŒ¨ ì‹œ í”Œë ˆì´ìŠ¤í™€ë”
  console.error('âŒ ë¸”ë¡œê·¸ ì´ë¯¸ì§€ ìƒì„± ìµœì¢… ì‹¤íŒ¨:', lastError?.message || lastError);
  const placeholderSvg = `<svg xmlns="http://www.w3.org/2000/svg" width="1600" height="900" viewBox="0 0 1600 900">
    <rect fill="#E8F4FD" width="1600" height="900"/>
    <rect fill="#fff" x="40" y="40" width="1520" height="820" rx="24"/>
    <text x="800" y="430" text-anchor="middle" font-family="Arial,sans-serif" font-size="24" fill="#64748b">ì´ë¯¸ì§€ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤</text>
    <text x="800" y="470" text-anchor="middle" font-family="Arial,sans-serif" font-size="16" fill="#94a3b8">ì´ë¯¸ì§€ë¥¼ í´ë¦­í•˜ì—¬ ìž¬ìƒì„±í•´ì£¼ì„¸ìš”</text>
  </svg>`;
  const base64Placeholder = btoa(unescape(encodeURIComponent(placeholderSvg)));
  return `data:image/svg+xml;base64,${base64Placeholder}`;
};

// ðŸŽ´ ê¸°ë³¸ í”„ë ˆìž„ ì´ë¯¸ì§€ URL (ë³´ë¼ìƒ‰ í…Œë‘ë¦¬ + í°ìƒ‰ ë°°ê²½)
const DEFAULT_FRAME_IMAGE_URL = 'https://www.genspark.ai/api/files/s/R8v4us3T';

// ê¸°ë³¸ í”„ë ˆìž„ ì´ë¯¸ì§€ ë¡œë“œ (ìºì‹±)
let defaultFrameImageCache: string | null = null;
const loadDefaultFrameImage = async (): Promise<string | null> => {
  if (defaultFrameImageCache) return defaultFrameImageCache;
  
  try {
    const response = await fetch(DEFAULT_FRAME_IMAGE_URL);
    if (!response.ok) throw new Error('Failed to fetch default frame');
    const blob = await response.blob();
    const base64 = await new Promise<string>((resolve) => {
      const reader = new FileReader();
      reader.onloadend = () => resolve(reader.result as string);
      reader.readAsDataURL(blob);
    });
    defaultFrameImageCache = base64;
    console.log('âœ… ê¸°ë³¸ í”„ë ˆìž„ ì´ë¯¸ì§€ ë¡œë“œ ì™„ë£Œ');
    return base64;
  } catch (error) {
    console.warn('âš ï¸ ê¸°ë³¸ í”„ë ˆìž„ ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨:', error);
    return null;
  }
};

// ðŸŽ´ ì¹´ë“œë‰´ìŠ¤ìš© ì´ë¯¸ì§€ ìƒì„± í•¨ìˆ˜ (í…ìŠ¤íŠ¸ í¬í•¨, ë³´ë¼ìƒ‰ í”„ë ˆìž„)
export const generateSingleImage = async (
  promptText: string,
  style: ImageStyle,
  aspectRatio: string,
  customStylePrompt?: string,
  referenceImage?: string,
  copyMode?: boolean
): Promise<string> => {
  const ai = getAiClient();

  // 1) ìž…ë ¥ ì •ë¦¬: ì¶©ëŒ ë¬¸êµ¬ ì œê±°
  const cleanPromptText = normalizePromptTextForImage(promptText);
  
  // ðŸŽ¨ ì°¸ê³  ì´ë¯¸ì§€ê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ í”„ë ˆìž„ ì´ë¯¸ì§€ ì‚¬ìš©
  let effectiveReferenceImage = referenceImage;
  if (!referenceImage) {
    effectiveReferenceImage = await loadDefaultFrameImage() || undefined;
    console.log('ðŸ–¼ï¸ ê¸°ë³¸ í”„ë ˆìž„ ì´ë¯¸ì§€ ì‚¬ìš©:', !!effectiveReferenceImage);
  }

  // 2) í”„ë ˆìž„/ìŠ¤íƒ€ì¼ ë¸”ë¡ ë¶„ë¦¬ (í”„ë ˆìž„ì€ ë ˆì´ì•„ì›ƒ, ìŠ¤íƒ€ì¼ì€ ë Œë”ë§)
  const frameBlock = buildFrameBlock(effectiveReferenceImage, copyMode);
  const styleBlock = buildStyleBlock(style, customStylePrompt);

  // 3) ìµœì¢… í”„ë¡¬í”„íŠ¸ ì¡°ë¦½: ì™„ì„±í˜• ì¹´ë“œ ì´ë¯¸ì§€ (í…ìŠ¤íŠ¸ê°€ ì´ë¯¸ì§€ í”½ì…€ë¡œ ë Œë”ë§!)
  // ðŸ”§ í•µì‹¬ í…ìŠ¤íŠ¸ë¥¼ í”„ë¡¬í”„íŠ¸ ìƒë‹¨ì— ë°°ì¹˜í•˜ì—¬ ëª¨ë¸ì´ ë°˜ë“œì‹œ ì¸ì‹í•˜ë„ë¡!
  
  // cleanPromptTextì—ì„œ í•µì‹¬ í…ìŠ¤íŠ¸ ì¶”ì¶œ (ë‹¤ì–‘í•œ íŒ¨í„´ ì§€ì›)
  const subtitleMatch = cleanPromptText.match(/subtitle:\s*"([^"]+)"/i) || 
                        cleanPromptText.match(/subtitle:\s*([^\n,]+)/i);
  const mainTitleMatch = cleanPromptText.match(/mainTitle:\s*"([^"]+)"/i) || 
                         cleanPromptText.match(/mainTitle:\s*([^\n,]+)/i);
  const descriptionMatch = cleanPromptText.match(/description:\s*"([^"]+)"/i) ||
                           cleanPromptText.match(/description:\s*([^\n]+)/i);
  // ðŸŽ¨ ë¹„ì£¼ì–¼ ì§€ì‹œë¬¸ ì¶”ì¶œ
  const visualMatch = cleanPromptText.match(/ë¹„ì£¼ì–¼:\s*([^\n]+)/i) ||
                      cleanPromptText.match(/visual:\s*([^\n]+)/i);
  
  const extractedSubtitle = (subtitleMatch?.[1] || '').trim().replace(/^["']|["']$/g, '');
  const extractedMainTitle = (mainTitleMatch?.[1] || '').trim().replace(/^["']|["']$/g, '');
  const extractedDescription = (descriptionMatch?.[1] || '').trim().replace(/^["']|["']$/g, '');
  const extractedVisual = (visualMatch?.[1] || '').trim();
  
  // ðŸš¨ ì¶”ì¶œ ì‹¤íŒ¨ ì‹œ ë¡œê·¸ ë° ì›ë³¸ ì‚¬ìš©
  const hasValidText = extractedSubtitle.length > 0 || extractedMainTitle.length > 0;
  if (!hasValidText) {
    console.warn('âš ï¸ í…ìŠ¤íŠ¸ ì¶”ì¶œ ì‹¤íŒ¨! cleanPromptText:', cleanPromptText.substring(0, 200));
  }
  
  // ðŸ”§ í…ìŠ¤íŠ¸ê°€ ì—†ìœ¼ë©´ ì›ë³¸ í”„ë¡¬í”„íŠ¸ ê·¸ëŒ€ë¡œ ì‚¬ìš© (ë¼ë²¨ ì—†ì´!)
  const finalPrompt = hasValidText ? `
ðŸš¨ RENDER THIS EXACT KOREAN TEXT IN THE IMAGE ðŸš¨

[TEXT HIERARCHY - MUST FOLLOW EXACTLY!]
â€» MAIN TITLE (BIG, BOLD, CENTER): "${extractedMainTitle}"
â€» SUBTITLE (small, above main title): "${extractedSubtitle}"
${extractedDescription ? `â€» DESCRIPTION (small, below main title): "${extractedDescription}"` : ''}

${extractedVisual ? `[ILLUSTRATION - MUST FOLLOW THIS VISUAL DESCRIPTION!]
ðŸŽ¨ "${extractedVisual}"
âš ï¸ Draw EXACTLY what is described above! Do NOT change or ignore this visual instruction!` : ''}

Generate a 1:1 square social media card with the Korean text above rendered directly into the image.

${frameBlock}
${styleBlock}

[TEXT LAYOUT - CRITICAL!]
- SUBTITLE: Small text (14-16px), positioned at TOP or above main title
- MAIN TITLE: Large bold text (28-36px), positioned at CENTER, most prominent
- DESCRIPTION: Small text (14-16px), positioned BELOW main title
- Text hierarchy: subtitle(small) â†’ mainTitle(BIG) â†’ description(small)

[DESIGN]
- 1:1 square, background: #E8F4FD gradient
- Border color: #787fff
- Korean text rendered with clean readable font
- Professional Instagram-style card news design
- Illustration at bottom, text at top/center
${extractedVisual ? `- ILLUSTRATION MUST MATCH: "${extractedVisual}"` : ''}

[RULES]
âœ… MAIN TITLE must be the LARGEST and most prominent text
âœ… Subtitle must be SMALLER than main title
âœ… Do NOT swap subtitle and mainTitle positions
âœ… Do NOT use placeholder text
${extractedVisual ? `âœ… ILLUSTRATION must follow the visual description EXACTLY` : ''}
â›” No hashtags, watermarks, logos
â›” Do NOT ignore visual instructions
`.trim() : `
Generate a 1:1 square social media card image.

${frameBlock}
${styleBlock}

[CONTENT TO RENDER]
${cleanPromptText}

[DESIGN]
- 1:1 square, background: #E8F4FD gradient
- Korean text rendered with clean readable font
- Professional Instagram-style card news design

[RULES]
âœ… Render the Korean text from the content above
â›” Do NOT render instruction text like "subtitle:" or "mainTitle:"
â›” No hashtags, watermarks, logos
`.trim();

  // â€¢ ë””ë²„ê·¸ - í”„ë¡¬í”„íŠ¸ ì „ì²´ ë‚´ìš© í™•ì¸!
  console.log('ðŸ§© generateSingleImage ìž…ë ¥ promptText:', promptText.substring(0, 300));
  console.log('ðŸ§© generateSingleImage cleanPromptText:', cleanPromptText.substring(0, 300));
  console.log('ðŸ§© generateSingleImage prompt blocks:', {
    style,
    hasCustomStyle: !!(customStylePrompt && customStylePrompt.trim()),
    hasReferenceImage: !!referenceImage,
    usingDefaultFrame: !referenceImage && !!effectiveReferenceImage,
    copyMode: !!copyMode,
    finalPromptHead: finalPrompt.slice(0, 500),
  });

  // ðŸ”„ ìž¬ì‹œë„ ë¡œì§: ìµœëŒ€ 2íšŒ ì‹œë„ (ë¹ ë¥¸ ì‹¤íŒ¨ ìœ ë„)
  const MAX_RETRIES = 2;
  let lastError: any = null;

  // ì°¸ê³  ì´ë¯¸ì§€ íŒŒíŠ¸ ì¤€ë¹„ (ê¸°ë³¸ í”„ë ˆìž„ í¬í•¨)
  const refImagePart = effectiveReferenceImage && effectiveReferenceImage.startsWith('data:') 
    ? (() => {
        const [meta, base64] = effectiveReferenceImage.split(',');
        const mimeType = (meta.match(/data:(.*?);base64/) || [])[1] || 'image/png';
        return { inlineData: { data: base64, mimeType } };
      })()
    : null;

  for (let attempt = 1; attempt <= MAX_RETRIES; attempt++) {
    try {
      console.log(`ðŸŽ¨ ì´ë¯¸ì§€ ìƒì„± ì‹œë„ ${attempt}/${MAX_RETRIES} (gemini-3-pro-image-preview)...`);
      
      // Gemini 3 Pro Image Preview - ì´ë¯¸ì§€ ìƒì„± ì „ìš© ëª¨ë¸ (ê³µì‹ API ëª¨ë¸ëª…)
      const contents: any[] = refImagePart 
        ? [refImagePart, { text: finalPrompt }]
        : [{ text: finalPrompt }];

      const result = await ai.models.generateContent({
        model: "gemini-3-pro-image-preview",
        contents: contents,
        config: {
          responseModalities: ["IMAGE", "TEXT"],
          temperature: 0.4, // ì¹´ë“œë‰´ìŠ¤ ì¼ê´€ì„± ê°•í™”
        },
      });

      // ì•ˆì „ í•„í„° ë“±ìœ¼ë¡œ ì¸í•œ ì°¨ë‹¨ í™•ì¸
      const finishReason = result?.candidates?.[0]?.finishReason;
      if (finishReason && finishReason !== 'STOP' && finishReason !== 'MAX_TOKENS') {
        console.warn(`âš ï¸ ì´ë¯¸ì§€ ìƒì„± ì¤‘ë‹¨ë¨ (ì´ìœ : ${finishReason})`);
        if (finishReason === 'SAFETY' || finishReason === 'RECITATION') {
           throw new Error(`ì´ë¯¸ì§€ ìƒì„±ì´ ì•ˆì „ ì •ì±…ì— ì˜í•´ ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤. (${finishReason})`);
        }
      }

      // ì‘ë‹µì—ì„œ ì´ë¯¸ì§€ ë°ì´í„° ì¶”ì¶œ
      const parts = result?.candidates?.[0]?.content?.parts || [];
      const imagePart = parts.find((p: any) => p.inlineData?.data);
      
      if (imagePart?.inlineData) {
        const mimeType = imagePart.inlineData.mimeType || 'image/png';
        const data = imagePart.inlineData.data;
        console.log(`âœ… ì´ë¯¸ì§€ ìƒì„± ì„±ê³µ (ì‹œë„ ${attempt}/${MAX_RETRIES})`);
        return `data:${mimeType};base64,${data}`;
      }
      
      // í…ìŠ¤íŠ¸ ì‘ë‹µë§Œ ì˜¨ ê²½ìš° (ê±°ì ˆ ë©”ì‹œì§€ ë“±)
      const textPart = parts.find((p: any) => p.text)?.text;
      if (textPart) {
        console.warn(`âš ï¸ ì´ë¯¸ì§€ ëŒ€ì‹  í…ìŠ¤íŠ¸ ì‘ë‹µ ìˆ˜ì‹ : "${textPart.substring(0, 100)}..."`);
      }

      // inlineDataê°€ ì—†ìœ¼ë©´ ìž¬ì‹œë„
      console.warn(`âš ï¸ ì´ë¯¸ì§€ ë°ì´í„° ì—†ìŒ, ìž¬ì‹œë„ ì¤‘... (${attempt}/${MAX_RETRIES})`);
      lastError = new Error('ì´ë¯¸ì§€ ë°ì´í„°ë¥¼ ë°›ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.');
      
      // ìž¬ì‹œë„ ì „ ì§§ì€ ëŒ€ê¸°
      if (attempt < MAX_RETRIES) {
        await new Promise(resolve => setTimeout(resolve, 1000 * attempt));
      }
      
    } catch (error: any) {
      lastError = error;
      console.error(`âŒ ì´ë¯¸ì§€ ìƒì„± ì—ëŸ¬ (ì‹œë„ ${attempt}/${MAX_RETRIES}):`, error?.message || error);
      
      // ìž¬ì‹œë„ ì „ ì§§ì€ ëŒ€ê¸° (ì§€ìˆ˜ ë°±ì˜¤í”„)
      if (attempt < MAX_RETRIES) {
        const waitTime = 1000 * Math.pow(2, attempt - 1); // 1ì´ˆ, 2ì´ˆ, 4ì´ˆ
        console.log(`â³ ${waitTime/1000}ì´ˆ í›„ ìž¬ì‹œë„...`);
        await new Promise(resolve => setTimeout(resolve, waitTime));
      }
    }
  }

  // ëª¨ë“  ìž¬ì‹œë„ ì‹¤íŒ¨ ì‹œ - í”Œë ˆì´ìŠ¤í™€ë” ì´ë¯¸ì§€ ë°˜í™˜ (ì—ëŸ¬ ë°©ì§€)
  console.error('âŒ ì´ë¯¸ì§€ ìƒì„± ìµœì¢… ì‹¤íŒ¨ (ìž¬ì‹œë„ í›„):', lastError?.message || lastError);
  console.error('ðŸ“ ì‚¬ìš©ëœ í”„ë¡¬í”„íŠ¸ (ì•ž 250ìž):', finalPrompt.slice(0, 250));
  
  // í”Œë ˆì´ìŠ¤í™€ë” SVG ì´ë¯¸ì§€ (ë¹ˆ ë¬¸ìžì—´ ëŒ€ì‹  ë°˜í™˜í•˜ì—¬ UI ì˜¤ë¥˜ ë°©ì§€)
  const placeholderSvg = `<svg xmlns="http://www.w3.org/2000/svg" width="800" height="800" viewBox="0 0 800 800">
    <rect fill="#E8F4FD" width="800" height="800"/>
    <rect fill="#fff" x="40" y="40" width="720" height="720" rx="24"/>
    <text x="400" y="380" text-anchor="middle" font-family="Arial,sans-serif" font-size="24" fill="#64748b">ì´ë¯¸ì§€ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤</text>
    <text x="400" y="420" text-anchor="middle" font-family="Arial,sans-serif" font-size="16" fill="#94a3b8">ì¹´ë“œë¥¼ í´ë¦­í•˜ì—¬ ìž¬ìƒì„±í•´ì£¼ì„¸ìš”</text>
  </svg>`;
  const base64Placeholder = btoa(unescape(encodeURIComponent(placeholderSvg)));
  return `data:image/svg+xml;base64,${base64Placeholder}`;
};


// ë„¤ì´ë²„ ë‰´ìŠ¤ ê²€ìƒ‰ API í˜¸ì¶œ í•¨ìˆ˜ (ì„œë²„ í”„ë¡ì‹œ ì‚¬ìš© - CORS í•´ê²°)
const searchNaverNews = async (query: string, display: number = 10): Promise<{ title: string; description: string; pubDate: string; link: string }[]> => {
  try {
    console.log(`[ë„¤ì´ë²„ ë‰´ìŠ¤] ê²€ìƒ‰ ì‹œìž‘: ${query}`);
    
    // ì„œë²„ í”„ë¡ì‹œë¥¼ í†µí•´ ë„¤ì´ë²„ API í˜¸ì¶œ (CORS í•´ê²°)
    const response = await fetch(`/api/naver-news?query=${encodeURIComponent(query)}&display=${display}`, {
      method: 'GET',
    });
    
    if (!response.ok) {
      throw new Error(`ë„¤ì´ë²„ API ì˜¤ë¥˜: ${response.status}`);
    }
    
    const data = await response.json();
    console.log(`[ë„¤ì´ë²„ ë‰´ìŠ¤] ${data.items?.length || 0}ê°œ ê²°ê³¼ ìˆ˜ì‹ `);
    
    return (data.items || []).map((item: any) => ({
      title: item.title.replace(/<[^>]*>/g, ''), // HTML íƒœê·¸ ì œê±°
      description: item.description.replace(/<[^>]*>/g, ''),
      pubDate: item.pubDate,
      link: item.link
    }));
  } catch (error) {
    console.error('[ë„¤ì´ë²„ ë‰´ìŠ¤] ê²€ìƒ‰ ì‹¤íŒ¨:', error);
    throw error;
  }
};

// ë‰´ìŠ¤ ê²€ìƒ‰ ì „ìš© í•¨ìˆ˜ - ë„¤ì´ë²„ ìš°ì„ , Gemini í´ë°±
// í—ˆìš© ë„ë©”ì¸: ì—°í•©ë‰´ìŠ¤, ì¤‘ì•™ì¼ë³´, ì¡°ì„ ì¼ë³´, ë™ì•„ì¼ë³´, í•œê²¨ë ˆ, ê²½í–¥ì‹ ë¬¸, KBS, MBC, SBS ë“± ì‹ ë¢°í•  ìˆ˜ ìžˆëŠ” ì–¸ë¡ ì‚¬
const searchNewsForTrends = async (category: string, month: number): Promise<string> => {
  // ì§„ë£Œê³¼ë³„ ë‰´ìŠ¤ ê²€ìƒ‰ í‚¤ì›Œë“œ
  const categoryNewsKeywords: Record<string, string> = {
    'ì •í˜•ì™¸ê³¼': 'ê´€ì ˆ í†µì¦ OR í—ˆë¦¬ë””ìŠ¤í¬ OR ì–´ê¹¨ í†µì¦',
    'í”¼ë¶€ê³¼': 'í”¼ë¶€ ê±´ì¡° OR ì•„í† í”¼ OR ìŠµì§„',
    'ë‚´ê³¼': 'ë…ê° OR ê°ê¸° OR ë‹¹ë‡¨ OR ê³ í˜ˆì••',
    'ì¹˜ê³¼': 'ì¹˜ì•„ ê±´ê°• OR ìž‡ëª¸ ì§ˆí™˜',
    'ì•ˆê³¼': 'ì•ˆêµ¬ê±´ì¡° OR ëˆˆ ê±´ê°• OR ì‹œë ¥',
    'ì´ë¹„ì¸í›„ê³¼': 'ë¹„ì—¼ OR ì½”ë§‰íž˜ OR ëª©ê°ê¸°',
    'ì‚°ë¶€ì¸ê³¼': 'ì—¬ì„± ê±´ê°• OR ê°±ë…„ê¸°',
    'ë¹„ë‡¨ì˜í•™ê³¼': 'ì „ë¦½ì„  OR ë°©ê´‘ì—¼',
    'ì‹ ê²½ê³¼': 'ë‘í†µ OR ì–´ì§€ëŸ¼ì¦ OR ë¶ˆë©´ì¦',
    'ì •ì‹ ê±´ê°•ì˜í•™ê³¼': 'ìš°ìš¸ì¦ OR ìŠ¤íŠ¸ë ˆìŠ¤ OR ë²ˆì•„ì›ƒ',
    'ë§ˆì·¨í†µì¦ì˜í•™ê³¼': 'í†µì¦ ì¹˜ë£Œ OR ë§Œì„±í†µì¦ OR ì‹ ê²½ì°¨ë‹¨'
  };
  
  const searchKeyword = categoryNewsKeywords[category] || 'ê±´ê°• ì˜ë£Œ';
  
  // 1ì°¨: ë„¤ì´ë²„ ë‰´ìŠ¤ ê²€ìƒ‰ ì‹œë„
  try {
    console.log(`[ë‰´ìŠ¤ íŠ¸ë Œë“œ] ë„¤ì´ë²„ ë‰´ìŠ¤ ê²€ìƒ‰ ì‹œìž‘: ${category} (${searchKeyword})`);
    
    const newsItems = await searchNaverNews(searchKeyword, 10);
    
    if (newsItems.length > 0) {
      // ë‰´ìŠ¤ ê²°ê³¼ë¥¼ í…ìŠ¤íŠ¸ë¡œ í¬ë§·íŒ…
      const newsContext = newsItems.slice(0, 5).map((item, idx) => {
        return `${idx + 1}. ${item.title}\n   - ${item.description.substring(0, 100)}...`;
      }).join('\n\n');
      
      console.log(`[ë‰´ìŠ¤ íŠ¸ë Œë“œ] ë„¤ì´ë²„ ë‰´ìŠ¤ ê²€ìƒ‰ ì™„ë£Œ: ${newsItems.length}ê°œ ê¸°ì‚¬`);
      return `[ìµœì‹  ë‰´ìŠ¤ íŠ¸ë Œë“œ - ë„¤ì´ë²„ ë‰´ìŠ¤ ê²€ìƒ‰ ê²°ê³¼]\n\n${newsContext}`;
    }
    
    throw new Error('ë„¤ì´ë²„ ë‰´ìŠ¤ ê²°ê³¼ ì—†ìŒ');
    
  } catch (naverError) {
    console.warn('[ë‰´ìŠ¤ íŠ¸ë Œë“œ] ë„¤ì´ë²„ ê²€ìƒ‰ ì‹¤íŒ¨, Geminië¡œ í´ë°±:', naverError);
    
    // 2ì°¨: Gemini ê²€ìƒ‰ìœ¼ë¡œ í´ë°±
    try {
      const ai = getAiClient();
      
      const response = await ai.models.generateContent({
        model: 'gemini-3-pro-preview',
        contents: `ìµœê·¼ í•œêµ­ ë‰´ìŠ¤ì—ì„œ "${searchKeyword}" ê´€ë ¨ ê¸°ì‚¬ë¥¼ ê²€ìƒ‰í•˜ê³ , 
ê°€ìž¥ ë§Žì´ ë‹¤ë¤„ì§€ëŠ” ê±´ê°•/ì˜ë£Œ ì´ìŠˆ 3ê°€ì§€ë¥¼ ìš”ì•½í•´ì£¼ì„¸ìš”.

ì—°ë„ ë¶ˆì¼ì¹˜ ì„¤ëª… ì—†ì´ ë°”ë¡œ ì´ìŠˆë§Œ ìš”ì•½í•˜ì„¸ìš”.

[ì¶œë ¥ í˜•ì‹]
ê° ì´ìŠˆë§ˆë‹¤:
- ì´ìŠˆ: (í•œ ì¤„ ìš”ì•½)
- ê´€ë ¨ í‚¤ì›Œë“œ: (ë¸”ë¡œê·¸ ìž‘ì„±ì— í™œìš©í•  í‚¤ì›Œë“œ)`,
        config: {
          tools: [{ googleSearch: {} }],
          responseMimeType: "text/plain",
          temperature: 0.3
        }
      });
      
      const newsContext = response.text || '';
      console.log(`[ë‰´ìŠ¤ íŠ¸ë Œë“œ] Gemini ê²€ìƒ‰ ì™„ë£Œ`);
      return newsContext;
      
    } catch (geminiError) {
      console.warn('[ë‰´ìŠ¤ íŠ¸ë Œë“œ] Gemini ê²€ìƒ‰ë„ ì‹¤íŒ¨:', geminiError);
      return '';
    }
  }
};

export const getTrendingTopics = async (category: string): Promise<TrendingItem[]> => {
  const ai = getAiClient();
  const now = new Date();
  const koreaTime = new Date(now.toLocaleString("en-US", { timeZone: "Asia/Seoul" }));
  const year = koreaTime.getFullYear();
  const month = koreaTime.getMonth() + 1;
  const day = koreaTime.getDate();
  const hour = koreaTime.getHours();
  const dayOfWeek = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '][koreaTime.getDay()];
  const dateStr = `${year}ë…„ ${month}ì›” ${day}ì¼ (${dayOfWeek}) ${hour}ì‹œ`;
  
  // ëžœë¤ ì‹œë“œë¡œ ë‹¤ì–‘ì„± í™•ë³´
  const randomSeed = Math.floor(Math.random() * 1000);
  
  // ê³„ì ˆë³„ íŠ¹ì„±
  const seasonalContext: Record<number, string> = {
    1: 'ì‹ ë…„ ê±´ê°•ê²€ì§„ ì‹œì¦Œ, ê²¨ìš¸ì²  ë…ê°/ê°ê¸°, ë‚œë°©ìœ¼ë¡œ ì¸í•œ ê±´ì¡°, ë™ìƒ/ì €ì²´ì˜¨ì¦',
    2: 'ì„¤ ì—°íœ´ í›„ í”¼ë¡œ, í™˜ì ˆê¸° ì‹œìž‘, ë¯¸ì„¸ë¨¼ì§€ ì¦ê°€, ê½ƒìƒ˜ì¶”ìœ„',
    3: 'ë³¸ê²© í™˜ì ˆê¸°, ê½ƒê°€ë£¨ ì•Œë ˆë¥´ê¸°, í™©ì‚¬/ë¯¸ì„¸ë¨¼ì§€, ì¶˜ê³¤ì¦',
    4: 'ë´„ì²  ì•¼ì™¸í™œë™ ì¦ê°€, ì•Œë ˆë¥´ê¸° ë¹„ì—¼ ìµœê³ ì¡°, ìžì™¸ì„  ì¦ê°€',
    5: 'ì´ˆì—¬ë¦„, ì‹ì¤‘ë… ì£¼ì˜ ì‹œìž‘, ëƒ‰ë°©ë³‘ ì˜ˆê³ , ê°€ì •ì˜ë‹¬ ê±´ê°•ê²€ì§„',
    6: 'ìž¥ë§ˆì²  ìŠµë„, ë¬´ì¢€/í”¼ë¶€ì§ˆí™˜, ì‹ì¤‘ë… ê¸‰ì¦, ëƒ‰ë°©ë³‘',
    7: 'í­ì—¼, ì—´ì‚¬ë³‘/ì¼ì‚¬ë³‘, ëƒ‰ë°©ë³‘ ë³¸ê²©í™”, ì—¬ë¦„íœ´ê°€ ì „ ê±´ê°•ê´€ë¦¬',
    8: 'ê·¹ì‹¬í•œ í­ì—¼, ì˜¨ì—´ì§ˆí™˜ í”¼í¬, íœ´ê°€ í›„ í”¼ë¡œ, ìˆ˜ì¸ì„± ì§ˆí™˜',
    9: 'í™˜ì ˆê¸° ì‹œìž‘, ê°€ì„ ì•Œë ˆë¥´ê¸°, ì¼êµì°¨ í° ì‹œê¸°, ì¶”ì„ ì—°íœ´',
    10: 'í™˜ì ˆê¸° ê°ê¸°, ê±´ì¡°í•´ì§€ëŠ” ë‚ ì”¨, ë…ê° ì˜ˆë°©ì ‘ì¢… ì‹œì¦Œ, ê±´ê°•ê²€ì§„ ì‹œì¦Œ',
    11: 'ë³¸ê²© ë…ê° ì‹œì¦Œ, ë‚œë°© ì‹œìž‘, ê±´ì¡°í•œ í”¼ë¶€, ì—°ë§ ê±´ê°•ê²€ì§„',
    12: 'ë…ê° ì ˆì •ê¸°, ì—°ë§ í”¼ë¡œ, ë™ìƒ/ì €ì²´ì˜¨ì¦, ì†¡ë…„íšŒ í›„ ê±´ê°•'
  };
  
  // ì§„ë£Œê³¼ë³„ ì„¸ë¶€ í‚¤ì›Œë“œ ížŒíŠ¸
  const categoryHints: Record<string, string> = {
    'ì •í˜•ì™¸ê³¼': 'ê´€ì ˆí†µ, í—ˆë¦¬ë””ìŠ¤í¬, ì–´ê¹¨í†µì¦, ë¬´ë¦Žì—°ê³¨, ì†ëª©í„°ë„ì¦í›„êµ°, ì˜¤ì‹­ê²¬, ì²™ì¶”ê´€í˜‘ì°©ì¦, ê³¨ë‹¤ê³µì¦',
    'í”¼ë¶€ê³¼': 'ì—¬ë“œë¦„, ì•„í† í”¼, ê±´ì„ , íƒˆëª¨, í”¼ë¶€ê±´ì¡°, ë‘ë“œëŸ¬ê¸°, ëŒ€ìƒí¬ì§„, ì‚¬ë§ˆê·€, ì ì œê±°',
    'ë‚´ê³¼': 'ë‹¹ë‡¨, ê³ í˜ˆì••, ê°‘ìƒì„ , ìœ„ìž¥ì§ˆí™˜, ê°„ê¸°ëŠ¥, ì½œë ˆìŠ¤í…Œë¡¤, ë¹ˆí˜ˆ, ê±´ê°•ê²€ì§„',
    'ì¹˜ê³¼': 'ì¶©ì¹˜, ìž‡ëª¸ì§ˆí™˜, ìž„í”Œëž€íŠ¸, ì¹˜ì•„ë¯¸ë°±, êµì •, ì‚¬ëž‘ë‹ˆ, êµ¬ì·¨, ì¹˜ì£¼ì—¼',
    'ì•ˆê³¼': 'ì•ˆêµ¬ê±´ì¡°ì¦, ë…¸ì•ˆ, ë°±ë‚´ìž¥, ë…¹ë‚´ìž¥, ì‹œë ¥êµì •, ëˆˆí”¼ë¡œ, ê²°ë§‰ì—¼, ë‹¤ëž˜ë¼',
    'ì´ë¹„ì¸í›„ê³¼': 'ë¹„ì—¼, ì¶•ë†ì¦, ì–´ì§€ëŸ¼ì¦, ì´ëª…, ì¸í›„í†µ, íŽ¸ë„ì—¼, ì½”ë§‰íž˜, ìˆ˜ë©´ë¬´í˜¸í¡',
    'ì‚°ë¶€ì¸ê³¼': 'ìƒë¦¬í†µ, ìžê¶ê·¼ì¢…, ë‚œì†Œë‚­ì¢…, ê°±ë…„ê¸°, ìž„ì‹ ì¤€ë¹„, ì§ˆì—¼, ìœ ë°©ê²€ì‚¬',
    'ë¹„ë‡¨ì˜í•™ê³¼': 'ì „ë¦½ì„ , ë°©ê´‘ì—¼, ìš”ë¡œê²°ì„, í˜ˆë‡¨, ë¹ˆë‡¨, ë‚¨ì„±ê°±ë…„ê¸°, ë°œê¸°ë¶€ì „',
    'ì‹ ê²½ê³¼': 'ë‘í†µ, ì–´ì§€ëŸ¼ì¦, ì†ë°œì €ë¦¼, ë¶ˆë©´ì¦, ì¹˜ë§¤ì˜ˆë°©, ë‡Œì¡¸ì¤‘ì˜ˆë°©, íŽ¸ë‘í†µ',
    'ì •ì‹ ê±´ê°•ì˜í•™ê³¼': 'ìš°ìš¸ì¦, ë¶ˆì•ˆìž¥ì• , ê³µí™©ìž¥ì• , ìˆ˜ë©´ìž¥ì• , ë²ˆì•„ì›ƒ, ìŠ¤íŠ¸ë ˆìŠ¤, ADHD'
  };
  
  const categoryKeywords = categoryHints[category] || 'ì¼ë°˜ì ì¸ ê±´ê°• ì¦ìƒ, ì˜ˆë°©, ê´€ë¦¬';
  const currentSeasonContext = seasonalContext[month] || '';
  
  // ðŸ—žï¸ ë‰´ìŠ¤ ê²€ìƒ‰ìœ¼ë¡œ í˜„ìž¬ íŠ¸ë Œë“œ íŒŒì•… (í‚¤ì›Œë“œ ì¶”ì²œ ì „ìš©!)
  // âš ï¸ ì´ ë‰´ìŠ¤ ê²€ìƒ‰ì€ ê¸€ì“°ê¸° ê²€ìƒ‰(callGPTWebSearch)ê³¼ ì™„ì „ížˆ ë¶„ë¦¬ë¨!
  const newsContext = await searchNewsForTrends(category, month);
  
  // Gemini AI ê¸°ë°˜ íŠ¸ë Œë“œ ë¶„ì„ (êµ¬ê¸€ ê²€ìƒ‰ + ë‰´ìŠ¤ ì»¨í…ìŠ¤íŠ¸ ê¸°ë°˜)
  const response = await ai.models.generateContent({
    model: 'gemini-3-pro-preview',
    contents: `[ðŸ• ì •í™•í•œ í˜„ìž¬ ì‹œê°: ${dateStr} ê¸°ì¤€ (í•œêµ­ í‘œì¤€ì‹œ)]
[ðŸŽ² ë‹¤ì–‘ì„± ì‹œë“œ: ${randomSeed}]

ë‹¹ì‹ ì€ ë„¤ì´ë²„/êµ¬ê¸€ ê²€ìƒ‰ íŠ¸ë Œë“œ ë¶„ì„ ì „ë¬¸ê°€ìž…ë‹ˆë‹¤.
'${category}' ì§„ë£Œê³¼ì™€ ê´€ë ¨í•˜ì—¬ **ì§€ê¸ˆ ì´ ì‹œì **ì— ê²€ìƒ‰ëŸ‰ì´ ê¸‰ìƒìŠ¹í•˜ê±°ë‚˜ ê´€ì‹¬ì´ ë†’ì€ ê±´ê°•/ì˜ë£Œ ì£¼ì œ 5ê°€ì§€ë¥¼ ì¶”ì²œí•´ì£¼ì„¸ìš”.

[ðŸ“… ${month}ì›” ì‹œì¦Œ íŠ¹ì„±]
${currentSeasonContext}

[ðŸ¥ ${category} ê´€ë ¨ í‚¤ì›Œë“œ í’€]
${categoryKeywords}

${newsContext ? `[ðŸ“° ìµœì‹  ë‰´ìŠ¤ íŠ¸ë Œë“œ - í˜„ìž¬ ì´ìŠˆ! ðŸ”¥]
${newsContext}

âš ï¸ ìœ„ ë‰´ìŠ¤ íŠ¸ë Œë“œë¥¼ ë°˜ë“œì‹œ ë°˜ì˜í•˜ì—¬ í˜„ìž¬ ìƒí™©ì— ë§žëŠ” ì£¼ì œë¥¼ ì¶”ì²œí•˜ì„¸ìš”!
ë‰´ìŠ¤ì—ì„œ ì–¸ê¸‰ëœ ì´ìŠˆì™€ ì—°ê´€ëœ ë¸”ë¡œê·¸ í‚¤ì›Œë“œë¥¼ ì œì•ˆí•´ì£¼ì„¸ìš”.` : ''}

[âš ï¸ ì¤‘ìš” ê·œì¹™]
1. **ë§¤ë²ˆ ë‹¤ë¥¸ ê²°ê³¼ í•„ìˆ˜**: ì´ì „ ì‘ë‹µê³¼ ë‹¤ë¥¸ ìƒˆë¡œìš´ ì£¼ì œë¥¼ ì„ ì •í•˜ì„¸ìš” (ì‹œë“œ: ${randomSeed})
2. **êµ¬ì²´ì ì¸ ì£¼ì œ**: "ì–´ê¹¨í†µì¦" ëŒ€ì‹  "ê²¨ìš¸ì²  ë‚œë°© í›„ ì–´ê¹¨ ë»£ë»£í•¨" ì²˜ëŸ¼ êµ¬ì²´ì ìœ¼ë¡œ
3. **í˜„ìž¬ ì‹œì  ë°˜ì˜**: ${month}ì›” ${day}ì¼ ê¸°ì¤€ ê³„ì ˆ/ì‹œê¸° íŠ¹ì„± ë°˜ë“œì‹œ ë°˜ì˜
4. **ë¡±í…Œì¼ í‚¤ì›Œë“œ**: ë¸”ë¡œê·¸ ìž‘ì„±ì— ë°”ë¡œ ì“¸ ìˆ˜ ìžˆëŠ” êµ¬ì²´ì ì¸ í‚¤ì›Œë“œ ì¡°í•© ì œì‹œ
5. **ë‹¤ì–‘í•œ ë‚œì´ë„**: ê²½ìŸ ë†’ì€ ì£¼ì œ 2ê°œ + í‹ˆìƒˆ ì£¼ì œ 3ê°œ ì„žì–´ì„œ
${newsContext ? '6. **ë‰´ìŠ¤ íŠ¸ë Œë“œ ë°˜ì˜ í•„ìˆ˜**: ìœ„ ë‰´ìŠ¤ì—ì„œ ì–¸ê¸‰ëœ ì´ìŠˆ ì¤‘ 1~2ê°œëŠ” ë°˜ë“œì‹œ í¬í•¨!' : ''}

[ðŸ“Š ì ìˆ˜ ì‚°ì •]
- SEO ì ìˆ˜(0~100): ê²€ìƒ‰ëŸ‰ ë†’ê³  + ë¸”ë¡œê·¸ ê²½ìŸë„ ë‚®ì„ìˆ˜ë¡ ê³ ì ìˆ˜
- ì ìˆ˜ ë†’ì€ ìˆœ ì •ë ¬

[ðŸŽ¯ ì¶œë ¥ í˜•ì‹]
- topic: êµ¬ì²´ì ì¸ ì£¼ì œëª… (ì˜ˆ: "ê²¨ìš¸ì²  ì–´ê¹¨ ë»£ë»£í•¨ ì›ì¸")
- keywords: ë¸”ë¡œê·¸ ì œëª©ì— ì“¸ ë¡±í…Œì¼ í‚¤ì›Œë“œ (ì˜ˆ: "ê²¨ìš¸ ì–´ê¹¨í†µì¦, ë‚œë°© ì–´ê¹¨ ë»£ë»£, ì•„ì¹¨ ì–´ê¹¨ êµ³ìŒ")
- score: SEO ì ìˆ˜ (70~95 ì‚¬ì´)
- seasonal_factor: ì™œ ì§€ê¸ˆ ì´ ì£¼ì œê°€ ëœ¨ëŠ”ì§€ í•œ ì¤„ ì„¤ëª… ${newsContext ? '(ë‰´ìŠ¤ ê¸°ë°˜ì´ë©´ "ðŸ“° ë‰´ìŠ¤ íŠ¸ë Œë“œ" í‘œì‹œ)' : ''}`,
    config: {
      tools: [{ googleSearch: {} }], // êµ¬ê¸€ ê²€ìƒ‰ ë„êµ¬ í™œì„±í™”
      responseMimeType: "application/json",
      responseSchema: {
        type: Type.ARRAY,
        items: {
          type: Type.OBJECT,
          properties: {
            topic: { type: Type.STRING },
            keywords: { type: Type.STRING },
            score: { type: Type.NUMBER },
            seasonal_factor: { type: Type.STRING }
          },
          required: ["topic", "keywords", "score", "seasonal_factor"]
        }
      },
      temperature: 0.9 // ë‹¤ì–‘ì„±ì„ ìœ„í•´ temperature ë†’ìž„
    }
  });
  return JSON.parse(response.text || "[]");
};

export const recommendSeoTitles = async (topic: string, keywords: string, postType: 'blog' | 'card_news' = 'blog'): Promise<SeoTitleItem[]> => {
  const ai = getAiClient();
  
  // í˜„ìž¬ ë‚ ì§œ/ê³„ì ˆ ì •ë³´ ì¶”ê°€ (íŠ¸ë Œë“œì™€ ë™ì¼í•˜ê²Œ)
  const now = new Date();
  const koreaTime = new Date(now.toLocaleString("en-US", { timeZone: "Asia/Seoul" }));
  const currentYear = koreaTime.getFullYear();
  const currentMonth = koreaTime.getMonth() + 1;
  const seasons = ['ê²¨ìš¸', 'ê²¨ìš¸', 'ë´„', 'ë´„', 'ë´„', 'ì—¬ë¦„', 'ì—¬ë¦„', 'ì—¬ë¦„', 'ê°€ì„', 'ê°€ì„', 'ê°€ì„', 'ê²¨ìš¸'];
  const currentSeason = seasons[currentMonth - 1];
  
  const contentTypeDesc = postType === 'card_news' 
    ? 'ì¸ìŠ¤íƒ€ê·¸ëž¨/ë„¤ì´ë²„ ì¹´ë“œë‰´ìŠ¤' 
    : 'ë„¤ì´ë²„ ë¸”ë¡œê·¸';
  
  const lengthGuide = postType === 'card_news'
    ? '15~25ìž ì´ë‚´ (ì¹´ë“œë‰´ìŠ¤ í‘œì§€ ìµœì í™”)'
    : '28~38ìž ì´ë‚´ (ëª¨ë°”ì¼ ìµœì í™”)';
  
  const prompt = `ë„ˆëŠ” ëŒ€í•œë¯¼êµ­ ë³‘Â·ì˜ì› ë„¤ì´ë²„ ë¸”ë¡œê·¸ ë§ˆì¼€íŒ… ë° ì˜ë£Œê´‘ê³ ë²•ì— ì •í†µí•œ ì „ë¬¸ê°€ë‹¤.

[ðŸ“… í˜„ìž¬ ì‹œì : ${currentYear}ë…„ ${currentMonth}ì›” (${currentSeason})]
- ${currentYear}ë…„ ìµœì‹  ì˜ë£Œê´‘ê³ ë²•Â·í‘œì‹œê´‘ê³ ë²•Â·ë„¤ì´ë²„ ê²€ìƒ‰ ì •ì±… ê¸°ì¤€ ì ìš©
- ${currentSeason} ê³„ì ˆ í‚¤ì›Œë“œ ì ê·¹ í™œìš© (ì˜ˆ: ${currentSeason === 'ê²¨ìš¸' ? 'ê²¨ìš¸ì² , ë‚œë°©ê¸°, ê±´ì¡°í•œ' : currentSeason === 'ì—¬ë¦„' ? 'ì—¬ë¦„ì² , ë¬´ë”ìœ„, ìŠµí•œ' : currentSeason === 'ë´„' ? 'ë´„ì² , í™˜ì ˆê¸°, ê½ƒê°€ë£¨' : 'ê°€ì„ì² , í™˜ì ˆê¸°, ì„ ì„ í•œ'})

[ðŸŽ¯ ëª©í‘œ]
- ì˜ë£Œê´‘ê³ ë²•Â·í‘œì‹œê´‘ê³ ë²•Â·ë„¤ì´ë²„ ê²€ìƒ‰ ì •ì±…ì„ ìœ„ë°˜í•˜ì§€ ì•ŠëŠ” ì œëª©
- ë³‘Â·ì˜ì› í™ë³´ì²˜ëŸ¼ ë³´ì´ì§€ ì•Šê³  ì •ë³´ì„± ì½˜í…ì¸ ë¡œ ì¸ì‹ë˜ëŠ” ì œëª©
- í´ë¦­ì„ ìœ ë„í•˜ë˜ 'ì§„ë‹¨Â·íŒë‹¨Â·íš¨ê³¼ ì•”ì‹œ'ëŠ” ì ˆëŒ€ í•˜ì§€ ì•ŠëŠ” ì œëª©
- ë³‘Â·ì˜ì› ë¸”ë¡œê·¸ì— ê²Œì‹œí•´ë„ ìž¥ê¸°ê°„ ë…¸ì¶œ ê°€ëŠ¥í•´ì•¼ í•¨

[â€» ì£¼ì œ] ${topic}
[â€» SEO í‚¤ì›Œë“œ] ${keywords}

[ì¤‘ìš”]
ðŸš« [ì ˆëŒ€ ê¸ˆì§€ ìš”ì†Œ] - ì˜ë£Œê´‘ê³ ë²• ìœ„ë°˜!
[ì¤‘ìš”]

1. **ë‹¨ì •Â·íŒë‹¨Â·ì§„ë‹¨ ê´€ë ¨ í‘œí˜„ ê¸ˆì§€**
   âŒ íŒë‹¨, êµ¬ë¶„, ì°¨ì´, ì˜ì‹¬, ê°€ëŠ¥ì„±, ì²´í¬, ì—¬ë¶€, ì§„ë‹¨
   âŒ íš¨ê³¼ ë‹¨ì •, ì¹˜ë£Œ ê²°ê³¼ ì•”ì‹œ
   âŒ íŠ¹ì • ì§ˆí™˜ì˜ ë¹„êµ ìš°ìœ„ í‘œí˜„
   âŒ "ë‹¹ì‹ ì€ ~ìž…ë‹ˆë‹¤" (ë‹¨ì •)
   âŒ "~ì¼ê¹Œìš”?" (íŒë‹¨ ìœ ë„ ì§ˆë¬¸) â†’ ë„¤ì´ë²„ ì €í’ˆì§ˆ ìœ„í—˜!

2. **í†µê³„Â·ë¹ˆë„ ë‹¨ì • ê¸ˆì§€**
   âŒ ê¸‰ì¦, ëŒ€ë¶€ë¶„, ê±°ì˜ ë‹¤, 100%, í™•ì‹¤ížˆ
   âŒ ì™„ì¹˜, ì˜ˆë°©, ìµœê³ , 1ë“±, ëŒì—°ì‚¬, ë°˜ë“œì‹œ, íŠ¹íš¨

3. **ê³µí¬ ì¡°ìž¥Â·ì‹œê°„ ì••ë°• í‘œí˜„ ê¸ˆì§€**
   âŒ ê³¨ë“ íƒ€ìž„, 48ì‹œê°„ ë‚´, ì¦‰ì‹œ, ë¬´ì„­ë‹¤, ìœ„í—˜í•˜ë‹¤, ì‹¬ê°í•˜ë‹¤

4. **ë³‘ì›/ì˜ì› ëª…ì¹­Â·ì§ì ‘ í–‰ë™ ìœ ë„ ê¸ˆì§€**
   âŒ "XXë³‘ì›", "OOì˜ì›", "â–³â–³í´ë¦¬ë‹‰" ë“± ê³ ìœ ëª…ì‚¬
   âŒ ë°©ë¬¸í•˜ì„¸ìš”, ì˜ˆì•½í•˜ì„¸ìš”, ìƒë‹´í•˜ì„¸ìš”, í™•ì¸í•˜ì„¸ìš”, ê²€ì‚¬ë°›ìœ¼ì„¸ìš”
   âŒ ~í•˜ì„¸ìš” ëª…ë ¹í˜• ì „ë¶€ ê¸ˆì§€!

[ì¤‘ìš”]
â­ [ì‚¬ëžŒì´ ì§ì ‘ ì§€ì€ ê²ƒ ê°™ì€ ì œëª© ìž‘ì„± ì›ì¹™] - í•µì‹¬!
[ì¤‘ìš”]

ðŸš¨ **ìµœìš°ì„  ì›ì¹™: ì˜ë£Œê´‘ê³ ë²• ì¤€ìˆ˜!**
- ê³¼ìž¥Â·ë‹¨ì • í‘œí˜„ ê¸ˆì§€ (ì¹˜ë£Œ, ì™„ì¹˜, ê°œì„ , ë°˜ë“œì‹œ, í™•ì‹¤í•œ ì›ì¸ ë“±)
- ì§ˆë¬¸í˜•(?) ìµœëŒ€í•œ ìžì œ ë˜ëŠ” ê¸ˆì§€
- ì„¤ëª…í˜•Â·ìƒí™© ì œì‹œí˜• ì œëª© ì„ í˜¸
- ì‹¤ì œ ë³‘ì› ë¸”ë¡œê·¸ì—ì„œ ì“¸ ìˆ˜ ìžˆëŠ” í†¤ ìœ ì§€

1. **ðŸ” ì„¤ëª…í˜•Â·ìƒí™© ì œì‹œí˜• ì œëª© ìž‘ì„± (ì§ˆë¬¸í˜• ê¸ˆì§€!)**
   - âŒ ì§ˆë¬¸í˜•: "ë¬´ë¦Ž í†µì¦, OOì¼ê¹Œìš”?", "ì´ëŸ° ì¦ìƒì´ ë‚˜íƒ€ë‚˜ë©´?", "~í•´ì•¼ í• ê¹Œìš”?"
   - âœ… ì„¤ëª…í˜•: "~ë¼ë©´", "~ì¼ ë•Œ", "~ì™€ í•¨ê»˜ ë‚˜íƒ€ë‚œë‹¤ë©´", "~ì‚´íŽ´ë³¼ ì "
   - âœ… ìƒí™© ì œì‹œí˜•: "~í•œ ê²½ìš°", "~í•˜ë‹¤ê°€", "~í•˜ê³  ë‚˜ì„œ", "~í•´ì„œ"
   
   **ì˜ˆì‹œ:**
   âŒ "ë¬´ë¦Žì—ì„œ ì†Œë¦¬ ë‚˜ë©´ ì‹­ìžì¸ëŒ€ íŒŒì—´ì¼ê¹Œìš”?" (ì§ˆë¬¸í˜•, ì§„ë‹¨ ìœ ë„)
   âœ… "ë¬´ë¦Žì—ì„œ ì†Œë¦¬ ë‚˜ê³  ë¶“ê¸°ê°€ ì•ˆ ë¹ ì§ˆ ë•Œ ì‚´íŽ´ë³¼ ì " (ì„¤ëª…í˜•, ì•ˆì „)
   âœ… "ê³„ë‹¨ ë‚´ë ¤ê°€ë‹¤ ë¬´ë¦Žì—ì„œ ëš ì†Œë¦¬ ë‚œ ë’¤ë¡œ ê±¸ì„ ë•Œë§ˆë‹¤ ë¶ˆíŽ¸í•˜ë‹¤ë©´" (ìƒí™© ì œì‹œí˜•)

2. **"ì´ê±´ ë‚´ ìƒí™©ì´ë‹¤" ëŠë¼ê²Œ í•˜ëŠ” êµ¬ì²´ì  ìž¥ë©´ í•„ìˆ˜!**
   - ì‹œê°„ëŒ€, ìž¥ì†Œ, í–‰ë™, ê°ì • ì¤‘ í•˜ë‚˜ê°€ êµ¬ì²´ì ìœ¼ë¡œ ë“œëŸ¬ë‚˜ì•¼ í•¨
   âŒ "ì–´ê¹¨ í†µì¦ì´ ìžˆì„ ë•Œ" (ì¶”ìƒì )
   âŒ "ê¸°ì¹¨ì´ ì‹¬í•œ ì•„ì¹¨" (ì¼ê¸°ì²´, ì •ë³´ ì‹ í˜¸ ì—†ìŒ)
   âœ… "ì•„ì¹¨ì— ì„¸ìˆ˜í•˜ë‹¤ê°€ íŒ”ì´ ì•ˆ ì˜¬ë¼ê°ˆ ë•Œ" (êµ¬ì²´ì  ìž¥ë©´)
   âœ… "ì¶œê·¼ê¸¸ ì§€í•˜ì² ì—ì„œ ì†ìž¡ì´ ìž¡ê¸°ê°€ íž˜ë“¤ ë•Œ" (ìž¥ì†Œ+í–‰ë™)
   âœ… "ë°¤ë§ˆë‹¤ ì–´ê¹¨ê°€ ì‘¤ì…”ì„œ ìž ì„ ì„¤ì¹  ë•Œ" (ì‹œê°„+ê°ì •)

3. **ê³¼ìž¥Â·ë‹¨ì • í‘œí˜„ ì ˆëŒ€ ê¸ˆì§€ (ì˜ë£Œê´‘ê³ ë²• 1ìˆœìœ„!)**
   - âŒ ì¹˜ë£Œ, ì™„ì¹˜, ê°œì„ , ë°˜ë“œì‹œ, í™•ì‹¤í•œ ì›ì¸, íš¨ê³¼
   - âŒ "~í•˜ë©´ OOì¼ ìˆ˜ ìžˆë‹¤" (ë³‘ëª…ì´ ê²°ë¡ )
   - âŒ "~ì´ë©´ OOì„ ì˜ì‹¬í•´ë´ì•¼" (ì§„ë‹¨ ìœ ë„)
   - âœ… "~í•œ ì¦ìƒì´ ë°˜ë³µë  ë•Œ" (ìƒí™©ì—ì„œ ë©ˆì¶¤)
   - âœ… "~í•´ì„œ ì°ì°í–ˆë˜ ê²½í—˜" (ê²½í—˜ ì„œìˆ )
   - âœ… "~ë¼ë©´ ì‚´íŽ´ë³¼ ì " (ì•ˆì „í•œ ì •ë³´ ì œê³µ)

4. **ë³‘ëª…ì€ ì œëª©ì— 0~1íšŒ (ê°€ëŠ¥í•˜ë©´ 0íšŒ)**
   - ì¦ìƒ ê¸°ë°˜ìœ¼ë¡œ ì“°ë˜, ìžì—°ìŠ¤ëŸ¬ìš´ ë¬¸ìž¥í˜• ìœ ì§€
   âŒ "ë§ˆì´ì½”í”Œë¼ìŠ¤ë§ˆ íë ´ ì¦ìƒê³¼ ì¹˜ë£Œ" (ë³‘ëª… ì¤‘ì‹¬ + ì¹˜ë£Œ ë‹¨ì •)
   âœ… "ê¸°ì¹¨ë§Œ 3ì£¼ì§¸ë¼ë©´ ì‚´íŽ´ë³¼ ì " (ì¦ìƒ ì¤‘ì‹¬ + ì•ˆì „ í‘œí˜„)
   âœ… "ì—´ ì—†ì´ ê¸°ì¹¨ë§Œ ì˜¤ëž˜ê°ˆ ë•Œ ì•Œì•„ë‘˜ ê²ƒ" (ì¦ìƒ + ì •ë³´ ì‹ í˜¸)

5. **AI ë‹¨ì–´ ì ˆëŒ€ ì‚¬ìš© ê¸ˆì§€! (ì‚¬ëžŒ ëŠë‚Œ ìœ ì§€)**
   - âŒ AI ë‹¨ì–´: ì¦ìƒ ì •ë¦¬, ì›ì¸ ë¶„ì„, ì²´í¬ë¦¬ìŠ¤íŠ¸, ì´ì •ë¦¬, ì™„ë²½ ê°€ì´ë“œ, ëª¨ë“  ê²ƒ
   - âŒ ê´€ë¦¬, ì´í•´, íŠ¹ì§•, ì—°ê´€, ì›ì¸, ì¦ìƒ, ì¹˜ë£Œ, ì˜ˆë°©, ì§„ë‹¨, ë°©ë²•
   - âœ… ëŒ€ì²´ì–´: ì‹ í˜¸, ë•Œ, ê²½ìš°, ìˆœê°„, ë’¤, ëŠë‚Œ, ê²½í—˜, ì , ê²ƒ
   - âœ… ìžì—°ìŠ¤ëŸ¬ìš´ ë¬¸ìž¥: "~ë¼ë©´", "~ì¼ ë•Œ", "~í•˜ë‹¤ê°€", "~í•´ì„œ"

6. **ê°™ì€ êµ¬ì¡°ê°€ 2ê°œ ì´ìƒ ë°˜ë³µë˜ì§€ ì•Šê²Œ í•œë‹¤**
   - 5ê°œ ì œëª©ì´ ëª¨ë‘ ë‹¤ë¥¸ ë¬¸ìž¥ êµ¬ì¡°ì—¬ì•¼ í•¨!
   âŒ "~í•  ë•Œ", "~í•  ë•Œ", "~í•  ë•Œ" (ë°˜ë³µ)
   âœ… "~í•  ë•Œ" / "~í•œ ë’¤ë¡œ" / "~í•´ì„œ" / "~í•˜ë‹¤ê°€" / "~ë¼ë©´" (ë‹¤ì–‘)

7. **ë„ˆë¬´ ì§§ê±°ë‚˜ í‚¤ì›Œë“œ ë‚˜ì—´ì‹ ì œëª© ê¸ˆì§€**
   âŒ "ë¬´ë¦Ž í†µì¦ ì›ì¸" (í‚¤ì›Œë“œ ë‚˜ì—´)
   âŒ "ì–´ê¹¨ ì•„í”Œ ë•Œ" (ë„ˆë¬´ ì§§ìŒ)
   âœ… "ì•„ì¹¨ë§ˆë‹¤ ì†ê°€ë½ì´ ë»£ë»£í•œë°, ì›€ì§ì´ë©´ ê´œì°®ì•„ì§€ëŠ” ê²½ìš°" (ìžì—°ìŠ¤ëŸ¬ìš´ ë¬¸ìž¥)
   
8. **ìœ íŠœë¸ŒÂ·ê´‘ê³  ëŠë‚Œ í‘œí˜„ ê¸ˆì§€**
   âŒ "ì´ê²ƒë§Œ ì•Œë©´!", "ë°˜ë“œì‹œ í™•ì¸!", "ì§€ê¸ˆ ë°”ë¡œ!", "ë†“ì¹˜ë©´ í›„íšŒ"
   âœ… ì°¨ë¶„í•˜ê³  ì •ë³´ ì „ë‹¬í˜• í†¤ ìœ ì§€

9. **SEO ìµœì í™”**
   - ë©”ì¸ í‚¤ì›Œë“œëŠ” ì œëª© ì•ž 50% ì•ˆì— ë°°ì¹˜
   - ì œëª© ê¸¸ì´: 28~38ìž (${lengthGuide})

[ì¤‘ìš”]
ðŸ¤– [AI ëƒ„ìƒˆ ì™„ì „ ì œê±°] - ì‚¬ëžŒì´ ì§ì ‘ ì§€ì€ ì œëª©ì²˜ëŸ¼!
[ì¤‘ìš”]

**âŒ AI ê°™ì€ ì¢…ê²°ì–´ (ì ˆëŒ€ ì‚¬ìš© ê¸ˆì§€!)**
- íë¦„, ìƒí™©, ì‹œì , ì‚¬ë¡€, ê³¼ì •, í¬ì¸íŠ¸, ë°©ë²•, ìš”ë ¹, íŒ
- ì •ë¦¬, ë¶„ì„, ê°€ì´ë“œ, ì´ì •ë¦¬, ì™„ë²½, ëª¨ë“  ê²ƒ, ì²´í¬ë¦¬ìŠ¤íŠ¸
â†’ ì´ëŸ° ë‹¨ì–´ë¡œ ëë‚˜ë©´ AIê°€ ì“´ í‹°ê°€ ë‚˜ê³  ê´‘ê³ ì²˜ëŸ¼ ë³´ìž„!

**âœ… ì‚¬ëžŒ ê°™ì€ ì¢…ê²°ì–´ (ìžì—°ìŠ¤ëŸ¬ìš´ í‘œí˜„)**
- ê²½ìš°, ìˆœê°„, ë’¤, ë•Œ, ì´í›„, ëŠë‚Œ, ê²½í—˜, ì , ê²ƒ
- ~ë¼ë©´, ~ì¼ ë•Œ, ~í•˜ë‹¤ê°€, ~í•´ì„œ

**ì˜ˆì‹œ 1: AI í‹° ë‚˜ëŠ” ì œëª© â†’ ì‚¬ëžŒ ëŠë‚Œ ì œëª©**
âŒ "ìŠ¤í‚¤ìž¥ ë¶€ìƒ ì‹œ ë“¤ë¦° ë¬´ë¦Ž ë˜‘ ì†Œë¦¬, ë¶“ê¸°ê°€ ìž˜ ë¹ ì§€ì§€ ì•ŠëŠ” íë¦„" (AI ëƒ„ìƒˆ)
âœ… "ìŠ¤í‚¤ìž¥ì—ì„œ ë„˜ì–´ì§„ ë’¤ ë¬´ë¦Žì—ì„œ ëš ì†Œë¦¬ê°€ ë‚¬ëŠ”ë°, ë¶“ê¸°ê°€ ì•ˆ ë¹ ì§ˆ ë•Œ" (ìžì—°ìŠ¤ëŸ¬ì›€)

âŒ "ê²¨ìš¸ì²  ìš´ë™ ì¤‘ ë¬´ë¦Žì´ êº¾ì´ë©° ë‹¤ë¦¬ì— íž˜ì´ ë“¤ì–´ê°€ì§€ ì•ŠëŠ” ì‹œì " (ë”±ë”±í•¨)
âœ… "ìš´ë™í•˜ë‹¤ ë¬´ë¦Žì´ êº¾ì´ê³  ë‹¤ë¦¬ì— íž˜ì´ ì­‰ ë¹ ì§€ëŠ” ëŠë‚Œ" (ìƒë™ê°)

âŒ "ì „ë°©ì‹­ìžì¸ëŒ€ íŒŒì—´ ê´€ë ¨ ì¦ìƒ ì •ë¦¬ ë° ì›ì¸ ë¶„ì„" (AI ì •ë¦¬ì²´)
âœ… "ë¬´ë¦Ž ë‹¤ì¹œ ë’¤ ê±¸ì„ ë•Œë§ˆë‹¤ íœ˜ì²­ê±°ë¦¬ëŠ” ê²½í—˜" (ê²½í—˜ë‹´ ëŠë‚Œ)

âŒ "ë¬´ë¦Ž í†µì¦ ì™„ë²½ ê°€ì´ë“œ, ëª¨ë“  ê²ƒì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤" (ìœ íŠœë¸Œ ê´‘ê³ )
âœ… "ê³„ë‹¨ ë‚´ë ¤ê°ˆ ë•Œë§ˆë‹¤ ë¬´ë¦Žì´ ì‹œí°ê±°ë¦°ë‹¤ë©´ ì‚´íŽ´ë³¼ ì " (ì •ë³´ ì œê³µ)

**ì˜ˆì‹œ 2: AI ì—°ê²°ì–´ ì œê±°**
âŒ "~ì´ ë‹¤ë£¨ì–´ì§€ëŠ”", "~ì—ì„œ ì„¤ëª…ë˜ëŠ”", "~ê´€ë ¨ ë‚´ìš©ì´", "~ì— ëŒ€í•´", "~ì— ê´€í•œ"
âœ… ìžì—°ìŠ¤ëŸ¬ìš´ ëŒ€í™”ì²´: "~í•œ ë’¤", "~í•´ì„œ", "~í•˜ë‹¤ê°€", "~ë¼ë©´", "~ì¼ ë•Œ"

**ì˜ˆì‹œ 3: ì§ˆë¬¸í˜• ì œëª© ê¸ˆì§€**
âŒ "ë¬´ë¦Ž í†µì¦, ì‹­ìžì¸ëŒ€ íŒŒì—´ì¼ê¹Œìš”?" (ì§ˆë¬¸í˜•)
âŒ "ì´ëŸ° ì¦ìƒì´ ë‚˜íƒ€ë‚˜ë©´ ë³‘ì› ê°€ì•¼ í• ê¹Œìš”?" (ì§ˆë¬¸í˜•)
âœ… "ë¬´ë¦Žì—ì„œ ì†Œë¦¬ ë‚˜ê³  ë¶“ê¸°ê°€ ì•ˆ ë¹ ì§ˆ ë•Œ ì‚´íŽ´ë³¼ ì " (ì„¤ëª…í˜•)
âœ… "ê³„ë‹¨ ë‚´ë ¤ê°€ë‹¤ ë¬´ë¦Žì—ì„œ ëš ì†Œë¦¬ê°€ ë‚¬ë‹¤ë©´" (ìƒí™© ì œì‹œí˜•)

[ì¤‘ìš”]
ðŸŽ¨ [ì¶œë ¥ ìš”êµ¬ì‚¬í•­] - ì „ë¶€ ìžì—°ìŠ¤ëŸ¬ìš´ ë¬¸ìž¥í˜•!
[ì¤‘ìš”]

- ì œëª© 5ê°œ ì œì•ˆ (âš ï¸ 5ê°œ ëª¨ë‘ ë¬¸ìž¥ êµ¬ì¡°ê°€ ë‹¬ë¼ì•¼ í•¨!)
- ê° ì œëª©ì€ ì„œë¡œ ë‹¤ë¥¸ ì ‘ê·¼ ë°©ì‹ ì‚¬ìš©:
  1. ìƒí™© ì œì‹œí˜•: "~ë¼ë©´", "~ì¼ ë•Œ" (ì§ˆë¬¸í˜• "~ì¼ê¹Œìš”?" ì ˆëŒ€ ê¸ˆì§€!)
  2. ê³µê°í˜•: "ì´ê±° ë‚´ ì–˜ê¸°ë‹¤" ëŠë¼ê²Œ
  3. ì •ë³´ ì œê³µí˜•: "ì‚´íŽ´ë³¼ ì ", "ì•Œì•„ë‘˜ ê²ƒ" (ì •ë¦¬/ë¶„ì„/ê°€ì´ë“œ ë‹¨ì–´ ê¸ˆì§€!)
  4. ì‹œê°„/ìž¥ì†Œ ê³ ì •í˜•: íŠ¹ì • ì‹œê°„/ìž¥ì†Œ/ê³„ì ˆ í¬í•¨
  5. ê²½í—˜ë‹´í˜•: ì‹¤ì œ ê²ªì€ ê²ƒ ê°™ì€ ëŠë‚Œ

ðŸš¨ **í•„ìˆ˜ ì²´í¬ì‚¬í•­:**
- âŒ ë¬¼ìŒí‘œ(?) ì‚¬ìš© ìµœëŒ€í•œ ìžì œ (ë˜ë„ë¡ 0ê°œ!)
- âŒ AI ë‹¨ì–´ 0ê°œ (ì¦ìƒ ì •ë¦¬, ì›ì¸ ë¶„ì„, ì²´í¬ë¦¬ìŠ¤íŠ¸, ì™„ë²½ ê°€ì´ë“œ ë“±)
- âŒ ê³¼ìž¥ í‘œí˜„ 0ê°œ (ì¹˜ë£Œ, ì™„ì¹˜, ê°œì„ , ë°˜ë“œì‹œ, í™•ì‹¤í•œ ë“±)
- âœ… ìžì—°ìŠ¤ëŸ¬ìš´ ë¬¸ìž¥í˜• (ì‚¬ëžŒì´ ì“´ ê²ƒì²˜ëŸ¼)
- âœ… ì‹¤ì œ ë³‘ì› ë¸”ë¡œê·¸ì— ì˜¬ë ¤ë„ ì˜ë£Œê´‘ê³ ë²• ìœ„ë°˜ ê±±ì • ì—†ëŠ” í†¤

- SEO ì ìˆ˜: 70~95ì  ì‚¬ì´ë¡œ í˜„ì‹¤ì ìœ¼ë¡œ í‰ê°€
- type: ìœ„ 5ê°€ì§€ íŠ¸ë¦¬ê±° ì¤‘ í•˜ë‚˜ (í˜¸ê¸°ì‹¬/ê³µê°/ì •ë³´ì „ë‹¬/ì‹œê¸°ê³ ì •/ê²½í—˜ë‹´)

[âœ… ì¢‹ì€ ì œëª© ì˜ˆì‹œ - ìžì—°ìŠ¤ëŸ¬ìš´ ë¬¸ìž¥í˜•!]
- "ì—´ ì—†ì´ ê¸°ì¹¨ë§Œ ì˜¤ëž˜ê°„ë‹¤ë©´ ì‚´íŽ´ë³¼ ì " (ìƒí™© ì œì‹œí˜•, ë¬¼ìŒí‘œ ì—†ìŒ)
- "ê°ê¸°ì•½ ë¨¹ì–´ë„ ì•ˆ ë‚˜ì„ ë•Œ ì•Œì•„ë‘˜ ê²ƒ" (ìƒí™© + ì •ë³´, ê³¼ìž¥ ì—†ìŒ)
- "ê¸°ì¹¨ë§Œ 3ì£¼ì§¸ë¼ë©´ í™•ì¸í•´ë³¼ ì " (ê¸°ê°„ + ìžì—°ìŠ¤ëŸ¬ìš´ í‘œí˜„)
- "ì•„ì¹¨ë§ˆë‹¤ ì†ê°€ë½ì´ ë»£ë»£í•œë°, ì›€ì§ì´ë©´ ê´œì°®ì•„ì§€ëŠ” ê²½ìš°" (êµ¬ì²´ì  ìž¥ë©´)
- "ë°¤ì— ëˆ„ìš°ë©´ ì–´ê¹¨ê°€ ì‘¤ì…”ì„œ ì˜†ìœ¼ë¡œ ëª» ëˆ„ìš¸ ë•Œ" (ì‹œê°„ + ì¦ìƒ, ë‹¨ì • ì—†ìŒ)
- "ì„¸ìˆ˜í•˜ë‹¤ê°€ íŒ”ì´ ê°‘ìžê¸° ì•ˆ ì˜¬ë¼ê°„ë‹¤ë©´" (í–‰ë™ + ì¦ìƒ, ìƒí™© ì œì‹œ)
- "ì¶œê·¼ê¸¸ì— ê³„ë‹¨ ë‚´ë ¤ê°€ë‹¤ ë¬´ë¦Žì´ ì‹œí°í•  ë•Œ" (ìž¥ì†Œ + í–‰ë™, ìžì—°ìŠ¤ëŸ¬ì›€)

[âŒ ë‚˜ìœ ì œëª© ì˜ˆì‹œ - AI í‹°/ê³¼ìž¥/ì§ˆë¬¸í˜•]
- "ë¬´ë¦Ž í†µì¦ ì™„ë²½ ê°€ì´ë“œ! ëª¨ë“  ê²ƒì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤" (AI ë‹¨ì–´ + ê³¼ìž¥)
- "ì‹­ìžì¸ëŒ€ íŒŒì—´ì¼ê¹Œìš”? ì¦ìƒ ì²´í¬ë¦¬ìŠ¤íŠ¸" (ì§ˆë¬¸í˜• + AI ë‹¨ì–´)
- "ë¬´ë¦Ž í†µì¦ ì›ì¸ ë¶„ì„ê³¼ ì¹˜ë£Œ ë°©ë²• ì´ì •ë¦¬" (AI ë‹¨ì–´ ë‚˜ì—´)
- "ì–´ê¹¨ í†µì¦, ì´ê²ƒë§Œ ì•Œë©´ ì™„ì¹˜!" (ê³¼ìž¥ + ë‹¨ì •)
- "ê´€ì ˆì—¼ ì¦ìƒ ì •ë¦¬ ë° ì˜ˆë°©ë²•" (AI ë‹¨ì–´ + ë”±ë”±í•¨)
- "ì¶œê·¼ê¸¸ì— ê¸°ì¹¨ ì°¸ëŠë¼ ëˆˆë¬¼ ëº€ ê²½í—˜" (ì¼ê¸°ì²´, ì •ë³´ ì—†ìŒ)
- "ë°¤ìƒˆ ë’¤ì²™ì˜€ë˜ ë‚ " (ì—ì„¸ì´ì²´, êµ¬ì²´ì„± ì—†ìŒ)

[ê²€ìˆ˜ ê¸°ì¤€ - ì˜ë£Œê´‘ê³ ë²• ìµœìš°ì„ !]
1. âŒ ë¬¼ìŒí‘œ(?) ì‚¬ìš© í™•ì¸ â†’ ë˜ë„ë¡ 0ê°œ! (ìµœëŒ€ 1ê°œê¹Œì§€ë§Œ í—ˆìš©)
2. âŒ AI ë‹¨ì–´ í™•ì¸ â†’ "ì •ë¦¬/ë¶„ì„/ê°€ì´ë“œ/ì™„ë²½/ëª¨ë“ ê²ƒ/ì²´í¬ë¦¬ìŠ¤íŠ¸/ì´ì •ë¦¬/ë°©ë²•/ìš”ë ¹/íŒ" 0ê°œ!
3. âŒ ê³¼ìž¥ ë‹¨ì–´ í™•ì¸ â†’ "ì¹˜ë£Œ/ì™„ì¹˜/ê°œì„ /ë°˜ë“œì‹œ/í™•ì‹¤í•œ/íš¨ê³¼" 0ê°œ!
4. âŒ AI ì¢…ê²°ì–´ í™•ì¸ â†’ "íë¦„/ìƒí™©/ì‹œì /ì‚¬ë¡€/ê³¼ì •/í¬ì¸íŠ¸" 0ê°œ!
5. âœ… ì˜ë£Œê´‘ê³ ë²• ì•ˆì „ì„± â†’ ë³‘Â·ì˜ì› ë¸”ë¡œê·¸ì— ê²Œì‹œí•´ë„ ë²•ì  ë¬¸ì œ ì—†ì–´ì•¼ í•¨
6. âœ… ìžì—°ìŠ¤ëŸ¬ì›€ â†’ ì‚¬ëžŒì´ ì§ì ‘ ì§€ì€ ê²ƒì²˜ëŸ¼ ë³´ì—¬ì•¼ í•¨
7. âœ… ì‹¤ì œ ë³‘ì› ë¸”ë¡œê·¸ í†¤ â†’ ì •ë³´ ì œê³µí˜• ë˜ëŠ” ê²½í—˜ë‹´ ëŠë‚Œ
8. ðŸ“ êµ¬ì¡° ë°˜ë³µ ì²´í¬ â†’ 5ê°œ ì œëª© ì¤‘ ê°™ì€ ë¬¸ìž¥ êµ¬ì¡° 2ê°œ ì´ìƒì´ë©´ íƒˆë½!`;
  
  const response = await ai.models.generateContent({
    model: 'gemini-3-pro-preview',
    contents: prompt,
    config: {
      responseMimeType: "application/json",
      responseSchema: {
        type: Type.ARRAY,
        items: {
          type: Type.OBJECT,
          properties: {
            title: { type: Type.STRING },
            score: { type: Type.NUMBER },
            type: { type: Type.STRING, enum: ['ìƒí™©ì œì‹œ', 'ê³µê°', 'ì •ë³´ì œê³µ', 'ì‹œê°„ìž¥ì†Œ', 'ê²½í—˜ë‹´'] }
          },
          required: ["title", "score", "type"]
        }
      }
    }
  });
  return JSON.parse(response.text || "[]");
};

/**
 * ì¶”ì²œëœ ì œëª©ë“¤ ì¤‘ ê°€ìž¥ ì í•©í•œ ì œëª© ì„ íƒ (ìˆœìœ„ ë§¤ê¸°ê¸°)
 */
export const rankSeoTitles = async (
  titles: SeoTitleItem[],
  topic: string,
  keywords: string,
  postContent?: string
): Promise<SeoTitleItem[]> => {
  const ai = getAiClient();

  // í˜„ìž¬ ë‚ ì§œ ì •ë³´
  const now = new Date();
  const koreaTime = new Date(now.toLocaleString("en-US", { timeZone: "Asia/Seoul" }));
  const currentYear = koreaTime.getFullYear();
  const currentMonth = koreaTime.getMonth() + 1;
  const seasons = ['ê²¨ìš¸', 'ê²¨ìš¸', 'ë´„', 'ë´„', 'ë´„', 'ì—¬ë¦„', 'ì—¬ë¦„', 'ì—¬ë¦„', 'ê°€ì„', 'ê°€ì„', 'ê°€ì„', 'ê²¨ìš¸'];
  const currentSeason = seasons[currentMonth - 1];

  const titlesJson = JSON.stringify(titles.map((t, idx) => ({
    index: idx + 1,
    title: t.title,
    originalScore: t.score,
    type: t.type
  })), null, 2);

  const prompt = `ë„ˆëŠ” ë³‘ì› ë¸”ë¡œê·¸ ì œëª© í‰ê°€ ì „ë¬¸ê°€ë‹¤.
ì£¼ì–´ì§„ ì œëª©ë“¤ì„ ì¢…í•©ì ìœ¼ë¡œ í‰ê°€í•˜ê³  ìµœì¢… ìˆœìœ„ë¥¼ ë§¤ê²¨ë¼.

[ðŸ“… í˜„ìž¬ ì‹œì : ${currentYear}ë…„ ${currentMonth}ì›” (${currentSeason})]
[â€» ì£¼ì œ] ${topic}
[â€» SEO í‚¤ì›Œë“œ] ${keywords}
${postContent ? `[â€» ë³¸ë¬¸ ì¼ë¶€]\n${postContent.substring(0, 300)}...\n` : ''}

[í‰ê°€í•  ì œëª© ëª©ë¡]
${titlesJson}

[í‰ê°€ ê¸°ì¤€ (ì¤‘ìš”ë„ ìˆœ)]

1ï¸âƒ£ **ì˜ë£Œê´‘ê³ ë²• ì•ˆì „ì„± (50ì ) - ìµœìš°ì„ !**
   - ì§„ë‹¨/íŒë‹¨/ì¹˜ë£Œ ìœ ë„ í‘œí˜„ ì—†ìŒ (+15ì )
   - ê³¼ìž¥/ë‹¨ì • í‘œí˜„ ì—†ìŒ (+15ì )
   - ê³µí¬ ì¡°ìž¥/ì‹œê°„ ì••ë°• ì—†ìŒ (+10ì )
   - ë³‘ì›/ì˜ì› í™ë³´ ëŠë‚Œ ì—†ìŒ (+10ì )

   âŒ ìœ„ë°˜ ì˜ˆì‹œ:
   - "~ì¼ê¹Œìš”?" (ì§„ë‹¨ ìœ ë„) â†’ -20ì 
   - "ì™„ì¹˜/ì¹˜ë£Œ/ê°œì„ " â†’ -20ì 
   - "ë°˜ë“œì‹œ/ê³¨ë“ íƒ€ìž„/ì¦‰ì‹œ" â†’ -15ì 
   - "í™•ì¸í•˜ì„¸ìš”/ê²€ì‚¬ë°›ìœ¼ì„¸ìš”" â†’ -15ì 

2ï¸âƒ£ **ìžì—°ìŠ¤ëŸ¬ì›€ (25ì )**
   - ì‚¬ëžŒì´ ì§ì ‘ ì§€ì€ ê²ƒ ê°™ìŒ (+10ì )
   - AI ë‹¨ì–´ ì—†ìŒ (ì •ë¦¬/ë¶„ì„/ê°€ì´ë“œ/ì²´í¬ë¦¬ìŠ¤íŠ¸/ì™„ë²½) (+10ì )
   - ëŒ€í™”ì²´/ê²½í—˜ë‹´ ëŠë‚Œ (+5ì )

   âŒ ê°ì  ìš”ì†Œ:
   - AI ì¢…ê²°ì–´ (íë¦„/ìƒí™©/ì‹œì /ì‚¬ë¡€/ê³¼ì •/í¬ì¸íŠ¸) â†’ -10ì 
   - ë”±ë”±í•œ ì •ë³´ ë‚˜ì—´í˜• â†’ -5ì 

3ï¸âƒ£ **ì£¼ì œ ì—°ê´€ì„± (15ì )**
   - ì£¼ì œ í•µì‹¬ ë‚´ìš© í¬í•¨ (+8ì )
   - SEO í‚¤ì›Œë“œ ìžì—°ìŠ¤ëŸ½ê²Œ í¬í•¨ (+7ì )

4ï¸âƒ£ **í´ë¦­ ìœ ë„ë ¥ (CTR ì˜ˆì¸¡) (10ì )**
   - "ì´ê±° ë‚´ ì–˜ê¸°ë‹¤" ê³µê° ìœ ë„ (+5ì )
   - êµ¬ì²´ì  ìƒí™© ì œì‹œ (+3ì )
   - í˜¸ê¸°ì‹¬ ìžê·¹ (ê³¼ìž¥ ì—†ì´) (+2ì )

[í‰ê°€ ë°©ë²•]
- ê° ì œëª©ì— ëŒ€í•´ 4ê°€ì§€ ê¸°ì¤€ë³„ ì ìˆ˜ ë¶€ì—¬
- ì´ì  (100ì  ë§Œì ) ê³„ì‚°
- ìµœì¢… ìˆœìœ„ (1~5ìœ„) ê²°ì •
- 1ìœ„ ì œëª© ì„ ì • ì´ìœ  ëª…í™•ížˆ ì„¤ëª…

[ì¤‘ìš”]
ðŸš¨ ì˜ë£Œê´‘ê³ ë²• ìœ„ë°˜ ìš”ì†Œê°€ ìžˆìœ¼ë©´ ë¬´ì¡°ê±´ ê°ì !
- "~ì¼ê¹Œìš”?" ìžˆìœ¼ë©´ -20ì 
- "ì¹˜ë£Œ/ì™„ì¹˜/ê°œì„ " ìžˆìœ¼ë©´ -20ì 
- AI ë‹¨ì–´ 2ê°œ ì´ìƒì´ë©´ -15ì 

[ì¶œë ¥ í˜•ì‹]
ê° ì œëª©ì˜ í‰ê°€ ê²°ê³¼ë¥¼ JSON ë°°ì—´ë¡œ ë°˜í™˜:
- title: ì œëª© ì›ë¬¸
- finalScore: ìµœì¢… ì ìˆ˜ (0-100)
- rank: ìˆœìœ„ (1-5)
- legalSafety: ì˜ë£Œê´‘ê³ ë²• ì•ˆì „ì„± ì ìˆ˜ (0-50)
- naturalness: ìžì—°ìŠ¤ëŸ¬ì›€ ì ìˆ˜ (0-25)
- relevance: ì£¼ì œ ì—°ê´€ì„± ì ìˆ˜ (0-15)
- ctr: í´ë¦­ ìœ ë„ë ¥ ì ìˆ˜ (0-10)
- reason: í‰ê°€ ì´ìœ  (1-2ë¬¸ìž¥)
- recommendation: 1ìœ„ë§Œ ê°œì„  ì œì•ˆ (ì„ íƒì‚¬í•­)

ì •ë ¬: finalScore ë†’ì€ ìˆœ (rank 1ì´ ì œì¼ ìœ„)`;

  const response = await ai.models.generateContent({
    model: 'gemini-3-pro-preview',
    contents: prompt,
    config: {
      responseMimeType: "application/json",
      responseSchema: {
        type: Type.ARRAY,
        items: {
          type: Type.OBJECT,
          properties: {
            title: { type: Type.STRING },
            finalScore: { type: Type.NUMBER },
            rank: { type: Type.NUMBER },
            legalSafety: { type: Type.NUMBER },
            naturalness: { type: Type.NUMBER },
            relevance: { type: Type.NUMBER },
            ctr: { type: Type.NUMBER },
            reason: { type: Type.STRING },
            recommendation: { type: Type.STRING }
          },
          required: ["title", "finalScore", "rank", "legalSafety", "naturalness", "relevance", "ctr", "reason"]
        }
      }
    }
  });

  const rankedTitles = JSON.parse(response.text || "[]");

  // ì›ëž˜ type ì •ë³´ ë³‘í•©
  return rankedTitles.map((ranked: any) => {
    const original = titles.find(t => t.title === ranked.title);
    return {
      ...ranked,
      type: original?.type || 'ì •ë³´ì œê³µ',
      score: ranked.finalScore // score í•„ë“œë¥¼ finalScoreë¡œ ì—…ë°ì´íŠ¸
    };
  });
};

// ì¹´ë“œë‰´ìŠ¤ ìŠ¤íƒ€ì¼ ì°¸ê³  ì´ë¯¸ì§€ ë¶„ì„ í•¨ìˆ˜ (í‘œì§€/ë³¸ë¬¸ êµ¬ë¶„)
export const analyzeStyleReferenceImage = async (base64Image: string, isCover: boolean = false): Promise<string> => {
  const ai = getAiClient();
  
  try {
    const response = await ai.models.generateContent({
      model: 'gemini-3-pro-preview',
      contents: [
        {
          role: 'user',
          parts: [
            {
              inlineData: {
                mimeType: base64Image.includes('png') ? 'image/png' : 'image/jpeg',
                data: base64Image.split(',')[1] // base64 ë°ì´í„°ë§Œ ì¶”ì¶œ
              }
            },
            {
              text: `ì´ ì¹´ë“œë‰´ìŠ¤/ì¸í¬ê·¸ëž˜í”½ ì´ë¯¸ì§€ì˜ **ë””ìžì¸ ìŠ¤íƒ€ì¼ê³¼ ì¼ëŸ¬ìŠ¤íŠ¸ ê·¸ë¦¼ì²´**ë¥¼ ë§¤ìš° ìƒì„¸ížˆ ë¶„ì„í•´ì£¼ì„¸ìš”.

[ì¤‘ìš”]
ðŸš¨ ìµœìš°ì„  ëª©í‘œ: "ê°™ì€ ì‹œë¦¬ì¦ˆ"ë¡œ ë³´ì´ê²Œ í•  ì¼ê´€ëœ ìŠ¤íƒ€ì¼ë§Œ ì¶”ì¶œ! ðŸš¨
[ì¤‘ìš”]

âš ï¸ [ì¤‘ìš”] ì´ ë¶„ì„ì€ "ìŠ¤íƒ€ì¼/í”„ë ˆìž„"ë§Œ ì¶”ì¶œí•©ë‹ˆë‹¤. ì´ë¯¸ì§€ ì† "ë‚´ìš©ë¬¼"ì€ ë¶„ì„í•˜ì§€ ë§ˆì„¸ìš”!
- âŒ ì´ë¯¸ì§€ ì† ì¼ëŸ¬ìŠ¤íŠ¸ê°€ "ë¬´ì—‡ì¸ì§€" (ë¼ì§€, ì‚¬ëžŒ, ëˆ ë“±) â†’ ë¶„ì„ ë¶ˆí•„ìš”!
- âŒ ì´ë¯¸ì§€ ì† í…ìŠ¤íŠ¸ê°€ "ë¬´ìŠ¨ ë‚´ìš©ì¸ì§€" â†’ ë¶„ì„ ë¶ˆí•„ìš”!
- âœ… ì¼ëŸ¬ìŠ¤íŠ¸ì˜ "ê·¸ë¦¬ëŠ” ë°©ì‹/ê¸°ë²•" (3D, í”Œëž«, ìˆ˜ì±„í™” ë“±) â†’ ë¶„ì„ í•„ìš”!
- âœ… ìƒ‰ìƒ íŒ”ë ˆíŠ¸, í”„ë ˆìž„ í˜•íƒœ, ë ˆì´ì•„ì›ƒ êµ¬ì¡° â†’ ë¶„ì„ í•„ìš”!

**ì´ ì´ë¯¸ì§€ëŠ” ${isCover ? 'í‘œì§€(1ìž¥)' : 'ë³¸ë¬¸(2ìž¥ ì´í›„)'} ìŠ¤íƒ€ì¼ ì°¸ê³ ìš©ìž…ë‹ˆë‹¤.**

---â”â”â”â”
ðŸŽ¨ [1ë‹¨ê³„] ì¼ëŸ¬ìŠ¤íŠ¸/ê·¸ë¦¼ì²´ DNA ë¶„ì„ (ê°€ìž¥ ì¤‘ìš”!)
---â”â”â”â”
1. **ê·¸ë¦¼ì²´ ì¢…ë¥˜** (ì •í™•ížˆ í•˜ë‚˜ë§Œ ì„ íƒ):
   - 3D í´ë ˆì´/ì í†  ë Œë”ë§ (Blender/Cinema4D ëŠë‚Œ)
   - 3D ì•„ì´ì†Œë©”íŠ¸ë¦­ ì¼ëŸ¬ìŠ¤íŠ¸
   - í”Œëž« ë²¡í„° ì¼ëŸ¬ìŠ¤íŠ¸ (ë¯¸ë‹ˆë©€)
   - ìˆ˜ì±„í™”/ì†ê·¸ë¦¼ ìŠ¤íƒ€ì¼
   - ìºë¦­í„° ì¼ëŸ¬ìŠ¤íŠ¸ (ê·€ì—¬ìš´/í‚¤ì¹˜)
   - ì‹¤ì‚¬ ì‚¬ì§„ / í¬í† ë¦¬ì–¼
   - ì„ í™”+ì±„ìƒ‰ ì¼ëŸ¬ìŠ¤íŠ¸
   - ê·¸ë¼ë°ì´ì…˜ ê¸€ëž˜ìŠ¤ëª¨í”¼ì¦˜

2. **ë Œë”ë§ íŠ¹ì§•**:
   - ì¡°ëª…: ë¶€ë“œëŸ¬ìš´ ìŠ¤íŠœë””ì˜¤ ì¡°ëª… / ê°•í•œ ê·¸ë¦¼ìž / í”Œëž« ì¡°ëª…
   - ì§ˆê°: ê´‘íƒ ìžˆëŠ” / ë¬´ê´‘ ë§¤íŠ¸ / ë°˜íˆ¬ëª…
   - ì™¸ê³½ì„ : ì—†ìŒ / ê°€ëŠ” ì„  / êµµì€ ì„ 
   - ê¹Šì´ê°: ì–•ì€ í”¼ì‚¬ê³„ì‹¬ë„ / ë“±ê°íˆ¬ì˜ / ì™„ì „ í”Œëž«

3. **ìƒ‰ìƒ íŒ”ë ˆíŠ¸** (ì •í™•í•œ HEX ì½”ë“œ 5ê°œ):
   - ì£¼ ë°°ê²½ìƒ‰: #______
   - ì£¼ ê°•ì¡°ìƒ‰: #______
   - ë³´ì¡°ìƒ‰ 1: #______
   - ë³´ì¡°ìƒ‰ 2: #______
   - í…ìŠ¤íŠ¸ìƒ‰: #______

4. **ìºë¦­í„°/ì˜¤ë¸Œì íŠ¸ ìŠ¤íƒ€ì¼** (ìžˆë‹¤ë©´):
   - ì–¼êµ´ í‘œí˜„: ì‹¬í”Œí•œ ì  ëˆˆ / í° ëˆˆ / ì—†ìŒ
   - ë¹„ìœ¨: 2ë“±ì‹  ê·€ì—¬ì›€ / ë¦¬ì–¼ ë¹„ìœ¨ / ì•„ì´ì½˜í˜•
   - í‘œì •: ë¯¸ì†Œ / ë¬´í‘œì • / ë‹¤ì–‘í•¨

---â”â”â”â”
ðŸ“ [2ë‹¨ê³„] ë ˆì´ì•„ì›ƒ/í”„ë ˆìž„ ë¶„ì„
---â”â”â”â”
5. **í”„ë ˆìž„ ìŠ¤íƒ€ì¼**: 
   - ë‘¥ê·¼ í…Œë‘ë¦¬ ì¹´ë“œ?
   - í…Œë‘ë¦¬ ìƒ‰ìƒ(HEX)ê³¼ êµµê¸°(px)

6. **í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼**:
   - ë¶€ì œëª©: ìƒ‰ìƒ, êµµê¸°
   - ë©”ì¸ ì œëª©: ìƒ‰ìƒ, êµµê¸°, ê°•ì¡° ë°©ì‹
   - ì„¤ëª…: ìƒ‰ìƒ

7. **ì¼ëŸ¬ìŠ¤íŠ¸ ë°°ì¹˜**: top / center / bottom, í¬ê¸° ë¹„ìœ¨(%)

**ë°˜ë“œì‹œ JSON í˜•ì‹ìœ¼ë¡œ ë‹µë³€ (illustStyle í•„ë“œ í•„ìˆ˜!):**
{
  "illustStyle": {
    "type": "3D í´ë ˆì´ ë Œë”ë§ / í”Œëž« ë²¡í„° / ì•„ì´ì†Œë©”íŠ¸ë¦­ / ìˆ˜ì±„í™” / ì‹¤ì‚¬",
    "lighting": "ë¶€ë“œëŸ¬ìš´ ìŠ¤íŠœë””ì˜¤ ì¡°ëª… / í”Œëž« / ê°•í•œ ê·¸ë¦¼ìž",
    "texture": "ê´‘íƒ ë§¤ë„ëŸ¬ì›€ / ë¬´ê´‘ ë§¤íŠ¸ / ë°˜íˆ¬ëª…",
    "outline": "ì—†ìŒ / ê°€ëŠ” ì„  / êµµì€ ì„ ",
    "characterStyle": "2ë“±ì‹  ê·€ì—¬ì›€ / ë¦¬ì–¼ ë¹„ìœ¨ / ì‹¬í”Œ ì•„ì´ì½˜",
    "colorPalette": ["#ì£¼ë°°ê²½", "#ê°•ì¡°ìƒ‰", "#ë³´ì¡°1", "#ë³´ì¡°2", "#í…ìŠ¤íŠ¸"],
    "promptKeywords": "ì´ ìŠ¤íƒ€ì¼ì„ ìž¬í˜„í•˜ê¸° ìœ„í•œ ì˜ì–´ í‚¤ì›Œë“œ 5-8ê°œ (ì˜ˆ: 3D clay render, soft shadows, pastel colors, rounded shapes, studio lighting)"
  },
  "frameStyle": "rounded-card / rectangle",
  "backgroundColor": "#E8F4FD",
  "borderColor": "#787fff",
  "borderWidth": "2px",
  "borderRadius": "16px",
  "boxShadow": "0 4px 12px rgba(0,0,0,0.1)",
  "subtitleStyle": { "color": "#6B7280", "fontSize": "14px", "fontWeight": "500" },
  "mainTitleStyle": { "color": "#1F2937", "fontSize": "28px", "fontWeight": "700" },
  "highlightStyle": { "color": "#787fff", "backgroundColor": "transparent" },
  "descStyle": { "color": "#4B5563", "fontSize": "16px" },
  "tagStyle": { "backgroundColor": "#F0F0FF", "color": "#787fff", "borderRadius": "20px" },
  "illustPosition": "bottom",
  "illustSize": "60%",
  "padding": "24px",
  "mood": "ë°ê³  ì¹œê·¼í•œ / ì „ë¬¸ì ì¸ / ë”°ëœ»í•œ ë“±",
  "keyFeatures": ["3D í´ë ˆì´ ë Œë”ë§", "íŒŒìŠ¤í…” ìƒ‰ìƒ", "ë‘¥ê·¼ í˜•íƒœ", "ë¶€ë“œëŸ¬ìš´ ê·¸ë¦¼ìž"],
  "styleReproductionPrompt": "ì´ ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼ì„ ì •í™•ížˆ ìž¬í˜„í•˜ê¸° ìœ„í•œ ì™„ì „í•œ ì˜ì–´ í”„ë¡¬í”„íŠ¸ 1-2ë¬¸ìž¥"
}`
            }
          ]
        }
      ],
      config: {
        responseMimeType: "application/json"
      }
    });
    
    return response.text || '{}';
  } catch (error) {
    console.error('ìŠ¤íƒ€ì¼ ë¶„ì„ ì‹¤íŒ¨:', error);
    return '{}';
  }
};

// ============================================
// ðŸ¤– ë¯¸ë‹ˆ ì—ì´ì „íŠ¸ ë°©ì‹ ì¹´ë“œë‰´ìŠ¤ ìƒì„± ì‹œìŠ¤í…œ
// ============================================

// ìŠ¬ë¼ì´ë“œ ìŠ¤í† ë¦¬ íƒ€ìž… ì •ì˜
interface SlideStory {
  slideNumber: number;
  slideType: 'cover' | 'concept' | 'content' | 'closing';
  subtitle: string;      // 4-8ìž (ì§§ê³  ìž„íŒ©íŠ¸ìžˆê²Œ!)
  mainTitle: string;     // 10-18ìž (ê°•ì¡° ë¶€ë¶„ <highlight>ë¡œ í‘œì‹œ)
  description: string;   // 15-25ìž (íŒë‹¨ 1ì¤„! ì„¤ëª… ì•„ë‹˜!)
  tags: string[];        // í•´ì‹œíƒœê·¸ 2-3ê°œ
  imageKeyword: string;  // ì´ë¯¸ì§€ í•µì‹¬ í‚¤ì›Œë“œ
}

interface CardNewsStory {
  topic: string;
  totalSlides: number;
  slides: SlideStory[];
  overallTheme: string;
}

// [1ë‹¨ê³„] ìŠ¤í† ë¦¬ ê¸°íš ì—ì´ì „íŠ¸
const storyPlannerAgent = async (
  topic: string, 
  category: string, 
  slideCount: number,
  writingStyle: WritingStyle
): Promise<CardNewsStory> => {
  const ai = getAiClient();
  const currentYear = getCurrentYear();
  
  const prompt = `ë‹¹ì‹ ì€ **ì „í™˜í˜• ì¹´ë“œë‰´ìŠ¤** ìŠ¤í† ë¦¬ ê¸°íš ì „ë¬¸ê°€ìž…ë‹ˆë‹¤.

[ðŸŽ¯ ë¯¸ì…˜] "${topic}" ì£¼ì œë¡œ ${slideCount}ìž¥ì§œë¦¬ **ì „í™˜í˜•** ì¹´ë“œë‰´ìŠ¤ë¥¼ ê¸°íší•˜ì„¸ìš”.

${CONTENT_DESCRIPTION}

[ðŸ“… í˜„ìž¬: ${currentYear}ë…„ - ë³´ìˆ˜ì  í•´ì„ ì›ì¹™]
- ${currentYear}ë…„ ê¸°ì¤€ ë³´ê±´ë³µì§€ë¶€Â·ì˜ë£Œê´‘ê³  ì‹¬ì˜ ì§€ì¹¨ì„ ë°˜ì˜
- **ë¶ˆí™•ì‹¤í•œ ê²½ìš° ë°˜ë“œì‹œ ë³´ìˆ˜ì ìœ¼ë¡œ í•´ì„**
- ì¶œì²˜ ì—†ëŠ” ìˆ˜ì¹˜/ì‹œê°„/í™•ë¥  í‘œí˜„ ê¸ˆì§€

[ì§„ë£Œê³¼] ${category}
[ê¸€ ìŠ¤íƒ€ì¼] ${writingStyle === 'expert' ? 'ì „ë¬¸ê°€í˜•(ì‹ ë¢°Â·ê¶Œìœ„)' : writingStyle === 'empathy' ? 'ê³µê°í˜•(ë…ìž ê³µê°)' : 'ì „í™˜í˜•(ì •ë³´â†’í™•ì¸ ìœ ë„)'}

ðŸš¨ðŸš¨ðŸš¨ðŸš¨ðŸš¨ðŸš¨ðŸš¨ðŸš¨ðŸš¨ðŸš¨
[ðŸ“± ì¹´ë“œë‰´ìŠ¤ í•µì‹¬ ì›ì¹™ - ë¸”ë¡œê·¸ì™€ ì™„ì „ížˆ ë‹¤ë¦„!]
ðŸš¨ðŸš¨ðŸš¨ðŸš¨ðŸš¨ðŸš¨ðŸš¨ðŸš¨ðŸš¨ðŸš¨

âŒ ë¸”ë¡œê·¸ = "ì½ê³  ì´í•´"
âœ… ì¹´ë“œë‰´ìŠ¤ = "ë³´ê³  íŒë‹¨" (3ì´ˆ ì•ˆì—!)

[ðŸ”‘ ì¹´ë“œë‰´ìŠ¤ í™©ê¸ˆ ê³µì‹]
âŒ ì„¤ëª… 70% â†’ âœ… íŒë‹¨ 70%
âŒ "ì™œëƒí•˜ë©´..." â†’ âœ… "ì´ë•ŒëŠ”..."
âŒ ë¬¸ìž¥ 2~3ì¤„ ì„¤ëª… â†’ âœ… íŒë‹¨ 1ì¤„ë¡œ ë

[[ì‹¬ë¦¬] ì‹¬ë¦¬ êµ¬ì¡°: ì§ˆë¬¸ â†’ ëŠê¸° â†’ íŒë‹¨ â†’ ë‹¤ìŒì¹´ë“œ]
- ê° ì¹´ë“œëŠ” "ë©ˆì¶¤ â†’ íŒë‹¨ â†’ ë„˜ê¹€"ì„ ìœ ë„í•´ì•¼ í•¨
- ì„¤ëª…í•˜ë©´ ìŠ¤í¬ë¡¤ ë©ˆì¶¤ë ¥ì´ ë–¨ì–´ì§!

[ðŸš¨ ì¹´ë“œë³„ ì‹¬ë¦¬ì  ì—­í•  - ${slideCount}ìž¥ ê¸°ì¤€ ðŸš¨]

**1ìž¥ - í‘œì§€ (ë©ˆì¶”ê²Œ í•˜ëŠ” ì—­í• ë§Œ!)**
- subtitle: 4~8ìž (ì˜ˆ: "ê²¨ìš¸ì² ì— ìœ ë…?", "í˜¹ì‹œ ë‚˜ë„?")
- mainTitle: 10~15ìž, ì§ˆë¬¸í˜• (ì˜ˆ: "ê²¨ìš¸ì²  í˜ˆê´€ ì‹ í˜¸ì¼ê¹Œìš”?")
- description: "" â† ðŸš¨ í‘œì§€ëŠ” description ì™„ì „ížˆ ë¹„ì›Œë‘ì„¸ìš”! ë¹ˆ ë¬¸ìžì—´ ""ë¡œ!
- ðŸ’¡ í‘œì§€ëŠ” ì œëª©+ë¶€ì œë§Œ! ì„¤ëª… ì—†ìŒ!

**2ìž¥ - ì˜¤í•´ ê¹¨ê¸° (íŒë‹¨ ìœ ë„)**
- subtitle: 4~8ìž (ì˜ˆ: "ë‹¨ìˆœí•œ ì¶”ìœ„ ë•Œë¬¸?")
- mainTitle: ì§ˆë¬¸í˜•ìœ¼ë¡œ ì°©ê° ê¹¨ê¸° (ì˜ˆ: "ìƒí™œ ê´€ë¦¬ë§Œìœ¼ë¡œ ì¶©ë¶„í• ê¹Œìš”?")
- description: âŒ ê¸´ ì„¤ëª… ê¸ˆì§€! íŒë‹¨ 1ì¤„ë§Œ (ì˜ˆ: "ë”°ëœ»í•˜ê²Œ ìž…ì–´ë„ í•´ê²°ë˜ì§€ ì•ŠëŠ” ì‹ í˜¸ê°€ ìžˆìŠµë‹ˆë‹¤")

${slideCount >= 5 ? `**3ìž¥ - ì¦ìƒ ëª…í™•í™” (í•µì‹¬ë§Œ)**
- subtitle: 4~8ìž (ì˜ˆ: "ë†“ì¹˜ê¸° ì‰¬ìš´ ì‹ í˜¸ë“¤")
- mainTitle: ì¦ìƒ ë‚˜ì—´ (ì˜ˆ: "ë°˜ë³µë˜ëŠ” ë‘í†µ\\nìˆ¨ì´ ì°¨ëŠ” ëŠë‚Œì´ ê³„ì†ëœë‹¤ë©´")
- description: í•œ ì¤„ íŒë‹¨ (ì˜ˆ: "í”¼ë¡œë‚˜ ìŠ¤íŠ¸ë ˆìŠ¤ì™€ êµ¬ë¶„ì´ í•„ìš”í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤")` : ''}

${slideCount >= 6 ? `**4ìž¥ - ìžê°€ íŒë‹¨ì˜ í•œê³„**
- subtitle: 4~8ìž (ì˜ˆ: "ìžê°€ íŒë‹¨ì˜ í•œê³„")  
- mainTitle: í•µì‹¬ ë©”ì‹œì§€ë§Œ (ì˜ˆ: "ì¦ìƒë§Œìœ¼ë¡œëŠ” ì›ì¸ì„ êµ¬ë¶„í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤")
- description: âŒ ì„¤ëª… ì‚­ì œ ë˜ëŠ” ìµœì†Œí™”` : ''}

${slideCount >= 7 ? `**5~${slideCount-2}ìž¥ - ì‹œì  ê³ ì • (ðŸ”¥ í•µì‹¬! ðŸ”¥)**
- ì¶”ê°€ ì •ë³´ë³´ë‹¤ "ì‹œì  ê³ ì •"ì— ì§‘ì¤‘
- ìƒí™œìŠµê´€ ì¹´ë“œëŠ” ìµœëŒ€ 1ìž¥ë§Œ!` : ''}

**${slideCount-1}ìž¥ - ì‹œì  ê³ ì •**
- subtitle: 4~8ìž (ì˜ˆ: "í™•ì¸ì´ í•„ìš”í•œ ìˆœê°„")
- mainTitle: (ì˜ˆ: "ì‚¬ë¼ì¡Œë‹¤ ë‹¤ì‹œ ë‚˜íƒ€ë‚œë‹¤ë©´\\ní™•ì¸ì´ í•„ìš”í•œ ì‹œì ìž…ë‹ˆë‹¤")
- description: ìµœì†Œí™”

**${slideCount}ìž¥ - ë§ˆì§€ë§‰ í‘œì§€/CTA (ëª…ë ¹í˜• ê¸ˆì§€! + ì „í™˜ë ¥ ê°•í™”!)**
- subtitle: 4~8ìž (ì˜ˆ: "ë¯¸ë£¨ì§€ ì•ŠëŠ” ìŠµê´€", "ì§€ê¸ˆì´ ê·¸ë•Œ")
- mainTitle: "ì™œ ì§€ê¸ˆì´ì–´ì•¼ í•˜ëŠ”ì§€" ì´ìœ ë¥¼ ë‹´ì•„ë¼!
  âœ… "ì§€ì¼œë³´ê¸°ë³´ë‹¤ ê´€ë¦¬ ë°©í–¥ì„ ì •í•  ì‹œì "
  âœ… "ì´ ë‹¨ê³„ì—ì„œëŠ” ë„˜ê¸°ê¸°ë³´ë‹¤ ì‚´íŽ´ë³¼ ë•Œìž…ë‹ˆë‹¤"
  âœ… "ë°˜ë³µëœë‹¤ë©´ ê¸°ì¤€ì´ í•„ìš”í•©ë‹ˆë‹¤"
  âŒ "~í•˜ì„¸ìš”" ëª…ë ¹í˜• ê¸ˆì§€!
  âŒ "ê°€ìž¥ ë¹ ë¥¸ ì²«ê±¸ìŒ" (ë„ˆë¬´ ì°©í•¨, ì „í™˜ë ¥ ì•½í•¨)
- description: "" â† ðŸš¨ ë§ˆì§€ë§‰ ìž¥ë„ description ì™„ì „ížˆ ë¹„ì›Œë‘ì„¸ìš”! ë¹ˆ ë¬¸ìžì—´ ""ë¡œ!
- ðŸ’¡ ë§ˆì§€ë§‰ ìž¥ì€ í‘œì§€ì²˜ëŸ¼ ì œëª©+ë¶€ì œë§Œ! ì„¤ëª… ì—†ìŒ!
- âŒ "í˜ˆì•¡ ê²€ì‚¬ë¡œ í™•ì¸í•˜ì„¸ìš”" ê°™ì€ ëª…ë ¹í˜• ê¸ˆì§€!
- âŒ "ì˜ë£Œê¸°ê´€ì„ ì°¾ì•„..." ë¬¸ìž¥ ê¸ˆì§€!
- ðŸ”¥ í•µì‹¬: "ì™œ ì§€ê¸ˆ?" + "ë¯¸ë£¨ë©´ ì–´ë–»ê²Œ?" ë‘ ë©”ì‹œì§€ ì¤‘ í•˜ë‚˜ í¬í•¨!

[ðŸ“ í…ìŠ¤íŠ¸ ë¶„ëŸ‰ ê·œì¹™ - ì¹´ë“œë‰´ìŠ¤ìš©!]
- subtitle: 4~8ìž (ì§ˆë¬¸/ìƒí™© í‘œí˜„)
  âœ… "ê²¨ìš¸ì² ì— ìœ ë…?", "í˜¹ì‹œ ë‚˜ë„?", "ë†“ì¹˜ê¸° ì‰¬ìš´ ì‹ í˜¸ë“¤"
  âŒ "ì™œ ì¤‘ìš”í• ê¹Œìš”?" (ë„ˆë¬´ ì¼ë°˜ì )
  
- mainTitle: 10~18ìž, ì¤„ë°”ê¿ˆ í¬í•¨, <highlight>ë¡œ ê°•ì¡°
  âœ… "ê°€ìŠ´ ë‹µë‹µí•¨Â·ë‘í†µ\\n<highlight>í˜ˆê´€ ì‹ í˜¸</highlight>ì¼ê¹Œìš”?"
  âŒ "í˜ˆê´€ ê±´ê°• ì²´í¬ ì‹ í˜¸ì¼ê¹Œìš”?" (ì²´í¬=í–‰ë™ìœ ë„ ëŠë‚Œ)
  
- description: 15~25ìžì˜ íŒë‹¨ 1ì¤„! (ì„¤ëª… ì•„ë‹˜!)
  âœ… "ë”°ëœ»í•˜ê²Œ ìž…ì–´ë„ í•´ê²°ë˜ì§€ ì•ŠëŠ” ì‹ í˜¸ê°€ ìžˆìŠµë‹ˆë‹¤"
  âœ… "í”¼ë¡œë‚˜ ì»¨ë””ì…˜ ë³€í™” ë“± ë‹¤ë¥¸ ì›ì¸ì—ì„œë„ ë‚˜íƒ€ë‚  ìˆ˜ ìžˆìŠµë‹ˆë‹¤"
  âœ… "ì‹ìŠµê´€ê³¼ ìƒí™œ ìŠµê´€ì— ë”°ë¼ ê°œì¸ì°¨ê°€ í½ë‹ˆë‹¤"
  âŒ "ê¸°ì˜¨ ë³€í™”ì— ë”°ë¥¸ í˜ˆê´€ ìˆ˜ì¶•ì€ ìžê°€ ê´€ë¦¬ ì˜ì—­ì„ ë„˜ì–´ ì „ë¬¸ì ì¸ í™•ì¸ì´ í•„ìš”í•œ ê²½ìš°ê°€..." (ë„ˆë¬´ ê¸º)
  âŒ "ë§¤ë…„ ê±´ê°•ë³´í—˜ í˜œíƒì„ í†µí•´ ë¹„ìš© ë¶€ë‹´ì„ ì¤„ì¸ í™•ì¸ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤..." (ë„ˆë¬´ ê¸º)

[ðŸ”„ ë‹¨ì–´ ë°˜ë³µ ê¸ˆì§€ - ë¦¬ë“¬ ìœ ì§€!]
âš ï¸ ê°™ì€ ë‹¨ì–´ê°€ 2íšŒ ì´ìƒ ë‚˜ì˜¤ë©´ ì¹´ë“œë‰´ìŠ¤ ë¦¬ë“¬ì´ ì£½ìŠµë‹ˆë‹¤!
- "í™•ì¸" ëŒ€ì‹  â†’ ì ê²€, ì‚´í”¼ë‹¤, ìƒíƒœ ë³´ê¸°, íŒŒì•…
- "ê´€ë¦¬" ëŒ€ì‹  â†’ ì¼€ì–´, ëŒë´„, ìœ ì§€, ìŠµê´€
- "í•„ìš”" ëŒ€ì‹  â†’ ì¤‘ìš”, ì˜ë¯¸ìžˆëŠ”, ì‹œì 
- "ì‹œì " ëŒ€ì‹  â†’ ìˆœê°„, íƒ€ì´ë°, ë•Œ, ë‹¨ê³„
â†’ ì˜ë¯¸ëŠ” ìœ ì§€í•˜ê³  ë‹¨ì–´ëŠ” ë¶„ì‚°!

[ðŸš¨ ì˜ë£Œë²• ì¤€ìˆ˜ - ìµœìš°ì„ ! ðŸš¨]

**ì ˆëŒ€ ê¸ˆì§€ í‘œí˜„:**
âŒ "ì¦‰ì‹œ ìƒë‹´", "ë°”ë¡œ ìƒë‹´", "ì§€ê¸ˆ ìƒë‹´"
âŒ "ì „ë¬¸ì˜ ìƒë‹´", "ì „ë¬¸ì˜ì™€ ìƒë‹´í•˜ì„¸ìš”"
âŒ "ë³‘ì› ë°©ë¬¸", "ë‚´ì›í•˜ì„¸ìš”", "ì˜ˆì•½í•˜ì„¸ìš”"
âŒ "ê²€ì§„ ë°›ìœ¼ì„¸ìš”", "ì§„ë£Œ ë°›ìœ¼ì„¸ìš”", "ê²€ì‚¬ ë°›ìœ¼ì„¸ìš”"
âŒ "~í•˜ì„¸ìš”" ëª…ë ¹í˜• ì „ë¶€!
âŒ "ì™„ì¹˜", "ìµœê³ ", "ë³´ìž¥", "í™•ì‹¤ížˆ", "ì²´í¬"
âŒ "ê³¨ë“ íƒ€ìž„", "48ì‹œê°„ ë‚´" ë“± êµ¬ì²´ì  ì‹œê°„ í‘œí˜„

**ì•ˆì „í•œ ëŒ€ì²´ í‘œí˜„:**
âœ… "í™•ì¸ì´ í•„ìš”í•œ ì‹œì ìž…ë‹ˆë‹¤"
âœ… "ì§€ì¼œë³´ê¸°ë³´ë‹¤ í™•ì¸ì´ ë¨¼ì €ìž…ë‹ˆë‹¤"
âœ… "ì „ë¬¸ì ì¸ íŒë‹¨ì´ í•„ìš”í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤"
âœ… "ê°œì¸ì°¨ê°€ ìžˆì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤"
âŒ "~ë¥¼ ê³ ë ¤í•´ë³¼ ìˆ˜ ìžˆì–´ìš”" (ë„ˆë¬´ ì•½í•¨)

[âš ï¸ ìƒí™œìŠµê´€ ì¹´ë“œ ì œí•œ]
- ìƒí™œìŠµê´€(ìš´ë™, ì‹ë‹¨, ê¸ˆì—° ë“±) ì¹´ë“œëŠ” **ìµœëŒ€ 1ìž¥**ë§Œ
- ìƒí™œìŠµê´€ì´ í•µì‹¬ ë©”ì‹œì§€(í™•ì¸ ì‹œì )ë¥¼ ëŒ€ì²´í•˜ë©´ ì•ˆ ë¨!

[âŒ ê¸ˆì§€]
- "01.", "ì²« ë²ˆì§¸" ë“± ë²ˆí˜¸ í‘œí˜„
- "í•´ê²°ì±… 1", "ë§ˆë¬´ë¦¬" ë“± í”„ë ˆìž„ì›Œí¬ ìš©ì–´
- ì¶œì²˜ ì—†ëŠ” êµ¬ì²´ì  ìˆ˜ì¹˜/ì‹œê°„/í™•ë¥  í‘œí˜„

[âœ… ìŠ¬ë¼ì´ë“œ ì—°ê²°]
- ì´ì „ ìŠ¬ë¼ì´ë“œì™€ ìžì—°ìŠ¤ëŸ½ê²Œ ì´ì–´ì§€ë„ë¡
- **ì‹¬ë¦¬ íë¦„**: ì£¼ì˜í™˜ê¸° â†’ ì˜¤í•´ê¹¨ê¸° â†’ ì¦ìƒëª…í™•í™” â†’ ìžê°€íŒë‹¨í•œê³„ â†’ ì‹œì ê³ ì • â†’ CTA

[ðŸŽ¯ ìµœì¢… ì²´í¬ë¦¬ìŠ¤íŠ¸]
1. ðŸš¨ 1ìž¥(í‘œì§€)ì˜ descriptionì´ ë¹„ì–´ìžˆëŠ”ê°€? â†’ ë°˜ë“œì‹œ "" ë¹ˆ ë¬¸ìžì—´ë¡œ!
2. ðŸš¨ ë§ˆì§€ë§‰ ìž¥ì˜ descriptionì´ ë¹„ì–´ìžˆëŠ”ê°€? â†’ ë°˜ë“œì‹œ "" ë¹ˆ ë¬¸ìžì—´ë¡œ!
3. ê° ì¹´ë“œ descriptionì´ 2ì¤„ ì´ìƒì¸ê°€? â†’ 1ì¤„(15~25ìž)ë¡œ ì¤„ì—¬ë¼!
4. "~í•˜ì„¸ìš”" ëª…ë ¹í˜•ì´ ìžˆëŠ”ê°€? â†’ "~ì‹œì ìž…ë‹ˆë‹¤", "~ë‹¨ê³„ìž…ë‹ˆë‹¤"ë¡œ ë°”ê¿”ë¼!
5. ì„¤ëª…ì´ íŒë‹¨ë³´ë‹¤ ë§Žì€ê°€? â†’ 'ì´ìœ  ì„¤ëª…' ì‚­ì œ, íŒë‹¨ë§Œ ë‚¨ê²¨ë¼!
6. "í™•ì¸/ì ê²€" ê°™ì€ ë‹¨ì–´ê°€ 2ë²ˆ ì´ìƒ ë°˜ë³µë˜ëŠ”ê°€? â†’ ë¶„ì‚°ì‹œì¼œë¼! (ì‚´í”¼ë‹¤, ìƒíƒœë³´ê¸°, íŒŒì•… ë“±)
7. CTAê°€ ë„ˆë¬´ ì°©í•œê°€? â†’ "ì™œ ì§€ê¸ˆì´ì–´ì•¼ í•˜ëŠ”ì§€" ì´ìœ  ì¶”ê°€!
8. CTAì— ì‹œìˆ ëª…(ìŠ¤í‚¨ë¶€ìŠ¤í„° ë“±)ì´ ìžˆëŠ”ê°€? â†’ "ê´€ë¦¬ ë°©í–¥", "ê´€ë¦¬ ê¸°ì¤€"ìœ¼ë¡œ ëŒ€ì²´!
9. "ë§žì¶¤í˜•", "ê°œì¸ë§žì¶¤" í‘œí˜„ì´ ìžˆëŠ”ê°€? â†’ "ìƒíƒœì— ë§žëŠ”"ìœ¼ë¡œ ëŒ€ì²´!

[ì¤‘ìš”]
[ì‹¬ì˜ í†µê³¼ í•µì‹¬ ê·œì¹™] ë³‘ì› ì¹´ë“œë‰´ìŠ¤ í†¤ ë¯¸ì„¸ ì¡°ì • - 5% ì™„í™”!
[ì¤‘ìš”]

**ðŸš¨ ì‹¬ì˜ íƒˆë½ ë°©ì§€ - í•µì‹¬ 3ê°€ì§€ ì¡°ì • í¬ì¸íŠ¸ ðŸš¨**

**â€» 10. í•©ë³‘ì¦ ì–¸ê¸‰ ì‹œ - 'ì˜ˆë°©' ë‹¨ì–´ ê¸ˆì§€! (ê°€ìž¥ ì¤‘ìš”!)**
- âŒ "í•©ë³‘ì¦ ì˜ˆë°©ì„ ìœ„í•´ ì´ˆê¸° í™•ì¸ì´ ì¤‘ìš”í•´ìš”" â†’ 'ì˜ˆë°©'ì´ ì¹˜ë£Œ íš¨ê³¼ ì•”ì‹œë¡œ í•´ì„ë¨!
- âŒ "í•©ë³‘ì¦ì„ ì˜ˆë°©í•˜ë ¤ë©´..." â†’ ì¹˜ë£Œ íš¨ê³¼ ê¸°ëŒ€ ìœ ë°œ
- âœ… "ì¦ìƒ ê²½ê³¼ë¥¼ ì‚´í”¼ëŠ” ê²ƒì´ ì¤‘ìš”í•œ ì´ìœ "
- âœ… "ê³ ìœ„í—˜êµ°ì—ì„œëŠ” ê²½ê³¼ ê´€ì°°ì´ ë” ì¤‘ìš”í•©ë‹ˆë‹¤"
- âœ… "ì¼ë¶€ ê²½ìš°ì—ëŠ” ì¦ìƒ ê²½ê³¼ì— ë”°ë¼ ì¶”ê°€ì ì¸ ê´€ë¦¬ê°€ í•„ìš”í•´ì§ˆ ìˆ˜ ìžˆë‹¤ëŠ” ì ì´ ë³´ê³ ë˜ê³  ìžˆìŠµë‹ˆë‹¤"
- âœ… "íŠ¹ížˆ ê³ ë ¹ì¸µì´ë‚˜ ì–´ë¦°ì´ëŠ” ì¦ìƒ ë³€í™”ë¥¼ ì£¼ì˜ ê¹Šê²Œ ì‚´í”¼ëŠ” ê²ƒì´ ë„ì›€ì´ ë©ë‹ˆë‹¤"
- â€» í•µì‹¬: 'ì˜ˆë°©' â†’ 'ê²½ê³¼ ê´€ì°°', 'ì‚´í”¼ëŠ” ê²ƒ'ìœ¼ë¡œ ëŒ€ì²´!

**â€» 11. ì‹œì  ê³ ì • ì¹´ë“œ - 'íšŒë³µ' ë‹¨ì–´ í†¤ ë‹¤ìš´!**
- âŒ "íšŒë³µ ê³¼ì •ì— ë„ì›€ì´ ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤" â†’ ì¹˜ë£Œ íš¨ê³¼ ì•”ì‹œ
- âŒ "ë¹ ë¥¸ íšŒë³µì„ ìœ„í•´" â†’ ê²°ê³¼ ë³´ìž¥ ëŠë‚Œ
- âœ… "ì´í›„ ê´€ë¦¬ ë°©í–¥ì„ ì •í•˜ëŠ” ë° ë„ì›€ì´ ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤"
- âœ… "ìƒíƒœì— ë§žëŠ” ê´€ë¦¬ ë°©í–¥ì„ í™•ì¸í•´ë³´ëŠ” ê²ƒë„ ê³ ë ¤í•´ë³¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤"
- â€» í•µì‹¬: 'íšŒë³µ' â†’ 'ê´€ë¦¬ ë°©í–¥', 'ê´€ë¦¬ ê¸°ì¤€'ìœ¼ë¡œ ëŒ€ì²´!

**â€» 12. ì „íŒŒ/ê°ì—¼ í‘œí˜„ ì™„í™” - ì±…ìž„ ê°•ì¡° ëŠë‚Œ ì œê±°!**
- âŒ "ì£¼ë³€ ê°€ì¡±ì´ë‚˜ ë™ë£Œì—ê²Œ ì˜í–¥ì„ ì¤„ ê°€ëŠ¥ì„±ë„ í•¨ê»˜ ê³ ë ¤í•´ë³¼ í•„ìš”" â†’ ì „íŒŒ ì±…ìž„ ê°•ì¡° ëŠë‚Œ
- âŒ "ì‚¬ëž‘í•˜ëŠ” ê°€ì¡±ì—ê²Œ ì „íŒŒë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤" â†’ ë¶ˆì•ˆ ì¡°ìž¥
- âœ… "ì£¼ë³€ ì‚¬ëžŒë“¤ê³¼ì˜ ìƒí™œ í™˜ê²½ì„ í•¨ê»˜ ê³ ë ¤í•´ë³¼ í•„ìš”ë„ ìžˆìŠµë‹ˆë‹¤"
- âœ… "í•¨ê»˜ ìƒí™œí•˜ëŠ” ë¶„ë“¤ì˜ ê±´ê°•ë„ í•¨ê»˜ ì‹ ê²½ ì“°ê²Œ ë˜ëŠ” ìƒí™©ì´ ìžˆì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤"
- â€» í•µì‹¬: 'ì „íŒŒ/ì˜í–¥' â†’ 'ìƒí™œ í™˜ê²½', 'í•¨ê»˜ ì‹ ê²½ ì“°ê²Œ ë˜ëŠ”'ìœ¼ë¡œ ì™„í™”!

**â€» 13. í–‰ë™ ê²°ì • ìœ ë„ - ë‹¨ì • â†’ ê°€ëŠ¥ì„± í‘œí˜„!**
- âŒ "ì§€ì¼œë³¼ ë‹¨ê³„ëŠ” ì§€ë‚¬ì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤" â†’ ê²°ì • ìœ ë„í˜•, ì‚´ì§ ê°•í•¨
- âŒ "ì´ë¯¸ ì§€ë‚œ ì‹œì ìž…ë‹ˆë‹¤" â†’ ë‹¨ì •í˜•
- âœ… "ì§€ì¼œë³´ê¸°ë³´ë‹¤ í•œ ë²ˆì¯¤ ì›ì¸ì„ êµ¬ë¶„í•´ë³¼ ì‹œì ì¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤"
- âœ… "í™•ì¸ì´ í•„ìš”í•œ ì‹œì ì¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤"
- âœ… "ì ê²€í•´ë³¼ íƒ€ì´ë°ì¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤"
- â€» í•µì‹¬: 'ì§€ë‚¬ìŠµë‹ˆë‹¤' â†’ 'ì‹œì ì¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤'ë¡œ ê°€ëŠ¥ì„± í‘œí˜„!

[ë³‘ì› ì¹´ë“œë‰´ìŠ¤ í†¤ ìµœì í™” - ê´‘ê³  ëŠë‚Œ ì œê±° + ì‹¬ì˜ í†µê³¼!]

**14. mainTitle ë‹¨ì •í˜• ì–´ë¯¸ ì™„í™”:**
- âŒ "~ìž…ë‹ˆë‹¤" ë‹¨ì •í˜• â†’ ì‚´ì§ ê°•í•˜ê²Œ ëŠê»´ì§ˆ ìˆ˜ ìžˆìŒ
- âœ… "~í•˜ëŠ” ìˆœê°„", "~ì˜ ë³€í™”", "~ì¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤"
- ì˜ˆì‹œ:
  âŒ "ë”°ëœ»í•œ ì´ë¶ˆ ì†ê³¼ ì°¨ê°€ìš´ ì•„ì¹¨ ê³µê¸°, í˜ˆê´€ì˜ ë°˜ì‘ìž…ë‹ˆë‹¤"
  âœ… "ë”°ëœ»í•œ ì´ë¶ˆ ì†ê³¼ ì°¨ê°€ìš´ ì•„ì¹¨ ê³µê¸°, í˜ˆê´€ì´ ë°˜ì‘í•˜ëŠ” ìˆœê°„"
  âœ… "ë”°ëœ»í•œ ì‹¤ë‚´ì—ì„œ ì°¨ê°€ìš´ ì•„ì¹¨ ê³µê¸°ë¡œ ë‚˜ì„¤ ë•Œ, í˜ˆê´€ì˜ ë³€í™”"

**15. 'ì „ë¬¸ê°€' ì§ì ‘ ì–¸ê¸‰ ê¸ˆì§€:**
- âŒ subtitle/mainTitleì— "ì „ë¬¸ê°€", "ì „ë¬¸ì˜" ì§ì ‘ ë“±ìž¥ ê¸ˆì§€
- âœ… descriptionì—ì„œë„ ê°€ê¸‰ì  ì–¸ê¸‰í•˜ì§€ ì•ŠëŠ” ê²Œ ë” ì•ˆì „
- â€» ì´ìœ : ë³¸ë¬¸ì— 'ì „ë¬¸ê°€'ê°€ ì—†ìœ¼ë©´ ì˜¤ížˆë ¤ ê´‘ê³  ëŠë‚Œì´ ì¤„ì–´ë“¦

**16. CTA(ë§ˆì§€ë§‰ ìž¥) í•´ì‹œíƒœê·¸ ìœ„ì¹˜ ê·œì¹™:**
- âŒ subtitleì— í•´ì‹œíƒœê·¸ ì§ì ‘ ë„£ê¸° â†’ ê´‘ê³  ëŠë‚Œ!
  ì˜ˆ: subtitle: "#ê²¨ìš¸ì² í˜ˆì•• #ì•„ì¹¨ë‘í†µ #í˜ˆì••ê´€ë¦¬"
- âœ… subtitleì€ ìˆœìˆ˜ í…ìŠ¤íŠ¸ë¡œ, í•´ì‹œíƒœê·¸ëŠ” tags ë°°ì—´ì—ë§Œ!
  ì˜ˆ: subtitle: "ê±´ê°•í•œ ê²¨ìš¸ì„ ìœ„í•œ ìž‘ì€ ì ê²€"
       tags: ["ê²¨ìš¸ì² í˜ˆì••", "ì•„ì¹¨ë‘í†µ", "í˜ˆì••ê´€ë¦¬"]
- â€» í•´ì‹œíƒœê·¸ê°€ CTA ë¶€ì œì— ë“¤ì–´ê°€ë©´ ì˜ë£Œê¸°ê´€ í†¤ì´ ì•„ë‹ˆë¼ ê´‘ê³  í†¤ì´ ë¨

**17. í‘œì§€(1ìž¥) ì œëª© ì„±ê³µ ê³µì‹ - ì‹œê¸°ì„± ê°•í™”!:**
- âœ… ì‹œê¸°ì„± + ì¼ìƒ ì¦ìƒ + ì˜ì‹¬ í”„ë ˆìž„ + í™•ì¸ ê¸°ì¤€
- âœ… "ìš”ì¦˜", "ê²¨ìš¸ì² ", "í™˜ì ˆê¸°" ë“± ì‹œê¸° í‘œí˜„ ì¶”ê°€ ì‹œ í´ë¦­ë¥  ìƒìŠ¹
- âœ… ì§ˆí™˜ ë‹¨ì • ì—†ìŒ, ì§ˆë¬¸í˜• ìœ ì§€
- ì˜ˆì‹œ (CTR ë†’ì€ ìœ í˜•):
  âœ… "ìš”ì¦˜ ìœ¼ìŠ¬ìœ¼ìŠ¬í•œ ì˜¤í•œ, ë‹¨ìˆœ ì¶”ìœ„ê°€ ì•„ë‹ ìˆ˜ ìžˆì–´ìš”"
  âœ… "ê²¨ìš¸ì²  ì•„ì¹¨ë§ˆë‹¤ ë’·ëª©ì´ ë»ê·¼í•˜ë‹¤ë©´? í˜ˆì•• ë³€í™” í™•ì¸ í¬ì¸íŠ¸"
  âœ… "í™˜ì ˆê¸°ì— ìœ ë… ì‹¬í•œ ë‘í†µ, ë‹¨ìˆœ í”¼ë¡œì¼ê¹Œìš”?"

**18. ì¦ìƒ ì œì‹œ ì¹´ë“œ - ë‹¤ë¥¸ ì›ì¸ ì™„ì¶© í•„ìˆ˜:**
- âœ… descriptionì— "ë‹¤ë¥¸ ì›ì¸ìœ¼ë¡œë„ ë‚˜íƒ€ë‚  ìˆ˜ ìžˆì–´" ì™„ì¶© ë¬¸ìž¥ í¬í•¨
- ì˜ˆì‹œ:
  "ë‹¤ë§Œ, ì´ëŠ” ìˆ˜ë©´ ìžì„¸ë‚˜ ìŠ¤íŠ¸ë ˆìŠ¤ ë“± ë‹¤ë¥¸ ì›ì¸ìœ¼ë¡œë„ ë‚˜íƒ€ë‚  ìˆ˜ ìžˆì–´ ì¦ìƒë§Œìœ¼ë¡œ ë‹¨ì •í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤"
- â€» ìžê°€ ëŒ€ìž… âœ” + ë‹¨ì • íšŒí”¼ âœ” + ë¶ˆì•ˆ ì™„ì¶© âœ” = ì˜ë£Œë²• ì•ˆì „

**19. í™•ì¸ ì‹œì  ì¹´ë“œ - í•µì‹¬ ì „í™˜ ìž¥ (ðŸ”¥ì‹¬ì˜ í•µì‹¬!ðŸ”¥):**
- âœ… "~ì¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤" ê°€ëŠ¥ì„± í‘œí˜„ í•„ìˆ˜
- âœ… "ë°˜ë³µëœë‹¤ë©´"ì´ë¼ëŠ” ì¡°ê±´ë¶€ ì „í™˜ ì‚¬ìš©
- âŒ "ì§€ì¼œë³¼ ë‹¨ê³„ëŠ” ì§€ë‚¬ìŠµë‹ˆë‹¤" â†’ ê²°ì • ìœ ë„í˜•, ì‚´ì§ ê°•í•¨
- âœ… "ì§€ì¼œë³´ê¸°ë³´ë‹¤ í•œ ë²ˆì¯¤ ì›ì¸ì„ êµ¬ë¶„í•´ë³¼ ì‹œì ì¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤"
- ì˜ˆì‹œ:
  mainTitle: "ë°˜ë³µë˜ëŠ” ë¶ˆíŽ¸í•¨, í™•ì¸ì´ í•„ìš”í•œ ì‹œì ì¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤"
- â€» ë‚´ì› ê°•ìš” âŒ / ì‹œì  ê³ ì • âœ” = ì „í™˜ë ¥ ìµœê³ 

**20. ê°ê¸°/ë…ê° ë“± ê°ì—¼ì„± ì§ˆí™˜ ì¹´ë“œ - ì „íŒŒ í‘œí˜„ í†¤ ë‹¤ìš´:**
- âŒ "ì£¼ë³€ ê°€ì¡±ì—ê²Œ ì˜í–¥ì„ ì¤„ ê°€ëŠ¥ì„±" â†’ ì „íŒŒ ì±…ìž„ ê°•ì¡° ëŠë‚Œ
- âœ… "ì£¼ë³€ ì‚¬ëžŒë“¤ê³¼ì˜ ìƒí™œ í™˜ê²½ì„ í•¨ê»˜ ê³ ë ¤í•´ë³¼ í•„ìš”ë„ ìžˆìŠµë‹ˆë‹¤"
- â€» ì „íŒŒë³´ë‹¤ 'í•¨ê»˜ ìƒí™œí•˜ëŠ” í™˜ê²½' í”„ë ˆìž„ìœ¼ë¡œ!

[ðŸ’¡ CTA ì¹´ë“œ ëª¨ë²” ë‹µì•ˆ - ì „í™˜ë ¥ ê°•í™” ë²„ì „!]
âœ… mainTitle ì˜ˆì‹œ (ì™œ ì§€ê¸ˆì¸ì§€ ì´ìœ  í¬í•¨!):
  - "ì§€ì¼œë³´ê¸°ë³´ë‹¤\\nê´€ë¦¬ ë°©í–¥ì„ ì •í•  ì‹œì "
  - "ë°˜ë³µëœë‹¤ë©´\\nê¸°ì¤€ì´ í•„ìš”í•©ë‹ˆë‹¤"
  - "ì´ ë‹¨ê³„ì—ì„œëŠ”\\në„˜ê¸°ê¸°ë³´ë‹¤ ì‚´íŽ´ë³¼ ë•Œìž…ë‹ˆë‹¤"
  - "ì§€ê¸ˆì˜ ë¶ˆíŽ¸í•¨ì„ ë„˜ê¸°ë©´\\në” ê¸´ ê´€ë¦¬ê°€ í•„ìš”í•´ì§ˆ ìˆ˜ ìžˆìŠµë‹ˆë‹¤"
âœ… description: "" (ë¹ˆ ë¬¸ìžì—´ - í‘œì§€ì²˜ëŸ¼!)
â†’ ëª…ë ¹ âŒ / íŒë‹¨ â­•
â†’ "ì™œ ì§€ê¸ˆ?" ì´ìœ  í•„ìˆ˜!

[ðŸ“‹ ì¶œë ¥ í•„ë“œ]
- topic: ì£¼ì œ (í•œêµ­ì–´)
- totalSlides: ì´ ìŠ¬ë¼ì´ë“œ ìˆ˜
- overallTheme: ì „ì²´ êµ¬ì¡° ì„¤ëª… (âš ï¸ ë°˜ë“œì‹œ í•œêµ­ì–´! ì˜ì–´ ê¸ˆì§€! 20ìž ì´ë‚´)
  ì˜ˆ: "ê³µê°ê³¼ ì •ë³´ ì „ë‹¬" / "ì¦ìƒ ì²´í¬ â†’ í™•ì¸ ì•ˆë‚´" / "ê±´ê°• ì •ë³´ ê³µìœ "
- slides: ìŠ¬ë¼ì´ë“œ ë°°ì—´`;

  try {
    const response = await ai.models.generateContent({
      model: 'gemini-3-pro-preview',
      contents: prompt,
      config: {
        tools: [{ googleSearch: {} }],
        responseMimeType: "application/json",
        responseSchema: {
          type: Type.OBJECT,
          properties: {
            topic: { type: Type.STRING },
            totalSlides: { type: Type.INTEGER },
            overallTheme: { type: Type.STRING },
            slides: {
              type: Type.ARRAY,
              items: {
                type: Type.OBJECT,
                properties: {
                  slideNumber: { type: Type.INTEGER },
                  slideType: { type: Type.STRING },
                  subtitle: { type: Type.STRING },
                  mainTitle: { type: Type.STRING },
                  description: { type: Type.STRING },
                  tags: { type: Type.ARRAY, items: { type: Type.STRING } },
                  imageKeyword: { type: Type.STRING }
                },
                required: ["slideNumber", "slideType", "subtitle", "mainTitle", "description", "tags", "imageKeyword"]
              }
            }
          },
          required: ["topic", "totalSlides", "slides", "overallTheme"]
        }
      }
    });
    
    const result = JSON.parse(response.text || "{}");
    
    // ðŸš¨ í›„ì²˜ë¦¬: 1ìž¥(í‘œì§€)ê³¼ ë§ˆì§€ë§‰ ìž¥ì˜ description ê°•ì œë¡œ ë¹ˆ ë¬¸ìžì—´ë¡œ!
    if (result.slides && result.slides.length > 0) {
      // 1ìž¥ (í‘œì§€) description ì œê±°
      result.slides[0].description = "";
      
      // ë§ˆì§€ë§‰ ìž¥ description ì œê±°
      if (result.slides.length > 1) {
        result.slides[result.slides.length - 1].description = "";
      }
      
      console.log('ðŸš¨ í‘œì§€/ë§ˆì§€ë§‰ ìž¥ description ê°•ì œ ì œê±° ì™„ë£Œ');
    }
    
    return result;
  } catch (error) {
    console.error('ìŠ¤í† ë¦¬ ê¸°íš ì—ì´ì „íŠ¸ ì‹¤íŒ¨:', error);
    throw error;
  }
};

// ë¶„ì„ëœ ìŠ¤íƒ€ì¼ ì „ì²´ ì¸í„°íŽ˜ì´ìŠ¤
interface AnalyzedStyle {
  frameStyle?: string;
  hasWindowButtons?: boolean;
  windowButtonColors?: string[];
  backgroundColor?: string;
  borderColor?: string;
  borderWidth?: string;
  borderRadius?: string;
  boxShadow?: string;
  subtitleStyle?: { color?: string; fontSize?: string; fontWeight?: string; };
  mainTitleStyle?: { color?: string; fontSize?: string; fontWeight?: string; };
  highlightStyle?: { color?: string; backgroundColor?: string; };
  descStyle?: { color?: string; fontSize?: string; };
  tagStyle?: { backgroundColor?: string; color?: string; borderRadius?: string; };
  illustPosition?: string;
  illustSize?: string;
  padding?: string;
  mood?: string;
  keyFeatures?: string[];
}

// [2ë‹¨ê³„] HTML ì¡°ë¦½ í•¨ìˆ˜ (ë¶„ì„ëœ ìŠ¤íƒ€ì¼ ì „ì²´ ì ìš©)
const assembleCardNewsHtml = (
  story: CardNewsStory,
  styleConfig?: AnalyzedStyle
): string => {
  const bgColor = styleConfig?.backgroundColor || '#E8F4FD';
  const bgGradient = `linear-gradient(180deg, ${bgColor} 0%, ${bgColor}dd 100%)`;
  const accentColor = styleConfig?.borderColor || '#3B82F6';
  
  // ë¶„ì„ëœ ìŠ¤íƒ€ì¼ ì ìš© (ê¸°ë³¸ê°’ í¬í•¨)
  const borderRadius = styleConfig?.borderRadius || '24px';
  const boxShadow = styleConfig?.boxShadow || '0 4px 16px rgba(0,0,0,0.08)';
  const borderWidth = styleConfig?.borderWidth || '0';
  const padding = styleConfig?.padding || '32px 28px';
  
  const subtitle = {
    color: styleConfig?.subtitleStyle?.color || accentColor,
    fontSize: styleConfig?.subtitleStyle?.fontSize || '14px',
    fontWeight: styleConfig?.subtitleStyle?.fontWeight || '700'
  };
  
  const mainTitle = {
    color: styleConfig?.mainTitleStyle?.color || '#1E293B',
    fontSize: styleConfig?.mainTitleStyle?.fontSize || '26px',
    fontWeight: styleConfig?.mainTitleStyle?.fontWeight || '900'
  };
  
  const highlight = {
    color: styleConfig?.highlightStyle?.color || accentColor,
    backgroundColor: styleConfig?.highlightStyle?.backgroundColor || 'transparent'
  };
  
  const desc = {
    color: styleConfig?.descStyle?.color || '#475569',
    fontSize: styleConfig?.descStyle?.fontSize || '15px'
  };
  
  const tag = {
    backgroundColor: styleConfig?.tagStyle?.backgroundColor || `${accentColor}15`,
    color: styleConfig?.tagStyle?.color || accentColor,
    borderRadius: styleConfig?.tagStyle?.borderRadius || '20px'
  };
  
  // ë¸Œë¼ìš°ì € ìœˆë„ìš° ë²„íŠ¼ HTML (ë¶„ì„ëœ ìŠ¤íƒ€ì¼ì— ìžˆìœ¼ë©´ ì ìš©)
  const windowButtonsHtml = styleConfig?.hasWindowButtons ? `
    <div class="window-buttons" style="display: flex; gap: 8px; padding: 12px 16px;">
      <span style="width: 12px; height: 12px; border-radius: 50%; background: ${styleConfig?.windowButtonColors?.[0] || '#FF5F57'};"></span>
      <span style="width: 12px; height: 12px; border-radius: 50%; background: ${styleConfig?.windowButtonColors?.[1] || '#FFBD2E'};"></span>
      <span style="width: 12px; height: 12px; border-radius: 50%; background: ${styleConfig?.windowButtonColors?.[2] || '#28CA41'};"></span>
    </div>` : '';
  
  const slides = story.slides.map((slide, idx) => {
    // mainTitleì—ì„œ <highlight> íƒœê·¸ë¥¼ ì‹¤ì œ spanìœ¼ë¡œ ë³€í™˜ (ë¶„ì„ëœ highlight ìŠ¤íƒ€ì¼ ì ìš©)
    const highlightBg = highlight.backgroundColor !== 'transparent' 
      ? `background: ${highlight.backgroundColor}; padding: 2px 6px; border-radius: 4px;` 
      : '';
    const formattedTitle = slide.mainTitle
      .replace(/<highlight>/g, `<span class="card-highlight" style="color: ${highlight.color}; ${highlightBg}">`)
      .replace(/<\/highlight>/g, '</span>')
      .replace(/\n/g, '<br/>');
    
    // í”„ë ˆìž„ ìŠ¤íƒ€ì¼ì— ë”°ë¥¸ border ì ìš©
    const borderStyle = borderWidth !== '0' ? `border: ${borderWidth} solid ${accentColor};` : '';
    
    // ðŸŽ¨ ì´ë¯¸ì§€ì— í…ìŠ¤íŠ¸ê°€ ë Œë”ë§ë˜ë¯€ë¡œ, HTMLì—ì„œëŠ” ì´ë¯¸ì§€ë§Œ í‘œì‹œ (í…ìŠ¤íŠ¸ ë ˆì´ì–´ ì œê±°)
    return `
      <div class="card-slide" style="background: ${bgGradient}; border-radius: ${borderRadius}; ${borderStyle} box-shadow: ${boxShadow}; overflow: hidden; aspect-ratio: 1/1; position: relative;">
        <div class="card-img-container" style="position: absolute; inset: 0; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center;">[IMG_${idx + 1}]</div>
        <!-- í…ìŠ¤íŠ¸ ë°ì´í„°ëŠ” ìˆ¨ê¹€ ì²˜ë¦¬ (íŽ¸ì§‘/ê²€ìƒ‰ìš©) -->
        <div class="card-text-data" style="display: none;" data-subtitle="${slide.subtitle}" data-title="${slide.mainTitle.replace(/"/g, '&quot;')}" data-desc="${slide.description.replace(/"/g, '&quot;')}"></div>
      </div>`;
  });
  
  return slides.join('\n');
};

// ì¹´ë“œë³„ í”„ë¡¬í”„íŠ¸ ë°ì´í„°ëŠ” types.tsì—ì„œ import

// [3ë‹¨ê³„] ì „ì²´ ì´ë¯¸ì§€ ì¹´ë“œìš© í”„ë¡¬í”„íŠ¸ ìƒì„± ì—ì´ì „íŠ¸
const fullImageCardPromptAgent = async (
  slides: SlideStory[],
  imageStyle: ImageStyle,
  category: string,
  styleConfig?: AnalyzedStyle,
  customImagePrompt?: string  // ì»¤ìŠ¤í…€ ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ ì¶”ê°€!
): Promise<CardPromptData[]> => {
  const ai = getAiClient();
  
  // ðŸš¨ photo/medical ìŠ¤íƒ€ì¼ ì„ íƒ ì‹œ ì»¤ìŠ¤í…€ í”„ë¡¬í”„íŠ¸ ë¬´ì‹œ! (ìŠ¤íƒ€ì¼ ë²„íŠ¼ ìš°ì„ )
  const isFixedStyle = imageStyle === 'photo' || imageStyle === 'medical';
  const hasCustomStyle = !isFixedStyle && customImagePrompt?.trim();
  const styleGuide = isFixedStyle
    ? STYLE_KEYWORDS[imageStyle]  // photo/medicalì€ ê³ ì • ìŠ¤íƒ€ì¼ ì‚¬ìš©
    : (hasCustomStyle ? customImagePrompt!.trim() : STYLE_KEYWORDS[imageStyle] || STYLE_KEYWORDS.illustration);
  
  console.log('ðŸŽ¨ fullImageCardPromptAgent ìŠ¤íƒ€ì¼:', imageStyle, '/ ì»¤ìŠ¤í…€ ì ìš©:', hasCustomStyle ? 'YES' : 'NO (ê³ ì • ìŠ¤íƒ€ì¼)');
  
  // ðŸŽ¨ ìŠ¤íƒ€ì¼ ì°¸ê³  ì´ë¯¸ì§€ê°€ ìžˆìœ¼ë©´ í•´ë‹¹ ìƒ‰ìƒ ì‚¬ìš©, ì—†ìœ¼ë©´ ê¸°ë³¸ê°’
  const bgColor = styleConfig?.backgroundColor || '#E8F4FD';
  const accentColor = styleConfig?.borderColor || '#3B82F6';
  const hasWindowButtons = styleConfig?.hasWindowButtons || false;
  const mood = styleConfig?.mood || 'ë°ê³  ì¹œê·¼í•œ';
  const keyFeatures = styleConfig?.keyFeatures?.join(', ') || '';
  
  // ìŠ¬ë¼ì´ë“œ ì •ë³´ (descriptionì´ ë¹„ì–´ìžˆìœ¼ë©´ ìƒëžµ!)
  const slideSummaries = slides.map((s, i) => {
    const isFirst = i === 0;
    const isLast = i === slides.length - 1;
    const label = isFirst ? ' (í‘œì§€)' : isLast ? ' (ë§ˆì§€ë§‰)' : '';
    const hasDescription = s.description && s.description.trim().length > 0;
    
    // descriptionì´ ì—†ê±°ë‚˜ ë¹„ì–´ìžˆìœ¼ë©´ ìƒëžµ!
    if (!hasDescription) {
      return `${i + 1}ìž¥${label}: subtitle="${s.subtitle}" mainTitle="${s.mainTitle.replace(/<\/?highlight>/g, '')}" âš ï¸description ì—†ìŒ - ì„¤ëª… í…ìŠ¤íŠ¸ ë„£ì§€ ë§ˆì„¸ìš”! ì´ë¯¸ì§€="${s.imageKeyword}"`;
    }
    return `${i + 1}ìž¥${label}: subtitle="${s.subtitle}" mainTitle="${s.mainTitle.replace(/<\/?highlight>/g, '')}" description="${s.description}" ì´ë¯¸ì§€="${s.imageKeyword}"`;
  }).join('\n');

  // ðŸŽ¨ ìŠ¤íƒ€ì¼ ì°¸ê³  ì´ë¯¸ì§€ê°€ ìžˆìœ¼ë©´ í•µì‹¬ ìš”ì†Œë§Œ ì „ë‹¬
  const styleRefInfo = styleConfig ? `
[ðŸŽ¨ ë””ìžì¸ í”„ë ˆìž„ ì°¸ê³ ]
- ë°°ê²½ìƒ‰: ${bgColor}
- ê°•ì¡°ìƒ‰: ${accentColor}
- í”„ë ˆìž„: ${hasWindowButtons ? 'ë¸Œë¼ìš°ì € ì°½ ë²„íŠ¼(ë¹¨/ë…¸/ì´ˆ) í•„ìˆ˜' : 'ë‘¥ê·¼ ì¹´ë“œ'}
- ë¶„ìœ„ê¸°: ${mood}
${keyFeatures ? `- íŠ¹ì§•: ${keyFeatures}` : ''}
` : '';

  // ì»¤ìŠ¤í…€ ìŠ¤íƒ€ì¼ ê°•ì¡° (ìžˆìœ¼ë©´ ìµœìš°ì„  ì ìš©! + ê¸°ë³¸ 3D ìŠ¤íƒ€ì¼ ê¸ˆì§€!)
  const customStyleInfo = hasCustomStyle ? `
[ì¤‘ìš”]
ðŸŽ¯ðŸŽ¯ðŸŽ¯ [ìµœìš°ì„ ] ì»¤ìŠ¤í…€ ìŠ¤íƒ€ì¼ í•„ìˆ˜ ì ìš©! ðŸŽ¯ðŸŽ¯ðŸŽ¯
[ì¤‘ìš”]

ìŠ¤íƒ€ì¼: "${customImagePrompt}"

â›” ì ˆëŒ€ ê¸ˆì§€: 3D ì¼ëŸ¬ìŠ¤íŠ¸, í´ë ˆì´ ë Œë”, ì•„ì´ì†Œë©”íŠ¸ë¦­ ë“± ê¸°ë³¸ ìŠ¤íƒ€ì¼ ì‚¬ìš© ê¸ˆì§€!
âœ… í•„ìˆ˜: ìœ„ì— ëª…ì‹œëœ "${customImagePrompt}" ìŠ¤íƒ€ì¼ë§Œ ì‚¬ìš©í•˜ì„¸ìš”!
` : '';

  const prompt = `ë‹¹ì‹ ì€ ì†Œì…œë¯¸ë””ì–´ ì¹´ë“œë‰´ìŠ¤ ë””ìžì´ë„ˆìž…ë‹ˆë‹¤. ì´ë¯¸ì§€ 1ìž¥ = ì™„ì„±ëœ ì¹´ë“œë‰´ìŠ¤ 1ìž¥!
${customStyleInfo}
${styleRefInfo}
[ìŠ¤íƒ€ì¼] ${styleGuide}
[ì§„ë£Œê³¼] ${category}

[ìŠ¬ë¼ì´ë“œë³„ í…ìŠ¤íŠ¸]
${slideSummaries}

[ì¤‘ìš”]
ðŸš¨ [ìµœìš°ì„ ] ë ˆì´ì•„ì›ƒ ê·œì¹™ - ë°˜ë“œì‹œ ì§€ì¼œì•¼ í•¨! ðŸš¨
[ì¤‘ìš”]

â›”â›”â›” ì ˆëŒ€ ê¸ˆì§€ë˜ëŠ” ë ˆì´ì•„ì›ƒ â›”â›”â›”
- ìƒë‹¨ì— í°ìƒ‰/ë‹¨ìƒ‰ í…ìŠ¤íŠ¸ ì˜ì—­ + í•˜ë‹¨ì— ì¼ëŸ¬ìŠ¤íŠ¸ ì˜ì—­ = 2ë¶„í•  = ê¸ˆì§€!
- í…ìŠ¤íŠ¸ ë°•ìŠ¤ì™€ ì´ë¯¸ì§€ ë°•ìŠ¤ê°€ ë‚˜ë‰˜ì–´ ë³´ì´ëŠ” ë””ìžì¸ = ê¸ˆì§€!
- ìœ„ì•„ëž˜ë¡œ 2ë“±ë¶„ëœ ë“¯í•œ êµ¬ì„± = ê¸ˆì§€!

âœ… ë°˜ë“œì‹œ ì´ë ‡ê²Œ ë§Œë“œì„¸ìš” âœ…
- ì¼ëŸ¬ìŠ¤íŠ¸/ë°°ê²½ì´ ì „ì²´ í™”ë©´(100%)ì„ ì±„ì›€!
- ê·¸ ìœ„ì— í…ìŠ¤íŠ¸ê°€ ì˜¤ë²„ë ˆì´ (ë°˜íˆ¬ëª… ë°°ê²½ ë˜ëŠ” ê·¸ë¦¼ìž íš¨ê³¼ë¡œ ê°€ë…ì„± í™•ë³´)
- ì˜í™” í¬ìŠ¤í„°, ì•¨ë²” ì»¤ë²„, ì¸ìŠ¤íƒ€ê·¸ëž¨ ì¹´ë“œì²˜ëŸ¼ í•˜ë‚˜ì˜ í†µí•© ë””ìžì¸!

[imagePrompt ìž‘ì„±ë²•]
- "ì „ì²´ í™”ë©´ì„ ì±„ìš°ëŠ” [ì¼ëŸ¬ìŠ¤íŠ¸ ë¬˜ì‚¬], ê·¸ ìœ„ì— [í…ìŠ¤íŠ¸] ì˜¤ë²„ë ˆì´" í˜•ì‹
- ì˜ˆ: "ì „ì²´ í™”ë©´ì„ ì±„ìš°ëŠ” ë¹„ì˜¤ëŠ” ì°½ê°€ ì¼ëŸ¬ìŠ¤íŠ¸, ê·¸ ìœ„ì— 'ë¬´ë¦Ž ì‘¤ì‹¬' í…ìŠ¤íŠ¸ ì˜¤ë²„ë ˆì´, íŒŒìŠ¤í…”í†¤"

[ì¹´ë“œ ë ˆì´ì•„ì›ƒ]
- 1ë²ˆ(í‘œì§€)/ë§ˆì§€ë§‰(CTA): ì œëª©+ë¶€ì œ+ì¼ëŸ¬ìŠ¤íŠ¸ë§Œ! ðŸš¨description ì ˆëŒ€ ê¸ˆì§€!
${hasWindowButtons ? '- ë¸Œë¼ìš°ì € ì°½ ë²„íŠ¼(ë¹¨/ë…¸/ì´ˆ) í¬í•¨' : ''}

[í•„ìˆ˜ ê·œì¹™]
- 1:1 ì •ì‚¬ê°í˜•, ë°°ê²½ìƒ‰ ${bgColor}
- âš ï¸ imagePromptëŠ” ë°˜ë“œì‹œ í•œêµ­ì–´ë¡œ!
- í•´ì‹œíƒœê·¸ ê¸ˆì§€
- "âš ï¸description ì—†ìŒ"ì´ë©´ ì„¤ëª… í…ìŠ¤íŠ¸ ë„£ì§€ ë§ˆì„¸ìš”!

[ì˜ë£Œë²•] ê¸ˆì§€: ìƒë‹´í•˜ì„¸ìš”, ë°©ë¬¸í•˜ì„¸ìš”, ì™„ì¹˜, ë³´ìž¥ / í—ˆìš©: ì¦ìƒëª…, ì§ˆí™˜ëª…, ì§ˆë¬¸í˜•`;

  try {
    const response = await ai.models.generateContent({
      model: 'gemini-3-pro-preview',
      contents: prompt,
      config: {
        responseMimeType: "application/json",
        responseSchema: {
          type: Type.OBJECT,
          properties: {
            cards: {
              type: Type.ARRAY,
              items: {
                type: Type.OBJECT,
                properties: {
                  imagePrompt: { type: Type.STRING },
                  textPrompt: {
                    type: Type.OBJECT,
                    properties: {
                      subtitle: { type: Type.STRING },
                      mainTitle: { type: Type.STRING },
                      description: { type: Type.STRING },
                      tags: { type: Type.ARRAY, items: { type: Type.STRING } }
                    },
                    required: ["subtitle", "mainTitle", "description", "tags"]
                  }
                },
                required: ["imagePrompt", "textPrompt"]
              }
            }
          },
          required: ["cards"]
        }
      }
    });
    
    const result = JSON.parse(response.text || '{"cards":[]}');
    
    // ðŸš¨ AIê°€ ìƒì„±í•œ imagePromptëŠ” ë¬´ì‹œí•˜ê³ , ìŠ¬ë¼ì´ë“œ ì •ë³´ + ì‚¬ìš©ìž ìŠ¤íƒ€ì¼ë¡œ ì§ì ‘ ì¡°í•©!
    // AIê°€ ë©‹ëŒ€ë¡œ ë‹¤ë¥¸ í…ìŠ¤íŠ¸/ìŠ¤íƒ€ì¼ì„ ë„£ëŠ” ë¬¸ì œ í•´ê²°
    const cards = slides.map((s, idx) => {
      const isFirst = idx === 0;
      const isLast = idx === slides.length - 1;
      const mainTitleClean = s.mainTitle.replace(/<\/?highlight>/g, '');
      
      // í‘œì§€/ë§ˆì§€ë§‰ì€ description ì—†ìŒ
      const descPart = (isFirst || isLast) ? '' : (s.description ? `, "${s.description}"` : '');
      
      // ðŸ”§ imagePrompt: ì‚¬ìš©ìžì—ê²Œ ë³´ì—¬ì¤„ í•µì‹¬ ì •ë³´ë§Œ! (ì˜ì–´ ì§€ì‹œë¬¸ì€ ìƒì„± ì‹œ ìžë™ ì¶”ê°€)
      // ìŠ¤íƒ€ì¼ì€ generateSingleImageì—ì„œ ê²°ì • (ì¤‘ë³µ ë°©ì§€)
      const descText = (isFirst || isLast) ? '' : (s.description ? `\ndescription: "${s.description}"` : '');
      const imagePrompt = `subtitle: "${s.subtitle}"
mainTitle: "${mainTitleClean}"${descText}
ë¹„ì£¼ì–¼: ${s.imageKeyword}
ë°°ê²½ìƒ‰: ${bgColor}`;
      
      // textPromptëŠ” AI ê²°ê³¼ ì‚¬ìš© (ìžˆìœ¼ë©´) ë˜ëŠ” ìŠ¬ë¼ì´ë“œ ì •ë³´ ì‚¬ìš©
      const aiCard = result.cards?.[idx];
      const textPrompt = aiCard?.textPrompt || {
        subtitle: s.subtitle,
        mainTitle: s.mainTitle,
        description: (isFirst || isLast) ? '' : s.description,
        tags: s.tags
      };
      
      // í‘œì§€/ë§ˆì§€ë§‰ì€ description ê°•ì œ ì œê±°
      if (isFirst || isLast) {
        textPrompt.description = '';
      }
      
      return { imagePrompt, textPrompt };
    });
    
    console.log('ðŸŽ¨ ì¹´ë“œ í”„ë¡¬í”„íŠ¸ ì§ì ‘ ìƒì„± ì™„ë£Œ:', cards.length, 'ìž¥, ìŠ¤íƒ€ì¼:', hasCustomStyle ? 'ì»¤ìŠ¤í…€' : 'ê¸°ë³¸');
    return cards;
  } catch (error) {
    console.error('ì „ì²´ ì´ë¯¸ì§€ ì¹´ë“œ í”„ë¡¬í”„íŠ¸ ì‹¤íŒ¨:', error);
    // ðŸ”§ fallbackë„ ë™ì¼í•˜ê²Œ: ìŠ¤íƒ€ì¼ì€ generateSingleImageì—ì„œ ê²°ì •!
    const fallbackCards = slides.map((s, idx) => {
      const isFirst = idx === 0;
      const isLast = idx === slides.length - 1;
      const mainTitleClean = s.mainTitle.replace(/<\/?highlight>/g, '');
      const descText = (isFirst || isLast) ? '' : (s.description ? `\ndescription: "${s.description}"` : '');
      return {
        imagePrompt: `subtitle: "${s.subtitle}"
mainTitle: "${mainTitleClean}"${descText}
ë¹„ì£¼ì–¼: ${s.imageKeyword}
ë°°ê²½ìƒ‰: ${bgColor}`,
        textPrompt: { 
          subtitle: s.subtitle, 
          mainTitle: s.mainTitle, 
          description: (isFirst || isLast) ? '' : s.description, 
          tags: s.tags 
        }
      };
    });
    console.log('ðŸš¨ [fullImageCardPromptAgent fallback] ì§ì ‘ ìƒì„±, ìŠ¤íƒ€ì¼:', hasCustomStyle ? 'ì»¤ìŠ¤í…€' : 'ê¸°ë³¸');
    return fallbackCards;
  }
};

// [ê¸°ì¡´ í˜¸í™˜] ì´ë¯¸ì§€ë§Œ ìƒì„±í•˜ëŠ” í”„ë¡¬í”„íŠ¸ ì—ì´ì „íŠ¸
const imagePromptAgent = async (
  slides: SlideStory[],
  imageStyle: ImageStyle,
  category: string
): Promise<string[]> => {
  const ai = getAiClient();
  
  const styleGuide = STYLE_KEYWORDS[imageStyle] || STYLE_KEYWORDS.illustration;
  
  const slideSummaries = slides.map((s, i) => `${i + 1}ìž¥: ${s.slideType} - ${s.imageKeyword}`).join('\n');
  
  const prompt = `ë‹¹ì‹ ì€ ì˜ë£Œ/ê±´ê°• ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ ì „ë¬¸ê°€ìž…ë‹ˆë‹¤.

[ë¯¸ì…˜] ê° ìŠ¬ë¼ì´ë“œì— ë§žëŠ” ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ë¥¼ í•œêµ­ì–´ë¡œ ìž‘ì„±í•˜ì„¸ìš”.
[ìŠ¤íƒ€ì¼] ${styleGuide}
[ì§„ë£Œê³¼] ${category}
[ìŠ¬ë¼ì´ë“œ] ${slideSummaries}

[ê·œì¹™]
- í•œêµ­ì–´ë¡œ ìž‘ì„±
- 4:3 ë¹„ìœ¨ ì í•©
- ë¡œê³ /ì›Œí„°ë§ˆí¬ ê¸ˆì§€
- ì˜ë£Œë²• ìœ„ë°˜ ë¬¸êµ¬ ê¸ˆì§€ (ìƒë‹´/ë°©ë¬¸/ì˜ˆì•½/ì™„ì¹˜/ë³´ìž¥)
- í—ˆìš©: ì¦ìƒëª…, ì§ˆí™˜ëª…, ì •ë³´ì„± í‚¤ì›Œë“œ, ì§ˆë¬¸í˜•, ìˆ«ìž

ì˜ˆì‹œ: "ê°€ìŠ´ í†µì¦ì„ ëŠë¼ëŠ” ì¤‘ë…„ ë‚¨ì„±, 3D ì¼ëŸ¬ìŠ¤íŠ¸, íŒŒëž€ìƒ‰ ë°°ê²½, ë°ì€ í†¤"`;

  try {
    const response = await ai.models.generateContent({
      model: 'gemini-3-pro-preview',
      contents: prompt,
      config: {
        responseMimeType: "application/json",
        responseSchema: {
          type: Type.OBJECT,
          properties: { prompts: { type: Type.ARRAY, items: { type: Type.STRING } } },
          required: ["prompts"]
        }
      }
    });
    
    const result = JSON.parse(response.text || '{"prompts":[]}');
    return result.prompts || [];
  } catch (error) {
    console.error('ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ ì—ì´ì „íŠ¸ ì‹¤íŒ¨:', error);
    return slides.map(s => `${s.imageKeyword}, ${styleGuide}`);
  }
};

// ============================================
// ðŸŽ¯ 2ë‹¨ê³„ ì›Œí¬í”Œë¡œìš°: ì›ê³  ìƒì„± â†’ ì‚¬ìš©ìž í™•ì¸ â†’ ì¹´ë“œë‰´ìŠ¤ ë””ìžì¸
// ============================================

// [1ë‹¨ê³„] ì›ê³  ìƒì„± í•¨ìˆ˜ - ë¸”ë¡œê·¸ì™€ ë™ì¼í•œ ê²€ì¦ëœ í”„ë¡¬í”„íŠ¸ ì‚¬ìš©
export const generateCardNewsScript = async (
  request: GenerationRequest,
  onProgress: (msg: string) => void
): Promise<CardNewsScript> => {
  const ai = getAiClient();
  const slideCount = request.slideCount || 6;
  const writingStyle = request.writingStyle || 'empathy';
  const writingStylePrompt = getWritingStylePrompts()[writingStyle];
  
  // ë¸”ë¡œê·¸ì™€ ë™ì¼í•œ ê²€ì¦ëœ í”„ë¡¬í”„íŠ¸ êµ¬ì¡° ì‚¬ìš©
  const medicalSafetyPrompt = getMedicalSafetyPrompt();
  const aiFeedbackRules = getAIFeedbackPrompt();
  
  onProgress('ðŸ“ [1ë‹¨ê³„] ì›ê³  ê¸°íš ì¤‘...');
  
  const prompt = `
${medicalSafetyPrompt}
${aiFeedbackRules}
${writingStylePrompt}
${getWritingStyleCommonRules()}
${PSYCHOLOGY_CTA_PROMPT}

[ì¤‘ìš”]
ðŸŽ¯ ì¹´ë“œë‰´ìŠ¤ ì›ê³  ìž‘ì„± ë¯¸ì…˜
[ì¤‘ìš”]

[ë¯¸ì…˜] "${request.topic}" ì£¼ì œë¡œ ${slideCount}ìž¥ì§œë¦¬ **ì¹´ë“œë‰´ìŠ¤ ì›ê³ **ë¥¼ ìž‘ì„±í•˜ì„¸ìš”.
[ì§„ë£Œê³¼] ${request.category}
[ê¸€ ìŠ¤íƒ€ì¼] ${writingStyle === 'expert' ? 'ì „ë¬¸ê°€í˜•(ì‹ ë¢°Â·ê¶Œìœ„)' : writingStyle === 'empathy' ? 'ê³µê°í˜•(ë…ìž ê³µê°)' : 'ì „í™˜í˜•(ì •ë³´â†’í™•ì¸ ìœ ë„)'}

${CONTENT_DESCRIPTION}

[[ì‹¬ë¦¬] í•µì‹¬ ì›ì¹™: ì¹´ë“œë‰´ìŠ¤ëŠ” "ì •ë³´ ë‚˜ì—´"ì´ ì•„ë‹ˆë¼ "ì‹¬ë¦¬ íë¦„"ì´ë‹¤!]
- ì¹´ë“œë‰´ìŠ¤ëŠ” ìŠ¬ë¼ì´ë“œí˜• ì„¤ë“ êµ¬ì¡°
- ê° ì¹´ë“œëŠ” **ì„œë¡œ ë‹¤ë¥¸ ì‹¬ë¦¬ì  ì—­í• **ì„ ê°€ì ¸ì•¼ í•¨
- ìƒí™œìŠµê´€(ìš´ë™, ì‹ë‹¨, ê¸ˆì—° ë“±)ì€ **ë³´ì¡° ì •ë³´ë¡œë§Œ** (ìµœëŒ€ 1ìž¥)
- ë§ˆì§€ë§‰ 2ìž¥ì€ ë°˜ë“œì‹œ "ì‹œì  ê³ ì •" + "ì•ˆì „í•œ CTA"

[ì¤‘ìš”]
ðŸ“ ê° ìŠ¬ë¼ì´ë“œë³„ ìž‘ì„± ë‚´ìš©
[ì¤‘ìš”]

1. **subtitle** (10-15ìž): ì§ˆë¬¸í˜• ë˜ëŠ” í•µì‹¬ í¬ì¸íŠ¸
   ì˜ˆ: "ì™œ ì¤‘ìš”í• ê¹Œìš”?", "í˜¹ì‹œ ì´ëŸ° ì¦ìƒ?"

2. **mainTitle** (15-25ìž): í•µì‹¬ ë©”ì‹œì§€, ì¤„ë°”ê¿ˆ(\\n) í¬í•¨ ê°€ëŠ¥
   ì˜ˆ: "ì´ ì‹ í˜¸ë¥¼\\në†“ì¹˜ì§€ ë§ˆì„¸ìš”"
   - ê°•ì¡°í•  ë¶€ë¶„ì€ <highlight>íƒœê·¸</highlight>ë¡œ ê°ì‹¸ê¸°

3. **description** (40-80ìž): êµ¬ì²´ì ì¸ ì„¤ëª…ë¬¸
   - ë…ìžê°€ ì–»ì–´ê°ˆ ì •ë³´ê°€ ìžˆì–´ì•¼ í•¨!
   - ë„ˆë¬´ ì§§ìœ¼ë©´ ì•ˆ ë¨ (ìµœì†Œ 40ìž)
   - ìœ„ ì˜ë£Œë²• ì¤€ìˆ˜ ê·œì¹™ ì ìš© í•„ìˆ˜!

4. **speakingNote** (50-100ìž): ì´ ìŠ¬ë¼ì´ë“œì—ì„œ ì „ë‹¬í•˜ê³  ì‹¶ì€ í•µì‹¬ ë©”ì‹œì§€
   - íŽ¸ì§‘ìž/ìž‘ì„±ìžê°€ ì°¸ê³ í•  ë‚´ë¶€ ë©”ëª¨
   - ì™œ ì´ ë‚´ìš©ì´ í•„ìš”í•œì§€, ë…ìžì—ê²Œ ì–´ë–¤ ê°ì •ì„ ìœ ë°œí•´ì•¼ í•˜ëŠ”ì§€
   - ì˜ˆ: "ë…ìžê°€ 'ë‚˜ë„ ê·¸ëŸ° ì¦ìƒ ìžˆëŠ”ë°?' í•˜ê³  ê³µê°í•˜ê²Œ ë§Œë“¤ì–´ì•¼ í•¨"

5. **imageKeyword** (10-20ìž): ì´ë¯¸ì§€ ìƒì„±ì„ ìœ„í•œ í•µì‹¬ í‚¤ì›Œë“œ
   ì˜ˆ: "ì‹¬ìž¥ ë“¤ê³  ìžˆëŠ” ì˜ì‚¬", "í”¼ë¡œí•œ ì§ìž¥ì¸"

[ì¤‘ìš”]
ðŸŽ­ ì¹´ë“œë³„ ì‹¬ë¦¬ì  ì—­í•  - ${slideCount}ìž¥ ê¸°ì¤€
[ì¤‘ìš”]

**1ìž¥ - ì£¼ì˜ í™˜ê¸° (í‘œì§€)**
- slideType: "cover"
- ìœ„í—˜ ì¸ì‹ ìœ ë„, í¥ë¯¸ ìœ ë°œ
- ê³µí¬ ì¡°ìž¥ ê¸ˆì§€, ì§ˆë¬¸í˜• ë˜ëŠ” ë°˜ì „í˜• ë¬¸êµ¬
- speakingNote: "ë…ìžì˜ ê´€ì‹¬ì„ ëŒì–´ì•¼ í•¨. 'ì–´? ë‚˜ë„?' ë°˜ì‘ ìœ ë„"

**2ìž¥ - ì˜¤í•´ ê¹¨ê¸° (ê°œë… ì •ë¦¬)**
- slideType: "concept"
- ì°©ê°ì„ ë°”ë¡œìž¡ëŠ” ë©”ì‹œì§€
- speakingNote: "ìž˜ëª»ëœ ìƒì‹ì„ ê¹¨ê³  ì˜¬ë°”ë¥¸ ì •ë³´ ì œê³µ"

${slideCount >= 5 ? `**3ìž¥ - ë³€í™” ì‹ í˜¸ ì²´í¬ (ì¦ìƒ ì²´í¬)**
- slideType: "content"
- ëŒ€í‘œì  ì¦ìƒ 2-3ê°€ì§€ ëª…í™•ížˆ
- âš ï¸ ì œëª©: "ìœ„í—˜ ì‹ í˜¸"ë³´ë‹¤ "ë³€í™” ì‹ í˜¸", "ì²´í¬ í¬ì¸íŠ¸" ì„ í˜¸
- âš ï¸ ì¦ìƒ ì„¤ëª… í›„ "ë‹¤ë¥¸ ì›ì¸ ê°€ëŠ¥ì„±" ì™„ì¶© ë¬¸ìž¥ í•„ìˆ˜!
- speakingNote: "êµ¬ì²´ì  ì¦ìƒì„ ë‚˜ì—´í•´ 'ìžê°€ ì²´í¬' ëŠë‚Œ"` : ''}

${slideCount >= 6 ? `**4ìž¥ - ìžê°€ íŒë‹¨ì˜ í•œê³„**
- slideType: "content"
- ê²€ì‚¬Â·ì˜í•™ì  í™•ì¸ í•„ìš”ì„± ê°•ì¡°
- speakingNote: "í˜¼ìž íŒë‹¨í•˜ë©´ ì•ˆ ë˜ëŠ” ì´ìœ  ì„¤ëª…"` : ''}

${slideCount >= 7 ? `**5~${slideCount-2}ìž¥ - ì¶”ê°€ ì •ë³´/ì‚¬ë¡€**
- slideType: "content"
- êµ¬ì²´ì  ì¦ìƒ ì„¤ëª…, ê´€ë ¨ ì •ë³´
- ìƒí™œìŠµê´€ì€ ìµœëŒ€ 1ìž¥ë§Œ!` : ''}

**${slideCount-1}ìž¥ - ì‹œì  ê³ ì • (ðŸ”¥ í•µì‹¬! ðŸ”¥)**
- slideType: "content"
- "ì´ëŸ° ì¦ìƒì´ ë‚˜íƒ€ë‚¬ë‹¤ë©´" â†’ "ì§€ì¼œë³´ê¸°ë³´ë‹¤ í™•ì¸ ì‹œì ì¼ ìˆ˜ ìžˆì–´ìš”"
- âš ï¸ êµ¬ì²´ì  ì‹œê°„(2ì£¼, 48ì‹œê°„ ë“±) ì ˆëŒ€ ê¸ˆì§€! ë²”ì£¼í˜•ìœ¼ë¡œ!
- speakingNote: "ì§€ê¸ˆì´ í™•ì¸í•  íƒ€ì´ë°ì´ë¼ëŠ” ê²ƒì„ ì¸ì‹ì‹œí‚¤ê¸°"

**${slideCount}ìž¥ - ì•ˆì „í•œ CTA**
- slideType: "closing"
- âš ï¸ ìœ„ CTA ì‹¬ë¦¬í•™ ê°€ì´ë“œ ì°¸ì¡°í•˜ì—¬ ìž‘ì„±!
- "ë¶ˆíŽ¸í•¨ì´ ë°˜ë³µëœë‹¤ë©´ ì „ë¬¸ì ì¸ í™•ì¸ì„ ê³ ë ¤í•´ë³¼ ìˆ˜ ìžˆì–´ìš”"
- speakingNote: "ì§ì ‘ ê¶Œìœ  ì—†ì´ í–‰ë™ì„ ìœ ë„í•˜ëŠ” ë¶€ë“œëŸ¬ìš´ ë§ˆë¬´ë¦¬"

[ì¤‘ìš”]
â€¢ SEO ìµœì í™” - ë„¤ì´ë²„/ì¸ìŠ¤íƒ€ê·¸ëž¨ ë…¸ì¶œìš©
[ì¤‘ìš”]

1. **í‘œì§€ ì œëª© SEO**
   - í•µì‹¬ í‚¤ì›Œë“œë¥¼ ì œëª© ì•žë¶€ë¶„ì— ë°°ì¹˜
   - ê²€ìƒ‰ ì˜ë„ì— ë§žëŠ” ì§ˆë¬¸í˜•/í˜¸ê¸°ì‹¬í˜• ì œëª©
   âœ… "í”¼ë¶€ê±´ì¡° ì›ì¸, ê²¨ìš¸ì— ë” ì‹¬í•´ì§€ëŠ” ì´ìœ "
   âŒ "í”¼ë¶€ì— ëŒ€í•´ ì•Œì•„ë´ìš”"

2. **í•´ì‹œíƒœê·¸ ì „ëžµ (ë§ˆì§€ë§‰ ì¹´ë“œ)**
   - ê²€ìƒ‰ëŸ‰ ë†’ì€ í‚¤ì›Œë“œ 5-7ê°œ
   - ë¡±í…Œì¼ í‚¤ì›Œë“œ í¬í•¨
   âœ… #í”¼ë¶€ê±´ì¡° #ê²¨ìš¸ì² í”¼ë¶€ê´€ë¦¬ #í”¼ë¶€ë³´ìŠµ #ê±´ì¡°í•œí”¼ë¶€ì¼€ì–´

3. **ê° ì¹´ë“œ mainTitleì— í‚¤ì›Œë“œ ìžì—°ìŠ¤ëŸ½ê²Œ í¬í•¨**
   - í•µì‹¬ í‚¤ì›Œë“œê°€ ì „ì²´ ì¹´ë“œì— 3-5íšŒ ë¶„ì‚°
   - ë™ì˜ì–´/ìœ ì‚¬ì–´ í•¨ê»˜ ì‚¬ìš©

[ì¤‘ìš”]
âš ï¸ ìµœì¢… ì²´í¬ë¦¬ìŠ¤íŠ¸
[ì¤‘ìš”]
â–¡ ì œëª©ì— 'ì¹˜ë£Œ/í•­ì•”/ì „ë¬¸ì˜ ê¶Œìž¥/ì´ì •ë¦¬' ì—†ëŠ”ì§€?
â–¡ ë„ìž…ë¶€ì— ìžê¸°ì†Œê°œ('ì—ë””í„°ìž…ë‹ˆë‹¤') ì—†ëŠ”ì§€?
â–¡ ìˆ«ìž/ì‹œê°„ì´ ë²”ì£¼í˜•ìœ¼ë¡œ í‘œí˜„ë˜ì—ˆëŠ”ì§€?
â–¡ ì¦ìƒ ì„¤ëª… í›„ 'ë‹¤ë¥¸ ì›ì¸ ê°€ëŠ¥ì„±' ë¬¸ìž¥ ìžˆëŠ”ì§€?
â–¡ CTAê°€ ì§ì ‘ ê¶Œìœ  ì—†ì´ ì™„ê³¡í•˜ê²Œ ìž‘ì„±ë˜ì—ˆëŠ”ì§€?
â–¡ ì—°ë„/ì›”ì´ ê³„ì ˆ í‘œí˜„ìœ¼ë¡œ ì¼ë°˜í™”ë˜ì—ˆëŠ”ì§€?
â–¡ í•µì‹¬ í‚¤ì›Œë“œê°€ í‘œì§€ ì œëª© ì•žë¶€ë¶„ì— ë°°ì¹˜ë˜ì—ˆëŠ”ì§€? (SEO)

[ðŸ“‹ ì¶œë ¥ í•„ë“œ - ëª¨ë“  í•„ë“œëŠ” í•œêµ­ì–´ë¡œ ìž‘ì„±!]
- title: ì œëª© (í•œêµ­ì–´)
- topic: ì£¼ì œ (í•œêµ­ì–´)
- overallTheme: ì „ì²´ êµ¬ì¡° ì„¤ëª… (âš ï¸ ë°˜ë“œì‹œ í•œêµ­ì–´! ì˜ì–´ ê¸ˆì§€! 20ìž ì´ë‚´)
  ì˜ˆ: "ê³µê°ê³¼ ì •ë³´ ì „ë‹¬" / "ì¦ìƒ ì²´í¬ â†’ í™•ì¸ ì•ˆë‚´" / "ê±´ê°• ì •ë³´ ê³µìœ "`;

  try {
    const response = await ai.models.generateContent({
      model: 'gemini-3-pro-preview',
      contents: prompt,
      config: {
        tools: [{ googleSearch: {} }],
        responseMimeType: "application/json",
        responseSchema: {
          type: Type.OBJECT,
          properties: {
            title: { type: Type.STRING },
            topic: { type: Type.STRING },
            totalSlides: { type: Type.INTEGER },
            overallTheme: { type: Type.STRING },
            slides: {
              type: Type.ARRAY,
              items: {
                type: Type.OBJECT,
                properties: {
                  slideNumber: { type: Type.INTEGER },
                  slideType: { type: Type.STRING },
                  subtitle: { type: Type.STRING },
                  mainTitle: { type: Type.STRING },
                  description: { type: Type.STRING },
                  speakingNote: { type: Type.STRING },
                  imageKeyword: { type: Type.STRING }
                },
                required: ["slideNumber", "slideType", "subtitle", "mainTitle", "description", "speakingNote", "imageKeyword"]
              }
            }
          },
          required: ["title", "topic", "totalSlides", "slides", "overallTheme"]
        }
      }
    });
    
    const result = JSON.parse(response.text || "{}");
    
    // ðŸš¨ í›„ì²˜ë¦¬: 1ìž¥(í‘œì§€)ê³¼ ë§ˆì§€ë§‰ ìž¥ì˜ description ê°•ì œë¡œ ë¹ˆ ë¬¸ìžì—´ë¡œ!
    if (result.slides && result.slides.length > 0) {
      // 1ìž¥ (í‘œì§€) description ì œê±°
      result.slides[0].description = "";
      
      // ë§ˆì§€ë§‰ ìž¥ description ì œê±°
      if (result.slides.length > 1) {
        result.slides[result.slides.length - 1].description = "";
      }
      
      console.log('ðŸš¨ [generateCardNewsScript] í‘œì§€/ë§ˆì§€ë§‰ ìž¥ description ê°•ì œ ì œê±° ì™„ë£Œ');
    }
    
    onProgress(`âœ… ì›ê³  ìƒì„± ì™„ë£Œ (${result.slides?.length || 0}ìž¥)`);
    
    return result as CardNewsScript;
  } catch (error) {
    console.error('ì›ê³  ìƒì„± ì‹¤íŒ¨:', error);
    throw error;
  }
};

// [2ë‹¨ê³„] ì›ê³ ë¥¼ ì¹´ë“œë‰´ìŠ¤ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜
export const convertScriptToCardNews = async (
  script: CardNewsScript,
  request: GenerationRequest,
  onProgress: (msg: string) => void
): Promise<{ content: string; imagePrompts: string[]; cardPrompts: CardPromptData[]; title: string; }> => {
  onProgress('ðŸŽ¨ [2ë‹¨ê³„] ì¹´ë“œë‰´ìŠ¤ ë””ìžì¸ ë³€í™˜ ì¤‘...');
  
  // ìŠ¤í† ë¦¬ë¥¼ SlideStory í˜•ì‹ìœ¼ë¡œ ë³€í™˜ (ê¸°ì¡´ í•¨ìˆ˜ì™€ í˜¸í™˜)
  const slides: SlideStory[] = script.slides.map(s => ({
    slideNumber: s.slideNumber,
    slideType: s.slideType as 'cover' | 'concept' | 'content' | 'closing',
    subtitle: s.subtitle,
    mainTitle: s.mainTitle,
    description: s.description,
    tags: [], // íƒœê·¸ëŠ” í”„ë¡¬í”„íŠ¸ ìƒì„± ì‹œ ì¶”ê°€ë¨
    imageKeyword: s.imageKeyword
  }));
  
  // ìŠ¤íƒ€ì¼ ë¶„ì„ (ì°¸ê³  ì´ë¯¸ì§€ê°€ ìžˆëŠ” ê²½ìš°)
  let styleConfig: AnalyzedStyle | undefined;
  if (request.coverStyleImage || request.contentStyleImage) {
    try {
      const styleImage = request.coverStyleImage || request.contentStyleImage;
      onProgress('ðŸŽ¨ ì°¸ê³  ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼ ë¶„ì„ ì¤‘...');
      const styleJson = await analyzeStyleReferenceImage(styleImage!, !!request.coverStyleImage);
      styleConfig = JSON.parse(styleJson);
      const features = styleConfig?.keyFeatures?.slice(0, 3).join(', ') || '';
      onProgress(`ìŠ¤íƒ€ì¼ ì ìš©: ${styleConfig?.backgroundColor || 'ë¶„ì„ë¨'} ${features ? `(${features})` : ''}`);
    } catch (e) {
      console.warn('ìŠ¤íƒ€ì¼ ë¶„ì„ ì‹¤íŒ¨, ê¸°ë³¸ ìŠ¤íƒ€ì¼ ì‚¬ìš©:', e);
    }
  }
  
  // HTML ì¡°ë¦½
  onProgress('ðŸ—ï¸ ì¹´ë“œ êµ¬ì¡° ìƒì„± ì¤‘...');
  const htmlContent = assembleCardNewsHtml({ ...script, slides }, styleConfig);
  
  // ì¹´ë“œ í”„ë¡¬í”„íŠ¸ ìƒì„± (ì»¤ìŠ¤í…€ ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ ì „ë‹¬!)
  onProgress('ðŸŽ¨ ì¹´ë“œ ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ ìƒì„± ì¤‘...');
  const cardPrompts = await fullImageCardPromptAgent(
    slides,
    request.imageStyle || 'illustration',
    request.category,
    styleConfig,
    request.customImagePrompt  // ì»¤ìŠ¤í…€ í”„ë¡¬í”„íŠ¸ ì „ë‹¬!
  );
  
  // ê³µí†µ í•¨ìˆ˜ë¡œ í”„ë¡¬í”„íŠ¸ ì •ë¦¬
  const imagePrompts = cardPrompts.map(c => cleanImagePromptText(c.imagePrompt));
  onProgress(`âœ… ì¹´ë“œë‰´ìŠ¤ ë””ìžì¸ ë³€í™˜ ì™„ë£Œ (${cardPrompts.length}ìž¥)`);
  
  return {
    content: htmlContent,
    imagePrompts,
    cardPrompts,
    title: script.title
  };
};

// [í†µí•©] ë¯¸ë‹ˆ ì—ì´ì „íŠ¸ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„° (ê¸°ì¡´ í˜¸í™˜ ìœ ì§€)
export const generateCardNewsWithAgents = async (
  request: GenerationRequest,
  onProgress: (msg: string) => void
): Promise<{ content: string; imagePrompts: string[]; cardPrompts: CardPromptData[]; title: string; }> => {
  const slideCount = request.slideCount || 6;
  
  // 1ë‹¨ê³„: ìŠ¤í† ë¦¬ ê¸°íš
  onProgress('ðŸ“ [1/3] ìŠ¤í† ë¦¬ ê¸°íš ì¤‘...');
  const story = await storyPlannerAgent(
    request.topic,
    request.category,
    slideCount,
    request.writingStyle || 'empathy'
  );
  
  if (!story.slides || story.slides.length === 0) {
    throw new Error('ìŠ¤í† ë¦¬ ê¸°íš ì‹¤íŒ¨: ìŠ¬ë¼ì´ë“œê°€ ìƒì„±ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
  }
  
  onProgress(`âœ… ìŠ¤í† ë¦¬ ê¸°íš ì™„ë£Œ (${story.slides.length}ìž¥)`);
  
  // 2ë‹¨ê³„: HTML ì¡°ë¦½
  onProgress('ðŸ—ï¸ [2/3] ì¹´ë“œ êµ¬ì¡° ìƒì„± ì¤‘...');
  
  // ìŠ¤íƒ€ì¼ ë¶„ì„ ê²°ê³¼ê°€ ìžˆìœ¼ë©´ ì „ì²´ ìŠ¤íƒ€ì¼ ì ìš©
  let styleConfig: AnalyzedStyle | undefined;
  if (request.coverStyleImage || request.contentStyleImage) {
    try {
      const styleImage = request.coverStyleImage || request.contentStyleImage;
      onProgress('ðŸŽ¨ ì°¸ê³  ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼ ë¶„ì„ ì¤‘...');
      const styleJson = await analyzeStyleReferenceImage(styleImage!, !!request.coverStyleImage);
      const parsed = JSON.parse(styleJson);
      
      // ì „ì²´ ìŠ¤íƒ€ì¼ ì •ë³´ ì „ë‹¬ (ìƒ‰ìƒë¿ë§Œ ì•„ë‹ˆë¼ í°íŠ¸, ë ˆì´ì•„ì›ƒ, í”„ë ˆìž„ ë“± ëª¨ë‘)
      styleConfig = {
        frameStyle: parsed.frameStyle,
        hasWindowButtons: parsed.hasWindowButtons,
        windowButtonColors: parsed.windowButtonColors,
        backgroundColor: parsed.backgroundColor,
        borderColor: parsed.borderColor,
        borderWidth: parsed.borderWidth,
        borderRadius: parsed.borderRadius,
        boxShadow: parsed.boxShadow,
        subtitleStyle: parsed.subtitleStyle,
        mainTitleStyle: parsed.mainTitleStyle,
        highlightStyle: parsed.highlightStyle,
        descStyle: parsed.descStyle,
        tagStyle: parsed.tagStyle,
        illustPosition: parsed.illustPosition,
        illustSize: parsed.illustSize,
        padding: parsed.padding,
        mood: parsed.mood,
        keyFeatures: parsed.keyFeatures
      };
      
      const features = parsed.keyFeatures?.slice(0, 3).join(', ') || '';
      onProgress(`ìŠ¤íƒ€ì¼ ì ìš©: ${parsed.backgroundColor || 'ë¶„ì„ë¨'} ${features ? `(${features})` : ''}`);
    } catch (e) {
      console.warn('ìŠ¤íƒ€ì¼ ë¶„ì„ ì‹¤íŒ¨, ê¸°ë³¸ ìŠ¤íƒ€ì¼ ì‚¬ìš©:', e);
    }
  }
  
  const htmlContent = assembleCardNewsHtml(story, styleConfig);
  onProgress('âœ… ì¹´ë“œ êµ¬ì¡° ìƒì„± ì™„ë£Œ');
  
  // 3ë‹¨ê³„: ì „ì²´ ì´ë¯¸ì§€ ì¹´ë“œ í”„ë¡¬í”„íŠ¸ ìƒì„± (í…ìŠ¤íŠ¸ + ì´ë¯¸ì§€ í†µí•©)
  onProgress('ðŸŽ¨ [3/3] ì¹´ë“œ í”„ë¡¬í”„íŠ¸ ìƒì„± ì¤‘...');
  const cardPrompts = await fullImageCardPromptAgent(
    story.slides,
    request.imageStyle || 'illustration',
    request.category,
    styleConfig,
    request.customImagePrompt  // ì»¤ìŠ¤í…€ í”„ë¡¬í”„íŠ¸ ì „ë‹¬!
  );
  
  // ê³µí†µ í•¨ìˆ˜ë¡œ í”„ë¡¬í”„íŠ¸ ì •ë¦¬
  const imagePrompts = cardPrompts.map(c => cleanImagePromptText(c.imagePrompt));
  onProgress(`âœ… ì¹´ë“œ í”„ë¡¬í”„íŠ¸ ${cardPrompts.length}ê°œ ìƒì„± ì™„ë£Œ`);
  
  return {
    content: htmlContent,
    imagePrompts,
    cardPrompts, // ìƒˆë¡œ ì¶”ê°€: í…ìŠ¤íŠ¸+ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ ì „ì²´
    title: story.topic
  };
};

// ============================================
// ê¸°ì¡´ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ ìƒì„± í•¨ìˆ˜ (ìœ ì§€)
// ============================================

export const generateBlogPostText = async (request: GenerationRequest, onProgress?: (msg: string) => void): Promise<{
    title: string;
    content: string;
    imagePrompts: string[];
    fact_check: FactCheckReport;
    analyzedStyle?: { backgroundColor?: string; borderColor?: string; };
    seoScore?: SeoScoreReport;
}> => {
  // ðŸ“Š ì„±ëŠ¥ ì¸¡ì • ì‹œìž‘
  const startTime = Date.now();
  let retryCount = 0;
  let errorOccurred = false;
  let errorMessage = '';

  // onProgressê°€ ì—†ìœ¼ë©´ ì½˜ì†” ë¡œê·¸ë¡œ ëŒ€ì²´
  const safeProgress = onProgress || ((msg: string) => console.log('ðŸ“ BlogText Progress:', msg));
  const ai = getAiClient();
  const isCardNews = request.postType === 'card_news';
  const targetLength = request.textLength || 2000;
  const targetSlides = request.slideCount || 6;
  
  // ìŠ¤íƒ€ì¼ ì°¸ê³  ì´ë¯¸ì§€ ë¶„ì„ (ì¹´ë“œë‰´ìŠ¤ì¼ ë•Œë§Œ - í‘œì§€/ë³¸ë¬¸ ë¶„ë¦¬)
  let coverStyleAnalysis = '';
  let contentStyleAnalysis = '';
  let analyzedBgColor = '';
  
  if (isCardNews) {
    // í‘œì§€ ìŠ¤íƒ€ì¼ ë¶„ì„
    if (request.coverStyleImage) {
      try {
        coverStyleAnalysis = await analyzeStyleReferenceImage(request.coverStyleImage, true);
      } catch (e) {
        console.warn('í‘œì§€ ìŠ¤íƒ€ì¼ ë¶„ì„ ì‹¤íŒ¨:', e);
      }
    }
    
    // ë³¸ë¬¸ ìŠ¤íƒ€ì¼ ë¶„ì„
    if (request.contentStyleImage) {
      try {
        contentStyleAnalysis = await analyzeStyleReferenceImage(request.contentStyleImage, false);
      } catch (e) {
        console.warn('ë³¸ë¬¸ ìŠ¤íƒ€ì¼ ë¶„ì„ ì‹¤íŒ¨:', e);
      }
    }
    
    // í‘œì§€ë§Œ ìžˆìœ¼ë©´ ë³¸ë¬¸ë„ ê°™ì€ ìŠ¤íƒ€ì¼ ì ìš©
    if (coverStyleAnalysis && !contentStyleAnalysis) {
      contentStyleAnalysis = coverStyleAnalysis;
    }
  }
  
  // ìŠ¤íƒ€ì¼ ë¶„ì„ ê²°ê³¼ë¥¼ í”„ë¡¬í”„íŠ¸ì— ì ìš©
  let styleAnalysis = '';
  let coverStyle: any = {};
  let contentStyle: any = {};
  
  if (coverStyleAnalysis || contentStyleAnalysis) {
    // JSON íŒŒì‹± ì‹œë„
    try {
      if (coverStyleAnalysis) coverStyle = JSON.parse(coverStyleAnalysis);
      if (contentStyleAnalysis) contentStyle = JSON.parse(contentStyleAnalysis);
      // ë°°ê²½ìƒ‰ ì €ìž¥ (í›„ì²˜ë¦¬ìš©)
      analyzedBgColor = coverStyle.backgroundColor || contentStyle.backgroundColor || '';
    } catch (e) {
      // JSON íŒŒì‹± ì‹¤íŒ¨ ì‹œ ì›ë³¸ í…ìŠ¤íŠ¸ ì‚¬ìš©
      console.warn('ìŠ¤íƒ€ì¼ JSON íŒŒì‹± ì‹¤íŒ¨:', e);
    }
    
    // ë¸Œë¼ìš°ì € í”„ë ˆìž„ HTML ìƒì„±
    const windowButtonsHtml = (style: any) => {
      if (style.hasWindowButtons || style.frameStyle === 'browser-window') {
        const colors = style.windowButtonColors || ['#FF5F57', '#FFBD2E', '#28CA41'];
        return `<div class="browser-header" style="display:flex; gap:6px; padding:8px 12px; background:#f0f0f0; border-radius:12px 12px 0 0;">
          <span style="width:12px; height:12px; border-radius:50%; background:${colors[0]};"></span>
          <span style="width:12px; height:12px; border-radius:50%; background:${colors[1]};"></span>
          <span style="width:12px; height:12px; border-radius:50%; background:${colors[2]};"></span>
        </div>`;
      }
      return '';
    };
    
    // inline CSS ìŠ¤íƒ€ì¼ ìƒì„± í•¨ìˆ˜
    const generateInlineStyle = (style: any) => {
      const parts = [];
      if (style.backgroundColor) parts.push(`background-color: ${style.backgroundColor}`);
      if (style.borderColor && style.borderWidth) {
        parts.push(`border: ${style.borderWidth} solid ${style.borderColor}`);
      } else if (style.borderColor) {
        parts.push(`border: 2px solid ${style.borderColor}`);
      }
      if (style.borderRadius) parts.push(`border-radius: ${style.borderRadius}`);
      if (style.boxShadow) parts.push(`box-shadow: ${style.boxShadow}`);
      if (style.padding) parts.push(`padding: ${style.padding}`);
      return parts.join('; ');
    };
    
    // ì œëª© ìŠ¤íƒ€ì¼ ìƒì„±
    const generateTitleStyle = (style: any) => {
      if (!style.mainTitleStyle) return '';
      const s = style.mainTitleStyle;
      const parts = [];
      if (s.color) parts.push(`color: ${s.color}`);
      if (s.fontSize) parts.push(`font-size: ${s.fontSize}`);
      if (s.fontWeight) parts.push(`font-weight: ${s.fontWeight}`);
      return parts.join('; ');
    };
    
    // ê°•ì¡° ìŠ¤íƒ€ì¼ ìƒì„±
    const generateHighlightStyle = (style: any) => {
      if (!style.highlightStyle) return '';
      const s = style.highlightStyle;
      const parts = [];
      if (s.color) parts.push(`color: ${s.color}`);
      if (s.backgroundColor && s.backgroundColor !== 'transparent') {
        parts.push(`background-color: ${s.backgroundColor}`);
        parts.push(`padding: 2px 6px`);
        parts.push(`border-radius: 4px`);
      }
      return parts.join('; ');
    };
    
    // ë¶€ì œëª© ìŠ¤íƒ€ì¼ ìƒì„±
    const generateSubtitleStyle = (style: any) => {
      if (!style.subtitleStyle) return '';
      const s = style.subtitleStyle;
      const parts = [];
      if (s.color) parts.push(`color: ${s.color}`);
      if (s.fontSize) parts.push(`font-size: ${s.fontSize}`);
      if (s.fontWeight) parts.push(`font-weight: ${s.fontWeight}`);
      return parts.join('; ');
    };
    
    // íƒœê·¸ ìŠ¤íƒ€ì¼ ìƒì„±
    const generateTagStyle = (style: any) => {
      if (!style.tagStyle) return '';
      const s = style.tagStyle;
      const parts = [];
      if (s.backgroundColor) parts.push(`background-color: ${s.backgroundColor}`);
      if (s.color) parts.push(`color: ${s.color}`);
      if (s.borderRadius) parts.push(`border-radius: ${s.borderRadius}`);
      parts.push(`padding: 4px 12px`);
      return parts.join('; ');
    };
    
    const coverInlineStyle = generateInlineStyle(coverStyle);
    const contentInlineStyle = generateInlineStyle(contentStyle);
    const coverTitleStyle = generateTitleStyle(coverStyle);
    const coverHighlightStyle = generateHighlightStyle(coverStyle);
    const coverSubtitleStyle = generateSubtitleStyle(coverStyle);
    const coverTagStyle = generateTagStyle(coverStyle);
    const contentTitleStyle = generateTitleStyle(contentStyle);
    const contentHighlightStyle = generateHighlightStyle(contentStyle);
    const contentSubtitleStyle = generateSubtitleStyle(contentStyle);
    const contentTagStyle = generateTagStyle(contentStyle);
    
    // ë¶„ì„ëœ ë°°ê²½ìƒ‰ì„ CSSë¡œ ë³€í™˜
    const bgColor = coverStyle.backgroundColor || contentStyle.backgroundColor || '#E8F4FD';
    const bgGradient = bgColor.includes('gradient') ? bgColor : `linear-gradient(180deg, ${bgColor} 0%, ${bgColor}dd 100%)`;
    
    styleAnalysis = `
[ðŸŽ¨ðŸŽ¨ðŸŽ¨ ì¹´ë“œë‰´ìŠ¤ ìŠ¤íƒ€ì¼ - ì´ ìŠ¤íƒ€ì¼ì„ ë°˜ë“œì‹œ ê·¸ëŒ€ë¡œ ì ìš©í•˜ì„¸ìš”! ðŸŽ¨ðŸŽ¨ðŸŽ¨]

**âš ï¸ ìµœìš°ì„  ê·œì¹™ âš ï¸**
**ëª¨ë“  ì¹´ë“œì— ë°˜ë“œì‹œ style="background: ${bgGradient};" ì ìš©!**
**ê¸°ë³¸ í° ë°°ê²½(#f8fafc, #fff) ì‚¬ìš© ê¸ˆì§€!**

**í•„ìˆ˜ ì ìš© ë°°ê²½ìƒ‰: ${bgColor}**

${coverStyleAnalysis ? `**ðŸ“• í‘œì§€ (1ìž¥) HTML:**
<div class="card-slide" style="background: ${bgGradient}; border-radius: 24px; overflow: hidden;">
  ${windowButtonsHtml(coverStyle)}
  <div class="card-content-area" style="padding: 32px 28px;">
    <p class="card-subtitle" style="${coverSubtitleStyle || 'color: #3B82F6; font-size: 14px; font-weight: 700;'}">ë¶€ì œëª© (10~15ìž)</p>
    <p class="card-main-title" style="${coverTitleStyle || 'color: #1E293B; font-size: 28px; font-weight: 900;'}">ë©”ì¸ ì œëª©<br/><span style="color: #3B82F6;">ê°•ì¡°</span></p>
    <div class="card-img-container">[IMG_1]</div>
    <p class="card-desc" style="font-size: 15px; color: #475569; line-height: 1.7;">30~50ìžì˜ êµ¬ì²´ì ì¸ ì„¤ëª… ë¬¸ìž¥ì„ ìž‘ì„±í•˜ì„¸ìš”!</p>
  </div>
</div>
` : ''}

${contentStyleAnalysis ? `**ðŸ“„ ë³¸ë¬¸ (2ìž¥~) HTML:**
<div class="card-slide" style="background: ${bgGradient}; border-radius: 24px; overflow: hidden;">
  ${windowButtonsHtml(contentStyle)}
  <div class="card-content-area" style="padding: 32px 28px;">
    <p class="card-subtitle" style="${contentSubtitleStyle || 'color: #3B82F6; font-size: 14px; font-weight: 700;'}">ë¶€ì œëª© (10~15ìž)</p>
    <p class="card-main-title" style="${contentTitleStyle || 'color: #1E293B; font-size: 28px; font-weight: 900;'}">ë©”ì¸ ì œëª©<br/><span style="color: #3B82F6;">ê°•ì¡°</span></p>
    <div class="card-img-container">[IMG_N]</div>
    <p class="card-desc" style="font-size: 15px; color: #475569; line-height: 1.7;">30~50ìžì˜ êµ¬ì²´ì ì¸ ì„¤ëª… ë¬¸ìž¥ì„ ìž‘ì„±í•˜ì„¸ìš”!</p>
  </div>
</div>
` : ''}

**ðŸš¨ ë°°ê²½ìƒ‰ í•„ìˆ˜ ì ìš©: ${bgColor} ðŸš¨**
style ì†ì„±ì— background: ${bgGradient}; ë°˜ë“œì‹œ í¬í•¨!
`;
  }
  
  let benchmarkingInstruction = '';
  if (request.referenceUrl) {
    benchmarkingInstruction = `
    [ðŸš¨ ë²¤ì¹˜ë§ˆí‚¹ ëª¨ë“œ í™œì„±í™”]
    Target URL: ${request.referenceUrl}
    Google Search ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ìœ„ URLì˜ íŽ˜ì´ì§€ë¥¼ ì ‘ì†í•´ ì½˜í…ì¸  êµ¬ì¡°ë¥¼ ë¶„ì„í•˜ì‹­ì‹œì˜¤.
    
    ${isCardNews 
      ? `[ë¯¸ì…˜: í…œí”Œë¦¿ êµ¬ì¡° ëª¨ë°©]
         - ìž…ë ¥ëœ URLì€ 'ì¹´ë“œë‰´ìŠ¤ í…œí”Œë¦¿'ìž…ë‹ˆë‹¤.
         - í•´ë‹¹ ì¹´ë“œë‰´ìŠ¤ì˜ [íŽ˜ì´ì§€ë³„ êµ¬ì„±(í‘œì§€-ëª©ì°¨-ë³¸ë¡ -ê²°ë¡ )], [í…ìŠ¤íŠ¸ ë°€ë„], [ê°•ì¡° ë¬¸êµ¬ ìŠ¤íƒ€ì¼]ì„ ë¶„ì„í•˜ì‹­ì‹œì˜¤.
         - ë¶„ì„í•œ íŠ¹ì§•ì„ ì•„ëž˜ [HTML êµ¬ì¡° ê°€ì´ë“œ]ì— ëŒ€ìž…í•˜ì—¬ ë‚´ìš©ì„ ìž‘ì„±í•˜ì‹­ì‹œì˜¤.
         - ì˜ˆ: ë ˆí¼ëŸ°ìŠ¤ê°€ 'Q&A' í˜•ì‹ì´ë©´ ë³¸ë¬¸ë„ 'Q&A'ë¡œ, 'O/X í€´ì¦ˆ' í˜•ì‹ì´ë©´ 'O/X í€´ì¦ˆ'ë¡œ êµ¬ì„±í•˜ì‹­ì‹œì˜¤.`
      : `[ë¯¸ì…˜: ë¸”ë¡œê·¸ ìŠ¤íƒ€ì¼ ëª¨ë°©]
         - ì´ ë¸”ë¡œê·¸ì˜ ë§íˆ¬, ë¬¸ë‹¨ êµ¬ì¡°, ì´ëª¨ì§€ ì‚¬ìš© íŒ¨í„´ì„ ì™„ë²½ížˆ ëª¨ë°©í•˜ì—¬ ê¸€ì„ ìž‘ì„±í•˜ì‹­ì‹œì˜¤.`}
    
    [âš ï¸ ì˜ë£Œë²• ì ˆëŒ€ ì¤€ìˆ˜] 
    - ë²¤ì¹˜ë§ˆí‚¹ ëŒ€ìƒì´ ê³¼ìž¥/ìœ„ë²• í‘œí˜„ì„ ì“°ë”ë¼ë„ ì ˆëŒ€ ë”°ë¼í•˜ì§€ ë§ê³  ì•ˆì „í•œ í‘œí˜„ìœ¼ë¡œ ìˆœí™”í•˜ì‹­ì‹œì˜¤.
    `;
  }

  const targetImageCount = request.imageCount ?? 1;
  const imageMarkers = targetImageCount > 0 
    ? Array.from({length: targetImageCount}, (_, i) => `[IMG_${i+1}]`).join(', ')
    : '';
  const writingStyle = request.writingStyle || 'empathy'; // ê¸°ë³¸ê°’: ê³µê°í˜•
  const writingStylePrompt = getWritingStylePrompts()[writingStyle];
  const imageStyle = request.imageStyle || 'illustration'; // ê¸°ë³¸ê°’: 3D ì¼ëŸ¬ìŠ¤íŠ¸
  
  // í•™ìŠµëœ ë§íˆ¬ ìŠ¤íƒ€ì¼ ì ìš©
  let learnedStyleInstruction = '';
  if (request.learnedStyleId) {
    try {
      const { getStyleById, getStylePromptForGeneration } = await import('./writingStyleService');
      const learnedStyle = getStyleById(request.learnedStyleId);
      if (learnedStyle) {
        learnedStyleInstruction = `
[ðŸŽ“ðŸŽ“ðŸŽ“ í•™ìŠµëœ ë§íˆ¬ ì ìš© - ìµœìš°ì„  ì ìš©! ðŸŽ“ðŸŽ“ðŸŽ“]
${getStylePromptForGeneration(learnedStyle)}

âš ï¸ ìœ„ í•™ìŠµëœ ë§íˆ¬ë¥¼ ë°˜ë“œì‹œ ì ìš©í•˜ì„¸ìš”!
- ë¬¸ìž¥ ë íŒ¨í„´ì„ ì •í™•ížˆ ë”°ë¼í•˜ì„¸ìš”
- ìžì£¼ ì‚¬ìš©í•˜ëŠ” í‘œí˜„ì„ ìžì—°ìŠ¤ëŸ½ê²Œ í™œìš©í•˜ì„¸ìš”
- ì „ì²´ì ì¸ ì–´ì¡°ì™€ ë¶„ìœ„ê¸°ë¥¼ ì¼ê´€ë˜ê²Œ ìœ ì§€í•˜ì„¸ìš”
`;
        console.log('ðŸ“ í•™ìŠµëœ ë§íˆ¬ ì ìš©:', learnedStyle.name);
      }
    } catch (e) {
      console.warn('í•™ìŠµëœ ë§íˆ¬ ë¡œë“œ ì‹¤íŒ¨:', e);
    }
  }
  
  // ì»¤ìŠ¤í…€ ì†Œì œëª© ì ìš©
  let customSubheadingInstruction = '';
  if (request.customSubheadings && request.customSubheadings.trim()) {
    const subheadings = request.customSubheadings.trim().split(/\r\n|\r|\n/).filter(h => h.trim());
    if (subheadings.length > 0) {
      customSubheadingInstruction = `
[ðŸ“‹ðŸ“‹ðŸ“‹ ì†Œì œëª© í•„ìˆ˜ ì‚¬ìš© - ì‚¬ìš©ìž ì§€ì • ì†Œì œëª©! ðŸ“‹ðŸ“‹ðŸ“‹]
ì•„ëž˜ ì†Œì œëª©ë“¤ì„ **ì •í™•ížˆ ê·¸ëŒ€ë¡œ** ì‚¬ìš©í•˜ì—¬ ë¬¸ë‹¨ì„ ìž‘ì„±í•˜ì„¸ìš”!
ì†Œì œëª© ê°œìˆ˜: ${subheadings.length}ê°œ

${subheadings.map((h, i) => `${i + 1}. ${h}`).join('\n')}

ðŸš¨ **í•„ìˆ˜ ê·œì¹™:**
- ìœ„ ì†Œì œëª©ì„ **ìˆœì„œëŒ€ë¡œ ì •í™•ížˆ ê·¸ëŒ€ë¡œ** ì‚¬ìš©í•  ê²ƒ!
- ì†Œì œëª© í…ìŠ¤íŠ¸ë¥¼ ì ˆëŒ€ ìˆ˜ì •í•˜ì§€ ë§ ê²ƒ!
- ê° ì†Œì œëª©ì— ë§žëŠ” ë‚´ìš©ìœ¼ë¡œ ë¬¸ë‹¨ì„ ìž‘ì„±í•  ê²ƒ!
- H3 íƒœê·¸(<h3>)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì†Œì œëª©ì„ í‘œì‹œí•  ê²ƒ!
`;
      console.log('ðŸ“‹ ì»¤ìŠ¤í…€ ì†Œì œëª© ì ìš©:', subheadings.length, 'ê°œ');
    }
  }
  
  // í˜„ìž¬ í•œêµ­ ì‹œê°„ ì •ë³´ (ìµœì‹  ì •ë³´ ê¸°ë°˜ ê¸€ ìž‘ì„±ìš©)
  const now = new Date();
  const koreaTime = new Date(now.toLocaleString("en-US", { timeZone: "Asia/Seoul" }));
  const currentYear = koreaTime.getFullYear();
  const currentMonth = koreaTime.getMonth() + 1;
  const currentDay = koreaTime.getDate();
  const currentSeason = currentMonth >= 3 && currentMonth <= 5 ? 'ë´„' 
    : currentMonth >= 6 && currentMonth <= 8 ? 'ì—¬ë¦„'
    : currentMonth >= 9 && currentMonth <= 11 ? 'ê°€ì„' : 'ê²¨ìš¸';
  const timeContext = `í˜„ìž¬ ë‚ ì§œ: ${currentYear}ë…„ ${currentMonth}ì›” ${currentDay}ì¼ (${currentSeason})`;
  // ì»¤ìŠ¤í…€ ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ê°€ ìžˆìœ¼ë©´ ìµœìš°ì„  ì‚¬ìš©
  const customImagePrompt = request.customImagePrompt?.trim();
  const imageStyleGuide = customImagePrompt
    ? `ì»¤ìŠ¤í…€ ìŠ¤íƒ€ì¼: ${customImagePrompt}` // ì»¤ìŠ¤í…€ í”„ë¡¬í”„íŠ¸ ìµœìš°ì„ !
    : imageStyle === 'illustration' 
    ? '3D ë Œë” ì¼ëŸ¬ìŠ¤íŠ¸, Blender ìŠ¤íƒ€ì¼, ë¶€ë“œëŸ¬ìš´ ìŠ¤íŠœë””ì˜¤ ì¡°ëª…, íŒŒìŠ¤í…” ìƒ‰ìƒ, ë‘¥ê·¼ í˜•íƒœ, ì¹œê·¼í•œ ìºë¦­í„°, ê¹”ë”í•œ ë°°ê²½ (â›”ê¸ˆì§€: ì‹¤ì‚¬, ì‚¬ì§„, DSLR)'
    : imageStyle === 'medical'
    ? 'ì˜í•™ 3D ì¼ëŸ¬ìŠ¤íŠ¸, í•´ë¶€í•™ì  ë Œë”ë§, í•´ë¶€í•™ì  êµ¬ì¡°, ìž¥ê¸° ë‹¨ë©´ë„, ë°˜íˆ¬ëª… ìž¥ê¸°, ìž„ìƒ ì¡°ëª…, ì˜ë£Œ ìƒ‰ìƒ íŒ”ë ˆíŠ¸ (â›”ê¸ˆì§€: ê·€ì—¬ìš´ ë§Œí™”, ì‹¤ì‚¬ ì–¼êµ´)'
    : 'ì‹¤ì‚¬ DSLR ì‚¬ì§„, ì§„ì§œ ì‚¬ì§„, 35mm ë Œì¦ˆ, ìžì—°ìŠ¤ëŸ¬ìš´ ë¶€ë“œëŸ¬ìš´ ì¡°ëª…, ì–•ì€ í”¼ì‚¬ê³„ì‹¬ë„, ì „ë¬¸ ë³‘ì› í™˜ê²½ (â›”ê¸ˆì§€: 3D ë Œë”, ì¼ëŸ¬ìŠ¤íŠ¸, ë§Œí™”, ì• ë‹ˆë©”ì´ì…˜)';
  
  // ë™ì ìœ¼ë¡œ ìµœì‹  ì˜ë£Œê´‘ê³ ë²• í”„ë¡¬í”„íŠ¸ ìƒì„±
  const medicalSafetyPrompt = getMedicalSafetyPrompt();
  const aiFeedbackRules = getAIFeedbackPrompt();
  
  // ðŸŽ¯ ê°„ì†Œí™”ëœ í•µì‹¬ í”„ë¡¬í”„íŠ¸ (API íƒ€ìž„ì•„ì›ƒ ë°©ì§€ - ê¸°ì¡´ 21KB â†’ ì•½ 2KB)
  const blogPrompt = `
ë„ˆëŠ” í•œêµ­ ë³‘Â·ì˜ì› ë„¤ì´ë²„ ë¸”ë¡œê·¸ìš© ì˜ë£Œ ì •ë³´ë¥¼ ìž‘ì„±í•˜ëŠ” ì „ë¬¸ ì˜ë£Œ ì½˜í…ì¸  ì—ë””í„°ë‹¤.

ðŸš¨ðŸš¨ðŸš¨ **[ì ˆëŒ€ 1ìˆœìœ„] ìž‘ì„± ì „ í•„ë…! ì´ê²ƒë§Œì€ ì ˆëŒ€ ê¸ˆì§€!!!** ðŸš¨ðŸš¨ðŸš¨

**1. ëª¨ë“  ìˆ«ìž í‘œí˜„ ì ˆëŒ€ ì‚¬ìš© ê¸ˆì§€!**
âŒ "200ì—¬ ì¢…", "2~4íšŒ", "6~8íšŒ", "1~2ì£¼", "38ë„", "3ì¼ ì´ìƒ", "30ì´ˆ"
âŒ ëª¨ë“  í†µê³„, íšŸìˆ˜, ê¸°ê°„, ì˜¨ë„, ê°œìˆ˜ â†’ ì „ë¶€ ê¸ˆì§€!
âœ… "ë§¤ìš° ë‹¤ì–‘í•œ", "ë“œë¬¼ì§€ ì•Šê²Œ", "ìžì£¼", "ë©°ì¹ ", "ì¼ì • ê¸°ê°„"

**2. ìƒíˆ¬ì  ë§ˆë¬´ë¦¬ í‘œí˜„ ì ˆëŒ€ ê¸ˆì§€!**
âŒ "ì˜¤ëŠ˜ ì „í•´ë“œë¦°", "~ë˜ê¸°ë¥¼ ë°”ëžë‹ˆë‹¤", "ê³„ê¸°ê°€ ë˜ê¸°ë¥¼", "ë„ì›€ì´ ë˜ê¸¸"
âœ… í•µì‹¬ ìš”ì•½ì´ë‚˜ ì£¼ì˜ì‚¬í•­ìœ¼ë¡œ ìžì—°ìŠ¤ëŸ½ê²Œ ì¢…ë£Œ!

**3. ë¸”ë¡œê·¸ íˆ¬ ê³¼ë‹¤ ì‚¬ìš© ê¸ˆì§€!**
âŒ "í•œ ë²ˆì¯¤ ê²½í—˜í•´ë³´ì…¨ì„ í…ë°ìš”" - ìƒíˆ¬ì  ë„ìž…ë¶€
âŒ "~ì¸ë°ìš”", "~ì´ì£ ", "~ê±°ë“ ìš”" ê³¼ë‹¤ ì‚¬ìš© (ë¬¸ìž¥ë‹¹ ìµœëŒ€ 1ê°œ!)
âŒ "~í•˜ëŠ” ê±´ ì–´ë–¨ê¹Œìš”?" - ë¸”ë¡œê·¸ ì§ˆë¬¸ íˆ¬
âŒ "ì˜¤ëŠ˜ì€ ~ì— ëŒ€í•´ ì‚´íŽ´ë³´ê² ìŠµë‹ˆë‹¤" - ë©”íƒ€ ì„¤ëª… (ì¦‰ì‹œ ë³¸ë¬¸ìœ¼ë¡œ!)

**4. ë²ˆì—­íˆ¬ ê¸ˆì§€!**
âŒ "~ì„ ë§í•˜ì£ ", "~ì„ ì˜ë¯¸í•˜ëŠ” ê²½ìš°ê°€ ë§ŽìŠµë‹ˆë‹¤"
âœ… "~ìž…ë‹ˆë‹¤", "~ì„ ê°€ë¦¬í‚µë‹ˆë‹¤"ë¡œ ê°„ê²°í•˜ê²Œ

ìœ„ 4ê°€ì§€ë¥¼ ì–´ê¸°ë©´ ì¦‰ì‹œ íƒˆë½! ìž‘ì„± ì‹œìž‘ ì „ 3ë²ˆ ì½ê³  ì‹œìž‘í•˜ì„¸ìš”!

[ðŸŽ¯ ëª©í‘œ]
- ë…ìžê°€ "ê´‘ê³  ê°™ë‹¤"ê°€ ì•„ë‹ˆë¼ "ì„¤ëª… ìž˜ í•´ì£¼ë„¤"ë¼ê³  ëŠë¼ëŠ” ì •ë³´ ì‹ ë¢°ë„ ë†’ì€ ê¸€ ìž‘ì„±
- ì˜í•™ì ìœ¼ë¡œ ê³¼ë„í•˜ì§€ ì•Šìœ¼ë©´ì„œë„ í—ˆìˆ í•˜ì§€ ì•Šì€ ì„¤ëª… ì œê³µ
- ì •ë³´ ì‹ ë¢°ë„ ê¸°ì¤€ì—ì„œ ë³„ì  5ì ì„ ë°›ì„ ìˆ˜ ìžˆëŠ” í†¤ ìœ ì§€

[ìž‘ì„± ìš”ì²­]
- ì§„ë£Œê³¼: ${request.category}
- ì£¼ì œ: ${request.topic}
- ëª©í‘œ ê¸¸ì´: ${targetLength}ìž (ì¤‘ìš”!)
- ì´ë¯¸ì§€: ${targetImageCount}ìž¥ (${imageMarkers} ë§ˆì»¤ ì‚¬ìš©)
${learnedStyleInstruction ? '- ë§íˆ¬: í•™ìŠµëœ ìŠ¤íƒ€ì¼ ì ìš©\n' + learnedStyleInstruction : ''}
${customSubheadingInstruction ? customSubheadingInstruction : ''}

[í˜„ìž¬ ì‹œì ]
${timeContext}

ðŸš¨ **ì ˆëŒ€ ê¸ˆì§€:** "${currentYear}ë…„", "ì˜¬í•´", "ì´ë²ˆ ${currentSeason}" ê°™ì€ ì‹œê°„ ì°¸ì¡° í‘œí˜„ ì‚¬ìš© ê¸ˆì§€!
âœ… **í—ˆìš©:** "${currentSeason}ì² ", "ì¶”ìš´ ë‚ ì”¨", "ë”ìš´ ë‚ ì”¨", "í™˜ì ˆê¸°" ê°™ì€ ì¼ë°˜ì  ê³„ì ˆ í‘œí˜„ë§Œ ì‚¬ìš©!

[ðŸš¨ ìž‘ì„± ì›ì¹™ - ìµœìš°ì„  ì¤€ìˆ˜!]

ðŸ”¥ **[ìµœìš°ì„ ] AI ë§íˆ¬ ì™„ì „ ì œê±° - ìžì—°ìŠ¤ëŸ¬ìš´ ê¸€ì“°ê¸°**
âŒ **ì ˆëŒ€ ê¸ˆì§€:**
- AI ì„¤ëª…ì²´, êµê³¼ì„œì²´, ë…¼ë¬¸ì²´ â†’ ì‹¤íŒ¨!
- "~í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤" ê³¼ë‹¤ ì‚¬ìš© (ë¬¸ë‹¨ë‹¹ ìµœëŒ€ 1íšŒ!)
- "~ë„ì›€ì´ ë©ë‹ˆë‹¤" ê³¼ë‹¤ ì‚¬ìš© (ê¸€ ì „ì²´ ìµœëŒ€ 2íšŒ!)
- "~ì–¸ê¸‰ë©ë‹ˆë‹¤", "~ì•Œë ¤ì ¸ ìžˆìŠµë‹ˆë‹¤" ê³¼ë‹¤ ì‚¬ìš© (ê¸€ ì „ì²´ ìµœëŒ€ 2íšŒ!)
- ì¶”ìƒëª…ì‚¬ ë°˜ë³µ ("ê³ ë ¤", "ì–‘ìƒ", "ì¸¡ë©´", "ê´€ì ") â†’ ìµœëŒ€í•œ ë°°ì œ!
- ê°™ì€ í‘œí˜„ì„ ë¬¸ë‹¨ë§ˆë‹¤ ë°˜ë³µ â†’ ì¦‰ì‹œ íƒˆë½!
- ê´‘ê³  ë¬¸ìž¥ì²˜ëŸ¼ ë³´ì´ëŠ” í‘œí˜„ â†’ ì‹¤íŒ¨!

ðŸš¨ **ë²ˆì—­íˆ¬ ê¸ˆì§€! (ë§¨ ìœ„ 4ë²ˆ ê·œì¹™ ì°¸ê³ )**
âŒ "~ì„ ë§í•˜ì£ ", "~ì˜ë¯¸í•˜ëŠ”", "~ì— ìžˆì–´ì„œ", "~í•¨ìœ¼ë¡œì¨", "~í•˜ëŠ” ê²ƒì´"
âœ… "~ìž…ë‹ˆë‹¤", "~ë•Œ", "~í•´ì„œ", ê°„ê²°í•˜ê²Œ!

âœ… **í•µì‹¬ ìž‘ì„±ë²•:**
- ë¬¸ìž¥ ì§§ê²Œ (í•œ ë¬¸ìž¥ì— ì •ë³´ 1ê°œ)
- ì¢…ê²°ì–´ë¯¸ ë‹¤ì–‘í™”: ~ìŠµë‹ˆë‹¤, ~ë©ë‹ˆë‹¤, ~íŽ¸ìž…ë‹ˆë‹¤, ~ê¸°ë„ í•©ë‹ˆë‹¤
- ì™„ì¶© í‘œí˜„ ë‹¤ì–‘í™”: "~ê²½ìš°ê°€ ìžˆìŠµë‹ˆë‹¤" ê¸€ ì „ì²´ ìµœëŒ€ 3íšŒ, "~ë„ì›€ì´ ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤" ìµœëŒ€ 2íšŒ

1. **ë‹¨ì • í‘œí˜„ ì ˆëŒ€ ê¸ˆì§€ (ì˜ë£Œë²•)**
   - âŒ ì¹˜ë£Œëœë‹¤, ë‚«ëŠ”ë‹¤, ë°˜ë“œì‹œ, íš¨ê³¼ê°€ ìžˆë‹¤ ì‚¬ìš© ê¸ˆì§€
   - âœ… ì™„ì¶© í‘œí˜„ ì‚¬ìš©í•˜ë˜ ë‹¤ì–‘í•˜ê²Œ ë³€í˜•

2. **ëª¨ë“  ì˜í•™ ì •ë³´ëŠ” 'ì¡°ê±´Â·ë²”ìœ„Â·ì°¨ì´'ë¥¼ í•¨ê»˜ ì œì‹œ**
   - âŒ "ë¬´ë¦Ž í†µì¦ì€ ì‹­ìžì¸ëŒ€ íŒŒì—´ì´ë‹¤"
   - âœ… "ë¬´ë¦Ž í†µì¦ì€ ì—¬ëŸ¬ ì›ì¸ì´ ìžˆì„ ìˆ˜ ìžˆìœ¼ë©°, ê·¸ì¤‘ ì‹­ìžì¸ëŒ€ ì†ìƒì´ ì˜ì‹¬ë˜ëŠ” ê²½ìš°ë„ ìžˆìŠµë‹ˆë‹¤"
   - ë‹¤ì–‘í•œ í‘œí˜„: "ê°œì¸ì°¨ê°€ ìžˆìŠµë‹ˆë‹¤", "ìƒí™©ì— ë”°ë¼ ë‹¤ë¦…ë‹ˆë‹¤", "ì‚¬ëžŒë§ˆë‹¤ ëŠë¼ëŠ” ì •ë„ê°€ ë‹¤ë¥¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤"

3. **ì›ì¸â€“ì¦ìƒâ€“ê³¼ì •â€“íŒë‹¨ ê¸°ì¤€ì„ ë°˜ë“œì‹œ ì—°ê²°í•´ ì„¤ëª…**
   - âŒ ì •ë³´ ë‚˜ì—´: "ì¦ìƒ 1. í†µì¦ 2. ë¶€ì¢… 3. ì†Œë¦¬"
   - âœ… ê³¼ì • ì„¤ëª…: "ë¬´ë¦Žì— ê°‘ìž‘ìŠ¤ëŸ¬ìš´ ì¶©ê²©ì´ ê°€í•´ì§€ë©´ ì¸ëŒ€ê°€ ëŠ˜ì–´ë‚˜ê±°ë‚˜ ëŠì–´ì§ˆ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì´ë•Œ ëš ì†Œë¦¬ê°€ ë“¤ë¦¬ê³ , ì´í›„ ë¶€ì¢…ì´ ë‚˜íƒ€ë‚˜ëŠ” ê²½ìš°ê°€ ìžˆìŠµë‹ˆë‹¤."

4. **'ì„¤ëª…í•´ì£¼ëŠ” ì‚¬ëžŒ'ì˜ í†¤ ìœ ì§€**
   - âŒ ì§€ì‹œí˜•Â·ê¶Œìœ í˜•: "ë³‘ì›ì„ ë°©ë¬¸í•˜ì„¸ìš”", "ê¼­ í™•ì¸í•˜ì„¸ìš”", "ì˜ˆë°©í•´ì•¼ í•©ë‹ˆë‹¤"
   - âœ… ì„¤ëª…í˜•: "ë³‘ì› ë°©ë¬¸ì´ í•„ìš”í•œ ê²½ìš°ìž…ë‹ˆë‹¤", "í™•ì¸í•´ë³´ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤", "ì£¼ì˜ê°€ í•„ìš”í•©ë‹ˆë‹¤"

5. **ì „ë¬¸ ìš©ì–´ëŠ” ì¼ìƒ ì–¸ì–´ë¡œ í’€ì–´ ì„¤ëª…**
   - âŒ "ì „ë°©ì‹­ìžì¸ëŒ€ íŒŒì—´ì€ ACL ì†ìƒìž…ë‹ˆë‹¤"
   - âœ… "ë¬´ë¦Ž ì•ˆìª½ì—ì„œ ë¼ˆë¥¼ ì—°ê²°í•˜ëŠ” ì¸ëŒ€ê°€ ëŠì–´ì§€ê±°ë‚˜ ëŠ˜ì–´ë‚˜ëŠ” ìƒíƒœë¥¼ ì „ë°©ì‹­ìžì¸ëŒ€ ì†ìƒì´ë¼ê³  í•©ë‹ˆë‹¤"

6. **íŠ¹ì • ì¹˜ë£ŒÂ·ì‹œìˆ ì˜ íš¨ê³¼ë¥¼ ê°•ì¡°í•˜ì§€ ë§ê³  'ì–´ë–¤ ë§¥ë½ì—ì„œ ê³ ë ¤ë˜ëŠ”ì§€'ë§Œ ì„¤ëª…**
   - âŒ "ì¤„ê¸°ì„¸í¬ ì¹˜ë£ŒëŠ” ê´€ì ˆì„ ìž¬ìƒì‹œí‚µë‹ˆë‹¤"
   - âœ… "ìƒíƒœì— ë”°ë¼ ì¤„ê¸°ì„¸í¬ ì‹œìˆ ì´ ê³ ë ¤ë˜ëŠ” ê²½ìš°ê°€ ìžˆìœ¼ë©°, ê°œì¸ì˜ ìƒí™©ì— ë”°ë¼ ì ìš© ì—¬ë¶€ê°€ ë‹¬ë¼ì§ˆ ìˆ˜ ìžˆìŠµë‹ˆë‹¤"

7. **ë…ìžê°€ ìŠ¤ìŠ¤ë¡œ íŒë‹¨í•  ìˆ˜ ìžˆëŠ” ê¸°ì¤€ì„ ì œê³µ**
   - ì–¸ì œ ì§€ì¼œë³¼ ìˆ˜ ìžˆëŠ”ì§€
   - ì–¸ì œ í™•ì¸ì´ í•„ìš”í•œì§€
   - ì–´ë–¤ ê²½ìš°ì— ì£¼ì˜ê°€ í•„ìš”í•œì§€

8. **ê´‘ê³ Â·í™ë³´ë¡œ ì˜¤í•´ë  ìˆ˜ ìžˆëŠ” í‘œí˜„ ìžë™ ë°°ì œ**
   - âŒ ê¸ˆì§€ ë‹¨ì–´: ìž¥ì , ìš°ìˆ˜ì„±, ìž¬ìƒ, ê°•í™”, ì˜ˆë°©, íšŒë³µ, ìž¬ë°œ ë°©ì§€, ìµœì‹ , íŠ¹íš¨
   - âœ… ëŒ€ì²´ í‘œí˜„: "ê³ ë ¤ë˜ëŠ” ê²½ìš°", "ì ìš©ë˜ëŠ” ìƒí™©", "ì™„í™”ì— ë„ì›€ì´ ë  ìˆ˜ ìžˆëŠ”"

â–  ì‚¬ëžŒì²˜ëŸ¼ ì“°ê¸° (P2) ðŸŽ¨
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
1. **ê°ê° ë¬˜ì‚¬ í™œìš©**
   âœ… "ì°Œë¦¿í•œ ëŠë‚Œ", "ë¬µì§í•˜ê³  ìš±ì‹ ê±°ë¦¬ëŠ”", "ë»£ë»£í•œ"
   âœ… "ì „ê¸°ê°€ ì˜¤ëŠ” ë“¯", "ì—´ì´ ë‚˜ëŠ”", "ë‹¹ê¸°ëŠ” ëŠë‚Œ"
   âŒ "í†µì¦ì´ ë°œìƒí•©ë‹ˆë‹¤" (ë”±ë”±í•¨)

2. **ì „í™˜ì–´ë¡œ íë¦„ ë§Œë“¤ê¸°**
   âœ… ì‹ ê¸°í•˜ê²Œë„, ë‹¤í–‰ížˆ, ë‹¤ë§Œ, í•˜ì§€ë§Œ, ê·¸ëŸ°ë°, ì´ëŸ° ìƒíƒœì—ì„œëŠ”
   âŒ ì´ì²˜ëŸ¼/ë”°ë¼ì„œ/ê²°ë¡ ì ìœ¼ë¡œ (AI í‘œí˜„)

3. **ë¹„ìœ ë¡œ ì‰½ê²Œ ì„¤ëª…**
   âœ… "ì°¢ì–´ì§„ ì˜·ìžë½ì„ ê³„ì† ìž¡ì•„ë‹¹ê¸°ë‹¤ ë³´ë©´ ì ì  ëŠ˜ì–´ë‚˜ëŠ” ê²ƒì²˜ëŸ¼"

4. **ëŒ€í™”ì²´ íë¦„ (ìžì—°ìŠ¤ëŸ½ê²Œ)**
   âœ… ~ì´ì•¼ê¸°ê°€ ë‹¬ë¼ì§‘ë‹ˆë‹¤, ~ê²ë‹ˆë‹¤, ~íŽ¸ì´ ë§ŽìŠµë‹ˆë‹¤
   âœ… ~ê²½ìš°ë„ ìžˆìŠµë‹ˆë‹¤, ~ë•Œë„ ìžˆì£ 

5. **ê¸€ êµ¬ì¡° (ì ì§„ì  ì‹¬í™”)**
   1ë¬¸ë‹¨: ìƒìƒí•œ ì¦ìƒ ìž¥ë©´ (ê³µê° ìœ ë„)
   2-3ë¬¸ë‹¨: ì¦ìƒì´ ì–´ë–»ê²Œ ë³€í•˜ëŠ”ì§€
   4ë¬¸ë‹¨: ì™œ ìƒê¸°ëŠ”ì§€ (ì›ì¸)
   5-6ë¬¸ë‹¨: ê´€ë¦¬ ë°©ë²•
   7ë¬¸ë‹¨: ì¼ìƒ ì£¼ì˜ì‚¬í•­
   ë§ˆì§€ë§‰: ë¶€ë“œëŸ¬ìš´ ë§ˆë¬´ë¦¬ (ê°•ìš” ì—†ì´)
   ì˜ˆì‹œ - ì²«ë¬¸ìž¥: "ìž ìžë¦¬ì—ì„œ ì¼ì–´ë‚˜ ë¬´ì‹¬ì½” ë°”ë‹¥ì— ë°œì„ ë””ë””ëŠ” ìˆœê°„, ë°œë’¤ê¿ˆì¹˜ ì•ˆìª½ì—ì„œ ì „ê¸°ê°€ ì˜¤ëŠ” ë“¯ ì°Œë¦¿í•œ ëŠë‚Œì„ ë°›ëŠ” ë¶„ë“¤ì´ ìžˆìŠµë‹ˆë‹¤."
   ì˜ˆì‹œ - ë§ˆë¬´ë¦¬: "ë‘ ë°œë¡œ ê±·ëŠ” ì¼ìƒì´ ê³„ì† ì´ì–´ì§€ë ¤ë©´, ëª¸ì´ ë³´ë‚´ëŠ” ì‹ í˜¸ë¥¼ ë„ˆë¬´ ëŠ¦ì§€ ì•Šê²Œ ë°›ì•„ë“¤ì´ëŠ” ê²Œ ë„ì›€ì´ ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤."

[ðŸ“ ë¬¸ìž¥ ìŠ¤íƒ€ì¼ - ìžì—°ìŠ¤ëŸ¬ìš´ íë¦„]
- í•œ ë¬¸ìž¥ì— ì •ë³´ 1ê°œë§Œ! ê¸¸ê²Œ ëŠ˜ì–´ì§€ë©´ AI ëƒ„ìƒˆ
- ì§§ì€ ë¬¸ìž¥ìœ¼ë¡œ ë¦¬ë“¬ê° ìžˆê²Œ (20ìž~30ìž ë‚´ì™¸)
- ì„¤ëª… â†’ ë³´ì¶© â†’ ì™„ê³¡í•œ ì •ë¦¬ êµ¬ì¡°
- âŒ ë…¼ë¬¸ì²´Â·AI ìš”ì•½ì²´Â·êµê³¼ì„œì²´ ì ˆëŒ€ ê¸ˆì§€!
- âœ… "~ìž…ë‹ˆë‹¤" ì—°ì† ì‚¬ìš© ê¸ˆì§€ â†’ "~ìŠµë‹ˆë‹¤", "~ë©ë‹ˆë‹¤", "~ã…‚ë‹ˆë‹¤", "~ëŠ” íŽ¸", "~ê¸°ë„ í•©ë‹ˆë‹¤" êµì°¨
- ë…ìžê°€ ê³ ê°œ ë„ë•ì´ê²Œ ë§Œë“œëŠ” íë¦„ â†’ "ì•„, ê·¸ëž˜ì„œ ê·¸ë ‡êµ¬ë‚˜" ëŠë‚Œ
- ê´‘ê³  ë¬¸ìž¥ì²˜ëŸ¼ ë³´ì´ë©´ ì¦‰ì‹œ íƒˆë½!

[í•µì‹¬ ê·œì¹™ - ê¸°ì¡´ ìœ ì§€]
1. ì˜ë£Œë²• ì¤€ìˆ˜: íš¨ê³¼ ë‹¨ì •, ì§ì ‘ ë‚´ì› ê¶Œìœ ("ë°©ë¬¸í•˜ì„¸ìš”") ê¸ˆì§€
2. ìžì—°ìŠ¤ëŸ¬ìš´ ë¬¸ìž¥ ë¦¬ë“¬, í˜„ìž¥ê° ìžˆëŠ” í‘œí˜„, ë…ìž ê³µê°í˜• ì„œìˆ 
3. ë¹ˆë„Â·ì¦ê°€Â·ìœ í–‰ í‘œí˜„ ì œí•œ â†’ "ë§Žë‹¤/ëŠ˜ì—ˆë‹¤/í”í•˜ë‹¤" ëŒ€ì‹  "ì¸ì‹ë˜ëŠ” ê²½ìš°", "ëŠë¼ëŠ” ë¶„ë“¤" ë“± ì²´ê° í‘œí˜„ìœ¼ë¡œ ì¹˜í™˜
4. ë§ˆì§€ë§‰ ë¬¸ë‹¨ì€ ì§€ì‹œí˜•ì´ ì•„ë‹Œ ì„ íƒí˜• ì •ë¦¬ â†’ "ì ê²€í•´ë³¼ ìˆ˜ ìžˆë‹¤", "í•˜ë‚˜ì˜ ê¸°ì¤€ì´ ë  ìˆ˜ ìžˆë‹¤"
5. ë³‘ëª…ì€ ì„¤ëª… ëª©ì ì— í•œí•´ ì œí•œì  ì‚¬ìš© â†’ ë°˜ë³µ ë…¸ì¶œì´ë‚˜ ê°•ì¡° ê¸ˆì§€

[ðŸš¨ ì˜ë£Œê´‘ê³ ë²• ë…¸ëž€ì¤„ í‘œí˜„ - ë°˜ë“œì‹œ í”¼í•˜ê¸°!]
âš ï¸ "~ì˜ì‹¬í•´ë³¼ ìˆ˜ ìžˆë‹¤" â†’ âœ… "~ì‚´íŽ´ë³¼ í•„ìš”ê°€ ìžˆëŠ”", "~í™•ì¸í•´ë³¼ ë§Œí•œ"
âš ï¸ "ìžê°€ ì§„ë‹¨ ë°©ë²•" â†’ âœ… "ì´ëŸ° ì¦ìƒì´ ìžˆë‹¤ë©´ ì²´í¬í•´ë³¼ ì‚¬í•­" / "ì£¼ì˜ê°€ í•„ìš”í•œ ê²½ìš°"
âš ï¸ ì†Œì œëª©ì— "ë°©ë²•/ì§„ë‹¨/íŒë³„" ê¸ˆì§€ â†’ âœ… "ì²´í¬/ì°¸ê³ /ì‚´íŽ´ë³´ê¸°" ì‚¬ìš©
âš ï¸ ì¹˜ë£Œ ì–¸ê¸‰ ì‹œ ì™„ì¶© ë¬¸ìž¥ í•„ìˆ˜ ì¶”ê°€: "ê°œì¸ì˜ ìƒíƒœì— ë”°ë¼ íŒë‹¨ì´ ë‹¬ë¼ì§ˆ ìˆ˜ ìžˆìœ¼ë¯€ë¡œ, ì˜ë£Œì§„ê³¼ì˜ ìƒë‹´ì„ í†µí•´ ê²°ì •í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì ìž…ë‹ˆë‹¤."

ðŸš¨ðŸš¨ðŸš¨ [ì ˆëŒ€ ê¸ˆì§€ - ì‹œê°„ ì°¸ì¡° & êµ¬ì²´ì  ê¸°ê°„] ðŸš¨ðŸš¨ðŸš¨
âŒ **ì‹œê°„ ì°¸ì¡° í‘œí˜„ ì ˆëŒ€ ê¸ˆì§€:** (ê¸€ì€ ì˜êµ¬ ë³´ê´€ë˜ë¯€ë¡œ)
- "2026ë…„ ê²¨ìš¸ì€~", "ì˜¬í•´ëŠ”~", "ê¸ˆë…„ì€~" â†’ ëª¨ë‘ ê¸ˆì§€!
- "ì´ë²ˆ ê²¨ìš¸~", "ì´ë²ˆ ì—¬ë¦„~", "ìµœê·¼ ëª‡ ë…„ê°„~" â†’ ëª¨ë‘ ê¸ˆì§€!
- âœ… ëŒ€ì²´: "ê²¨ìš¸ì² ì—ëŠ”~", "ì¶”ìš´ ë‚ ì”¨ì—ëŠ”~", "í™˜ì ˆê¸°ì—ëŠ”~"

âŒ **êµ¬ì²´ì  ê¸°ê°„ í‘œí˜„ ì ˆëŒ€ ê¸ˆì§€:**
- "2ì£¼ ì´ìƒ", "3ì¼~5ì¼", "24ì‹œê°„~48ì‹œê°„", "1ì£¼ì¼ ì •ë„" â†’ ëª¨ë‘ ê¸ˆì§€!
- âœ… ëŒ€ì²´: "ì¼ì • ê¸°ê°„ ì´ìƒ", "ë©°ì¹ ì§¸", "ì‹œê°„ì´ ì§€ë‚˜ë„", "ê°œì¸ì— ë”°ë¼ ì°¨ì´"

[ë„¤ì´ë²„ SEO ìµœì í™”]
- ë„ìž…ë¶€: ë…ìž ì¼ìƒ ì²´í—˜í˜• ("ì²˜ìŒì—ëŠ”" â†’ "ì ì " â†’ "ì–´ëŠ ìˆœê°„" ì‹œê°„ íë¦„)
- ì†Œì œëª©: ì§ˆë¬¸í˜•(H3) "~ì´ëž€?", "~ì¦ìƒì€?" (SEO ìµœì í™”, ë³¸ë¬¸ ë‚´ ì§ˆë¬¸ ê¸ˆì§€!)
- ë¬¸ìž¥/ë¬¸ë‹¨ ë¦¬ë“¬ ë‹¤ì–‘í™”: ì§§ì€/ì¤‘ê°„/ê¸´ ë¬¸ìž¥ ì„žê¸°, 1ì¤„/3ì¤„/2ì¤„ ë¬¸ë‹¨ ì„žê¸° (AI íŒ¨í„´ íƒˆí”¼)

[ìžì—°ìŠ¤ëŸ¬ìš´ ê¸€ì“°ê¸°]
13. ê°ì • ê³µê°: "ì¼ìƒìƒí™œì´ ë¶ˆíŽ¸í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤" (âœ…), "ì €ë„ ê²ªì—ˆëŠ”ë°ìš”" (âŒ ì²´í—˜ë‹´)
14. êµ¬ì²´ì  ìƒí™©: "ì•„ì¹¨ì— ì¼ì–´ë‚  ë•Œ", "ê³„ë‹¨ ë‚´ë ¤ê°ˆ ë•Œ", "ë‚ ì”¨ê°€ íë¦° ë‚ "
15. ì´ëª¨ì§€: ì†Œì œëª©ì—ë§Œ ì‚¬ìš© (âš ï¸ðŸ’¡ðŸŽ¯âœ…), ê°ì • ì´ëª¨ì§€ ê¸ˆì§€ (ðŸ˜Šâ¤ï¸ðŸ”¥)
16. ë„¤ì´ë²„ SEO: ì†Œì œëª© ì§ˆë¬¸í˜• "~ì´ëž€?", ì •ë³´ ë°€ë„ ë†’ì´ê¸°, ë¬¸ë‹¨ ê°„ ìžì—°ìŠ¤ëŸ¬ìš´ ì—°ê²°
17. êµ¬ì–´ì²´ ì ˆì œ: ê¸€ ì „ì²´ ìµœëŒ€ 3~4ê°œ (ë§¨ ìœ„ 3ë²ˆ ê·œì¹™)
18. 3ì¸ì¹­ ì‹œì : "ì¼ë°˜ì ìœ¼ë¡œ" (âœ…), "ì €ëŠ”/ìš°ë¦¬/ë‹¹ì‹ " (âŒ)
19. ë¬¸ë‹¨ ì‹œìž‘ ë‹¤ì–‘í™”: ì„¤ëª…í˜•/ìƒí™©í˜•/ì¡°ê±´í˜•/ì‹œê°„í˜•/ë¹„êµí˜• ì„žê¸°
20. ê¸€ íë¦„: ê³µê° â†’ ì •ë³´ â†’ ì‹ ë¢° â†’ í–‰ë™ (AIDA)

[ì£¼ì˜ì‚¬í•­]
- ì¶”ìƒëª…ì‚¬ ë°°ì œ: "ê³ ë ¤/ì–‘ìƒ/ì¸¡ë©´" â†’ "ì‚´íŽ´ë³´ë‹¤/ë‚˜íƒ€ë‚˜ë‹¤/ëŠë¼ë‹¤"
- ê°™ì€ í‘œí˜„ ë°˜ë³µ ê¸ˆì§€: "~ê²½ìš°ê°€ ìžˆìŠµë‹ˆë‹¤" ê¸€ ì „ì²´ ìµœëŒ€ 3íšŒ
- ë§ˆë¬´ë¦¬: ìƒíˆ¬ì  í‘œí˜„ ê¸ˆì§€ (ë§¨ ìœ„ 2ë²ˆ ê·œì¹™ ì°¸ê³ ) â†’ í•µì‹¬ ìš”ì•½ì´ë‚˜ ì£¼ì˜ì‚¬í•­ìœ¼ë¡œ ì¢…ë£Œ

[HTML êµ¬ì¡°]
â›” ì¸ì‚¬ë§ ê¸ˆì§€ ("ì•ˆë…•í•˜ì„¸ìš”") â†’ âœ… ë°”ë¡œ ì¼ìƒ ìƒí™© ë¬˜ì‚¬ë¡œ ì‹œìž‘
<div class="naver-post-container">
  <p>ë„ìž…: ë…ìž ì²´í—˜ ë¬˜ì‚¬ (2~3ë¬¸ë‹¨)</p>
  <h3>ì†Œì œëª© (ì´ëª¨ì§€ 1ê°œ + ì§ˆë¬¸í˜•/ì •ë³´í˜•)</h3>
  <p>ë³¸ë¬¸ ë‚´ìš© (ë¬¸ë‹¨ ê¸¸ì´ ë‹¤ì–‘í•˜ê²Œ: 1ì¤„/3ì¤„/2ì¤„ ì„žê¸°)</p>
  ${targetImageCount >= 1 ? '[IMG_1]\n' : ''}
  <h3>ë‹¤ìŒ ì†Œì œëª©</h3>
  <p>ë³¸ë¬¸ ê³„ì†...</p>
  <p>ë§ˆë¬´ë¦¬: í•µì‹¬ ìš”ì•½ì´ë‚˜ ì£¼ì˜ì‚¬í•­ìœ¼ë¡œ ìžì—°ìŠ¤ëŸ½ê²Œ ì¢…ë£Œ (ìƒíˆ¬ì  ë©˜íŠ¸ ê¸ˆì§€!)</p>
  <p>#í•´ì‹œíƒœê·¸ 10ê°œ</p>
</div>

[ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ ê·œì¹™ - í•œêµ­ì–´ ìž‘ì„±]
- ì´ë¯¸ì§€ì— í…ìŠ¤íŠ¸/ë¡œê³  ì ˆëŒ€ ê¸ˆì§€
- ìŠ¤íƒ€ì¼ í‚¤ì›Œë“œ: ${imageStyleGuide}

[ðŸ“¤ ìµœì¢… ì²´í¬]
â–¡ ì˜ë£Œë²•: ë‹¨ì •Â·ì§€ì‹œÂ·ë³´ìž¥ í‘œí˜„ 0ê°œ
â–¡ AI ëƒ„ìƒˆ: ìˆ«ìž/í†µê³„/ë²ˆí˜¸/ì¶”ìƒëª…ì‚¬ ê¸ˆì§€
â–¡ í†¤: "ê´‘ê³ " ì•„ë‹Œ "ì„¤ëª…" ëŠë‚Œ
â–¡ ë¶„ëŸ‰: ${targetLength + 100}~${targetLength + 200}ìž
â–¡ ê°ê° ë¬˜ì‚¬ í¬í•¨ (ì°Œë¦¿í•œ, ë¬µì§í•œ, ë»£ë»£í•œ ë“±)
â–¡ ì „í™˜ì–´ ì‚¬ìš© (ì‹ ê¸°í•˜ê²Œë„, ë‹¤í–‰ížˆ, ë‹¤ë§Œ, í•˜ì§€ë§Œ)
â–¡ ë¹„ìœ  1ê°œ ì´ìƒ (ì´í•´ ë•ê¸°)
â–¡ ëŒ€í™”ì²´ íë¦„ (~ê²ë‹ˆë‹¤, ~ë•Œë„ ìžˆì£  ë“±)

[JSON ì‘ë‹µ]
{
  "title": "ì œëª© (ìƒíƒœ ì ê²€í˜• ì§ˆë¬¸)",
  "content": "HTML ë³¸ë¬¸",
  "imagePrompts": ["í•œêµ­ì–´ í”„ë¡¬í”„íŠ¸1", "í•œêµ­ì–´ í”„ë¡¬í”„íŠ¸2"],
  "fact_check": {
    "fact_score": 85,
    "safety_score": 95,
    "conversion_score": 80,
    "ai_smell_score": 10,
    "verified_facts_count": 5,
    "issues": ["ë¬¸ì œì "],
    "recommendations": ["ê¶Œìž¥ì‚¬í•­"]
  }
}

âš ï¸ ai_smell_scoreëŠ” ë‚®ì„ìˆ˜ë¡ ì¢‹ìŒ (7ì  ì´í•˜ ëª©í‘œ, 15ì  ì´ˆê³¼ ì‹œ ìž¬ìž‘ì„±)
âš ï¸ ëª©í‘œ ê¸¸ì´: ê³µë°± ì œì™¸ ${targetLength + 100}~${targetLength + 200}ìž ë²”ìœ„ ë‚´!

[ê²€ìƒ‰ ì •ë³´ í™œìš©]
(ê²€ìƒ‰ ì •ë³´ëŠ” generateWithAgentModeì—ì„œ ìžë™ìœ¼ë¡œ ìˆ˜ì§‘ë©ë‹ˆë‹¤)

[ìž‘ì„± ì‹œìž‘]
ìœ„ ìš”ì²­ì‚¬í•­ê³¼ ê²€ìƒ‰ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì „ë¬¸ì ì´ê³  ì‹ ë¢°ë„ ë†’ì€ ì½˜í…ì¸ ë¥¼ ìž‘ì„±í•´ì£¼ì„¸ìš”.
ë°˜ë“œì‹œ JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µí•˜ê³ , ëª©í‘œ ê¸¸ì´(ê³µë°± ì œì™¸ ${targetLength + 100}~${targetLength + 200}ìž)ë¥¼ ì¤€ìˆ˜í•´ì£¼ì„¸ìš”.
  `;

  /* ê¸°ì¡´ ìƒì„¸ í”„ë¡¬í”„íŠ¸ ì£¼ì„ ì²˜ë¦¬ (API íƒ€ìž„ì•„ì›ƒ ë°©ì§€)
    
    [ðŸ“… í˜„ìž¬ ì‹œì  ì •ë³´ - ìµœì‹  ì •ë³´ ê¸°ë°˜ ìž‘ì„± í•„ìˆ˜!]
    ${timeContext}
    
    ---â”â”
    ðŸš¨ ì ˆëŒ€ ê¸ˆì§€ ê·œì¹™ (ì´ê²ƒë§Œ ì§€ì¼œë„ 80ì !)
    ---â”â”
    
    âŒ **"~ì¸ì§€, ~ì¸ì§€, ~ì¸ì§€" ë‚˜ì—´ íŒ¨í„´ ì ˆëŒ€ ê¸ˆì§€!**
       - **ì´ëŸ° íŒ¨í„´ ë°œê²¬ ì¦‰ì‹œ íƒˆë½:**
         - "êµ¬í† ê°€ ë°˜ë³µë˜ëŠ”ì§€, ë¬¼ì„ ë§ˆì…”ë„ ìœ ì§€ê°€ ì–´ë ¤ìš´ì§€, ì„¤ì‚¬ê°€ ë¬¼ì²˜ëŸ¼ ì´ì–´ì§€ëŠ”ì§€"
         - "í†µì¦ì´ ë” ëšœë ·í•´ì§€ëŠ”ì§€, ê³ ê´€ì ˆ íšŒì „ ì‹œ í†µì¦ì´ ì»¤ì§€ëŠ”ì§€, ê±·ê¸° êº¼ë ¤ì§€ëŠ”ì§€"
         - "ì˜¤í•œÂ·ë°œì—´ê°Â·ê·¼ìœ¡í†µì´ ê°™ì´ ë¶™ëŠ”ì§€, ì£¼ë³€ì—ì„œë„ ë¹„ìŠ·í•œ ì¦ìƒì´ ì´ì–´ì§€ëŠ”ì§€"
       
       - **ë°˜ë“œì‹œ ë¬¸ë‹¨ íë¦„ìœ¼ë¡œ í’€ì–´ì“°ê¸°:**
         âœ… "êµ¬í† ê°€ ë°˜ë³µë˜ê³  ë¬¼ì„ ë§ˆì…”ë„ ìœ ì§€í•˜ê¸° ì–´ë ¤ìš´ ìƒíƒœê°€ ì´ì–´ì§ˆ ìˆ˜ ìžˆë‹¤. ì„¤ì‚¬ê°€ ë¬¼ì²˜ëŸ¼ ë‚˜ì˜¤ë©´ì„œ ë³µí†µ ê°•ë„ê°€ ì»¤ì§€ëŠ” íë¦„ì´ ìžˆë‹¤ë©´, ì˜¤í•œì´ë‚˜ ë°œì—´ê°, ê·¼ìœ¡í†µ ê°™ì€ ì „ì‹  ì¦ìƒì´ í•¨ê»˜ ë‚˜íƒ€ë‚˜ëŠ” ê²½ìš°ë„ ìžˆë‹¤. ê°€ì¡±ì´ë‚˜ ë™ë£Œ ë“± ì£¼ë³€ì—ì„œë„ ë¹„ìŠ·í•œ ì¦ìƒì´ ì´ì–´ì§„ë‹¤ë©´..."
       
       - **ë‚˜ì—´ì‹ ë¶ˆë¦¿ í¬ì¸íŠ¸ë„ ê¸ˆì§€:**
         âŒ "- ~ì¸ì§€ í™•ì¸í•´ë³´ì„¸ìš”"
         âŒ "- ~ì¸ì§€ ì²´í¬í•´ë³´ì„¸ìš”"
         âŒ "- ~ì¸ì§€ ì‚´íŽ´ë´…ë‹ˆë‹¤"
         âŒ "- ~í•˜ê³  ìžˆëŠ”ì§€"
         âŒ "- ~ì§€ ì•Šì•˜ëŠ”ì§€"
         
       - **ðŸš¨ ì²´í¬í¬ì¸íŠ¸ ë³„ë„ ì„¹ì…˜ ì ˆëŒ€ ê¸ˆì§€!:**
         âŒ "ì²´í¬ í¬ì¸íŠ¸" ì†Œì œëª© í›„ ë¶ˆë¦¿ ë¦¬ìŠ¤íŠ¸
         âŒ "í™•ì¸ ì‚¬í•­" ì†Œì œëª© í›„ ë¶ˆë¦¿ ë¦¬ìŠ¤íŠ¸
         âŒ "ì ê²€ í•­ëª©" ì†Œì œëª© í›„ ë¶ˆë¦¿ ë¦¬ìŠ¤íŠ¸
         â†’ ëª¨ë“  ì²´í¬í¬ì¸íŠ¸ëŠ” ë°˜ë“œì‹œ ë¬¸ë‹¨ ì„œìˆ ì— ë…¹ì—¬ì„œ ìžì—°ìŠ¤ëŸ½ê²Œ í‘œí˜„!
         â†’ ë³„ë„ ì„¹ì…˜ìœ¼ë¡œ ë¶„ë¦¬í•˜ë©´ AI smell + ì˜í•™ë°±ê³¼ êµ¬ì¡°ë¡œ ìµœí•˜ìœ„ ë…¸ì¶œ!
    
    âŒ **ê¸€ ì„œë‘ì— ë©”íƒ€ ì„¤ëª… ê¸ˆì§€!**
       - "ì´ ê¸€ì€ ~ì— ì´ˆì ì„ ë§žì·„ìŠµë‹ˆë‹¤"
       - "~í•˜ë ¤ëŠ” ëª©ì ì€ ì•„ë‹ˆë©°"
       - "~ì°¸ê³ í•  ìˆ˜ ìžˆëŠ” ì •ë³´ìž…ë‹ˆë‹¤"
       - ê¸€ì“´ì´ì˜ ì˜ë„ë‚˜ ëª©ì ì„ ì„¤ëª…í•˜ëŠ” ë¬¸ìž¥ ê¸ˆì§€
       - ë°”ë¡œ ë³¸ë¡ ìœ¼ë¡œ ì‹œìž‘
    
    âŒ **íŒë‹¨ íšŒí”¼ í‘œí˜„ ë°˜ë³µ ì œí•œ!**
       - "ë‹¨ì •í•˜ê¸°ëŠ” ì–´ë µìŠµë‹ˆë‹¤", "íŒë‹¨í•˜ê¸°ê°€ ì–´ë µìŠµë‹ˆë‹¤" ë“±
       - ë™ì¼ í‘œí˜„ 2íšŒ ì´ìƒ ë°˜ë³µ ê¸ˆì§€ (1íšŒëŠ” í—ˆìš©)
       - ë‹¤ì–‘í•œ í‘œí˜„ ì‚¬ìš© ê¶Œìž¥: "ëª…í™•ížˆ êµ¬ë¶„ë˜ì§€ ì•ŠëŠ” ê²½ìš°ë„ ìžˆë‹¤", "ê²¹ì¹˜ëŠ” ë¶€ë¶„ì´ ìžˆë‹¤" ë“±
    
    ---â”â”
    
    ðŸ”Ž **ê¸€ ìž‘ì„± ì „ í•„ìˆ˜ ê²€ìƒ‰ ë‹¨ê³„ (ë°˜ë“œì‹œ ìˆœì„œëŒ€ë¡œ ìˆ˜í–‰!)** ðŸ”Ž
    
    âš ï¸ **í•µì‹¬: health.kdca.go.kr ì „ìš© ê²€ìƒ‰ ê°•í™”!** âš ï¸
    
    1ìˆœìœ„:1ìˆœìœ„ (ìµœìš°ì„ ! ë°˜ë“œì‹œ ë¨¼ì €!)**: 
       ê²€ìƒ‰ì–´: "${request.topic} site:health.kdca.go.kr"
       â†’ ì§ˆë³‘ê´€ë¦¬ì²­ ê±´ê°•ì •ë³´í¬í„¸ (ì¼ë°˜ì¸ ëŒ€ìƒ ê±´ê°•ì •ë³´)
       â†’ URL í˜•ì‹: https://health.kdca.go.kr/...
       â†’ ðŸš¨ ì´ ì‚¬ì´íŠ¸ì—ì„œ ì¶©ë¶„í•œ ìžë£Œë¥¼ ì°¾ì•˜ë‹¤ë©´ í•´ì™¸ ì‚¬ì´íŠ¸(PubMed) ê²€ìƒ‰ ìƒëžµ!
       â†’ ðŸš¨ health.kdca.go.kr ê²°ê³¼ë¥¼ ê¸€ì— ê°€ìž¥ ë§Žì´ ë°˜ì˜!
    
    2ìˆœìœ„:2ìˆœìœ„**: 
       ê²€ìƒ‰ì–´: "${request.topic} site:kdca.go.kr"
       â†’ ì§ˆë³‘ê´€ë¦¬ì²­ ê³µì‹ ì‚¬ì´íŠ¸ (ë³´ë„ìžë£Œ, í†µê³„, ê°ì—¼ë³‘ ì •ë³´)
    
    3ìˆœìœ„:3ìˆœìœ„**: 
       ê²€ìƒ‰ì–´: "${request.topic} site:mohw.go.kr OR site:nhis.or.kr"
       â†’ ë³´ê±´ë³µì§€ë¶€, êµ­ë¯¼ê±´ê°•ë³´í—˜ê³µë‹¨ ê³µì‹ ìžë£Œ
    
    4ìˆœìœ„:4ìˆœìœ„**: 
       ê²€ìƒ‰ì–´: "${request.topic} ëŒ€í•œ${request.category}í•™íšŒ ê°€ì´ë“œë¼ì¸ ${currentYear}"
       â†’ êµ­ë‚´ í•™íšŒ ìµœì‹  ì§€ì¹¨ í™•ì¸
    
    5. **5ìˆœìœ„ (ì„ íƒì  - êµ­ë‚´ ìžë£Œ ë¶€ì¡± ì‹œì—ë§Œ!)**: 
       ê²€ìƒ‰ì–´: "${request.topic} site:pubmed.ncbi.nlm.nih.gov ${currentYear}"
       â†’ ìµœì‹  ë…¼ë¬¸/ì—°êµ¬ ê²°ê³¼ í™•ì¸
       â†’ âš ï¸ 1~4ìˆœìœ„ì—ì„œ ì¶©ë¶„í•œ ìžë£Œë¥¼ ì°¾ì•˜ë‹¤ë©´ ì´ ë‹¨ê³„ëŠ” ìƒëžµ!
    
    ðŸ“‹ **ê²€ìƒ‰ ì „ëžµ (health.kdca.go.kr ìš°ì„ !):**
    âœ… health.kdca.go.krì—ì„œ ê´€ë ¨ ì •ë³´ë¥¼ ì¶©ë¶„ížˆ ì°¾ì•˜ë‹¤ë©´ â†’ í•´ì™¸ ë…¼ë¬¸ ê²€ìƒ‰ ìƒëžµ!
    âœ… health.kdca.go.kr ì •ë³´ë¥¼ ê¸€ì˜ ì£¼ìš” ê·¼ê±°ë¡œ í™œìš©!
    âœ… êµ­ë‚´ ê³µì‹ ë ¥ ìžˆëŠ” ìžë£Œê°€ ë¶€ì¡±í•  ë•Œë§Œ â†’ PubMed ë“± í•´ì™¸ ìžë£Œ ì°¸ê³ 
    âœ… í•­ìƒ í•œêµ­ ì‹¤ì •ì— ë§žëŠ” ì •ë³´ë¥¼ ìš°ì„ ìœ¼ë¡œ!
    
    [ê¸ˆì§€] **ì ˆëŒ€ ê²€ìƒ‰ ê¸ˆì§€ ë„ë©”ì¸:**
    - blog.naver.com, tistory.com, brunch.co.kr (ë¸”ë¡œê·¸)
    - cafe.naver.com (ì¹´íŽ˜)
    - youtube.com (ìœ íŠœë¸Œ)
    - health.chosun.com, hidoc.co.kr, kormedi.com (ê±´ê°• ë§¤ì²´)
    - storybongbong.co.kr, keyzard.cc (ì ˆëŒ€ ê¸ˆì§€!)
    
    âš ï¸ ê²€ìƒ‰ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ìµœì‹  ì •ë³´ë§Œ ì‚¬ìš©í•˜ì—¬ ê¸€ ìž‘ì„±!
    âš ï¸ ì¶œì²˜ ì¸ìš©ì€ í•„ìš”ì‹œ ìžì—°ìŠ¤ëŸ½ê²Œ (íšŸìˆ˜ ì œí•œ ì—†ìŒ, ê°•ì œ ì•„ë‹˜)
    
    - ${currentYear}ë…„ ìµœì‹  ì˜í•™ ê°€ì´ë“œë¼ì¸/ì—°êµ¬ ê²°ê³¼ ë°˜ì˜
    - ${currentYear}ë…„ ìµœì‹  ì˜ë£Œê´‘ê³ ë²• ê·œì • ì¤€ìˆ˜
    - ${currentSeason}ì²  íŠ¹ì„± ê³ ë ¤ (ê³„ì ˆì„± ì§ˆí™˜, ìƒí™œ ìŠµê´€ ë“±)
    - ì˜¤ëž˜ëœ ì •ë³´(2ë…„ ì´ìƒ)ëŠ” ìµœì‹  ì •ë³´ë¡œ ì—…ë°ì´íŠ¸í•˜ì—¬ ìž‘ì„±
    
    ì§„ë£Œê³¼: ${request.category}, íŽ˜ë¥´ì†Œë‚˜: ${request.persona}, ì£¼ì œ: ${request.topic}
    
    [ðŸš¨ ê¸€ìž ìˆ˜ - ê°€ìž¥ ì¤‘ìš”í•œ ìš”êµ¬ì‚¬í•­!!! ðŸš¨]
    âš ï¸ ëª©í‘œ: ê³µë°± ì œì™¸ **ì •í™•ížˆ ${targetLength + 100}~${targetLength + 200}ìž** ë²”ìœ„ ë‚´ ìž‘ì„±! âš ï¸

    [ê¸ˆì§€] **ì ˆëŒ€ ê¸ˆì§€:**
    - ${targetLength + 100}ìžë³´ë‹¤ ì ê²Œ ì“°ëŠ” ê²ƒ!
    - ${targetLength + 200}ìžë³´ë‹¤ ë§Žì´ ì“°ëŠ” ê²ƒ! (ì¦‰ì‹œ ì¤‘ë‹¨!)

    âœ… **í•„ìˆ˜ ì¤€ìˆ˜ ë²”ìœ„:** ${targetLength + 100}ìž ~ ${targetLength + 200}ìž
    ðŸŽ¯ **ì´ìƒì ì¸ ë²”ìœ„:** ${targetLength + 100}ìž ~ ${targetLength + 150}ìž

    ðŸ“Œ **ë¶„ëŸ‰ ì œí•œ ê·œì¹™:**
    - 1500ìž ì„¤ì • â†’ 1600~1700ìž ë²”ìœ„ (1700ìž ë„˜ìœ¼ë©´ ì•ˆ ë¨!)
    - 2000ìž ì„¤ì • â†’ 2100~2200ìž ë²”ìœ„ (2200ìž ë„˜ìœ¼ë©´ ì•ˆ ë¨!)
    - âš ï¸ ìƒí•œì„  ë„ë‹¬ ì‹œ ì¦‰ì‹œ ê²°ë¡  ìž‘ì„±í•˜ê³  ë§ˆë¬´ë¦¬!
    
    ðŸ“ ë¶„ëŸ‰ ì „ëžµ:
    - ì„œë¡  10%, ë³¸ë¡  2~4ê°œ ì„¹ì…˜, ê²°ë¡  10%, í•´ì‹œíƒœê·¸ 10ê°œ
    - ìƒí•œì„  ë„ë‹¬ ì‹œ ì¦‰ì‹œ ë§ˆë¬´ë¦¬
    - ë¯¸ë‹¬ ì‹œ: ì„¹ì…˜ ì¶”ê°€ ë˜ëŠ” êµ¬ì²´ì  ì˜ˆì‹œ ì¶”ê°€
    
    ì´ë¯¸ì§€ ê°œìˆ˜: ${targetImageCount}ìž¥ ${targetImageCount > 0 ? `(${imageMarkers} ë§ˆì»¤ ì‚¬ìš©)` : '(ì´ë¯¸ì§€ ì—†ì´ í…ìŠ¤íŠ¸ë§Œ ìž‘ì„±)'}

    ðŸš¨ **ì´ë¯¸ì§€ ë§ˆì»¤ ì‚¬ìš© ì£¼ì˜ì‚¬í•­:**
    - ì´ë¯¸ì§€ ë§ˆì»¤([IMG_1], [IMG_2] ë“±)ëŠ” ë¬¸ë‹¨ ì‚¬ì´ì— ì‚½ìž…
    - âš ï¸ ì´ë¯¸ì§€ ë§ˆì»¤ ë’¤ì—ë„ ë°˜ë“œì‹œ ë‹¤ìŒ ì†Œì œëª©ê³¼ ë³¸ë¬¸ ê³„ì† ìž‘ì„±!
    - ì´ë¯¸ì§€ ë§ˆì»¤ë§Œ ì“°ê³  ë©ˆì¶”ì§€ ë§ˆì„¸ìš”!
    - ì´ë¯¸ì§€ëŠ” ë‹¨ìˆœížˆ ì‹œê° ìžë£Œì¼ ë¿, ê¸€ì€ ${targetLength + 100}~${targetLength + 200}ìžê¹Œì§€ ê³„ì† ìž‘ì„±

    [AI ëƒ„ìƒˆ ì œê±° í•µì‹¬]
    - ì› ìˆ«ìž (â‘ â‘¡â‘¢â‘£â‘¤) ê¸ˆì§€
    - ì—°ê²°ì–´ ê³¼ë‹¤ (ê·¸ëŸ¬ë‚˜, í•˜ì§€ë§Œ, ê·¸ëŸ°ë°) â†’ 5íšŒ ë¯¸ë§Œ
    - ê°•ì¡° ë¶€ì‚¬ ë‚¨ìš© (ë§¤ìš°, êµ‰ìž¥ížˆ, ìƒë‹¹ížˆ) â†’ 6íšŒ ë¯¸ë§Œ
    - ì¢…ê²°ì–´ë¯¸ ë‹¤ì–‘í™”: ~ìŠµë‹ˆë‹¤, ~ë©ë‹ˆë‹¤, ~íŽ¸ìž…ë‹ˆë‹¤, ~ê¸°ë„ í•©ë‹ˆë‹¤

    ðŸš¨ **ìˆ«ìž í‘œí˜„ ì ˆëŒ€ ê¸ˆì§€! (ë§¨ ìœ„ 1ë²ˆ ê·œì¹™ ì°¸ê³ )**
    ëª¨ë“  í†µê³„/íšŸìˆ˜/ê¸°ê°„/ê°œìˆ˜ ê¸ˆì§€ â†’ "ë§¤ìš° ë‹¤ì–‘í•œ", "ë“œë¬¼ì§€ ì•Šê²Œ", "ìžì£¼", "ë©°ì¹ " ì‚¬ìš©

    [ë„¤ì´ë²„ ë¸”ë¡œê·¸ HTML í˜•ì‹ ìž‘ì„± í•„ìˆ˜]
    ðŸš¨ **ë§ˆí¬ë‹¤ìš´ ë¬¸ë²• ì ˆëŒ€ ì‚¬ìš© ê¸ˆì§€!!!** ðŸš¨
    âŒ **êµµì€ê¸€ì”¨** â†’ âœ… <strong>êµµì€ê¸€ì”¨</strong> ë˜ëŠ” <b>êµµì€ê¸€ì”¨</b>
    âŒ *ê¸°ìš¸ìž„* â†’ âœ… <em>ê¸°ìš¸ìž„</em>
    âŒ ### ì œëª© â†’ âœ… <h3>ì œëª©</h3>
    âŒ - ëª©ë¡ â†’ âœ… <ul><li>ëª©ë¡</li></ul>
    âŒ [ë§í¬](url) â†’ âœ… <a href="url">ë§í¬</a>
    
    â›” íŠ¹ížˆ **ë‹¨ì–´** ì´ëŸ° ì‹ìœ¼ë¡œ ë³„í‘œ ë‘ ê°œë¡œ ê°ì‹¸ëŠ” ê±° ì ˆëŒ€ ê¸ˆì§€!
    â›” ë°˜ë“œì‹œ <strong>ë‹¨ì–´</strong> ë˜ëŠ” <b>ë‹¨ì–´</b>ë¡œ ìž‘ì„±!
    
    HTML êµ¬ì¡° (ì´ë¯¸ì§€ ${targetImageCount}ìž¥ ë°°ì¹˜, ê¸€ìž ìˆ˜ ${targetLength}ìž ê¸°ì¤€):
    <div class="naver-post-container">
      <h3>ðŸŽ¯ ì„œë¡  ì œëª© (ê³µê° ìœ ë„)</h3>
      <p>ì„œë¡  ë¬¸ë‹¨ (${targetLength >= 4000 ? '400ìž ì´ìƒ' : targetLength >= 3000 ? '300ìž ì´ìƒ' : '200ìž ì´ìƒ'}) - ${writingStyle === 'expert' ? 'ì˜í•™ì  ì¸ì‚¬ì´íŠ¸ë‚˜ ë…¼ë¬¸/í•™íšŒ ì¸ìš©ìœ¼ë¡œ ì‹œìž‘' : 'êµ¬ì²´ì  ìƒí™© ë¬˜ì‚¬ë¡œ ì‹œìž‘! (ì˜ˆ: "ížˆí„° ì¼œê³  ìžê³  ì¼ì–´ë‚˜ë©´...")'}</p>
      <p>ì„œë¡  ì¶”ê°€ ë¬¸ë‹¨ - ì™œ ì´ ì£¼ì œê°€ ì¤‘ìš”í•œì§€ ì„¤ëª…</p>
      
      ${targetImageCount >= 1 ? '[IMG_1]' : ''}
      
      <h3>â€» ë³¸ë¡  1: ì •ì˜/ê°œë… ì„¤ëª…</h3>
      <p>í•µì‹¬ ê°œë… ì„¤ëª… (${targetLength >= 4000 ? '500ìž ì´ìƒ' : '350ìž ì´ìƒ'})</p>
      <p>ì¶”ê°€ ì„¤ëª… + ì˜ˆì‹œ</p>
      <ul>
        <li>í¬ì¸íŠ¸ 1 - ìƒì„¸ ì„¤ëª…</li>
        <li>í¬ì¸íŠ¸ 2 - ìƒì„¸ ì„¤ëª…</li>
        <li>í¬ì¸íŠ¸ 3 - ìƒì„¸ ì„¤ëª…</li>
      </ul>
      
      ${targetImageCount >= 2 ? '[IMG_2]' : ''}
      
      <h3>âš ï¸ ë³¸ë¡  2: ì›ì¸/ì¦ìƒ ìƒì„¸</h3>
      <p>ì›ì¸ ì„¤ëª… (${targetLength >= 4000 ? '500ìž ì´ìƒ' : '350ìž ì´ìƒ'})</p>
      <p>ì¦ìƒë³„ ìƒì„¸ ì„¤ëª… + êµ¬ì²´ì  ì‚¬ë¡€</p>
      <ul>
        <li>ì›ì¸/ì¦ìƒ 1 - "ì˜ˆë¥¼ ë“¤ì–´..." ìƒì„¸ ì„¤ëª…</li>
        <li>ì›ì¸/ì¦ìƒ 2 - êµ¬ì²´ì  ìƒí™© ë¬˜ì‚¬</li>
        <li>ì›ì¸/ì¦ìƒ 3 - ì£¼ì˜ì‚¬í•­</li>
      </ul>
      
      ${targetImageCount >= 3 ? '[IMG_3]' : ''}
      
      ${targetLength >= 3500 ? `
      <h3>ðŸ”¬ ë³¸ë¡  3: ì§„ë‹¨/ê²€ì‚¬ ë°©ë²•</h3>
      <p>ê²€ì‚¬ ë°©ë²• ìƒì„¸ ì„¤ëª… (400ìž ì´ìƒ) - ì–´ë–¤ ê²€ì‚¬ë¥¼ í•˜ëŠ”ì§€, ê²€ì‚¬ ê³¼ì •ì€ ì–´ë–¤ì§€</p>
      <p>ê²€ì‚¬ ê²°ê³¼ í•´ì„ ë°©ë²• + ì£¼ì˜ì‚¬í•­</p>
      <ul>
        <li>ê²€ì‚¬ ì¢…ë¥˜ 1 ì„¤ëª…</li>
        <li>ê²€ì‚¬ ì¢…ë¥˜ 2 ì„¤ëª…</li>
      </ul>
      ` : ''}
      
      ${targetImageCount >= 4 ? '[IMG_4]' : ''}
      
      ${targetLength >= 4000 ? `
      <h3>ðŸ’Š ë³¸ë¡  4: ì¹˜ë£Œ/ê´€ë¦¬ ë°©ë²•</h3>
      <p>ì¹˜ë£Œ ë°©ë²• ìƒì„¸ ì„¤ëª… (500ìž ì´ìƒ)</p>
      <p>ê´€ë¦¬ ë°©ë²• + ìƒí™œ ìŠµê´€ ê°œì„  íŒ</p>
      <ul>
        <li>ì¹˜ë£Œë²• 1 - ìž¥ë‹¨ì  ì„¤ëª…</li>
        <li>ì¹˜ë£Œë²• 2 - ì ìš© ëŒ€ìƒ</li>
        <li>ìƒí™œ ê´€ë¦¬ë²• - êµ¬ì²´ì  ë°©ë²•</li>
      </ul>
      ` : ''}
      
      ${targetLength >= 4500 ? `
      <h3>ðŸ›¡ï¸ ë³¸ë¡  5: ì˜ˆë°©ë²•/ì£¼ì˜ì‚¬í•­</h3>
      <p>ì˜ˆë°©ë²• ìƒì„¸ ì„¤ëª… (400ìž ì´ìƒ)</p>
      <p>ì¼ìƒì—ì„œ ì‹¤ì²œí•  ìˆ˜ ìžˆëŠ” êµ¬ì²´ì  ë°©ë²•ë“¤</p>
      <ul>
        <li>ì˜ˆë°©ë²• 1 - ì‹¤ì²œ ë°©ë²•</li>
        <li>ì˜ˆë°©ë²• 2 - ì‹¤ì²œ ë°©ë²•</li>
        <li>ì£¼ì˜ì‚¬í•­ - ì´ëŸ° ê²½ìš°ëŠ” ì£¼ì˜!</li>
      </ul>
      ` : ''}
      
      ${targetImageCount >= 5 ? '[IMG_5]' : ''}
      
      ${targetLength >= 3500 ? `
      <h3>â“ ìžì£¼ ë¬»ëŠ” ì§ˆë¬¸ (FAQ)</h3>
      <p><strong>Q1. [ìžì£¼ ë¬»ëŠ” ì§ˆë¬¸ 1]</strong></p>
      <p>A1. ìƒì„¸í•œ ë‹µë³€ (150ìž ì´ìƒ)</p>
      <p><strong>Q2. [ìžì£¼ ë¬»ëŠ” ì§ˆë¬¸ 2]</strong></p>
      <p>A2. ìƒì„¸í•œ ë‹µë³€ (150ìž ì´ìƒ)</p>
      ` : '<!-- FAQëŠ” 3500ìž ì´ìƒì—ì„œë§Œ í¬í•¨ -->'}
      
      <h3>âœ… ë§ˆë¬´ë¦¬: í•µì‹¬ ì •ë¦¬</h3>
      <p>í•µì‹¬ ë‚´ìš© ìš”ì•½ (${targetLength >= 4000 ? '300ìž ì´ìƒ' : '200ìž ì´ìƒ'}) - ${writingStyle === 'conversion' ? 'í–‰ë™ì„ í•˜ë‚˜ë¡œ ì§‘ì¤‘! ("ë”± í•˜ë‚˜ë§Œ ê¸°ì–µí•˜ì„¸ìš”...")' : 'í•µì‹¬ ì •ë³´ ìš”ì•½'}</p>

      <p>ë§ˆë¬´ë¦¬ ë¬¸ë‹¨ ì„œìˆ  (ì•„ëž˜ ê·œì¹™ ì°¸ì¡°) - ë³„ë„ ë°•ìŠ¤ ì—†ì´ ìžì—°ìŠ¤ëŸ¬ìš´ ë¬¸ë‹¨ìœ¼ë¡œ!</p>

      <p>í•´ì‹œíƒœê·¸ 10~15ê°œ</p>
    </div>

    [ðŸ“ ê¸€ìž ìˆ˜ ì²´í¬ í”„ë¡œì„¸ìŠ¤ - ë‹¨ê³„ë³„ í™•ì¸!]
    ðŸš¨ **ìž‘ì„± ì¤‘ ê¸€ìž ìˆ˜ í™•ì¸:**
    1. ì„œë¡  ìž‘ì„± í›„ â†’ ëˆ„ì  ${Math.round(targetLength * 0.1)}~${Math.round(targetLength * 0.15)}ìž í™•ì¸
    2. ë³¸ë¡  1 ìž‘ì„± í›„ â†’ ëˆ„ì  ${Math.round(targetLength * 0.3)}~${Math.round(targetLength * 0.35)}ìž í™•ì¸
    3. ë³¸ë¡  2 ìž‘ì„± í›„ â†’ ëˆ„ì  ${Math.round(targetLength * 0.5)}~${Math.round(targetLength * 0.6)}ìž í™•ì¸
    4. ë³¸ë¡  3 ìž‘ì„± í›„ â†’ ëˆ„ì  ${Math.round(targetLength * 0.75)}~${Math.round(targetLength * 0.8)}ìž í™•ì¸
    5. ë§ˆë¬´ë¦¬ ì „ â†’ ëˆ„ì  ${targetLength - 150}ìž ì´ìƒ í™•ì¸
    6. í•´ì‹œíƒœê·¸ ì¶”ê°€ í›„ â†’ ìµœì¢… ${targetLength + 100}~${targetLength + 200}ìž í™•ì¸

    âš ï¸ **ê¸€ìž ìˆ˜ ì´ˆê³¼ ë°©ì§€:**
    - ${targetLength + 180}ìž ë„ë‹¬ ì‹œ ë‹¤ìŒ ì†Œì œëª© ìŠ¤í‚µí•˜ê³  ë§ˆë¬´ë¦¬ë¡œ ì´ë™!
    - ë§ˆë¬´ë¦¬ëŠ” 80~100ìžë¡œ ê°„ê²°í•˜ê²Œ!
    - í•´ì‹œíƒœê·¸ë¡œ ë¯¸ì„¸ ì¡°ì • (ë¶€ì¡±í•˜ë©´ 2~3ê°œ ì¶”ê°€, ë„˜ì¹˜ë©´ ì¤„ì´ê¸°)
    
    ${PSYCHOLOGY_CTA_PROMPT}
    
    [ðŸŽ¯ ë§ˆë¬´ë¦¬ ë¬¸ë‹¨ ìž‘ì„± ê·œì¹™ - CTA ë°•ìŠ¤ ê¸ˆì§€!]
    
    ðŸš¨ **ì ˆëŒ€ ê¸ˆì§€:**
    - <div class="cta-box"> ê°™ì€ ë³„ë„ ë°•ìŠ¤ í˜•íƒœ ê¸ˆì§€!
    - "ðŸ’¡ ê±´ê°• ì²´í¬ í¬ì¸íŠ¸" ê°™ì€ ë°•ìŠ¤ ì œëª© ê¸ˆì§€!
    - ë¬¼ìŒí‘œ(?) ì‚¬ìš© ê¸ˆì§€!
    - "ê¸°ì¤€ì„ ì„¸ìš°ë‹¤", "ê¸°ì¤€ì„ ë§ˆë ¨í•˜ë‹¤", "íŒë‹¨ì´ ì •ë¦¬ë˜ë‹¤" ê¸ˆì§€!
    - ì¶”ìƒ ëª…ì‚¬(ê¸°ì¤€, íŒë‹¨, ì •ë¦¬, ë„ì›€)ë¥¼ ì›ì¸Â·ê²°ê³¼ì²˜ëŸ¼ ì—°ê²°í•˜ëŠ” ë¬¸ìž¥ ê¸ˆì§€!
    
    âœ… **ì´ë ‡ê²Œ ì“°ì„¸ìš”:**
    - ë§ˆë¬´ë¦¬ë„ ì¼ë°˜ <p> íƒœê·¸ë¡œ ìžì—°ìŠ¤ëŸ¬ìš´ ë¬¸ë‹¨ ì„œìˆ !
    - ì–´ë–»ê²Œ ëŠê»´ì§ˆ ìˆ˜ ìžˆëŠ”ì§€ ì„¤ëª…í•˜ëŠ” ë¬¸ìž¥
    - ì–´ë–¤ ê²½ìš°ê°€ ìžˆëŠ”ì§€ ë‚˜ì—´í•˜ëŠ” ë¬¸ìž¥
    - í—·ê°ˆë¦¬ê¸° ì‰¬ìš´ ì§€ì ì„ ì§šëŠ” ë¬¸ìž¥
    
    **ë§ˆë¬´ë¦¬ ë¬¸ë‹¨ ì˜ˆì‹œ:**
    âŒ ê¸ˆì§€: <div class="cta-box"><p class="cta-title">ðŸ’¡ ê±´ê°• ì²´í¬ í¬ì¸íŠ¸</p>...</div>
    âŒ ê¸ˆì§€: "ë‚™ìƒ í›„ í†µì¦ì€ 'ì°¸ê¸°'ë³´ë‹¤ 'íŒ¨í„´ ì •ë¦¬'ê°€ ë¨¼ì €ì¼ ë•Œê°€ ìžˆìŠµë‹ˆë‹¤"
    âŒ ê¸ˆì§€: "ê¸°ì¤€ì„ ë‹¤ì‹œ ì„¸ì›Œë³¼ íƒ€ì´ë°ì¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤"
    
    âœ… ì¢‹ìŒ: "ë„˜ì–´ì§„ ì§í›„ì—” ê´œì°®ë‹¤ê°€ë„ ì‹œê°„ì´ ì§€ë‚˜ë©´ì„œ ì²´ì¤‘ì„ ì‹£ëŠ” ìˆœê°„ í†µì¦ì´ ì„ ëª…í•´ì§€ëŠ” ê²½ìš°ê°€ ìžˆë‹¤. ê²‰ìœ¼ë¡œ ë©ì´ í¬ì§€ ì•Šì•„ë„ ê°™ì€ ë™ìž‘ì—ì„œ ë°˜ë³µì ìœ¼ë¡œ ë¶ˆíŽ¸í•¨ì´ ëŠê»´ì§„ë‹¤ë©´, ë‹¨ìˆœ íƒ€ë°•ê³¼ëŠ” ë‹¤ë¥¸ íë¦„ì¼ ìˆ˜ ìžˆë‹¤. ë‚´ì¼ì€ ì˜¤ëŠ˜ë³´ë‹¤ í†µì¦ì´ ì¤„ì–´ë“œëŠ”ì§€, íŠ¹ì • ë™ìž‘ì—ì„œ ì—¬ì „ížˆ ê±¸ë¦¬ëŠ”ì§€ ë¹„êµí•´ë³´ëŠ” ê²ƒë„ ì°¸ê³ ê°€ ë  ìˆ˜ ìžˆë‹¤."
    
    ì£¼ì˜ì‚¬í•­:
    1. ëª¨ë“  ì œëª©ì€ <h3> íƒœê·¸ ì‚¬ìš©
    2. ëª¨ë“  ë¬¸ë‹¨ì€ <p> íƒœê·¸ ì‚¬ìš©
    3. ë¦¬ìŠ¤íŠ¸ëŠ” <ul><li> íƒœê·¸ ì‚¬ìš©
    4. ì´ë¯¸ì§€ ë§ˆì»¤ ${imageMarkers}ë¥¼ ê¸€ ì¤‘ê°„ì— ì ì ˆížˆ ë°°ì¹˜
    5. í•´ì‹œíƒœê·¸ëŠ” ë§ˆì§€ë§‰ì— <p> ì•ˆì— ìž‘ì„±
    6. **ë§ˆë¬´ë¦¬ëŠ” ë³„ë„ ë°•ìŠ¤ ì—†ì´ ìžì—°ìŠ¤ëŸ¬ìš´ <p> ë¬¸ë‹¨ìœ¼ë¡œ!**
    
    **ë§ˆë¬´ë¦¬ ë¬¸ë‹¨ í•„ìˆ˜ ê·œì¹™:**
    - "ë°©ë¬¸í•˜ì„¸ìš”", "ë‚´ì›í•˜ì„¸ìš”" ê°™ì€ ì§ì ‘ ê¶Œìœ  í‘œí˜„ ì ˆëŒ€ ê¸ˆì§€
    - "ê²€ì§„ì„ ê³ ë ¤í•´ ë³´ì‹œëŠ” ê²ƒë„ ì¢‹ìŠµë‹ˆë‹¤", "ì „ë¬¸ì˜ì™€ ìƒë‹´ì´ í•„ìš”í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤" ë“± ê°„ì ‘ í‘œí˜„ ì‚¬ìš©
    - ë³‘ì› ì´ë¦„, ì „í™”ë²ˆí˜¸, ì£¼ì†Œ ì ˆëŒ€ ê¸ˆì§€
    
    [ðŸ“Š í’ˆì§ˆ í‰ê°€ - 3ê°€ì§€ ì ìˆ˜]

    **1. conversion_score (0~100ì )** - ì˜ë£Œë²• ì¤€ìˆ˜í•˜ë©´ì„œ ì „í™˜ë ¥ ì¸¡ì •
    ê³µê° ë„ìž…ë¶€(20) + ì •ë³´ ê°€ì¹˜(20) + ì‹¬ë¦¬ì  ê¸´ë°•ê°(20) + CTA í’ˆì§ˆ(20) + ì „ì²´ íë¦„(20)
    â†’ "ì´ê±° ë‚´ ì–˜ê¸°ë„¤!" êµ¬ì²´ì  ìƒí™© ë¬˜ì‚¬, ì „ë¬¸ ì¸ì‚¬ì´íŠ¸, ê°„ì ‘ì  í–‰ë™ ìœ ë„

    **2. safety_score (0~100ì )** - ì˜ë£Œê´‘ê³ ë²• ìœ„ë°˜ ê°ì 
    ì§ì ‘ ê¶Œìœ (-30), íš¨ê³¼ ë³´ìž¥(-25), ê³¼ëŒ€ ê´‘ê³ (-20), ë¹„êµ ê´‘ê³ (-20), ê³µí¬ ìœ ë°œ(-15), ë³‘ì› ì •ë³´(-10)
    âœ… ì•ˆì „: "ê²€ì§„ì„ ê³ ë ¤í•´ë³´ëŠ” ê²ƒë„ ì¢‹ìŠµë‹ˆë‹¤", "ì „ë¬¸ì˜ì™€ ìƒë‹´ì´ í•„ìš”í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤"
    âš ï¸ conversion 100ì ì´ì–´ë„ ì˜ë£Œë²• ìœ„ë°˜ ì‹œ íƒˆë½!

    **3. ai_smell_score (0~100ì )** - ë‚®ì„ìˆ˜ë¡ ì¢‹ìŒ! 7ì  ì´í•˜ ëª©í‘œ, 15ì  ì´ˆê³¼ ì‹œ ìž¬ìž‘ì„±
    ë¬¸ìž¥ ë¦¬ë“¬ ë‹¨ì¡°(25) + íŒë‹¨ ë‹¨ì •í˜•(20) + í˜„ìž¥ê° ë¶€ìž¬(20) + í…œí”Œë¦¿ êµ¬ì¡°(15) + ê°€ì§œ ê³µê°(10) + í–‰ë™ ìœ ë„ ì‹¤íŒ¨(10)
    â†’ ì¢…ê²°ì–´ë¯¸/ë¬¸ìž¥ ì‹œìž‘ ë°˜ë³µ, "í™•ì¸ í•„ìš”" ë‚¨ë°œ, ìƒí™© ë§¥ë½ ì—†ìŒ, ì •ì˜â†’ì›ì¸â†’ì¦ìƒ ìˆœì„œ
    íŒì •: 0~7ì (âœ…ì‚¬ëžŒê¸€) / 8~15ì (âš ï¸ê²½ê³„) / 16ì +(ðŸš¨AIí™•ì •)
    
    [ðŸŽ¨ ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ ìž‘ì„± ê·œì¹™ - ë§¤ìš° ì¤‘ìš”!]
    **imagePrompts ë°°ì—´ì— ë“¤ì–´ê°ˆ í”„ë¡¬í”„íŠ¸ëŠ” ë°˜ë“œì‹œ í•œêµ­ì–´ë¡œ ìž‘ì„±í•˜ì„¸ìš”!**
    ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼: ${customImagePrompt ? `ì»¤ìŠ¤í…€: ${customImagePrompt}` : imageStyle === 'illustration' ? '3D ì¼ëŸ¬ìŠ¤íŠ¸' : imageStyle === 'medical' ? 'ì˜í•™ 3D í•´ë¶€í•™' : 'ì‹¤ì‚¬ ì‚¬ì§„'}
    
    **ðŸš¨ ë¸”ë¡œê·¸ ì´ë¯¸ì§€ í…ìŠ¤íŠ¸ ê·œì¹™ (ë§¤ìš° ì¤‘ìš”!):**
    - âŒ ì´ë¯¸ì§€ì— í…ìŠ¤íŠ¸ ë„£ì§€ ë§ˆì„¸ìš”! (ê¸€ìž, ìˆ«ìž, ë¬¸êµ¬ ëª¨ë‘ ê¸ˆì§€)
    - âŒ ë¡œê³ , ì›Œí„°ë§ˆí¬, ê°„íŒ, í‘œì§€íŒ ê¸ˆì§€
    - âœ… ìˆœìˆ˜í•œ ì¼ëŸ¬ìŠ¤íŠ¸/ì‚¬ì§„ë§Œ ìƒì„±
    - âœ… í”„ë¡¬í”„íŠ¸ì— "í…ìŠ¤íŠ¸ ì—†ì´", "ê¸€ìž ì—†ì´" ëª…ì‹œ í•„ìˆ˜!
    
    ê° ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ì— ë°˜ë“œì‹œ í¬í•¨í•  ìŠ¤íƒ€ì¼ í‚¤ì›Œë“œ:
    ${imageStyleGuide}
    
    ${customImagePrompt ? `**âš ï¸ ì»¤ìŠ¤í…€ ìŠ¤íƒ€ì¼ í•„ìˆ˜ ì ìš©!**
    ì‚¬ìš©ìžê°€ "${customImagePrompt}" ìŠ¤íƒ€ì¼ì„ ìš”ì²­í–ˆìŠµë‹ˆë‹¤.
    ëª¨ë“  ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ì— ì´ ìŠ¤íƒ€ì¼ í‚¤ì›Œë“œë¥¼ ë°˜ë“œì‹œ í¬í•¨í•˜ì„¸ìš”!
    ì˜ˆì‹œ: "[ìž¥ë©´ ë¬˜ì‚¬], ${customImagePrompt}, í…ìŠ¤íŠ¸ ì—†ì´"` : `ì˜ˆì‹œ (${imageStyle === 'illustration' ? '3D ì¼ëŸ¬ìŠ¤íŠ¸' : imageStyle === 'medical' ? 'ì˜í•™ 3D' : 'ì‹¤ì‚¬ ì‚¬ì§„'} ìŠ¤íƒ€ì¼):
    ${imageStyle === 'illustration' 
      ? '- "ë°ì€ ë³‘ì› ìƒë‹´ì‹¤ì—ì„œ ì˜ì‚¬ê°€ í™˜ìžì—ê²Œ ì„¤ëª…í•˜ëŠ” ëª¨ìŠµ, 3D ì¼ëŸ¬ìŠ¤íŠ¸, ì•„ì´ì†Œë©”íŠ¸ë¦­ ë·°, í´ë ˆì´ ë Œë”, íŒŒëž€ìƒ‰ í°ìƒ‰ íŒ”ë ˆíŠ¸, í…ìŠ¤íŠ¸ ì—†ì´"'
      : imageStyle === 'medical'
      ? '- "ì¸ì²´ ì‹¬ìž¥ì˜ 3D ë‹¨ë©´ë„, ì¢Œì‹¬ì‹¤ê³¼ ìš°ì‹¬ì‹¤ì´ ë³´ì´ëŠ” í•´ë¶€í•™ì  êµ¬ì¡°, í˜ˆê´€ê³¼ íŒë§‰ì´ ë³´ì´ëŠ” ì˜í•™ ì¼ëŸ¬ìŠ¤íŠ¸, íŒŒëž€ìƒ‰ ë°°ê²½, í…ìŠ¤íŠ¸ ì—†ì´"'
      : '- "ê¹”ë”í•œ ë³‘ì› ìƒë‹´ì‹¤ì—ì„œ ì˜ì‚¬ê°€ í™˜ìžì™€ ìƒë‹´í•˜ëŠ” ëª¨ìŠµ, ì‹¤ì‚¬ ì‚¬ì§„, DSLR ì´¬ì˜, ìžì—°ìŠ¤ëŸ¬ìš´ ì¡°ëª…, í…ìŠ¤íŠ¸ ì—†ì´"'}`}
    
    ---â”â”
    âœ… ìµœì¢… ì²´í¬ë¦¬ìŠ¤íŠ¸ - ìž‘ì„± í›„ ë°˜ë“œì‹œ í™•ì¸!
    ---â”â”

    â–¡ "~ì¸ì§€, ~ì¸ì§€, ~ì¸ì§€" ë‚˜ì—´ íŒ¨í„´ 0ê°œ? (ë¬¸ë‹¨ íë¦„ìœ¼ë¡œ í’€ì–´ì¼ëŠ”ì§€ í™•ì¸!)
    â–¡ ë©”íƒ€ ì„¤ëª… ì—†ìŒ? ("ì˜¤ëŠ˜ì€ ~ì‚´íŽ´ë³´ê² ìŠµë‹ˆë‹¤", "~ì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤" ê¸ˆì§€!)
    â–¡ ë§ˆë¬´ë¦¬ì— ìƒíˆ¬ì  í‘œí˜„ ì—†ìŒ? ("ì˜¤ëŠ˜ ì „í•´ë“œë¦°", "ë˜ê¸°ë¥¼ ë°”ëžë‹ˆë‹¤" ê¸ˆì§€!)
    â–¡ íŒë‹¨ íšŒí”¼ í‘œí˜„ ë™ì¼ í‘œí˜„ 2íšŒ ì´ìƒ ë°˜ë³µ ì•ˆ í•¨?
    â–¡ ë¬¼ìŒí‘œ(?) 0ê°œì¸ì§€ í™•ì¸! (ì†Œì œëª© ì œì™¸)
    â–¡ "~ìˆ˜ ìžˆìŠµë‹ˆë‹¤" ë¬¸ë‹¨ë‹¹ 1íšŒ ì´í•˜?
    â–¡ ì²« ë¬¸ìž¥ì´ ìƒí™© ì„œìˆ í˜•ìœ¼ë¡œ ì‹œìž‘?
    â–¡ ë¶„ëŸ‰ ${targetLength + 100}~${targetLength + 200}ìž ë²”ìœ„ ë‚´?
    â–¡ AI ëƒ„ìƒˆ ì ìˆ˜ 15ì  ì´í•˜? (7ì  ì´í•˜ ëª©í‘œ!)
  */  // ê¸°ì¡´ ìƒì„¸ í”„ë¡¬í”„íŠ¸ ë


  const cardNewsPrompt = `
    **ðŸš¨ ìµœìš°ì„  ì§€ì¹¨: ì´ê²ƒì€ ì¹´ë“œë‰´ìŠ¤ìž…ë‹ˆë‹¤! ðŸš¨**
    - ë¸”ë¡œê·¸ í¬ìŠ¤íŒ… í˜•ì‹(ê¸´ ë¬¸ë‹¨)ìœ¼ë¡œ ìž‘ì„±í•˜ë©´ ì•ˆ ë©ë‹ˆë‹¤!
    - ë°˜ë“œì‹œ <div class="card-slide"> êµ¬ì¡°ì˜ ìŠ¬ë¼ì´ë“œ í˜•ì‹ìœ¼ë¡œ ìž‘ì„±í•˜ì„¸ìš”!
    - ê° ìŠ¬ë¼ì´ë“œëŠ” ì§§ì€ í…ìŠ¤íŠ¸(ì œëª© 12ìž, ì„¤ëª… 20ìž ì´ë‚´)ë§Œ í¬í•¨í•©ë‹ˆë‹¤!
    
    ${medicalSafetyPrompt}
    ${aiFeedbackRules}
    ${writingStylePrompt}
    ${getWritingStyleCommonRules()}
    ${benchmarkingInstruction}
    ${styleAnalysis}
    
    [ðŸ“… í˜„ìž¬ ì‹œì  ì •ë³´ - ìµœì‹  ì •ë³´ ê¸°ë°˜ ìž‘ì„± í•„ìˆ˜!]
    ${timeContext}
    
    ðŸš¨ðŸš¨ðŸš¨ **ì‹œê°„ ì°¸ì¡° í‘œí˜„ ì ˆëŒ€ ê¸ˆì§€!** ðŸš¨ðŸš¨ðŸš¨
    âŒ "${currentYear}ë…„ì—ëŠ”~", "ì˜¬í•´ëŠ”~", "ì´ë²ˆ ${currentSeason}ì€~" â†’ ëª¨ë‘ ê¸ˆì§€!
    âœ… "${currentSeason}ì² ì—ëŠ”~", "ì¶”ìš´ ë‚ ì”¨ì—ëŠ”~" (ì¼ë°˜ì  ê³„ì ˆ í‘œí˜„ë§Œ ì‚¬ìš©)
    
    - ìµœì‹  ì˜í•™ ê°€ì´ë“œë¼ì¸/ì—°êµ¬ ê²°ê³¼ ë°˜ì˜ (ì—°ë„ í‘œê¸° ì—†ì´!)
    - ${currentSeason}ì²  íŠ¹ì„± ê³ ë ¤ (ê³„ì ˆì„± ì§ˆí™˜, ìƒí™œ ìŠµê´€ ë“±)
    - Google ê²€ìƒ‰ìœ¼ë¡œ ìµœì‹  ì •ë³´ í™•ì¸ í›„ ìž‘ì„±
    
    ì§„ë£Œê³¼: ${request.category}, ì£¼ì œ: ${request.topic}
    ì´ ${targetSlides}ìž¥ì˜ ì¹´ë“œë‰´ìŠ¤
    ê¸€ ìŠ¤íƒ€ì¼: ${writingStyle === 'expert' ? 'ì „ë¬¸ê°€í˜•(ì‹ ë¢°Â·ê¶Œìœ„Â·ë…¼ë¬¸ ì¸ìš©)' : writingStyle === 'empathy' ? 'ê³µê°í˜•(ë…ìž ê³µê° ìœ ë„)' : 'ì „í™˜í˜•(í–‰ë™ ìœ ë„)'}
    
    [ðŸš¨ í•µì‹¬ ì£¼ì œ í‚¤ì›Œë“œ - ë°˜ë“œì‹œ ëª¨ë“  ì¹´ë“œì— ë°˜ì˜í•˜ì„¸ìš”! ðŸš¨]
    
    **ì£¼ì œ: "${request.topic}"**
    - ì´ ì£¼ì œê°€ ëª¨ë“  ì¹´ë“œì˜ ì¤‘ì‹¬ì´ ë˜ì–´ì•¼ í•©ë‹ˆë‹¤!
    - "${request.topic}"ê³¼ ì§ì ‘ ê´€ë ¨ëœ êµ¬ì²´ì ì¸ ë‚´ìš©ë§Œ ìž‘ì„±í•˜ì„¸ìš”!
    - ì¼ë°˜ì ì´ê³  ì¶”ìƒì ì¸ ê±´ê°• ì •ë³´ëŠ” âŒ ê¸ˆì§€!
    - "${request.topic}"ì˜ êµ¬ì²´ì ì¸ ì¦ìƒ, ì›ì¸, íŠ¹ì§•ì„ ë‹¤ë£¨ì„¸ìš”!
    
    **âš ï¸ ì§ˆí™˜ëª…/ì¦ìƒëª… ì‚¬ìš© ê·œì¹™:**
    - "${request.topic}"ì— í¬í•¨ëœ ì§ˆí™˜ëª…(ì˜ˆ: í˜ˆì•¡ì•”, ë‹¹ë‡¨ë³‘, ê³ í˜ˆì•• ë“±)ì€ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ì„¸ìš”!
    - ì˜ë£Œ ì •ë³´ë¥¼ ëŒë ¤ë§í•˜ì§€ ë§ˆì„¸ìš”! ì§ì ‘ì ìœ¼ë¡œ ì„¤ëª…í•˜ì„¸ìš”!
    - "ëª¸ì˜ ë³€í™”", "ê±´ê°• ì´ìƒ ì‹ í˜¸" ê°™ì€ ëª¨í˜¸í•œ í‘œí˜„ âŒ
    - "${request.topic}"ì˜ ì‹¤ì œ ì¦ìƒëª…ê³¼ íŠ¹ì§•ì„ êµ¬ì²´ì ìœ¼ë¡œ âœ…
    
    [ðŸš¨ ê°€ìž¥ ì¤‘ìš”: ìŠ¤í† ë¦¬ ì—°ê²°ì„± - ë°˜ë“œì‹œ ì½ê³  ì ìš©í•˜ì„¸ìš”! ðŸš¨]
    
    **ì¹´ë“œë‰´ìŠ¤ëŠ” ë°˜ë“œì‹œ "í•˜ë‚˜ì˜ ìŠ¤í† ë¦¬"ë¡œ ì—°ê²°ë˜ì–´ì•¼ í•©ë‹ˆë‹¤!**
    - ê° ìŠ¬ë¼ì´ë“œê°€ ë…ë¦½ì ì¸ ë‚´ìš©ì´ë©´ ì•ˆ ë©ë‹ˆë‹¤!
    - 1ìž¥ë¶€í„° ë§ˆì§€ë§‰ ìž¥ê¹Œì§€ "${request.topic}"ì— ëŒ€í•´ ê¹Šì´ ìžˆê²Œ ë‹¤ë£¨ì„¸ìš”!
    - "í‘œì§€ â†’ ì •ì˜/ê°œìš” â†’ êµ¬ì²´ì  ì¦ìƒ/íŠ¹ì§•ë“¤ â†’ ë§ˆë¬´ë¦¬" êµ¬ì¡°ë¥¼ ë”°ë¥´ì„¸ìš”!
    
    **ìŠ¤í† ë¦¬ êµ¬ì¡° (${targetSlides}ìž¥) - "${request.topic}" ê¸°ì¤€:**
    
    ðŸ“• **1ìž¥ (í‘œì§€)**: "${request.topic}" ì£¼ì œ ì†Œê°œ
    - ì œëª©ì— "${request.topic}" í‚¤ì›Œë“œ í•„ìˆ˜ í¬í•¨!
    - ì˜ˆ: "${request.topic}, ì´ëŸ° ì‹ í˜¸ë¥¼ ë†“ì¹˜ì§€ ë§ˆì„¸ìš”"
    
    ðŸ“˜ **2ìž¥**: "${request.topic}"ì´ëž€? (ì •ì˜/ê°œìš”)
    - "${request.topic}"ê°€ ë¬´ì—‡ì¸ì§€ ì§ì ‘ì ìœ¼ë¡œ ì„¤ëª…
    - ëª¨í˜¸í•˜ê²Œ ëŒë ¤ë§í•˜ì§€ ì•Šê¸°!
    
    ðŸ“— **3~${targetSlides - 1}ìž¥**: "${request.topic}"ì˜ êµ¬ì²´ì  ì¦ìƒ/íŠ¹ì§•/ë°©ë²•
    - ê° ìŠ¬ë¼ì´ë“œì— "${request.topic}"ê³¼ ì§ì ‘ ê´€ë ¨ëœ í•˜ë‚˜ì˜ êµ¬ì²´ì  ë‚´ìš©
    - ì‹¤ì œ ì¦ìƒëª…, íŠ¹ì§•, ì›ì¸ ë“±ì„ ëª…í™•í•˜ê²Œ!
    - ì˜ˆì‹œ: í˜ˆì•¡ì•”ì´ë¼ë©´ â†’ "ë©ì´ ì‰½ê²Œ ë“œë‚˜ìš”?", "ìž‡ëª¸ ì¶œí˜ˆ", "ë§Œì„± í”¼ë¡œ", "ë¦¼í”„ì ˆ ë¶€ì¢…"
    
    ðŸ“™ **${targetSlides}ìž¥ (ë§ˆë¬´ë¦¬)**: ì •ë¦¬ + í–‰ë™ ìœ ë„
    - "${request.topic}" ê´€ë ¨ í•µì‹¬ ë©”ì‹œì§€
    - ìžê°€ì§„ë‹¨/ì „ë¬¸ì˜ ìƒë‹´ ê¶Œìœ  ë“±
    
    **âœ… "${request.topic}" ì£¼ì œ ì˜¬ë°”ë¥¸ ì˜ˆì‹œ:**
    ë§Œì•½ ì£¼ì œê°€ "í˜ˆì•¡ì•” ì´ˆê¸°ì¦ìƒ"ì´ë¼ë©´:
    1ìž¥: "í˜ˆì•¡ì•”, ì´ ì‹ í˜¸ë¥¼ ë†“ì¹˜ê³  ìžˆì§„ ì•Šë‚˜ìš”?" (í‘œì§€)
    2ìž¥: "í˜ˆì•¡ì•”ì´ëž€?" - í˜ˆì•¡ì„¸í¬ì— ìƒê¸°ëŠ” ì•”ì˜ ì¢…ë¥˜ ì„¤ëª…
    3ìž¥: "ë©ì´ ì‰½ê²Œ ë“œì‹œë‚˜ìš”?" - í˜ˆì†ŒíŒ ê°ì†Œë¡œ ì¸í•œ ì¦ìƒ
    4ìž¥: "ìž‡ëª¸ì—ì„œ í”¼ê°€ ìžì£¼ ë‚˜ë‚˜ìš”?" - ì¶œí˜ˆ ê²½í–¥ ì„¤ëª…
    5ìž¥: "ì‰¬ì–´ë„ í’€ë¦¬ì§€ ì•ŠëŠ” í”¼ë¡œê°" - ë¹ˆí˜ˆë¡œ ì¸í•œ í”¼ë¡œ
    6ìž¥: "ì¡°ê¸° ë°œê²¬ì´ ì¤‘ìš”í•©ë‹ˆë‹¤" - ì •ê¸°ê²€ì§„ ê¶Œìœ 
    
    **âŒ ìž˜ëª»ëœ ì˜ˆì‹œ (ì£¼ì œì™€ ë™ë–¨ì–´ì§„ ì¼ë°˜ë¡ ):**
    1ìž¥: "ëª¸ì´ ë³´ë‚´ëŠ” ì‹ í˜¸" (â† ì£¼ì œ í‚¤ì›Œë“œ ì—†ìŒ!)
    2ìž¥: "í”¼ë¡œì˜ ì›ì¸" (â† ë„ˆë¬´ ì¼ë°˜ì !)
    3ìž¥: "ê±´ê°•ê´€ë¦¬ì˜ ì¤‘ìš”ì„±" (â† ì£¼ì œì™€ ë¬´ê´€!)
    â†’ "${request.topic}"ì„ ì§ì ‘ ë‹¤ë£¨ì§€ ì•Šìœ¼ë©´ ì•ˆ ë©ë‹ˆë‹¤!
    
    ${PSYCHOLOGY_CTA_PROMPT}
    
    [ðŸŽ¯ ë§ˆì§€ë§‰ ìŠ¬ë¼ì´ë“œ (${targetSlides}ìž¥) ì‹¬ë¦¬í•™ì  ì „í™˜ ë¬¸êµ¬ ê·œì¹™]
    ë§ˆì§€ë§‰ ì¹´ë“œëŠ” ë…ìžê°€ "ë‹¤ìŒ í–‰ë™"ì„ ë– ì˜¬ë¦¬ê²Œ í•˜ëŠ” ì‹¬ë¦¬í•™ì  ì„¤ë“ ê¸°ë²•ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
    
    **ë§ˆì§€ë§‰ ìŠ¬ë¼ì´ë“œ ì˜ˆì‹œ:**
    card-subtitle: "ì§€ê¸ˆì´ ê¸°íšŒì˜ˆìš”" / "í•¨ê»˜ ì§€ì¼œìš”" / "ì‹œìž‘í•´ë³¼ê¹Œìš”?"
    card-main-title: "ìž‘ì€ ìŠµê´€ì´<br/><span class='card-highlight'>ìƒëª…</span>ì„ ì§€í‚µë‹ˆë‹¤"
    card-desc: "ê±´ê°•í•œ ì˜¤ëŠ˜ì´ í–‰ë³µí•œ ë‚´ì¼ì„ ë§Œë“­ë‹ˆë‹¤ ðŸ˜Š"
    
    **ì‹¬ë¦¬í•™ ê¸°ë²• ì ìš© ì˜ˆì‹œ (ë§ˆì§€ë§‰ ì¹´ë“œ):**
    - ì†ì‹¤íšŒí”¼: "ë¯¸ë£¨ë©´ ë†“ì¹  ìˆ˜ ìžˆì–´ìš”"
    - ì‚¬íšŒì ì¦ê±°: "ë§Žì€ ë¶„ë“¤ì´ ì‹¤ì²œ ì¤‘ì´ì—ìš”"  
    - ì‹œì˜ì„±: "ì´ë§˜ë•Œê°€ ì ê¸°ì˜ˆìš”"
    - ê°ì •í˜¸ì†Œ: "ì†Œì¤‘í•œ ì¼ìƒ, ì˜¤ëž˜ ëˆ„ë¦¬ì„¸ìš”"
    
    ${request.referenceUrl ? 'â˜…ë²¤ì¹˜ë§ˆí‚¹ URLì˜ êµ¬ì„± ë°©ì‹ë„ ì°¸ê³ í•˜ì„¸ìš”.' : ''}
    
    ${styleAnalysis ? `
    **âš ï¸ ì¤‘ìš”: ìŠ¤íƒ€ì¼ ì°¸ê³  ì´ë¯¸ì§€ê°€ ìžˆìŠµë‹ˆë‹¤! âš ï¸**
    - ìœ„ì—ì„œ ì œê³µí•œ "í‘œì§€/ë³¸ë¬¸ HTML í…œí”Œë¦¿"ì˜ style ì†ì„±ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ì„¸ìš”!
    - ê¸°ë³¸ HEALTH NOTE ìŠ¤íƒ€ì¼(ì£¼í™©ìƒ‰ í…Œë‘ë¦¬)ì„ ì‚¬ìš©í•˜ë©´ ì•ˆ ë©ë‹ˆë‹¤!
    - ë¶„ì„ëœ ìƒ‰ìƒ(${coverStyle.backgroundColor || contentStyle.backgroundColor || 'ë¶„ì„ëœ ìƒ‰ìƒ'})ì„ ë°˜ë“œì‹œ ì ìš©í•˜ì„¸ìš”!
    ` : `
    [HTML êµ¬ì¡° - ê¸°ë³¸ ìŠ¤íƒ€ì¼ (ì—°í•œ í•˜ëŠ˜ìƒ‰ ë°°ê²½)]
    **âš ï¸ ì¤‘ìš”: ì•„ëž˜ í…œí”Œë¦¿ì„ ê·¸ëŒ€ë¡œ ë³µì‚¬í•´ì„œ ì‚¬ìš©í•˜ì„¸ìš”! style ì†ì„± í•„ìˆ˜!**
    
    <div class="card-slide" style="background: linear-gradient(180deg, #E8F4FD 0%, #F0F9FF 100%); border-radius: 24px; padding: 0; overflow: hidden;">
      <div style="padding: 32px 28px; display: flex; flex-direction: column; align-items: center; text-align: center; height: 100%;">
        <p class="card-subtitle" style="font-size: 14px; font-weight: 700; color: #3B82F6; margin-bottom: 8px;">ì§ˆë¬¸í˜• ë¶€ì œëª© (10~15ìž)</p>
        <p class="card-main-title" style="font-size: 28px; font-weight: 900; color: #1E293B; line-height: 1.3; margin: 0 0 16px 0;">ë©”ì¸ ì œëª©<br/><span style="color: #3B82F6;">ê°•ì¡° í…ìŠ¤íŠ¸</span></p>
        <div class="card-img-container" style="width: 100%; margin: 16px 0;">[IMG_N]</div>
        <p class="card-desc" style="font-size: 15px; color: #475569; line-height: 1.6; font-weight: 500; max-width: 90%;">ì—¬ê¸°ì— 30~50ìžì˜ êµ¬ì²´ì ì¸ ì„¤ëª… ë¬¸ìž¥ì„ ìž‘ì„±í•˜ì„¸ìš”. ë…ìžê°€ ì •ë³´ë¥¼ ì–»ì„ ìˆ˜ ìžˆë„ë¡ ì¶©ë¶„ížˆ!</p>
      </div>
    </div>
    
    **ðŸš¨ card-desc ë¶€ë¶„ì´ ê°€ìž¥ ì¤‘ìš”í•©ë‹ˆë‹¤! ë°˜ë“œì‹œ 30ìž ì´ìƒ ìž‘ì„±í•˜ì„¸ìš”! ðŸš¨**
    
    **ë°°ê²½ìƒ‰ í•„ìˆ˜: style="background: linear-gradient(180deg, #E8F4FD 0%, #F0F9FF 100%);" ì ìš©!**
    `}
    
    [[ê¸ˆì§€] ì ˆëŒ€ ê¸ˆì§€ í‘œí˜„ - ì¹´ë“œì— ì´ëŸ° í…ìŠ¤íŠ¸ ë„£ì§€ ë§ˆì„¸ìš”!]
    âŒ "01.", "02.", "03." ê°™ì€ ìŠ¬ë¼ì´ë“œ ë²ˆí˜¸
    âŒ "í•´ê²°ì±… 1", "í•´ê²°ì±… 2", "ë§ˆë¬´ë¦¬" ê°™ì€ êµ¬ì¡° ìš©ì–´
    âŒ "ì²« ë²ˆì§¸", "ë‘ ë²ˆì§¸", "ì„¸ ë²ˆì§¸" ê°™ì€ ìˆœì„œ í‘œí˜„
    âŒ "í›„í‚¹", "ë¬¸ì œ ì œê¸°", "ì›ì¸/ë°°ê²½" ê°™ì€ í”„ë ˆìž„ì›Œí¬ ìš©ì–´
    
    [âœ… ì˜¬ë°”ë¥¸ ì˜ˆì‹œ]
    card-subtitle: "ì•Œê³  ê³„ì…¨ë‚˜ìš”?" / "ì™œ ìœ„í—˜í• ê¹Œìš”?" / "ì´ë ‡ê²Œ í•´ë³´ì„¸ìš”"
    card-main-title: "ê²¨ìš¸ì²  ì‹¬ìž¥ë§ˆë¹„<br/><span class='card-highlight'>3ë°°</span> ì¦ê°€" 
    
    [ðŸš¨ ìž‘ì„± ê·œì¹™ - ë§¤ìš° ì¤‘ìš” ðŸš¨]
    1. ê° ìŠ¬ë¼ì´ë“œì— [IMG_1]~[IMG_${targetSlides}] ë§ˆì»¤ í•„ìˆ˜
    2. ì´ì „ ìŠ¬ë¼ì´ë“œì™€ ë‚´ìš©ì´ ìžì—°ìŠ¤ëŸ½ê²Œ ì—°ê²°
    3. card-main-titleì€ **ë°˜ë“œì‹œ <p> íƒœê·¸ ì‚¬ìš©** (h1 ì‚¬ìš© ê¸ˆì§€!)
    4. card-main-titleì€ **15~20ìž**ë¡œ ì¶©ë¶„ížˆ ìž‘ì„±! ì¤„ë°”ê¿ˆì€ <br/> ì‚¬ìš©
    5. card-subtitleì€ **10~15ìž**ì˜ ì§ˆë¬¸í˜• ë˜ëŠ” í•µì‹¬ í¬ì¸íŠ¸
    6. **card-descëŠ” ë°˜ë“œì‹œ 30~50ìž**ì˜ êµ¬ì²´ì ì¸ ì„¤ëª… ë¬¸ìž¥ í¬í•¨! (ê°€ìž¥ ì¤‘ìš”!)
    7. ì‹¤ì œ ë…ìžê°€ ë³¼ ì½˜í…ì¸ ë§Œ ìž‘ì„± (ë©”íƒ€ ì •ë³´ ê¸ˆì§€)
    8. **ê¸€ì”¨ê°€ ë„ˆë¬´ ì—†ìœ¼ë©´ ì•ˆ ë¨!** ê° ì¹´ë“œì— ì¶©ë¶„í•œ ì •ë³´ ì „ë‹¬ í•„ìˆ˜!
    
    [ðŸ“ í…ìŠ¤íŠ¸ ë¶„ëŸ‰ ê·œì¹™ - ë°˜ë“œì‹œ ì§€í‚¤ì„¸ìš”!]
    âŒ ìž˜ëª»ëœ ì˜ˆ (í…ìŠ¤íŠ¸ ë¶€ì¡±):
    - card-subtitle: "ì§€ê¸ˆ ì•Œì•„ì•¼ í•´ìš”" (8ìž)
    - card-main-title: "ì‹¬ì •ì§€<br/><span class='card-highlight'>4ë¶„</span>" (6ìž)
    - card-desc: "ê³¨ë“ íƒ€ìž„ ì‚¬ìˆ˜" (6ìž) â† ë„ˆë¬´ ì§§ìŒ!
    
    âœ… ì˜¬ë°”ë¥¸ ì˜ˆ (ì¶©ë¶„í•œ í…ìŠ¤íŠ¸):
    - card-subtitle: "ì™œ 4ë¶„ì´ ì¤‘ìš”í• ê¹Œìš”?" (12ìž)
    - card-main-title: "ë‡Œì„¸í¬ ìƒì¡´<br/><span class='card-highlight'>ë§ˆì§€ë…¸ì„ </span>" (12ìž)
    - card-desc: "4ë¶„ì´ ì§€ë‚˜ë©´ ë‡Œ ì†ìƒì´ ê¸‰ê²©ížˆ ì§„í–‰ë¼ìš”. ê³¨ë“ íƒ€ìž„ì„ ë†“ì¹˜ì§€ ë§ˆì„¸ìš”!" (40ìž) â† ì´ ì •ë„ëŠ” ë˜ì–´ì•¼ í•¨!
    
    [âŒ ìž˜ëª»ëœ ì˜ˆì‹œ - ì ˆëŒ€ ì´ë ‡ê²Œ ì“°ì§€ ë§ˆì„¸ìš”]
    <p class="card-main-title">ìŠ¤íƒ€í‹´ ìž„ì˜ ì¤‘ë‹¨ì€ ê¸ˆë¬¼! ì „ë¬¸ì˜ê°€ ê°•ì¡°í•˜ëŠ” ë§Œì„±ì§ˆí™˜ ë³µì•½ ìˆœì‘ë„ì˜ ì¤‘ìš”ì„±</p>
    
    [âœ… ì˜¬ë°”ë¥¸ ì˜ˆì‹œ]
    <p class="card-main-title">ìŠ¤íƒ€í‹´<br/><span class="card-highlight">ì¤‘ë‹¨ ê¸ˆì§€!</span></p>
    
    [ðŸŽ¨ ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ ìž‘ì„± ê·œì¹™ - ë§¤ìš° ì¤‘ìš”!]
    **imagePrompts ë°°ì—´ì— ë“¤ì–´ê°ˆ í”„ë¡¬í”„íŠ¸ëŠ” ë°˜ë“œì‹œ í•œêµ­ì–´ë¡œ ìž‘ì„±í•˜ì„¸ìš”!**
    ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼: ${customImagePrompt ? `ì»¤ìŠ¤í…€: ${customImagePrompt}` : imageStyle === 'illustration' ? '3D ì¼ëŸ¬ìŠ¤íŠ¸' : imageStyle === 'medical' ? 'ì˜í•™ 3D í•´ë¶€í•™' : 'ì‹¤ì‚¬ ì‚¬ì§„'}
    
    **ðŸ“ ì¹´ë“œë‰´ìŠ¤ ì´ë¯¸ì§€ í…ìŠ¤íŠ¸ ê·œì¹™:**
    - ì¹´ë“œë‰´ìŠ¤ ì´ë¯¸ì§€ì—ëŠ” ì œëª©, ì„¤ëª… í…ìŠ¤íŠ¸ê°€ ë“¤ì–´ê°ˆ ìˆ˜ ìžˆìŒ
    - í•œê¸€, ìˆ«ìž ìœ„ì£¼ë¡œ
    - ë¡œê³ , ì›Œí„°ë§ˆí¬ ê¸ˆì§€
    
    ê° ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ì— ë°˜ë“œì‹œ í¬í•¨í•  ìŠ¤íƒ€ì¼ í‚¤ì›Œë“œ:
    ${imageStyleGuide}
    
    ${customImagePrompt ? `**âš ï¸ ì»¤ìŠ¤í…€ ìŠ¤íƒ€ì¼ í•„ìˆ˜ ì ìš©!**
    ì‚¬ìš©ìžê°€ "${customImagePrompt}" ìŠ¤íƒ€ì¼ì„ ìš”ì²­í–ˆìŠµë‹ˆë‹¤.
    ëª¨ë“  ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ì— ì´ ìŠ¤íƒ€ì¼ í‚¤ì›Œë“œë¥¼ ë°˜ë“œì‹œ í¬í•¨í•˜ì„¸ìš”!
    ì˜ˆì‹œ: "[ìž¥ë©´ ë¬˜ì‚¬], ${customImagePrompt}"` : `ì˜ˆì‹œ (${imageStyle === 'illustration' ? '3D ì¼ëŸ¬ìŠ¤íŠ¸' : imageStyle === 'medical' ? 'ì˜í•™ 3D' : 'ì‹¤ì‚¬ ì‚¬ì§„'} ìŠ¤íƒ€ì¼):
    ${imageStyle === 'illustration' 
      ? '- "ë°ì€ ë³‘ì› ë°°ê²½ì˜ ê±´ê°• ì¸í¬ê·¸ëž˜í”½, 3D ì¼ëŸ¬ìŠ¤íŠ¸, ì•„ì´ì†Œë©”íŠ¸ë¦­ ë·°, í´ë ˆì´ ë Œë”, íŒŒëž€ìƒ‰ í°ìƒ‰ íŒ”ë ˆíŠ¸"'
      : imageStyle === 'medical'
      ? '- "ì¸ì²´ íì˜ 3D ë‹¨ë©´ë„, ê¸°ê´€ì§€ì™€ íí¬ êµ¬ì¡°ê°€ ë³´ì´ëŠ” í•´ë¶€í•™ ì¼ëŸ¬ìŠ¤íŠ¸, íˆ¬ëª… íš¨ê³¼, íŒŒëž€ìƒ‰ ì˜ë£Œ ë°°ê²½"'
      : '- "ê¹”ë”í•œ ë³‘ì› í™˜ê²½ ì´ë¯¸ì§€, ì‹¤ì‚¬ ì‚¬ì§„, DSLR ì´¬ì˜, ì „ë¬¸ì ì¸ ë¶„ìœ„ê¸°"'}`}
    
    [ðŸš¨ ìµœì¢… ê²€ì¦ - ìž‘ì„± í›„ ë°˜ë“œì‹œ í™•ì¸í•˜ì„¸ìš”! ðŸš¨]
    ê° ì¹´ë“œì˜ card-descê°€ 30ìž ì´ìƒì¸ì§€ í™•ì¸í•˜ì„¸ìš”!
    ì˜ˆ: "ì‹¬ìž¥ì´ ë©ˆì¶˜ ì§€ 4ë¶„ì´ ì§€ë‚˜ë©´ ë‡Œì„¸í¬ê°€ ë§ˆìŒëŒ€ë¡œ ëˆ„ì„¤ë˜ê¸° ì‹œìž‘í•´ìš”" (ì´ ì •ë„ ê¸¸ì´)
    í…ìŠ¤íŠ¸ê°€ ë„ˆë¬´ ì§§ìœ¼ë©´ ë…ìžê°€ ì •ë³´ë¥¼ ì–»ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!
  `;

  try {
    // GPT ì œê±° - Geminië§Œ ì‚¬ìš©
    const providerSettings = getAiProviderSettings();
    let result: any;

    // Gemini ì‚¬ìš©
    console.log('ðŸ”µ Using Gemini for text generation');
    
    // ë¡œê·¸ ì¶œë ¥ (generateContent í˜¸ì¶œ ì „ì— ì‹¤í–‰)
    console.log('ðŸ”„ Gemini ì›¹ ê²€ìƒ‰ ë° ì½˜í…ì¸  ìƒì„± ì‹œìž‘');
    console.log('ðŸ“ Step 1 ì‹œìž‘ ì¤€ë¹„...');
    
    // ðŸ“ Step 1: Gemini ì›¹ ê²€ìƒ‰ìœ¼ë¡œ ìµœì‹  ì •ë³´ ìˆ˜ì§‘
    console.log('ðŸ“ onProgress í˜¸ì¶œ ì§ì „...');
    try {
      if (typeof onProgress === 'function') {
        safeProgress('â€¢ Step 1: ìµœì‹  ì •ë³´ë¥¼ ê²€ìƒ‰í•˜ê³  ìžˆìŠµë‹ˆë‹¤...');
      } else {
        console.warn('âš ï¸ onProgressê°€ í•¨ìˆ˜ê°€ ì•„ë‹˜:', typeof onProgress);
      }
    } catch (progressError) {
      console.error('âŒ onProgress í˜¸ì¶œ ì—ëŸ¬:', progressError);
    }
    console.log('ðŸ“ onProgress í˜¸ì¶œ ì™„ë£Œ, searchPrompt ìƒì„± ì‹œìž‘...');
    
    const searchPrompt = `
ë‹¹ì‹ ì€ ì˜ë£Œ ì •ë³´ ê²€ìƒ‰ ì „ë¬¸ê°€ìž…ë‹ˆë‹¤.
ì•„ëž˜ ì£¼ì œì— ëŒ€í•´ ê³µì‹ ë ¥ ìžˆëŠ” ìµœì‹  ì •ë³´ë¥¼ ìˆ˜ì§‘í•´ì£¼ì„¸ìš”.

[ê²€ìƒ‰ ì£¼ì œ]
- ì§„ë£Œê³¼: ${request.category}
- ì£¼ì œ: ${request.topic}
- í‚¤ì›Œë“œ: ${request.keywords}

ðŸš¨ðŸš¨ðŸš¨ **[ìµœìš°ì„  ê²€ìƒ‰ - health.kdca.go.kr í•„ìˆ˜!]** ðŸš¨ðŸš¨ðŸš¨

**1ìˆœìœ„ (ìµœìš°ì„ ! ë°˜ë“œì‹œ ê°€ìž¥ ë¨¼ì € ê²€ìƒ‰!)**: 
   ðŸ”´ ê²€ìƒ‰ì–´: "${request.topic} site:health.kdca.go.kr"
   ðŸ”´ URL: https://health.kdca.go.kr/healthinfo/
   â†’ ì§ˆë³‘ê´€ë¦¬ì²­ ê±´ê°•ì •ë³´í¬í„¸ (ì¼ë°˜ì¸ ëŒ€ìƒ ê±´ê°•ì •ë³´)
   â†’ âš ï¸ ì´ ì‚¬ì´íŠ¸ì—ì„œ ë°˜ë“œì‹œ ìµœì†Œ 2ê°œ ì´ìƒì˜ ì •ë³´ë¥¼ ìˆ˜ì§‘í•˜ì„¸ìš”!
   â†’ âš ï¸ ì´ ì‚¬ì´íŠ¸ì—ì„œ ì¶©ë¶„í•œ ìžë£Œë¥¼ ì°¾ì•˜ë‹¤ë©´ í•´ì™¸ ì‚¬ì´íŠ¸ ê²€ìƒ‰ ìƒëžµ!
   â†’ ì˜ˆì‹œ URL: https://health.kdca.go.kr/healthinfo/biz/health/...

**2ìˆœìœ„**: 
   ê²€ìƒ‰ì–´: "${request.topic} site:kdca.go.kr"
   â†’ ì§ˆë³‘ê´€ë¦¬ì²­ ê³µì‹ ì‚¬ì´íŠ¸ (ë³´ë„ìžë£Œ, í†µê³„, ê°ì—¼ë³‘ ì •ë³´)

**3ìˆœìœ„**: 
   ê²€ìƒ‰ì–´: "${request.topic} site:mohw.go.kr OR site:nhis.or.kr OR site:hira.or.kr"
   â†’ ë³´ê±´ë³µì§€ë¶€, êµ­ë¯¼ê±´ê°•ë³´í—˜ê³µë‹¨, ê±´ê°•ë³´í—˜ì‹¬ì‚¬í‰ê°€ì›

**4ìˆœìœ„**: 
   ê²€ìƒ‰ì–´: "${request.topic} ëŒ€í•œ${request.category}í•™íšŒ ê°€ì´ë“œë¼ì¸ ${getCurrentYear()}"
   â†’ êµ­ë‚´ í•™íšŒ ìµœì‹  ì§€ì¹¨ í™•ì¸

**5ìˆœìœ„ (ì„ íƒì  - êµ­ë‚´ ìžë£Œ ë¶€ì¡± ì‹œì—ë§Œ!)**: 
   ê²€ìƒ‰ì–´: "${request.topic} site:pubmed.ncbi.nlm.nih.gov ${getCurrentYear()}"
   â†’ âš ï¸ 1~4ìˆœìœ„ì—ì„œ ì¶©ë¶„í•œ ìžë£Œë¥¼ ì°¾ì•˜ë‹¤ë©´ ì´ ë‹¨ê³„ëŠ” ìƒëžµ!

ðŸ“‹ **ê²€ìƒ‰ ì „ëžµ (health.kdca.go.kr ìµœìš°ì„ !):**
ðŸ”´ 1ìˆœìœ„: health.kdca.go.krì—ì„œ ë°˜ë“œì‹œ ë¨¼ì € ê²€ìƒ‰! (ìµœì†Œ 2ê°œ ì´ìƒ ìˆ˜ì§‘ ëª©í‘œ)
âœ… health.kdca.go.krì—ì„œ ê´€ë ¨ ì •ë³´ë¥¼ ì¶©ë¶„ížˆ ì°¾ì•˜ë‹¤ë©´ â†’ í•´ì™¸ ë…¼ë¬¸ ê²€ìƒ‰ ìƒëžµ!
âœ… êµ­ë‚´ ê³µì‹ ë ¥ ìžˆëŠ” ìžë£Œê°€ ë¶€ì¡±í•  ë•Œë§Œ â†’ PubMed ë“± í•´ì™¸ ìžë£Œ ì°¸ê³ 
âœ… í•­ìƒ í•œêµ­ ì‹¤ì •ì— ë§žëŠ” ì •ë³´ë¥¼ ìš°ì„ ìœ¼ë¡œ!

[ê¸ˆì§€] **ì ˆëŒ€ ê²€ìƒ‰ ê¸ˆì§€ ë„ë©”ì¸:**
- blog.naver.com, tistory.com, brunch.co.kr (ë¸”ë¡œê·¸)
- cafe.naver.com (ì¹´íŽ˜)
- youtube.com (ìœ íŠœë¸Œ)
- health.chosun.com, hidoc.co.kr, kormedi.com (ê±´ê°• ë§¤ì²´)
- storybongbong.co.kr, keyzard.cc (ì ˆëŒ€ ê¸ˆì§€!)

[ê²€ìƒ‰ ì§€ì‹œ]
- ðŸ”´ health.kdca.go.kr ê²°ê³¼ë¥¼ ê°€ìž¥ ë¨¼ì €, ê°€ìž¥ ë§Žì´ ìˆ˜ì§‘ (ìµœìš°ì„ !)
- í˜„ìž¬ ${getCurrentYear()}ë…„ ê¸°ì¤€ ìµœì‹  ìžë£Œ ìš°ì„ 
- ë¸”ë¡œê·¸, ì¹´íŽ˜, SNS, ìœ íŠœë¸Œ ì •ë³´ëŠ” ì ˆëŒ€ ìˆ˜ì§‘ ê¸ˆì§€
- í†µê³„ëŠ” ë°˜ë“œì‹œ ì¶œì²˜ì™€ ì—°ë„ í¬í•¨

[JSON ì‘ë‹µ í˜•ì‹]
{
  "collected_facts": [
    {
      "fact": "ìˆ˜ì§‘í•œ ì‚¬ì‹¤ ì •ë³´",
      "source": "ì¶œì²˜ (í•™íšŒ/ê¸°ê´€ëª…)",
      "year": ${getCurrentYear()},
      "url": "ì°¸ê³  URL (health.kdca.go.kr URL ìµœìš°ì„ !)"
    }
  ],
  "key_statistics": [
    {
      "stat": "í†µê³„ ë‚´ìš©",
      "source": "ì¶œì²˜",
      "year": ${getCurrentYear()}
    }
  ],
  "latest_guidelines": [
    {
      "guideline": "ê°€ì´ë“œë¼ì¸ ë‚´ìš©",
      "organization": "ë°œí‘œ ê¸°ê´€",
      "year": ${getCurrentYear()}
    }
  ]
}`;

    // â€¢ Gemini ì›¹ ê²€ìƒ‰ìœ¼ë¡œ ìµœì‹  ì •ë³´ ìˆ˜ì§‘
    console.log('â€¢ Gemini ì›¹ ê²€ìƒ‰ ì‹œìž‘');
    safeProgress('â€¢ Step 1: Gemini ì›¹ ê²€ìƒ‰ ì¤‘...');
    
    let geminiResults: any = null;
    let searchResults: any = {};
    
    // ðŸ”µ Gemini ê²€ìƒ‰ ì‹¤í–‰
    const geminiSearchPromise = (async () => {
      try {
        console.log('ðŸ”µ Gemini ê²€ìƒ‰ ì‹œìž‘...');
        const ai = getAiClient();
        const searchResponse = await ai.models.generateContent({
          model: "gemini-3-pro-preview",
          contents: searchPrompt,
          config: {
            tools: [{ googleSearch: {} }],
            responseMimeType: "application/json"
          }
        });
        
        // ì•ˆì „í•œ JSON íŒŒì‹±
        let result;
        const rawText = searchResponse.text || "{}";
        
        try {
          // JSON ë¸”ë¡ ì¶”ì¶œ ì‹œë„ (```json ... ``` í˜•íƒœì¼ ìˆ˜ ìžˆìŒ)
          const jsonMatch = rawText.match(/```json\s*([\s\S]*?)\s*```/) || 
                           rawText.match(/```\s*([\s\S]*?)\s*```/) ||
                           [null, rawText];
          
          const cleanedText = jsonMatch[1].trim();
          result = JSON.parse(cleanedText);
        } catch (parseError) {
          console.warn('âš ï¸ JSON íŒŒì‹± ì‹¤íŒ¨, ì›ë³¸ í…ìŠ¤íŠ¸ ì¼ë¶€:', rawText.substring(0, 200));
          // ë¹ˆ ê°ì²´ë¡œ í´ë°±
          result = {
            collected_facts: [],
            key_statistics: [],
            latest_guidelines: []
          };
        }
        
        const factCount = result.collected_facts?.length || 0;
        const statCount = result.key_statistics?.length || 0;
        console.log(`âœ… Gemini ê²€ìƒ‰ ì™„ë£Œ - íŒ©íŠ¸ ${factCount}ê°œ, í†µê³„ ${statCount}ê°œ`);
        return { success: true, data: result, source: 'gemini' };
      } catch (error) {
        console.error('âš ï¸ Gemini ê²€ìƒ‰ ì‹¤íŒ¨:', error);
        return { success: false, data: null, source: 'gemini', error };
      }
    })();
    
    // Gemini ê²€ìƒ‰ ì‹¤í–‰
    const geminiResult = await geminiSearchPromise;
    
    geminiResults = geminiResult.success ? geminiResult.data : null;
    
    // GPT ê²€ìƒ‰ ë¹„í™œì„±í™” (Geminië§Œ ì‚¬ìš©)
    const gptResults: any = null;
    const gptFactCount = 0;
    const gptStatCount = 0;
    
    // ìƒì„¸ ë¡œê·¸
    const geminiFactCount = geminiResults?.collected_facts?.length || 0;
    const geminiStatCount = geminiResults?.key_statistics?.length || 0;
    
    console.log('ðŸ“Š ê²€ìƒ‰ ê²°ê³¼ ìƒì„¸:');
    console.log(`   ðŸ”µ Gemini: ${geminiResult.success ? 'ì„±ê³µ' : 'ì‹¤íŒ¨'} - íŒ©íŠ¸ ${geminiFactCount}ê°œ, í†µê³„ ${geminiStatCount}ê°œ`);
    
    // ðŸ”€ í¬ë¡œìŠ¤ì²´í¬: ë‘ ê²°ê³¼ ë³‘í•© ë° ê²€ì¦
    
    // health.kdca.go.kr ìš°ì„ ìˆœìœ„ ì •ë ¬ í•¨ìˆ˜ (1ìˆœìœ„: health.kdca.go.kr)
    const sortByKdcaHealthPriority = (items: any[]) => {
      if (!items || !Array.isArray(items)) return items;
      
      // ðŸ”´ 1ìˆœìœ„: health.kdca.go.kr URLì´ ìžˆëŠ” í•­ëª©ì„ ìµœìƒë‹¨ì— ë°°ì¹˜ (ìµœìš°ì„ !)
      const kdcaHealthItems = items.filter((item: any) => 
        item.url?.includes('health.kdca.go.kr') || 
        item.source?.includes('ì§ˆë³‘ê´€ë¦¬ì²­ ê±´ê°•ì •ë³´') ||
        item.source?.includes('health.kdca.go.kr') ||
        item.source?.includes('ê±´ê°•ì •ë³´í¬í„¸')
      );
      
      // 2ìˆœìœ„: kdca.go.kr (ë©”ì¸ ì‚¬ì´íŠ¸) í•­ëª©
      const kdcaMainItems = items.filter((item: any) => 
        !item.url?.includes('health.kdca.go.kr') && 
        !item.source?.includes('health.kdca.go.kr') &&
        !item.source?.includes('ê±´ê°•ì •ë³´í¬í„¸') &&
        (item.url?.includes('kdca.go.kr') || item.source?.includes('ì§ˆë³‘ê´€ë¦¬ì²­'))
      );
      
      // 3ìˆœìœ„: ê¸°íƒ€ ì •ë¶€ ê¸°ê´€ (mohw.go.kr, nhis.or.kr ë“±)
      const otherGovItems = items.filter((item: any) => 
        !item.url?.includes('kdca.go.kr') &&
        !item.source?.includes('ì§ˆë³‘ê´€ë¦¬ì²­') &&
        (item.url?.includes('.go.kr') || item.url?.includes('.or.kr'))
      );
      
      // 4ìˆœìœ„: ë‚˜ë¨¸ì§€ í•­ëª©
      const otherItems = items.filter((item: any) => 
        !item.url?.includes('health.kdca.go.kr') &&
        !item.url?.includes('kdca.go.kr') &&
        !item.url?.includes('.go.kr') &&
        !item.url?.includes('.or.kr') &&
        !item.source?.includes('ì§ˆë³‘ê´€ë¦¬ì²­') &&
        !item.source?.includes('ê±´ê°•ì •ë³´í¬í„¸')
      );
      
      const sortedItems = [...kdcaHealthItems, ...kdcaMainItems, ...otherGovItems, ...otherItems];
      
      // ë¡œê·¸ ì¶œë ¥ (health.kdca.go.kr ê°•ì¡°)
      if (kdcaHealthItems.length > 0) {
        console.log(`ðŸ”´ [1ìˆœìœ„] health.kdca.go.kr ê²°ê³¼ ${kdcaHealthItems.length}ê°œ ìµœìš°ì„  ë°°ì¹˜!`);
        kdcaHealthItems.forEach((item: any, idx: number) => {
          console.log(`   ${idx + 1}. ${item.url || item.source || '(URL ì—†ìŒ)'}`);
        });
      }
      if (kdcaMainItems.length > 0) {
        console.log(`   [2ìˆœìœ„] kdca.go.kr ê²°ê³¼ ${kdcaMainItems.length}ê°œ`);
      }
      if (otherGovItems.length > 0) {
        console.log(`   [3ìˆœìœ„] ê¸°íƒ€ ì •ë¶€ê¸°ê´€ ê²°ê³¼ ${otherGovItems.length}ê°œ`);
      }
      
      return sortedItems;
    };
    
    if (geminiResults && gptResults) {
      // ðŸŽ¯ ë‘˜ ë‹¤ ì„±ê³µ: í¬ë¡œìŠ¤ì²´í¬ ë³‘í•©
      console.log('ðŸŽ¯ ë“€ì–¼ ê²€ìƒ‰ ì„±ê³µ - í¬ë¡œìŠ¤ì²´í¬ ë³‘í•© ì‹œìž‘');
      safeProgress('ðŸ”€ í¬ë¡œìŠ¤ì²´í¬: Gemini + GPT-5.2 ê²°ê³¼ ë³‘í•© ì¤‘...');
      
      // ë³‘í•© í›„ health.kdca.go.kr ìš°ì„  ì •ë ¬
      const mergedFacts = [
        ...(geminiResults.collected_facts || []).map((f: any) => ({ ...f, verified_by: 'gemini' })),
        ...(gptResults.collected_facts || []).map((f: any) => ({ ...f, verified_by: 'gpt' }))
      ];
      
      const mergedStats = [
        ...(geminiResults.key_statistics || []).map((s: any) => ({ ...s, verified_by: 'gemini' })),
        ...(gptResults.key_statistics || []).map((s: any) => ({ ...s, verified_by: 'gpt' }))
      ];
      
      const mergedGuidelines = [
        ...(geminiResults.latest_guidelines || []).map((g: any) => ({ ...g, verified_by: 'gemini' })),
        ...(gptResults.latest_guidelines || []).map((g: any) => ({ ...g, verified_by: 'gpt' }))
      ];
      
      searchResults = {
        collected_facts: sortByKdcaHealthPriority(mergedFacts),
        key_statistics: sortByKdcaHealthPriority(mergedStats),
        latest_guidelines: sortByKdcaHealthPriority(mergedGuidelines),
        sources: gptResults.sources || [],
        gemini_found: geminiFactCount + geminiStatCount,
        gpt_found: gptFactCount + gptStatCount
      };
      
      // ðŸ”§ ë§¥ë½ ê¸°ë°˜ ìœ ì‚¬ë„ ê³„ì‚° (ë¬¸ìž¥ì´ ë‹¬ë¼ë„ ê°™ì€ ë§¥ë½ì´ë©´ ë§¤ì¹­!)
      // ì‚¬ìš©ìž ìš”ì²­ ê°œì„ : 2ê¸€ìž ì´ìƒ í•œê¸€/ì˜ì–´/ìˆ«ìžë§Œ ì¶”ì¶œ (ìžì¹´ë“œ ìœ ì‚¬ë„ ê¸°ë°˜)
      const extractKeywords = (text: string): Set<string> => {
        if (!text) return new Set();
        // íŠ¹ìˆ˜ë¬¸ìž ì œê±° ë° ì†Œë¬¸ìž ë³€í™˜ (í•œê¸€, ì˜ë¬¸, ìˆ«ìž, ê³µë°±ë§Œ ë‚¨ê¹€)
        const cleanText = text.toLowerCase().replace(/[^\wê°€-íž£\s]/g, '');
        
        // ê³µë°±ìœ¼ë¡œ ë¶„ë¦¬ í›„ 2ê¸€ìž ì´ìƒë§Œ í•„í„°ë§
        const tokens = cleanText.split(/\s+/).filter(token => token.length >= 2);
        
        return new Set(tokens);
      };
      
      // ðŸ†• í•µì‹¬ í‚¤ì›Œë“œ ëª©ë¡ (ê°€ì¤‘ì¹˜ ë¶€ìŠ¤íŠ¸ìš©)
      const CRITICAL_KEYWORDS = [
        'ë…¸ë¡œë°”ì´ëŸ¬ìŠ¤', '2025', '2026', 'ê°ì—¼ì¦', 'í™˜ìž', 'ê¸‰ì¦', 'ì˜ˆë°©', 
        'í˜ˆë‹¹', 'í˜ˆì••', 'ë‹¹ë‡¨', 'ì•”', 'ì—¼ì¦', 'ë©´ì—­', 'ë¹„íƒ€ë¯¼', 'ë‹¨ë°±ì§ˆ', 
        'ì§€ë°©', 'ì½œë ˆìŠ¤í…Œë¡¤', 'ì²´ì¤‘', 'ë¹„ë§Œ', 'ìˆ˜ë©´', 'ìš´ë™', 'ì‹ì´', 'ì„­ì·¨', 'ì¦ìƒ', 'ì§„ë‹¨',
        'ì¹˜ë£Œ', 'ê´€ë¦¬', 'ê²€ì‚¬', 'ìˆ˜ì¹˜', 'ì •ìƒ', 'ì´ìƒ', 'ìœ„í—˜', 'íš¨ê³¼', 'ë¶€ìž‘ìš©',
        'ì›ì¸', 'ê¸°ì „', 'í•©ë³‘ì¦', 'ì•…í™”', 'í˜¸ì „', 'ê°œì„ ', 'ê°ì†Œ', 'ì¦ê°€', 'ìœ ì§€', 'ê¶Œìž¥'
      ];
      
      const calculateSimilarity = (text1: string, text2: string): number => {
        const setA = extractKeywords(text1);
        const setB = extractKeywords(text2);

        if (setA.size === 0 || setB.size === 0) return 0;

        // 1. ìžì¹´ë“œ ìœ ì‚¬ë„ (Jaccard Similarity) = êµì§‘í•© / í•©ì§‘í•©
        let intersection = 0;
        setA.forEach(word => {
          if (setB.has(word)) intersection++;
        });

        const union = new Set([...setA, ...setB]).size;
        // ìžì¹´ë“œ ì§€ìˆ˜ (0~1) -> ì ìˆ˜í™” (0~100)
        let score = (intersection / union) * 100;

        // 2. í•µì‹¬ í‚¤ì›Œë“œ(Critical Keywords) í¬í•¨ ì‹œ ê°€ì¤‘ì¹˜ ë¶€ìŠ¤íŠ¸
        let criticalMatchCount = 0;
        CRITICAL_KEYWORDS.forEach(k => {
           // ë‹¨ìˆœ í¬í•¨ ì—¬ë¶€ ì²´í¬
           if (text1.includes(k) && text2.includes(k)) {
              criticalMatchCount++;
           }
        });

        // í•µì‹¬ í‚¤ì›Œë“œê°€ 2ê°œ ì´ìƒ ê²¹ì¹˜ë©´ +20ì  ê°€ì‚°
        if (criticalMatchCount >= 2) {
           score += 20; 
        }
        
        // 100ì  ì´ˆê³¼ ë°©ì§€
        if (score > 100) score = 100;
        
        // ë””ë²„ê¹… ë¡œê·¸ (ìœ ì‚¬ë„ê°€ ì–´ëŠ ì •ë„ ìžˆì„ ë•Œë§Œ)
        if (score > 10) {
          console.log(`   ðŸ“Š ìœ ì‚¬ë„: ${score.toFixed(1)}% (ìžì¹´ë“œ ê¸°ë°˜ + í•µì‹¬í‚¤ì›Œë“œ ë¶€ìŠ¤íŠ¸)`);
          console.log(`      - A: "${text1.substring(0, 30)}..."`);
          console.log(`      - B: "${text2.substring(0, 30)}..."`);
        }
        
        // ê¸°ì¡´ ì½”ë“œì™€ì˜ í˜¸í™˜ì„±ì„ ìœ„í•´ 0~100 ì ìˆ˜ë¥¼ 0~1.0 ë¹„ìœ¨ë¡œ ë°˜í™˜í•˜ì§€ ì•Šê³ , 
        // ì•„ëž˜ ë¡œì§ì—ì„œ ì ìˆ˜(0~100) ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ê±°ë‚˜, ì—¬ê¸°ì„œ 100ìœ¼ë¡œ ë‚˜ëˆ ì„œ ë°˜í™˜í•  ìˆ˜ ìžˆìŒ.
        // ê¸°ì¡´ ì½”ë“œê°€ finalSim(0.0~1.0)ì„ ê¸°ëŒ€í–ˆìœ¼ë‚˜, ì—¬ê¸°ì„  ì ìˆ˜ ìžì²´ë¥¼ ë°˜í™˜í•˜ê³  ë¹„êµ ë¡œì§ì„ ìˆ˜ì •í•¨.
        return score;
      };
      
      // êµì°¨ ê²€ì¦ëœ í•­ëª© ìˆ˜ ê³„ì‚° (THRESHOLD: 30ì )
      let crossVerifiedCount = 0;
      const THRESHOLD = 30;

      searchResults.collected_facts.forEach((f1: any, i: number) => {
        searchResults.collected_facts.forEach((f2: any, j: number) => {
          if (i < j && f1.verified_by !== f2.verified_by) {
            const score = calculateSimilarity(f1.fact || '', f2.fact || '');
            // 30ì  ì´ìƒì´ë©´ êµì°¨ ê²€ì¦ ì„±ê³µìœ¼ë¡œ ê°„ì£¼
            if (score >= THRESHOLD) {
              f1.cross_verified = true;
              f2.cross_verified = true;
              crossVerifiedCount++;
              console.log(`   âœ… êµì°¨ ê²€ì¦ ì„±ê³µ! (ì ìˆ˜: ${score.toFixed(1)}ì )`);
            }
          }
        });
      });
      
      searchResults.cross_verified_count = crossVerifiedCount;
      
      const geminiTotal = searchResults.gemini_found || 0;
      const gptTotal = searchResults.gpt_found || 0;
      
      console.log(`âœ… í¬ë¡œìŠ¤ì²´í¬ ì™„ë£Œ:`);
      console.log(`   ðŸ”µ Gemini: ${geminiTotal}ê°œ ì •ë³´`);
      console.log(`   ðŸŸ¢ GPT-5.2: ${gptTotal}ê°œ ì •ë³´`);
      console.log(`   ðŸ”— êµì°¨ ê²€ì¦: ${crossVerifiedCount}ê°œ`);
      
      safeProgress(`âœ… í¬ë¡œìŠ¤ì²´í¬ ì™„ë£Œ: Gemini ${geminiTotal}ê°œ + GPT ${gptTotal}ê°œ â†’ ${crossVerifiedCount}ê°œ êµì°¨ê²€ì¦`);
      
    } else if (geminiResults) {
      // Gemini ê²€ìƒ‰ ì„±ê³µ
      console.log('ðŸ”µ Gemini ê²€ìƒ‰ ì„±ê³µ');
      searchResults = {
        collected_facts: sortByKdcaHealthPriority(geminiResults.collected_facts || []),
        key_statistics: sortByKdcaHealthPriority(geminiResults.key_statistics || []),
        latest_guidelines: sortByKdcaHealthPriority(geminiResults.latest_guidelines || []),
        gemini_found: geminiFactCount + geminiStatCount
      };
      safeProgress(`âœ… Gemini ê²€ìƒ‰ ì™„ë£Œ: ${geminiFactCount + geminiStatCount}ê°œ ì •ë³´ ìˆ˜ì§‘`);
      
    } else if (gptResults) {
      // GPTë§Œ ì„±ê³µ (í˜„ìž¬ ë¹„í™œì„±í™”)
      console.log('ðŸŸ¢ GPT ê²€ìƒ‰ ì„±ê³µ');
      searchResults = {
        collected_facts: sortByKdcaHealthPriority(gptResults.collected_facts || []),
        key_statistics: sortByKdcaHealthPriority(gptResults.key_statistics || []),
        latest_guidelines: sortByKdcaHealthPriority(gptResults.latest_guidelines || []),
        sources: gptResults.sources || [],
        gpt_found: gptFactCount + gptStatCount
      };
      safeProgress(`âœ… GPT ê²€ìƒ‰ ì™„ë£Œ: ${gptFactCount + gptStatCount}ê°œ ì •ë³´ ìˆ˜ì§‘`);
      
    } else {
      // ë‘˜ ë‹¤ ì‹¤íŒ¨ - ë‹¨ìˆœí™”ëœ ì—ëŸ¬ ì²˜ë¦¬ (í¬ë¡œìŠ¤ì²´í¬ í•„ë“œ ì œê±°)
      console.error('âŒ ê²€ìƒ‰ ì‹¤íŒ¨');
      safeProgress('âš ï¸ ê²€ìƒ‰ ì‹¤íŒ¨ - AI í•™ìŠµ ë°ì´í„° ê¸°ë°˜ìœ¼ë¡œ ì§„í–‰');
      searchResults = {};
    }
    
    // ðŸ“ Step 2: AIê°€ ê²€ìƒ‰ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ê¸€ ìž‘ì„±
    console.log('ðŸ“ Step 2 ì‹œìž‘: AI ê¸€ì“°ê¸°...');
    if (typeof onProgress === 'function') {
      safeProgress('âœï¸ Step 2: AIê°€ ìžì—°ìŠ¤ëŸ¬ìš´ ê¸€ì„ ìž‘ì„±í•˜ê³  ìžˆìŠµë‹ˆë‹¤...');
    }
    
    // Gemini ì „ìš© í”„ë¡¬í”„íŠ¸ ì‚¬ìš© - v5.3 í”„ë¡¬í”„íŠ¸ ì ìš©
    // GPT52_SYSTEM_PROMPT: ì˜ë£Œê´‘ê³ ë²• + ê¸ˆì§€ì–´ ì‚¬ì „ + ì¢…ê²°ì–´ë¯¸ + í‚¤ì›Œë“œ + SEO + ì¶œì²˜ê²€ì¦ + ìžê°€ì²´í¬
    const geminiSystemPrompt = GPT52_SYSTEM_PROMPT;
    
    // í¬ë¡œìŠ¤ì²´í¬ ìƒíƒœì— ë”°ë¥¸ ì‹ ë¢°ë„ ì•ˆë‚´ (ë‘˜ ë‹¤ ì‹¤íŒ¨ëŠ” ì´ë¯¸ ìœ„ì—ì„œ throwë¨)
    // crossCheckGuide ì œê±° (GPT ì—†ìœ¼ë¯€ë¡œ ë¶ˆí•„ìš”)
    
    const systemPrompt = `${geminiSystemPrompt}

[ðŸ“š ê²€ìƒ‰ ê²°ê³¼ - ìµœì‹  ì •ë³´]

ì•„ëž˜ëŠ” Google Searchë¡œ ìˆ˜ì§‘í•œ ìµœì‹  ì •ë³´ìž…ë‹ˆë‹¤.
ì‹ ë¢°í•  ìˆ˜ ìžˆëŠ” ì¶œì²˜ì˜ ì •ë³´ë¥¼ ìš°ì„ ì ìœ¼ë¡œ í™œìš©í•˜ì„¸ìš”.

${JSON.stringify(searchResults, null, 2)}

[âš ï¸ í¬ë¡œìŠ¤ì²´í¬ ê¸°ë°˜ ìž‘ì„± ê·œì¹™]
1. ${searchResults.cross_check_status === 'dual_verified' 
    ? 'ðŸŽ¯ êµì°¨ ê²€ì¦ëœ ì •ë³´(cross_verified=true)ë¥¼ ìµœìš°ì„ ìœ¼ë¡œ ì‚¬ìš©í•˜ì„¸ìš” - ê°€ìž¥ ì‹ ë¢°ë„ ë†’ìŒ!' 
    : 'ë‹¨ì¼ ì†ŒìŠ¤ ê²€ìƒ‰ ê²°ê³¼ì´ë¯€ë¡œ ì¶œì²˜ í‘œê¸°ì— ë”ìš± ì‹ ê²½ ì“°ì„¸ìš”'}
2. í†µê³„/ìˆ˜ì¹˜ ì‚¬ìš© ì‹œ ë°˜ë“œì‹œ ì¶œì²˜ì™€ ì—°ë„ë¥¼ í•¨ê»˜ í‘œê¸° (ì˜ˆ: "ì§ˆë³‘ê´€ë¦¬ì²­ ${getCurrentYear()}ë…„ ìžë£Œì— ë”°ë¥´ë©´...")
3. êµì°¨ ê²€ì¦ë˜ì§€ ì•Šì€ ì •ë³´ëŠ” "~ë¡œ ì•Œë ¤ì ¸ ìžˆìŠµë‹ˆë‹¤", "~í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤" ë“± ì™„í™” í‘œí˜„ ì‚¬ìš©
4. ë‘ ì†ŒìŠ¤ì—ì„œ ìƒì¶©ë˜ëŠ” ì •ë³´ê°€ ìžˆë‹¤ë©´ ë” ê³µì‹ ë ¥ ìžˆëŠ” ì¶œì²˜(í•™íšŒ, ì •ë¶€ê¸°ê´€) ìš°ì„ 

[ðŸ“‹ JSON ì‘ë‹µ í˜•ì‹]
{
  "title": "ì œëª© (ìƒíƒœ ì ê²€í˜• ì§ˆë¬¸)",
  "content": "HTML í˜•ì‹ì˜ ë³¸ë¬¸ ë‚´ìš© (í¬ë¡œìŠ¤ì²´í¬ëœ ì •ë³´ ìš°ì„  ì‚¬ìš©)",
  ${targetImageCount > 0 ? '"imagePrompts": ["ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸1", "ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸2", ...],' : 'âš ï¸ imagePrompts í•„ë“œ ìƒëžµ - ì´ë¯¸ì§€ 0ìž¥ ì„¤ì •ë¨'}
  "fact_check": {
    "fact_score": 0-100 (ë†’ì„ìˆ˜ë¡ ì¢‹ìŒ),
    "safety_score": 0-100 (ë†’ì„ìˆ˜ë¡ ì¢‹ìŒ),
    "conversion_score": 0-100 (ë†’ì„ìˆ˜ë¡ ì¢‹ìŒ),
    "ai_smell_score": 0-100 (âš ï¸ ë‚®ì„ìˆ˜ë¡ ì¢‹ìŒ! ì—­ì ìˆ˜! 7ì  ì´í•˜ ëª©í‘œ! 90ì  = ìµœì•…!),
    "verified_facts_count": 0,
    "issues": ["ë¬¸ì œì 1", "ë¬¸ì œì 2"],
    "recommendations": ["ê¶Œìž¥ì‚¬í•­1", "ê¶Œìž¥ì‚¬í•­2"]
  }
}

âš ï¸ ì¤‘ìš”: AI ëƒ„ìƒˆ ì ìˆ˜ëŠ” ë‹¤ë¥¸ ì ìˆ˜ì™€ ë°˜ëŒ€ìž…ë‹ˆë‹¤! âš ï¸
- fact_score, safety_score, conversion_score â†’ ë†’ì„ìˆ˜ë¡ ì¢‹ìŒ (100ì  = ìµœê³ )
- ai_smell_score â†’ ë‚®ì„ìˆ˜ë¡ ì¢‹ìŒ (7ì  ì´í•˜ = ìµœê³ , 90ì  = ìµœì•…)`;

    console.log('ðŸ“ callOpenAI_Staged í˜¸ì¶œ ì§ì „...');
    console.log('ðŸ“ í”„ë¡¬í”„íŠ¸ ê¸¸ì´:', (isCardNews ? cardNewsPrompt : blogPrompt).length);
    console.log('ðŸ“ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸(ê²€ìƒ‰ ê²°ê³¼) ê¸¸ì´:', JSON.stringify(searchResults, null, 2).length);
    
    // ðŸš€ ìƒˆë¡œìš´ ë‹¨ê³„ë³„ ì²˜ë¦¬ ì‹œìŠ¤í…œ ì‚¬ìš©
    const contextData = `[ðŸ“š ê²€ìƒ‰ ê²°ê³¼ - ìµœì‹  ì •ë³´]

ì•„ëž˜ëŠ” Google Searchë¡œ ìˆ˜ì§‘í•œ ìµœì‹  ì •ë³´ìž…ë‹ˆë‹¤.
ì‹ ë¢°í•  ìˆ˜ ìžˆëŠ” ì¶œì²˜ì˜ ì •ë³´ë¥¼ ìš°ì„ ì ìœ¼ë¡œ í™œìš©í•˜ì„¸ìš”.

${JSON.stringify(searchResults, null, 2)}

[âœ… ì •ë³´ í™œìš© ê·œì¹™]
1. ê³µì‹ ë ¥ ìžˆëŠ” ì¶œì²˜(ì˜ë£Œê¸°ê´€, í•™íšŒ, ì •ë¶€ê¸°ê´€)ì˜ ì •ë³´ë¥¼ ìš°ì„  ì‚¬ìš©
2. í†µê³„/ìˆ˜ì¹˜ ì‚¬ìš© ì‹œ ë°˜ë“œì‹œ ì¶œì²˜ì™€ ì—°ë„ë¥¼ í•¨ê»˜ í‘œê¸°
3. ì˜í•™ì  ì •ë³´ëŠ” "~ë¡œ ì•Œë ¤ì ¸ ìžˆìŠµë‹ˆë‹¤" ë“± ì™„í™” í‘œí˜„ ì‚¬ìš©
4. ìµœì‹  ì •ë³´ë¥¼ ì ê·¹ ë°˜ì˜í•˜ë˜, ê²€ì¦ëœ ì •ë³´ë¥¼ ìš°ì„ `;
    
    // GPT í˜¸ì¶œ ë¶€ë¶„ ì£¼ì„ ì²˜ë¦¬ (Geminië§Œ ì‚¬ìš©)
    /*
    const responseText = await callOpenAI_Staged(
      isCardNews ? cardNewsPrompt : blogPrompt, 
      contextData,
      request.textLength || 2000,
      safeProgress
    );
    console.log('ðŸ“ callOpenAI_Staged ì‘ë‹µ ë°›ìŒ, ê¸¸ì´:', responseText?.length);
    
    result = JSON.parse(responseText);
    
    console.log('âœ… GPT-5.2 ìž‘ì„± ì™„ë£Œ');
    */
    
    // Gemini ì‚¬ìš© (ê¸°ë³¸ê°’)
    console.log('ðŸ”µ Using Gemini for text generation');
    console.log('ðŸ“ í”„ë¡¬í”„íŠ¸ ê¸¸ì´:', (isCardNews ? cardNewsPrompt : blogPrompt).length, 'chars');
    console.log('ðŸ“‹ í”„ë¡¬í”„íŠ¸ ë¯¸ë¦¬ë³´ê¸°:', (isCardNews ? cardNewsPrompt : blogPrompt).substring(0, 200));
    safeProgress('âœï¸ Geminiê°€ ì½˜í…ì¸ ë¥¼ ìž‘ì„±í•˜ê³  ìžˆìŠµë‹ˆë‹¤...');
    
    try {
      console.log('ðŸ”„ Gemini API í˜¸ì¶œ ì‹œìž‘...');
      console.log('ðŸ“¦ contextData ê¸¸ì´:', contextData?.length || 0);
      console.log('ðŸ“¦ blogPrompt ê¸¸ì´:', blogPrompt?.length || 0);
      console.log('ðŸ“¦ ì „ì²´ í”„ë¡¬í”„íŠ¸ ë¯¸ë¦¬ë³´ê¸°:', `${contextData}\n\n${blogPrompt}`.substring(0, 500));
      
      // ðŸŽ¬ ì¼ë°˜ generateContent ì‚¬ìš© (íƒ€ìž„ì•„ì›ƒ ì œê±° - Geminiê°€ ì•Œì•„ì„œ ì²˜ë¦¬)
      safeProgress('âœï¸ AIê°€ ì½˜í…ì¸ ë¥¼ ìž‘ì„±í•˜ê³  ìžˆìŠµë‹ˆë‹¤... (ìž ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”)');

      // ðŸ“Š ì§„í–‰ë¥  ì‹œë®¬ë ˆì´ì…˜ (ì‹¤ì œ ìŠ¤íŠ¸ë¦¬ë° ëŒ€ì‹  ì˜ˆìƒ ì‹œê°„ ê¸°ë°˜)
      const progressInterval = setInterval(() => {
        const elapsed = Date.now() - startTime;
        const estimatedTotal = targetLength * 10; // ê¸€ìžë‹¹ 10ms ì˜ˆìƒ
        const progress = Math.min(90, (elapsed / estimatedTotal) * 100);
        safeProgress(`âœï¸ ìž‘ì„± ì¤‘... ${Math.round(progress)}%`);
      }, 2000);

      try {
        // ðŸš€ íƒ€ìž„ì•„ì›ƒ ì¶”ê°€ (180ì´ˆ = 3ë¶„) - í”„ë¡¬í”„íŠ¸ê°€ ê¸¸ì–´ì„œ ìƒì„± ì‹œê°„ í•„ìš”
        const GENERATION_TIMEOUT = 180000;
        
        const generationPromise = ai.models.generateContent({
          model: "gemini-3-pro-preview",
          contents: `${systemPrompt}\n\n${isCardNews ? cardNewsPrompt : blogPrompt}`,
          config: {
            tools: [{ googleSearch: {} }],
            responseMimeType: "application/json",
            // ðŸ“Š ê°„ì†Œí™”ëœ ì‘ë‹µ ìŠ¤í‚¤ë§ˆ (ë³µìž¡ë„ ê°ì†Œ â†’ ìƒì„± ì†ë„ í–¥ìƒ)
            responseSchema: {
              type: Type.OBJECT,
              properties: {
                title: { type: Type.STRING },
                content: { type: Type.STRING },
                imagePrompts: { type: Type.ARRAY, items: { type: Type.STRING } },
                fact_check: {
                  type: Type.OBJECT,
                  properties: {
                    fact_score: { type: Type.INTEGER },
                    safety_score: { type: Type.INTEGER },
                    conversion_score: { type: Type.INTEGER },
                    ai_smell_score: { type: Type.INTEGER },
                    verified_facts_count: { type: Type.INTEGER },
                    issues: { type: Type.ARRAY, items: { type: Type.STRING } },
                    recommendations: { type: Type.ARRAY, items: { type: Type.STRING } }
                  },
                  required: ["fact_score", "safety_score", "conversion_score", "ai_smell_score"]
                }
              },
              required: ["title", "content", "fact_check"]
            }
          }
        });
        
        const timeoutPromise = new Promise<never>((_, reject) => {
          setTimeout(() => reject(new Error('â° ê¸€ì“°ê¸° íƒ€ìž„ì•„ì›ƒ (3ë¶„) - í”„ë¡¬í”„íŠ¸ê°€ ë„ˆë¬´ ê¹ë‹ˆë‹¤')), GENERATION_TIMEOUT);
        });
        
        const geminiResponse = await Promise.race([generationPromise, timeoutPromise]);
        
        const responseText = geminiResponse.text || '';
        clearInterval(progressInterval); // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸ ì¤‘ì§€

        const charCountNoSpaces = responseText.replace(/\s/g, '').length;
        console.log(`âœ… ìƒì„± ì™„ë£Œ: ${charCountNoSpaces}ìž (ê³µë°±ì œì™¸) / ${responseText.length}ìž (ê³µë°±í¬í•¨)`);
        safeProgress(`âœ… ìƒì„± ì™„ë£Œ: ${charCountNoSpaces}ìž`);

        const response = { text: responseText };

        console.log('âœ… Gemini ì‘ë‹µ ìˆ˜ì‹ :', response.text?.length || 0, 'chars');

        if (!response.text) {
          throw new Error('Geminiê°€ ë¹ˆ ì‘ë‹µì„ ë°˜í™˜í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
        }

        result = JSON.parse(response.text);
        console.log('âœ… Gemini JSON íŒŒì‹± ì„±ê³µ');

      } catch (geminiError: any) {
        clearInterval(progressInterval); // ì—ëŸ¬ ì‹œì—ë„ ì¤‘ì§€
        console.error('âŒ Gemini ìƒì„± ì‹¤íŒ¨:', geminiError);
        
        // ì—ëŸ¬ íƒ€ìž…ë³„ ì²˜ë¦¬
        if (geminiError.message?.includes('quota') || geminiError.message?.includes('limit') || geminiError.message?.includes('429')) {
          throw new Error('ðŸš« API ì‚¬ìš©ëŸ‰ í•œê³„ì— ë„ë‹¬í–ˆìŠµë‹ˆë‹¤. ìž ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
        } else if (geminiError.message?.includes('JSON')) {
          throw new Error('ðŸ“‹ AI ì‘ë‹µ í˜•ì‹ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
        } else {
          throw new Error(`âŒ Gemini ì˜¤ë¥˜: ${geminiError.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'}`);
        }
      }
    
    // ðŸ”§ GPT-5.2ëŠ” ë‹¤ì–‘í•œ í•„ë“œëª…ìœ¼ë¡œ ë°˜í™˜í•  ìˆ˜ ìžˆìŒ â†’ contentë¡œ ì •ê·œí™”
    if (!result.content) {
      // ê°€ëŠ¥í•œ ëª¨ë“  í•„ë“œëª… ì²´í¬
      const possibleContentFields = ['contentHtml', 'body', 'html', 'htmlContent', 'bodyHtml', 'article', 'text'];
      for (const field of possibleContentFields) {
        if (result[field]) {
          console.log(`âœ… GPT-5.2 '${field}' í•„ë“œë¥¼ contentë¡œ ì •ê·œí™”`);
          result.content = result[field];
          break;
        }
      }
    }
    
    // ë””ë²„ê·¸: result ê°ì²´ì˜ ëª¨ë“  í•„ë“œ ì¶œë ¥
    console.log('ðŸ“‹ result ê°ì²´ í•„ë“œ:', Object.keys(result));
    if (!result.content) {
      console.error('âŒ content í•„ë“œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. result:', JSON.stringify(result).substring(0, 500));
    }
    
    // AIê°€ contentë¥¼ ë°°ì—´ì´ë‚˜ ê°ì²´ë¡œ ë°˜í™˜í•œ ê²½ìš° ë°©ì–´ ì²˜ë¦¬
    if (result.content && typeof result.content !== 'string') {
      console.warn('AI returned non-string content, attempting to extract HTML...');
      if (Array.isArray(result.content)) {
        // ë°°ì—´ì¸ ê²½ìš° ê° í•­ëª©ì—ì„œ HTML ì¶”ì¶œ
        result.content = result.content.map((item: any) => {
          if (typeof item === 'string') return item;
          if (item?.content) return item.content;
          if (item?.html) return item.html;
          return '';
        }).join('');
      } else if (typeof result.content === 'object') {
        // ê°ì²´ì¸ ê²½ìš° contentë‚˜ html í•„ë“œ ì¶”ì¶œ
        result.content = result.content.content || result.content.html || JSON.stringify(result.content);
      }
    }
    
    // ë¶ˆí•„ìš”í•œ í…ìŠ¤íŠ¸ ë° ì´ëª¨ì§€ ì œê±° (ì „ë¬¸ ì˜ë£Œ ì½˜í…ì¸  í†¤ ìœ ì§€)
    if (result.content && typeof result.content === 'string') {
      result.content = result.content
        .replace(/\(ì´ë¯¸ì§€ ì—†ìŒ\)/g, '')
        .replace(/\(ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤\)/g, '')
        .replace(/\[ì´ë¯¸ì§€ ì—†ìŒ\]/g, '')
        .replace(/\[IMG_\d+\]/g, '') // ë‚¨ì•„ìžˆëŠ” ì´ë¯¸ì§€ ë§ˆì»¤ ì œê±°
        .replace(/<p>\s*<\/p>/g, '') // ë¹ˆ p íƒœê·¸ ì œê±°
        // ì´ëª¨ì§€ ì œê±° (ì „ë¬¸ ì˜ë£Œ ì½˜í…ì¸  í†¤)
        .replace(/[\u{1F300}-\u{1F9FF}]/gu, '') // ì´ëª¨ì§€ ë²”ìœ„
        .replace(/[\u{2600}-\u{26FF}]/gu, '') // ê¸°íƒ€ ê¸°í˜¸
        .replace(/[\u{2700}-\u{27BF}]/gu, '') // ë”©ë±ƒ
        .replace(/[\u{FE00}-\u{FE0F}]/gu, '') // ë³€í˜• ì„ íƒìž
        .replace(/[\u{1F000}-\u{1F02F}]/gu, '') // ë§ˆìž‘ íƒ€ì¼
        .trim();
    }
    
    // ì œëª©ì—ì„œë„ ì´ëª¨ì§€ ì œê±°
    if (result.title && typeof result.title === 'string') {
      result.title = result.title
        .replace(/[\u{1F300}-\u{1F9FF}]/gu, '')
        .replace(/[\u{2600}-\u{26FF}]/gu, '')
        .replace(/[\u{2700}-\u{27BF}]/gu, '')
        .trim();
    }
    
    // ë¶„ì„ëœ ìŠ¤íƒ€ì¼ ì •ë³´ ì¶”ê°€
    if (analyzedBgColor) {
      result.analyzedStyle = { backgroundColor: analyzedBgColor };
    }
    
    // ðŸ”§ fact_check ê¸°ë³¸ê°’ ì„¤ì • (Geminiê°€ ë°˜í™˜í•˜ì§€ ì•Šì€ í•„ë“œ ë³´ì™„)
    if (!result.fact_check) {
      result.fact_check = {};
    }
    // conversion_scoreê°€ ì—†ê±°ë‚˜ 0ì´ë©´ ê¸°ë³¸ê°’ 70 ì„¤ì • (ì½˜í…ì¸ ê°€ ìƒì„±ë˜ì—ˆìœ¼ë©´ ìµœì†Œ 70ì )
    if (!result.fact_check.conversion_score || result.fact_check.conversion_score === 0) {
      result.fact_check.conversion_score = 70;
      console.log('âš ï¸ conversion_score ê¸°ë³¸ê°’ 70ì  ì„¤ì • (AI ë¯¸ë°˜í™˜)');
    }
    // ë‹¤ë¥¸ í•„ë“œë“¤ë„ ê¸°ë³¸ê°’ ì„¤ì • (0ë„ falsyì´ë¯€ë¡œ undefined/null/0 ëª¨ë‘ ì²˜ë¦¬)
    if (result.fact_check.fact_score === undefined || result.fact_check.fact_score === null) {
      result.fact_check.fact_score = 80;
    }
    if (result.fact_check.safety_score === undefined || result.fact_check.safety_score === null) {
      result.fact_check.safety_score = 85;
    }
    // ai_smell_scoreëŠ” 0ì´ ìœ íš¨í•œ ê°’ì´ ì•„ë‹˜ (ë‚®ì„ìˆ˜ë¡ ì¢‹ì€ ì ìˆ˜)
    if (result.fact_check.ai_smell_score === undefined || result.fact_check.ai_smell_score === null) {
      result.fact_check.ai_smell_score = 15;
      console.log('âš ï¸ ai_smell_score ê¸°ë³¸ê°’ 15ì  ì„¤ì • (AI ë¯¸ë°˜í™˜)');
    }
    if (result.fact_check.verified_facts_count === undefined || result.fact_check.verified_facts_count === null) {
      result.fact_check.verified_facts_count = 3;
    }
    if (!result.fact_check.issues) result.fact_check.issues = [];
    if (!result.fact_check.recommendations) result.fact_check.recommendations = [];
    
    console.log('ðŸ“Š fact_check ìµœì¢…ê°’:', result.fact_check);
    
    // ðŸŽ¯ SEO ìžë™ í‰ê°€ (ìž¬ìƒì„± ì—†ì´ í‰ê°€ë§Œ ìˆ˜í–‰)
    const hasContent = result.content || result.contentHtml;
    if (!isCardNews && hasContent && result.title) {
      console.log('ðŸ“Š SEO ìžë™ í‰ê°€ ì‹œìž‘...');
      if (typeof onProgress === 'function') {
        safeProgress('ðŸ“Š SEO ì ìˆ˜ë¥¼ ìžë™ í‰ê°€í•˜ê³  ìžˆìŠµë‹ˆë‹¤...');
      }
      
      try {
        // content ë˜ëŠ” contentHtml í•„ë“œ ì§€ì›
        const htmlContent = result.contentHtml || result.content;
        if (!htmlContent) {
          console.error('âŒ SEO í‰ê°€ ë¶ˆê°€: resultì— content ë˜ëŠ” contentHtml í•„ë“œê°€ ì—†ìŠµë‹ˆë‹¤');
          console.error('   - result í•„ë“œ:', Object.keys(result));
        } else {
          const seoReport = await evaluateSeoScore(
            htmlContent,
            result.title,
            request.topic,
            request.keywords || ''
          );
          
          console.log(`ðŸ“Š SEO í‰ê°€ ì™„ë£Œ - ì´ì : ${seoReport.total}ì `);
          
          // SEO ì ìˆ˜ë¥¼ ê²°ê³¼ì— ì¶”ê°€
          result.seoScore = seoReport;
          
          // ì§„í–‰ ìƒí™© ì—…ë°ì´íŠ¸
          if (typeof onProgress === 'function') {
            safeProgress(`ðŸ“Š SEO í‰ê°€ ì™„ë£Œ - ì´ì : ${seoReport.total}ì `);
          }
          
          if (seoReport.total >= 85) {
            console.log('âœ… SEO ì ìˆ˜ 85ì  ì´ìƒ!');
            if (typeof onProgress === 'function') {
              safeProgress(`âœ… SEO ì ìˆ˜ ${seoReport.total}ì `);
            }
          } else {
            console.log(`â„¹ï¸ SEO ì ìˆ˜ ${seoReport.total}ì  - ì°¸ê³ ìš©`);
            if (typeof onProgress === 'function') {
              safeProgress(`â„¹ï¸ SEO ì ìˆ˜ ${seoReport.total}ì `);
            }
          }
        }
      } catch (seoError) {
        console.error('âŒ SEO í‰ê°€ ì˜¤ë¥˜:', seoError);
      }
      
      // SEO í‰ê°€ ì™„ë£Œ ë©”ì‹œì§€
      if (typeof onProgress === 'function') {
        safeProgress('âœ… Step 2 ì™„ë£Œ: ê¸€ ìž‘ì„± ë° SEO í‰ê°€ ì™„ë£Œ');
      }
    }
    } catch (contentGenerationError: any) {
      console.error('âŒ ì½˜í…ì¸  ìƒì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', contentGenerationError);
      throw contentGenerationError;
    }

    // ðŸ“Š í”„ë¡¬í”„íŠ¸ ë¶„ì„ ë¡œê·¸ ê¸°ë¡
    try {
      const { logPromptGeneration } = await import('../utils/promptAnalytics');
      const generationTime = Date.now() - startTime;
      const actualContent = result.content || result.contentHtml || '';
      const plainText = actualContent.replace(/<[^>]*>/g, '').replace(/\s+/g, ' ').trim();
      const actualLength = plainText.length;

      logPromptGeneration({
        promptVersion: 'v2.0_natural_writing',
        category: request.category,
        topic: request.topic,
        targetLength: targetLength,
        imageCount: request.imageCount || 0,
        actualLength: actualLength,
        ai_smell_score: result.fact_check?.ai_smell_score || 0,
        safety_score: result.fact_check?.safety_score || 0,
        fact_score: result.fact_check?.fact_score || 0,
        conversion_score: result.fact_check?.conversion_score || 0,
        generationTime: generationTime,
        retryCount: retryCount,
        errorOccurred: errorOccurred,
        errorMessage: errorMessage,
        wasEdited: false,
        wasSaved: false
      });
    } catch (analyticsError) {
      console.error('âš ï¸ Analytics logging failed:', analyticsError);
      // ë¡œê·¸ ì‹¤íŒ¨í•´ë„ ë©”ì¸ ê¸°ëŠ¥ì€ ê³„ì†
    }

    return result;
  } catch (error) {
    errorOccurred = true;
    errorMessage = (error as Error).message || 'Unknown error';
    throw error;
  }
};

// ðŸ—žï¸ ë³´ë„ìžë£Œ ìƒì„± í•¨ìˆ˜
const generatePressRelease = async (request: GenerationRequest, onProgress: (msg: string) => void): Promise<GeneratedContent> => {
  const currentDate = new Date();
  const year = currentDate.getFullYear();
  const month = currentDate.getMonth() + 1;
  const day = currentDate.getDate();
  const formattedDate = `${year}ë…„ ${month}ì›” ${day}ì¼`;
  
  const pressTypeLabels: Record<string, string> = {
    'achievement': 'ì‹¤ì  ë‹¬ì„±',
    'new_service': 'ì‹ ê·œ ì„œë¹„ìŠ¤/ìž¥ë¹„ ë„ìž…',
    'research': 'ì—°êµ¬/í•™ìˆ  ì„±ê³¼',
    'event': 'í–‰ì‚¬/ì´ë²¤íŠ¸',
    'award': 'ìˆ˜ìƒ/ì¸ì¦ íšë“',
    'health_tips': 'ê±´ê°• ì¡°ì–¸/ì •ë³´'
  };
  
  const pressTypeLabel = pressTypeLabels[request.pressType || 'achievement'] || 'ì‹¤ì  ë‹¬ì„±';
  const hospitalName = request.hospitalName || 'OOë³‘ì›';
  const doctorName = request.doctorName || 'í™ê¸¸ë™';
  const doctorTitle = request.doctorTitle || 'ì›ìž¥';
  const maxLength = request.textLength || 1400;
  
  // í•™ìŠµëœ ë§íˆ¬ ìŠ¤íƒ€ì¼ ì ìš©
  let learnedStyleInstruction = '';
  if (request.learnedStyleId) {
    try {
    const { getStyleById, getStylePromptForGeneration } = await import('./writingStyleService');
    const learnedStyle = getStyleById(request.learnedStyleId);
    if (learnedStyle) {
      learnedStyleInstruction = `
[ðŸŽ“ í•™ìŠµëœ ë§íˆ¬ ì ìš© - ë³´ë„ìžë£Œ ìŠ¤íƒ€ì¼ ìœ ì§€í•˜ë©° ì ìš©!]
${getStylePromptForGeneration(learnedStyle)}

âš ï¸ ìœ„ í•™ìŠµëœ ë§íˆ¬ë¥¼ ë³´ë„ìžë£Œ í˜•ì‹ì— ë§žê²Œ ì ìš©í•˜ì„¸ìš”:
- ì „ë¬¸ì ì¸ ë³´ë„ìžë£Œ ì–´ì¡°ëŠ” ìœ ì§€
- ë¬¸ìž¥ ë íŒ¨í„´ê³¼ í‘œí˜„ ìŠ¤íƒ€ì¼ë§Œ ë°˜ì˜
- ê³¼ë„í•œ êµ¬ì–´ì²´ëŠ” ì§€ì–‘
`;
      console.log('ðŸ“ ë³´ë„ìžë£Œì— í•™ìŠµëœ ë§íˆ¬ ì ìš©:', learnedStyle.name);
    }
    } catch (e) {
    console.warn('í•™ìŠµëœ ë§íˆ¬ ë¡œë“œ ì‹¤íŒ¨:', e);
    }
  }
  
  onProgress('ðŸ—žï¸ ë³´ë„ìžë£Œ ìž‘ì„± ì¤‘...');
  
  const pressPrompt = `
ë‹¹ì‹ ì€ ë³‘ì› í™ë³´íŒ€ ë³´ë„ìžë£Œ ì „ë¬¸ê°€ìž…ë‹ˆë‹¤.
${learnedStyleInstruction}
ì•„ëž˜ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì–¸ë¡  ë°°í¬ìš© ë³´ë„ìžë£Œë¥¼ ìž‘ì„±í•´ì£¼ì„¸ìš”.

[ê¸°ë³¸ ì •ë³´]
- ìž‘ì„±ì¼: ${formattedDate}
- ë³‘ì›ëª…: ${hospitalName}
- ì§„ë£Œê³¼: ${request.category}
- ì˜ë£Œì§„: ${doctorName} ${doctorTitle}
- ë³´ë„ ìœ í˜•: ${pressTypeLabel}
- ì£¼ì œ: ${request.topic}
- í‚¤ì›Œë“œ: ${request.keywords}
- âš ï¸ ìµœëŒ€ ê¸€ìž ìˆ˜: ê³µë°± ì œì™¸ ${maxLength}ìž (ë°˜ë“œì‹œ ì´ ê¸€ìž ìˆ˜ë¥¼ ë„˜ì§€ ë§ˆì„¸ìš”!)

[í•„ìˆ˜ í¬í•¨ ë¬¸êµ¬ - ë°˜ë“œì‹œ ë³´ë„ìžë£Œ í•˜ë‹¨ì— í¬í•¨]
âš ï¸ ë³¸ ìžë£ŒëŠ” ${hospitalName}ì˜ í™ë³´ ëª©ì ìœ¼ë¡œ ìž‘ì„±ëœ ë³´ë„ìžë£Œìž…ë‹ˆë‹¤.
ì˜í•™ì  ì •ë³´ëŠ” ì°¸ê³ ìš©ì´ë©°, ì •í™•í•œ ì§„ë‹¨ê³¼ ì¹˜ë£ŒëŠ” ë°˜ë“œì‹œ ì „ë¬¸ì˜ì™€ ìƒë‹´í•˜ì‹œê¸° ë°”ëžë‹ˆë‹¤.

[ë³´ë„ìžë£Œ í˜•ì‹ - ë°˜ë“œì‹œ HTMLë¡œ ìž‘ì„±]
<div class="press-release-container">
  <div class="press-header">
    <p class="press-date">${formattedDate}</p>
    <p class="press-embargo">ì¦‰ì‹œ ë³´ë„ ê°€ëŠ¥</p>
  </div>
  
  <h1 class="press-title">[ì œëª©: ìž„íŒ©íŠ¸ ìžˆëŠ” í•œ ì¤„ - 50ìž ì´ë‚´]</h1>
  <h2 class="press-subtitle">[ë¶€ì œ: í•µì‹¬ ë‚´ìš© ìš”ì•½ - 70ìž ì´ë‚´]</h2>
  
  <div class="press-lead">
    <p>[ë¦¬ë“œë¬¸: 5W1H ì›ì¹™ì— ë”°ë¼ í•µì‹¬ ë‚´ìš© ìš”ì•½ - 150~200ìž]</p>
  </div>
  
  <div class="press-body">
    <h3>â–  ë°°ê²½ ë° í˜„í™©</h3>
    <p>[ê´€ë ¨ ì˜ë£Œ í˜„í™©, ì‚¬íšŒì  ë°°ê²½ ì„¤ëª… - 200~300ìž]</p>
    
    <h3>â–  ì£¼ìš” ë‚´ìš©</h3>
    <p>[ë³´ë„ í•µì‹¬ ë‚´ìš© ìƒì„¸ ì„¤ëª… - 300~400ìž]</p>
    <ul>
    <li>í•µì‹¬ í¬ì¸íŠ¸ 1</li>
    <li>í•µì‹¬ í¬ì¸íŠ¸ 2</li>
    <li>í•µì‹¬ í¬ì¸íŠ¸ 3</li>
    </ul>
    
    <h3>â–  ì „ë¬¸ê°€ ì½”ë©˜íŠ¸</h3>
    <blockquote class="press-quote">
    <p>"[${doctorName} ${doctorTitle}ì˜ ì „ë¬¸ì ì´ê³  ì‹ ë¢°ê° ìžˆëŠ” ì½”ë©˜íŠ¸ - 100~150ìž]"</p>
    <cite>- ${hospitalName} ${request.category} ${doctorName} ${doctorTitle}</cite>
    </blockquote>
    
    <h3>â–  í–¥í›„ ê³„íš</h3>
    <p>[í–¥í›„ ë°œì „ ê³„íš, ë¹„ì „ ì œì‹œ - 150~200ìž]</p>
  </div>
  
  <div class="press-footer">
    <div class="press-contact">
    <h4>â–£ ë¬¸ì˜ì²˜</h4>
    <p>${hospitalName} í™ë³´íŒ€</p>
    <p>ì „í™”: 02-0000-0000 / ì´ë©”ì¼: pr@hospital.com</p>
    </div>
    
    <div class="press-disclaimer">
    <p>â€» ë³¸ ìžë£ŒëŠ” ${hospitalName}ì˜ í™ë³´ ëª©ì ìœ¼ë¡œ ìž‘ì„±ëœ ë³´ë„ìžë£Œìž…ë‹ˆë‹¤.</p>
    <p>â€» ì˜í•™ì  ì •ë³´ëŠ” ì°¸ê³ ìš©ì´ë©°, ì •í™•í•œ ì§„ë‹¨ê³¼ ì¹˜ë£ŒëŠ” ë°˜ë“œì‹œ ì „ë¬¸ì˜ì™€ ìƒë‹´í•˜ì‹œê¸° ë°”ëžë‹ˆë‹¤.</p>
    <p>â€» ë³¸ ë³´ë„ìžë£ŒëŠ” ë°°í¬ ì „ ë°˜ë“œì‹œ ë‚´ìš© ê²€í† ê°€ í•„ìš”í•©ë‹ˆë‹¤.</p>
    </div>
  </div>
</div>

[ìž‘ì„± ì§€ì¹¨]
1. ê°ê´€ì ì´ê³  ê³µì‹ì ì¸ ì–´ì¡° ì‚¬ìš© (ë§ˆì¼€íŒ… ë¬¸êµ¬ ì§€ì–‘)
2. ê³¼ìž¥ëœ í‘œí˜„ ê¸ˆì§€ (ìµœê³ , ìµœì´ˆ, ìœ ì¼ ë“± ê²€ì¦ ë¶ˆê°€ í‘œí˜„ ì£¼ì˜)
3. êµ¬ì²´ì ì¸ ìˆ˜ì¹˜ì™€ ì‚¬ì‹¤ì— ê¸°ë°˜í•œ ë‚´ìš©
4. ì „ë¬¸ì˜ ì½”ë©˜íŠ¸ëŠ” ì‹ ë¢°ê° ìžˆìœ¼ë©´ì„œë„ í™˜ìž ì¤‘ì‹¬ì  ë©”ì‹œì§€
5. ì˜ë£Œê´‘ê³  ì‹¬ì˜ ê¸°ì¤€ ì¤€ìˆ˜ (ê³¼ëŒ€ê´‘ê³  ê¸ˆì§€)

[ðŸš¨ AI ëƒ„ìƒˆ ì ìˆ˜ ì‹œìŠ¤í…œ v2.0 - ë³´ë„ìžë£Œ í•„ìˆ˜ ì ìš©!]
**ì´ì : 100ì  | 15ì  ì´ˆê³¼ ì‹œ ìž¬ìž‘ì„± ëŒ€ìƒ**
**ðŸ”„ v2.0: ì¤‘ë³µ ì œê±°, ë°°ì  ìž¬ì¡°ì •, ì‹¬ì‚¬ìˆ™ê³  í‰ê°€**

**ì²´í¬ í¬ì¸íŠ¸ (ì ìˆ˜ ë†’ì„ìˆ˜ë¡ AI ëƒ„ìƒˆ ì‹¬í•¨):**

1. **ë¬¸ìž¥ ë¦¬ë“¬ ë‹¨ì¡°ë¡œì›€** (0~25ì ) â˜… ê°€ìž¥ ì¤‘ìš”
   â€¢ ë™ì¼ ì¢…ê²°ì–´ë¯¸ 3íšŒ ì´ìƒ ë°˜ë³µ â†’ +7ì 
   â€¢ ë¬¸ìž¥ ì‹œìž‘ íŒ¨í„´ 3íšŒ ì´ìƒ ë°˜ë³µ â†’ +6ì 
   â€¢ ë¬¸ë‹¨ ê¸¸ì´ ê· ì¼ / ì„¤ëª…ë§Œ ì—°ì† â†’ +6ì ì”©

2. **íŒë‹¨ ë‹¨ì •í˜• ê¸€ì“°ê¸°** (0~20ì )
   â€¢ í•œ ë¬¸ë‹¨ì— ì¡°ê±´/ê°€ëŠ¥ì„± ì¢…ê²° 3íšŒ ì´ìƒ â†’ +8ì 
   â€¢ ê¸°ì¤€ ì—†ì´ "í™•ì¸ í•„ìš”"ë§Œ ë°˜ë³µ â†’ +7ì 
   â€¢ ì €ìž ì˜ê²¬/íŒë‹¨ 0íšŒ â†’ +5ì 

3. **í˜„ìž¥ê° ë¶€ìž¬** (0~20ì )
   â€¢ ì‹œê°„/ê³„ì ˆ/ìƒí™© ë§¥ë½ ì „ë¬´ â†’ +7ì 
   â€¢ ì‹¤ì œ ì§ˆë¬¸/ê³ ë¯¼ ì‹œë‚˜ë¦¬ì˜¤ ì—†ìŒ â†’ +7ì 
   â€¢ í˜„ìž¥ ìš©ì–´ 0íšŒ â†’ +6ì 

4. **í…œí”Œë¦¿ êµ¬ì¡°** (0~15ì )
   â€¢ ë°°ê²½â†’ì£¼ìš”ë‚´ìš©â†’ì „ë§ì˜ ë»”í•œ êµ¬ì¡° â†’ +6ì 
   â€¢ ë…ìž ìžê°€ ì²´í¬ í¬ì¸íŠ¸ ì—†ìŒ â†’ +5ì 
   â€¢ ì „í™˜ì–´ ì—†ì´ ë‚˜ì—´ë§Œ â†’ +4ì 

5. **ê°€ì§œ ê³µê°** (0~10ì )
   â€¢ "ê´€ì‹¬ì´ ë†’ì•„ì§€ê³  ìžˆë‹¤" ë¥˜ ë²”ìš© ê³µê°ë§Œ â†’ +4ì 
   â€¢ êµ¬ì²´ì  ìƒí™©Â·ê°ì • ì§€ëª© ì—†ìŒ â†’ +3ì 
   â€¢ ê³µê° ìœ„ì¹˜ ê³ ì • â†’ +3ì 

6. **í–‰ë™ ìœ ë„ ì‹¤íŒ¨** (0~10ì )
   â€¢ ë§¤ë²ˆ ë™ì¼í•œ ë§ˆë¬´ë¦¬ íŒ¨í„´ â†’ +4ì 
   â€¢ ì‹œì Â·ì¡°ê±´ ì—†ëŠ” ê¶Œìœ  â†’ +3ì 
   â€¢ ìƒí™©ë³„ ë¶„ê¸° ì—†ìŒ â†’ +3ì 

**ê°œì„  ë°©ë²•:**
- ê´€ì°°í˜• ë¬¸ìž¥ ì„žê¸° (ì˜ˆ: "ì‹¤ì œë¡œ ~ë¬¸ì˜ê°€ ëŠ˜ì–´ë‚˜ê³  ìžˆë‹¤")
- êµ¬ì²´ì  ë§¥ë½ ì¶”ê°€ (ì‹œê¸°, ëŒ€ìƒ, ìƒí™©)
- ë¬¸ìž¥ ì—”ë”© ë‹¤ì–‘í™”: "~ê±°ë“ ìš”", "~ë”ë¼ê³ ìš”", "~ì¸ ê²½ìš°ë„ ìžˆìŠµë‹ˆë‹¤"
- ì „ë¬¸ê°€ ì½”ë©˜íŠ¸ì— í˜„ìž¥ê° ìžˆëŠ” í‘œí˜„ ì¶”ê°€

**íŒì • (v2.0):** 0~7ì =âœ…ì‚¬ëžŒê¸€ | 8~15ì =âš ï¸ë¶€ë¶„ìˆ˜ì • | 16ì â†‘=ðŸš¨ìž¬ìž‘ì„±

[ðŸ“Š í†µê³„/ìˆ˜ì¹˜ ì¸ìš© ê·œì¹™ - í•„ìˆ˜! (í˜„ìž¬: ${year}ë…„)]
âš ï¸ ëª¨ë“  í†µê³„ì™€ ìˆ˜ì¹˜ëŠ” ë°˜ë“œì‹œ ì¶œì²˜ì™€ ì—°ë„ë¥¼ í•¨ê»˜ í‘œê¸°!
âš ï¸ í˜„ìž¬ ${year}ë…„ ê¸°ì¤€, ê°€ìž¥ ìµœì‹  ìžë£Œ(${year}ë…„ ë˜ëŠ” ${year-1}ë…„)ë¥¼ ìš°ì„  ì¸ìš©!
âœ… "${year}ë…„ êµ­ë¯¼ê±´ê°•ì˜ì–‘ì¡°ì‚¬ì— ë”°ë¥´ë©´..." ë˜ëŠ” "${year-1}ë…„ ìžë£Œ ê¸°ì¤€..."
âœ… "ëŒ€í•œOOí•™íšŒ ${year}ë…„ ìµœì‹  ê°€ì´ë“œë¼ì¸ì— ì˜í•˜ë©´..."
âœ… "ë³´ê±´ë³µì§€ë¶€ ${year}ë…„ í†µê³„ ê¸°ì¤€..."
âœ… "${year-1}ë…„ ë°œí‘œëœ ì—°êµ¬ì— ë”°ë¥´ë©´..." (1ë…„ ì „ ìžë£Œë„ OK, ë‹¨ ì—°ë„ ëª…ì‹œ)
âŒ "êµ­ë‚´ í™˜ìžê°€ ìˆ˜ë°±ë§Œ ëª…ì— ë‹¬í•©ë‹ˆë‹¤" (ì¶œì²˜/ì—°ë„ ì—†ìŒ)
âŒ "ìµœê·¼ ì—°êµ¬ì— ë”°ë¥´ë©´..." (êµ¬ì²´ì  ì¶œì²˜/ì—°ë„ ì—†ìŒ)
âŒ 2ë…„ ì´ìƒ ì˜¤ëž˜ëœ ìžë£Œë¥¼ "ìµœì‹ "ì´ë¼ê³  í‘œí˜„ ê¸ˆì§€!

[[ê¸ˆì§€] ì–¸ë¡ ì¤‘ìž¬ìœ„ ê°€ì´ë“œë¼ì¸ ì¤€ìˆ˜]
- ì‚¬ì‹¤ê³¼ ì˜ê²¬ ëª…í™•ížˆ êµ¬ë¶„
- ì¶”ì¸¡ì„± í‘œí˜„ ì‹œ "~ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤", "~ê²ƒìœ¼ë¡œ ì˜ˆìƒëœë‹¤" ì‚¬ìš©
- ì¸ìš©ë¬¸ì€ ì •í™•ížˆ, ë§¥ë½ ì™œê³¡ ê¸ˆì§€
- ìˆ˜ì¹˜ ê³¼ìž¥/ì¶•ì†Œ ê¸ˆì§€

[ì¤‘ìš”]
- ë°˜ë“œì‹œ ìœ„ HTML êµ¬ì¡°ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©
- ë§ˆí¬ë‹¤ìš´ ë¬¸ë²• ì‚¬ìš© ê¸ˆì§€ (### ì´ë‚˜ **êµµê²Œ** ë“±)
- ëª¨ë“  í…ìŠ¤íŠ¸ëŠ” HTML íƒœê·¸ë¡œ ê°ì‹¸ì„œ ì¶œë ¥
`;

  const ai = getAiClient();
  const result = await ai.models.generateContent({
    model: 'gemini-3-pro-preview',
    contents: pressPrompt,
    config: {
    responseMimeType: "text/plain"
    }
  });
  let pressContent = result.text || '';
  
  // HTML ì •ë¦¬
  pressContent = pressContent
    .replace(/```html?\n?/gi, '')
    .replace(/```\n?/gi, '')
    .trim();
  
  // press-release-containerê°€ ì—†ìœ¼ë©´ ê°ì‹¸ê¸°
  if (!pressContent.includes('class="press-release-container"')) {
    pressContent = `<div class="press-release-container">${pressContent}</div>`;
  }
  
  // CSS ìŠ¤íƒ€ì¼ ì¶”ê°€
  const pressStyles = `
<style>
.press-release-container {
  font-family: 'Pretendard', -apple-system, sans-serif;
  max-width: 800px;
  margin: 0 auto;
  padding: 40px;
  background: #fff;
  line-height: 1.8;
  color: #333;
}
.press-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-bottom: 20px;
  border-bottom: 2px solid #1a1a1a;
  margin-bottom: 30px;
}
.press-date {
  font-size: 14px;
  color: #666;
  margin: 0;
}
.press-embargo {
  font-size: 12px;
  color: #fff;
  background: #7c3aed;
  padding: 4px 12px;
  border-radius: 4px;
  font-weight: 600;
  margin: 0;
}
.press-title {
  font-size: 28px;
  font-weight: 800;
  color: #1a1a1a;
  margin: 0 0 12px 0;
  line-height: 1.4;
}
.press-subtitle {
  font-size: 18px;
  font-weight: 500;
  color: #555;
  margin: 0 0 30px 0;
  padding-bottom: 20px;
  border-bottom: 1px solid #eee;
}
.press-lead {
  background: #f8f9fa;
  padding: 20px 24px;
  border-left: 4px solid #7c3aed;
  margin-bottom: 30px;
  border-radius: 0 8px 8px 0;
}
.press-lead p {
  margin: 0;
  font-size: 16px;
  font-weight: 500;
  color: #333;
}
.press-body h3 {
  font-size: 18px;
  font-weight: 700;
  color: #1a1a1a;
  margin: 30px 0 15px 0;
}
.press-body p {
  font-size: 15px;
  color: #444;
  margin: 0 0 15px 0;
}
.press-body ul {
  margin: 15px 0;
  padding-left: 24px;
}
.press-body li {
  font-size: 15px;
  color: #444;
  margin: 8px 0;
}
.press-quote {
  background: linear-gradient(135deg, #f5f3ff 0%, #ede9fe 100%);
  padding: 24px 28px;
  border-radius: 12px;
  margin: 20px 0;
  border: none;
}
.press-quote p {
  font-size: 16px;
  font-style: italic;
  color: #4c1d95;
  margin: 0 0 12px 0;
  font-weight: 500;
}
.press-quote cite {
  font-size: 14px;
  color: #6b7280;
  font-style: normal;
  font-weight: 600;
}
.press-footer {
  margin-top: 40px;
  padding-top: 30px;
  border-top: 2px solid #1a1a1a;
}
.press-contact {
  background: #f8f9fa;
  padding: 20px;
  border-radius: 8px;
  margin-bottom: 20px;
}
.press-contact h4 {
  font-size: 14px;
  font-weight: 700;
  color: #1a1a1a;
  margin: 0 0 10px 0;
}
.press-contact p {
  font-size: 14px;
  color: #666;
  margin: 4px 0;
}
.press-disclaimer {
  background: #fff3cd;
  padding: 16px 20px;
  border-radius: 8px;
  border: 1px solid #ffc107;
}
.press-disclaimer p {
  font-size: 12px;
  color: #856404;
  margin: 4px 0;
}
</style>
`;

  const finalHtml = pressStyles + pressContent;
  
  // ì œëª© ì¶”ì¶œ
  const titleMatch = pressContent.match(/<h1[^>]*class="press-title"[^>]*>([^<]+)/);
  const title = titleMatch ? titleMatch[1].trim() : `${hospitalName} ${pressTypeLabel} ë³´ë„ìžë£Œ`;
  
  onProgress('âœ… ë³´ë„ìžë£Œ ìž‘ì„± ì™„ë£Œ!');
  
  return {
    title,
    htmlContent: finalHtml,
    imageUrl: '',
    fullHtml: finalHtml,
    tags: [hospitalName, request.category, pressTypeLabel, request.topic],
    factCheck: {
    fact_score: 90,
    safety_score: 95,
    conversion_score: 70,
    ai_smell_score: 12, // ë³´ë„ìžë£Œ ê¸°ë³¸ê°’ - ê²½ê³„ì„  ìˆ˜ì¤€
    verified_facts_count: 5,
    issues: [],
    recommendations: ['ë³´ë„ ì „ ë²•ë¬´íŒ€ ê²€í†  ê¶Œìž¥', 'ì¸ìš© í†µê³„ ì¶œì²˜ í™•ì¸ í•„ìš”', 'AI ëƒ„ìƒˆ ì ìˆ˜ í™•ì¸ - ë¬¸ìž¥ íŒ¨í„´ ë‹¤ì–‘í™” ê¶Œìž¥']
    },
    postType: 'press_release'
  };
};

export const generateFullPost = async (request: GenerationRequest, onProgress?: (msg: string) => void): Promise<GeneratedContent> => {
  // onProgressê°€ ì—†ìœ¼ë©´ ì½˜ì†” ë¡œê·¸ë¡œ ëŒ€ì²´
  const safeProgress = onProgress || ((msg: string) => console.log('ðŸ“ Progress:', msg));
  
  const isCardNews = request.postType === 'card_news';
  const isPressRelease = request.postType === 'press_release';
  
  // â€¢ ë””ë²„ê·¸: requestì— customImagePromptê°€ ìžˆëŠ”ì§€ í™•ì¸
  console.log('â€¢ generateFullPost ì‹œìž‘ - request.imageStyle:', request.imageStyle);
  console.log('â€¢ generateFullPost ì‹œìž‘ - request.customImagePrompt:', request.customImagePrompt ? request.customImagePrompt.substring(0, 50) : 'undefined/ì—†ìŒ');
  
  // ðŸ—žï¸ ë³´ë„ìžë£Œ: ì „ìš© ìƒì„± í•¨ìˆ˜ ì‚¬ìš©
  if (isPressRelease) {
    return generatePressRelease(request, safeProgress);
  }
  
  // ðŸ¤– ì¹´ë“œë‰´ìŠ¤: ë¯¸ë‹ˆ ì—ì´ì „íŠ¸ ë°©ì‹ ì‚¬ìš©
  if (isCardNews) {
    safeProgress('ðŸ¤– ë¯¸ë‹ˆ ì—ì´ì „íŠ¸ ë°©ì‹ìœ¼ë¡œ ì¹´ë“œë‰´ìŠ¤ ìƒì„± ì‹œìž‘...');
    
    try {
    // ë¯¸ë‹ˆ ì—ì´ì „íŠ¸ë¡œ ìŠ¤í† ë¦¬ ê¸°íš + HTML ì¡°ë¦½ + ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ ìƒì„±
    const agentResult = await generateCardNewsWithAgents(request, safeProgress);
    
    // ì´ë¯¸ì§€ ìƒì„±
    const styleName = STYLE_NAMES[request.imageStyle] || STYLE_NAMES.illustration;
    safeProgress(`ðŸŽ¨ ${styleName} ìŠ¤íƒ€ì¼ë¡œ 4:3 ì´ë¯¸ì§€ ìƒì„± ì¤‘...`);
    
    // ðŸŽ¨ ì´ë¯¸ì§€ = ì¹´ë“œ ì „ì²´! (í…ìŠ¤íŠ¸ê°€ ì´ë¯¸ì§€ ì•ˆì— í¬í•¨ëœ ì™„ì„±í˜•)
    const maxImages = request.slideCount || 6;
    safeProgress(`ðŸŽ¨ ${maxImages}ìž¥ì˜ ì™„ì„±í˜• ì¹´ë“œ ì´ë¯¸ì§€ ìƒì„± ì¤‘...`);
    
    // ì°¸ê³  ì´ë¯¸ì§€ ì„¤ì • (í‘œì§€ ë˜ëŠ” ë³¸ë¬¸ ìŠ¤íƒ€ì¼ ì´ë¯¸ì§€)
    const referenceImage = request.coverStyleImage || request.contentStyleImage;
    const copyMode = request.styleCopyMode; // true=ë ˆì´ì•„ì›ƒ ë³µì œ, false=ëŠë‚Œë§Œ ì°¸ê³ 

    // imagePromptsê°€ ì—†ìœ¼ë©´ ë¹ˆ ë°°ì—´ë¡œ ì´ˆê¸°í™”
    if (!agentResult.imagePrompts || !Array.isArray(agentResult.imagePrompts)) {
      agentResult.imagePrompts = [];
    }

    // â€¢ ë””ë²„ê·¸: imagePrompts ë‚´ìš© í™•ì¸
    if (agentResult.imagePrompts.length > 0) {
      console.log('ðŸŽ¨ ì²« ìƒì„± imagePrompts:', agentResult.imagePrompts.map((p, i) => ({ index: i, promptHead: p.substring(0, 200) })));
    }

    // ìˆœì°¨ ìƒì„±ìœ¼ë¡œ ì§„í–‰ë¥  í‘œì‹œ
    const images: { index: number; data: string; prompt: string }[] = [];
    for (let i = 0; i < Math.min(maxImages, agentResult.imagePrompts.length); i++) {
      safeProgress(`ðŸŽ¨ ì¹´ë“œ ì´ë¯¸ì§€ ${i + 1}/${maxImages}ìž¥ ìƒì„± ì¤‘...`);
      const img = await generateSingleImage(
        agentResult.imagePrompts[i], 
        request.imageStyle, 
        "1:1", 
        request.customImagePrompt, 
        referenceImage, 
        copyMode
      );
      images.push({ index: i + 1, data: img, prompt: agentResult.imagePrompts[i] });
    }
    
    // ì´ë¯¸ì§€ ìžì²´ê°€ ì¹´ë“œ ì „ì²´! (HTML í…ìŠ¤íŠ¸ ì—†ì´ ì´ë¯¸ì§€ë§Œ)
    // ðŸš¨ alt ì†ì„±ì—ë„ ì½”ë“œ ë¬¸ìžì—´ì´ ë“¤ì–´ê°€ì§€ ì•Šë„ë¡ í•„í„°ë§!
    const cleanAltText = (text: string) => text
      .replace(/[A-Za-z0-9+/=_-]{10,}/g, '')
      .replace(/[a-zA-Z0-9]{5,}\/[a-zA-Z0-9/]+/g, '')
      .replace(/[^\uAC00-\uD7AFê°€-íž£a-zA-Z0-9\s.,!?~():\-]+/g, '')
      .replace(/\s+/g, ' ')
      .trim()
      .substring(0, 100); // alt í…ìŠ¤íŠ¸ ê¸¸ì´ ì œí•œ
    
    const cardSlides = images.map((img, idx) => {
      if (img.data) {
        return `
          <div class="card-slide" style="border-radius: 24px; overflow: hidden; aspect-ratio: 1/1; box-shadow: 0 4px 16px rgba(0,0,0,0.08);">
            <img src="${img.data}" alt="${cleanAltText(img.prompt)}" data-index="${img.index}" class="card-full-img" style="width: 100%; height: 100%; object-fit: cover;" />
          </div>`;
      }
      return '';
    }).filter(Boolean).join('\n');
    
    const finalHtml = `
      <div class="card-news-container">
        <h2 class="hidden-title">${agentResult.title}</h2>
        <div class="card-grid-wrapper">
          ${cardSlides}
        </div>
        <div class="legal-box-card">${MEDICAL_DISCLAIMER}</div>
      </div>
    `.trim();
    
    safeProgress('âœ… ì¹´ë“œë‰´ìŠ¤ ìƒì„± ì™„ë£Œ!');
    
    return {
      title: agentResult.title,
      htmlContent: finalHtml,
      imageUrl: images[0]?.data || "",
      fullHtml: finalHtml,
      tags: [],
      factCheck: {
        fact_score: 85,
        safety_score: 90,
        conversion_score: 80,
        verified_facts_count: 5,
        issues: [],
        recommendations: []
      },
      postType: 'card_news',
      imageStyle: request.imageStyle,
      customImagePrompt: request.customImagePrompt, // ì»¤ìŠ¤í…€ ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ ì €ìž¥ (ìž¬ìƒì„±ìš©)
      cardPrompts: agentResult.cardPrompts // ìž¬ìƒì„±ìš© í”„ë¡¬í”„íŠ¸ ë°ì´í„°
    };
    } catch (error) {
    console.error('ë¯¸ë‹ˆ ì—ì´ì „íŠ¸ ë°©ì‹ ì‹¤íŒ¨, ê¸°ì¡´ ë°©ì‹ìœ¼ë¡œ í´ë°±:', error);
    safeProgress('âš ï¸ ë¯¸ë‹ˆ ì—ì´ì „íŠ¸ ì‹¤íŒ¨, ê¸°ì¡´ ë°©ì‹ìœ¼ë¡œ ìž¬ì‹œë„...');
    // ê¸°ì¡´ ë°©ì‹ìœ¼ë¡œ í´ë°± (ì•„ëž˜ ì½”ë“œë¡œ ê³„ì†)
    }
  }
  
  // ðŸ“ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ ë˜ëŠ” ì¹´ë“œë‰´ìŠ¤ í´ë°±: ê¸°ì¡´ ë°©ì‹ ì‚¬ìš©
  const hasStyleRef = request.postType === 'card_news' && (request.coverStyleImage || request.contentStyleImage);
  if (hasStyleRef) {
    if (request.coverStyleImage && request.contentStyleImage) {
    safeProgress('ðŸŽ¨ í‘œì§€/ë³¸ë¬¸ ìŠ¤íƒ€ì¼ ë¶„ì„ ì¤‘...');
    } else if (request.coverStyleImage) {
    safeProgress('ðŸŽ¨ í‘œì§€ ìŠ¤íƒ€ì¼ ë¶„ì„ ì¤‘ (ë³¸ë¬¸ë„ ë™ì¼ ì ìš©)...');
    } else {
    safeProgress('ðŸŽ¨ ë³¸ë¬¸ ìŠ¤íƒ€ì¼ ë¶„ì„ ì¤‘...');
    }
  }
  
  const step1Msg = hasStyleRef
    ? `ì°¸ê³  ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼ë¡œ ì¹´ë“œë‰´ìŠ¤ ìƒì„± ì¤‘...`
    : request.referenceUrl 
    ? `ðŸ”— ë ˆí¼ëŸ°ìŠ¤ URL ë¶„ì„ ë° ${request.postType === 'card_news' ? 'ì¹´ë“œë‰´ìŠ¤ í…œí”Œë¦¿ ëª¨ë°©' : 'ìŠ¤íƒ€ì¼ ë²¤ì¹˜ë§ˆí‚¹'} ì¤‘...` 
    : `ë„¤ì´ë²„ ë¡œì§ ë¶„ì„ ë° ${request.postType === 'card_news' ? 'ì¹´ë“œë‰´ìŠ¤ ê¸°íš' : 'ë¸”ë¡œê·¸ ì›ê³  ìž‘ì„±'} ì¤‘...`;
  
  safeProgress(step1Msg);
  
  const textData = await generateBlogPostText(request, safeProgress);
  
  const styleName = STYLE_NAMES[request.imageStyle] || STYLE_NAMES.illustration;
  const imgRatio = request.postType === 'card_news' ? "4:3" : "16:9";
  
  safeProgress(`ðŸŽ¨ ${styleName} ìŠ¤íƒ€ì¼ë¡œ ${imgRatio} ì´ë¯¸ì§€ ìƒì„± ì¤‘...`);
  
  const maxImages = request.postType === 'card_news' ? (request.slideCount || 6) : (request.imageCount ?? 1);
  
  // í´ë°± ë°©ì‹ì—ì„œë„ ì°¸ê³  ì´ë¯¸ì§€ ì „ë‹¬ (ë ˆì´ì•„ì›ƒ ìž¬ê°€ê³µ ì§€ì›)
  const fallbackReferenceImage = request.coverStyleImage || request.contentStyleImage;
  const fallbackCopyMode = request.styleCopyMode;
  
  // ðŸ–¼ï¸ ë¸”ë¡œê·¸ vs ì¹´ë“œë‰´ìŠ¤ ì´ë¯¸ì§€ ìƒì„± ë¶„ê¸°
  // ë¸”ë¡œê·¸: generateBlogImage (í…ìŠ¤íŠ¸ ì—†ëŠ” ìˆœìˆ˜ ì´ë¯¸ì§€, 16:9)
  // ì¹´ë“œë‰´ìŠ¤: generateSingleImage (í…ìŠ¤íŠ¸ í¬í•¨, ë¸Œë¼ìš°ì € í”„ë ˆìž„, 1:1)
  // âš ï¸ ì´ë¯¸ì§€ 0ìž¥ì´ë©´ ìƒì„± ìŠ¤í‚µ
  let images: { index: number; data: string; prompt: string }[] = [];

  // imagePromptsê°€ ì—†ìœ¼ë©´ ë¹ˆ ë°°ì—´ë¡œ ì´ˆê¸°í™” (imageCountê°€ 0ì¼ ë•Œ AIê°€ ìƒëžµí•  ìˆ˜ ìžˆìŒ)
  if (!textData.imagePrompts || !Array.isArray(textData.imagePrompts)) {
    textData.imagePrompts = [];
  }

  if (maxImages > 0 && textData.imagePrompts.length > 0) {
    // ìˆœì°¨ ìƒì„±ìœ¼ë¡œ ì§„í–‰ë¥  í‘œì‹œ
    for (let i = 0; i < Math.min(maxImages, textData.imagePrompts.length); i++) {
      safeProgress(`ðŸŽ¨ ì´ë¯¸ì§€ ${i + 1}/${maxImages}ìž¥ ìƒì„± ì¤‘...`);
      const p = textData.imagePrompts[i];
      let img: string;
      
      if (request.postType === 'card_news') {
        // ì¹´ë“œë‰´ìŠ¤: ê¸°ì¡´ í•¨ìˆ˜ ì‚¬ìš© (í…ìŠ¤íŠ¸ í¬í•¨, ë¸Œë¼ìš°ì € í”„ë ˆìž„)
        img = await generateSingleImage(p, request.imageStyle, imgRatio, request.customImagePrompt, fallbackReferenceImage, fallbackCopyMode);
      } else {
        // ë¸”ë¡œê·¸: ìƒˆ í•¨ìˆ˜ ì‚¬ìš© (í…ìŠ¤íŠ¸ ì—†ëŠ” ìˆœìˆ˜ ì´ë¯¸ì§€)
        img = await generateBlogImage(p, request.imageStyle, imgRatio, request.customImagePrompt);
      }
      
      images.push({ index: i + 1, data: img, prompt: p });
    }
  } else {
    console.log('ðŸ–¼ï¸ ì´ë¯¸ì§€ 0ìž¥ ì„¤ì • - ì´ë¯¸ì§€ ìƒì„± ìŠ¤í‚µ');
    safeProgress('ðŸ“ ì´ë¯¸ì§€ ì—†ì´ í…ìŠ¤íŠ¸ë§Œ ìƒì„± ì™„ë£Œ');
  }

  // ðŸ”§ content ë˜ëŠ” contentHtml í•„ë“œ ë‘˜ ë‹¤ ì§€ì›
  let body = textData.content || textData.contentHtml || '';
  
  // ë°©ì–´ ì½”ë“œ: bodyê°€ ì—†ìœ¼ë©´ ì—ëŸ¬
  if (!body || body.trim() === '') {
    console.error('âŒ textData.content/contentHtml ë‘˜ ë‹¤ ë¹„ì–´ìžˆìŠµë‹ˆë‹¤:', textData);
    console.error('   - ì‚¬ìš© ê°€ëŠ¥í•œ í•„ë“œ:', Object.keys(textData));
    throw new Error('AIê°€ ì½˜í…ì¸ ë¥¼ ìƒì„±í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
  }
  
  // bodyê°€ HTMLì´ ì•„ë‹Œ JSON/ë°°ì—´ í˜•íƒœì¸ì§€ ê²€ì¦
  if (body && (body.startsWith('[{') || body.startsWith('{"'))) {
    console.error('AI returned JSON instead of HTML, attempting to extract...');
    try {
    const parsed = JSON.parse(body);
    if (Array.isArray(parsed)) {
      body = parsed.map(item => item.content || item.html || '').join('');
    } else if (parsed.content || parsed.html) {
      body = parsed.content || parsed.html;
    }
    } catch (e) {
    console.error('Failed to parse JSON content:', e);
    }
  }
  
  // AIê°€ classë¥¼ ë¹¼ë¨¹ì—ˆì„ ê²½ìš° ê°•ì œë¡œ ê°ì‹¸ê¸°
  if (request.postType !== 'card_news' && !body.includes('class="naver-post-container"')) {
    body = `<div class="naver-post-container">${body}</div>`;
  }
  
  // ðŸš¨ ì¹´ë“œë‰´ìŠ¤ì¸ë° card-slideê°€ ì—†ìœ¼ë©´ AIê°€ HTML êµ¬ì¡°ë¥¼ ì™„ì „ížˆ ë¬´ì‹œí•œ ê²ƒ!
  // ì´ ê²½ìš° ê¸°ë³¸ ì¹´ë“œë‰´ìŠ¤ í…œí”Œë¦¿ìœ¼ë¡œ ê°•ì œ ìƒì„±
  if (request.postType === 'card_news' && !body.includes('class="card-slide"')) {
    console.warn('AI ignored card-slide structure, generating fallback template...');
    const slideCount = request.slideCount || 6;
    const fallbackSlides: string[] = [];
    
    // bodyì—ì„œ í…ìŠ¤íŠ¸ ì¶”ì¶œ ì‹œë„
    const plainText = body.replace(/<[^>]*>/g, ' ').replace(/\s+/g, ' ').trim();
    const sentences = plainText.split(/[.!?ã€‚]/).filter(s => s.trim().length > 5);
    
    for (let i = 0; i < slideCount; i++) {
    const isFirst = i === 0;
    const isLast = i === slideCount - 1;
    const sentenceIdx = Math.min(i, sentences.length - 1);
    const sentence = sentences[sentenceIdx] || request.topic;
    
    let subtitle = isFirst ? 'ì•Œì•„ë³´ìž!' : isLast ? 'í•¨ê»˜ ì‹¤ì²œí•´ìš”' : `í¬ì¸íŠ¸ ${i}`;
    let mainTitle = isFirst 
      ? `${request.topic}<br/><span class="card-highlight">ì´ì •ë¦¬</span>`
      : isLast 
      ? `ê±´ê°•í•œ ìŠµê´€<br/><span class="card-highlight">ì‹œìž‘í•´ìš”!</span>`
      : sentence.slice(0, 15) + (sentence.length > 15 ? '...' : '');
    let desc = sentence.slice(0, 50) || 'ê±´ê°•í•œ ìƒí™œì„ ìœ„í•œ ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”.';
    
    fallbackSlides.push(`
      <div class="card-slide" style="background: linear-gradient(180deg, #E8F4FD 0%, #F0F9FF 100%); border-radius: 24px; overflow: hidden;">
        <div style="padding: 32px 28px; display: flex; flex-direction: column; align-items: center; text-align: center; height: 100%;">
          <p class="card-subtitle" style="font-size: 14px; font-weight: 700; color: #3B82F6; margin-bottom: 8px;">${subtitle}</p>
          <p class="card-main-title" style="font-size: 28px; font-weight: 900; color: #1E293B; line-height: 1.3; margin: 0 0 16px 0;">${mainTitle}</p>
          <div class="card-img-container" style="width: 100%; margin: 16px 0;">[IMG_${i + 1}]</div>
          <p class="card-desc" style="font-size: 15px; color: #475569; line-height: 1.6; font-weight: 500; max-width: 90%;">${desc}</p>
        </div>
      </div>
    `);
    }
    body = fallbackSlides.join('\n');
  }
  
  images.forEach(img => {
    const pattern = new RegExp(`\\[IMG_${img.index}\\]`, "gi");
    if (img.data) {
    let imgHtml = "";
    if (request.postType === 'card_news') {
        imgHtml = `<img src="${img.data}" alt="${img.prompt}" data-index="${img.index}" class="card-full-img" style="width: 100%; height: auto; display: block;" />`;
    } else {
        imgHtml = `<div class="content-image-wrapper"><img src="${img.data}" alt="${img.prompt}" data-index="${img.index}" /></div>`;
    }
    body = body.replace(pattern, imgHtml);
    } else {
    // ì´ë¯¸ì§€ ìƒì„± ì‹¤íŒ¨ ì‹œ ë§ˆì»¤ ì œê±°
    body = body.replace(pattern, '');
    }
  });
  
  // í˜¹ì‹œ ë‚¨ì•„ìžˆëŠ” [IMG_N] ë§ˆì»¤ ëª¨ë‘ ì œê±°
  body = body.replace(/\[IMG_\d+\]/gi, '');

  // ì¹´ë“œë‰´ìŠ¤: ë¶„ì„ëœ ìŠ¤íƒ€ì¼ ë°°ê²½ìƒ‰ ê°•ì œ ì ìš© (AIê°€ ë¬´ì‹œí•  ê²½ìš° ëŒ€ë¹„)
  if (request.postType === 'card_news' && textData.analyzedStyle?.backgroundColor) {
    const bgColor = textData.analyzedStyle.backgroundColor;
    const bgGradient = bgColor.includes('gradient') ? bgColor : `linear-gradient(180deg, ${bgColor} 0%, ${bgColor}dd 100%)`;
    // ê¸°ì¡´ card-slideì˜ background ìŠ¤íƒ€ì¼ì„ ë¶„ì„ëœ ìƒ‰ìƒìœ¼ë¡œ êµì²´
    body = body.replace(
    /(<div[^>]*class="[^"]*card-slide[^"]*"[^>]*style="[^"]*)background:[^;]*;?/gi,
    `$1background: ${bgGradient};`
    );
    // ë§Œì•½ background ìŠ¤íƒ€ì¼ì´ ì—†ëŠ” card-slideê°€ ìžˆë‹¤ë©´ ì¶”ê°€
    body = body.replace(
    /<div([^>]*)class="([^"]*card-slide[^"]*)"([^>]*)>/gi,
    (match, pre, cls, post) => {
      if (match.includes('style="')) {
        // ì´ë¯¸ styleì´ ìžˆì§€ë§Œ backgroundê°€ ì—†ìœ¼ë©´ ì¶”ê°€
        if (!match.includes('background:')) {
          return match.replace('style="', `style="background: ${bgGradient}; `);
        }
        return match;
      } else {
        // styleì´ ì—†ìœ¼ë©´ ì¶”ê°€
        return `<div${pre}class="${cls}"${post} style="background: ${bgGradient};">`;
      }
    }
    );
    safeProgress(`ðŸŽ¨ í…œí”Œë¦¿ ìƒ‰ìƒ(${bgColor}) ì ìš© ì™„ë£Œ`);
  }

  let finalHtml = "";
  if (request.postType === 'card_news') {
    finalHtml = `
    <div class="card-news-container">
       <h2 class="hidden-title">${textData.title}</h2>
       <div class="card-grid-wrapper">
          ${body}
       </div>
       <div class="legal-box-card">${MEDICAL_DISCLAIMER}</div>
    </div>
    `.trim();
  } else {
    // ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸: ë§¨ ìœ„ì— ë©”ì¸ ì œëª©(h2) ì¶”ê°€ (ì¤‘ë³µ ë°©ì§€)
    const mainTitle = request.topic || textData.title;
    
    // ì´ë¯¸ main-titleì´ ìžˆëŠ”ì§€ í™•ì¸
    const hasMainTitle = body.includes('class="main-title"') || body.includes('class=\'main-title\'');
    
    if (hasMainTitle) {
      // ì´ë¯¸ ì œëª©ì´ ìžˆìœ¼ë©´ ê·¸ëŒ€ë¡œ ì‚¬ìš©
      if (body.includes('class="naver-post-container"')) {
        finalHtml = body;
      } else {
        finalHtml = `<div class="naver-post-container">${body}</div>`;
      }
    } else {
      // ì œëª©ì´ ì—†ìœ¼ë©´ ì¶”ê°€
      if (body.includes('class="naver-post-container"')) {
        finalHtml = body.replace(
          '<div class="naver-post-container">',
          `<div class="naver-post-container"><h2 class="main-title">${mainTitle}</h2>`
        );
      } else {
        finalHtml = `<div class="naver-post-container"><h2 class="main-title">${mainTitle}</h2>${body}</div>`;
      }
    }
  }

  // ============================================
  // ðŸŽ¯ SEO ì ìˆ˜ëŠ” generateWithAgentModeì—ì„œ ì´ë¯¸ í‰ê°€ë¨
  // ì—¬ê¸°ì„œëŠ” textData.seoScoreë¥¼ ì‚¬ìš© (ì¤‘ë³µ í‰ê°€ ë°©ì§€)
  // ============================================
  let seoScore: SeoScoreReport | undefined = textData.seoScore;
  
  // ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ì¸ ê²½ìš° SEO ì ìˆ˜ í™•ì¸ (ì´ë¯¸ í‰ê°€ëœ ê²½ìš° ìŠ¤í‚µ)
  if (request.postType === 'blog') {
    if (seoScore) {
    // ì´ë¯¸ generateWithAgentModeì—ì„œ SEO í‰ê°€ê°€ ì™„ë£Œë¨
    console.log('ðŸ“Š ì´ë¯¸ í‰ê°€ëœ SEO ì ìˆ˜ ì‚¬ìš©:', seoScore.total);
    if (seoScore.total >= 85) {
      safeProgress(`âœ… SEO ì ìˆ˜ ${seoScore.total}ì `);
    } else {
      safeProgress(`â„¹ï¸ SEO ì ìˆ˜ ${seoScore.total}ì `);
    }
    }
    
    // ============================================
    // ðŸ¤– AI ëƒ„ìƒˆ ì ìˆ˜ ì²´í¬ + 16ì  ì´ìƒ ìžë™ ìž¬ìƒì„±
    // ============================================
    const aiSmellScore = textData.fact_check?.ai_smell_score || 0;
    const MAX_AI_SMELL_SCORE = 15;
    
    if (aiSmellScore > MAX_AI_SMELL_SCORE) {
    console.log(`ðŸ¤– AI ëƒ„ìƒˆ ì ìˆ˜ ${aiSmellScore}ì  > 15ì , ìžë™ ê°œì„  ì‹œë„`);
    safeProgress(`ðŸ¤– AI ëƒ„ìƒˆ ì ìˆ˜ ${aiSmellScore}ì  (15ì  ì´ˆê³¼) - ìžë™ ê°œì„  ì¤‘...`);
    
    try {
      const aiSmellImprovementPrompt = `
ë‹¹ì‹ ì€ AI ëƒ„ìƒˆë¥¼ ì œê±°í•˜ëŠ” ì „ë¬¸ê°€ìž…ë‹ˆë‹¤.
ì•„ëž˜ ë¸”ë¡œê·¸ ê¸€ì˜ AI ëƒ„ìƒˆ ì ìˆ˜ê°€ ${aiSmellScore}ì ìž…ë‹ˆë‹¤. 15ì  ì´í•˜ë¡œ ì¤„ì—¬ì£¼ì„¸ìš”.

[í˜„ìž¬ ë³¸ë¬¸]
${finalHtml.substring(0, 6000)}

[AI ëƒ„ìƒˆ ì œê±° í•µì‹¬ ê·œì¹™]
1. "~ìˆ˜ ìžˆìŠµë‹ˆë‹¤" ì—°ì† 2íšŒ ì´ìƒ ë‚˜ì˜¤ë©´ í•˜ë‚˜ë¥¼ "~ì¸ ê²½ìš°ë„ ìžˆìŠµë‹ˆë‹¤", "~ë¡œ ì´ì–´ì§€ê¸°ë„ í•©ë‹ˆë‹¤"ë¡œ ë³€ê²½
2. ê° ë¬¸ë‹¨ì— ê´€ì°°ìž ì‹œì  ë¬¸ìž¥ 1ê°œ ì¶”ê°€ ("ì´ëŸ° ë¶„ë“¤ì´ ë§Žë”ë¼ê³ ìš”", "ë³‘ì›ì—ì„œ ìžì£¼ ë“£ëŠ” ì´ì•¼ê¸°ì˜ˆìš”")
3. ì²« ë¬¸ìž¥ì€ ì •ì˜ê°€ ì•„ë‹Œ ìƒí™© ë¬˜ì‚¬ë¡œ ì‹œìž‘ ("ê¼­ ë§Žì´ ë¨¹ì§€ ì•Šì•˜ëŠ”ë°ë„...")
4. ë§ˆì§€ë§‰ ë¬¸ìž¥ ëœ êµê³¼ì„œì ìœ¼ë¡œ ("ì›ì¸ì„ í™•ì¸í•´ë‘ë©´ ì´í›„ ê´€ë¦¬ê°€ ìˆ˜ì›”í•´ì ¸ìš”")
5. ë¬¸ë‹¨ë§ˆë‹¤ ê¸°ëŠ¥ì´ ë„ˆë¬´ ëª…í™•í•˜ë©´ íë¦„ìœ¼ë¡œ ì—°ê²° ("ê·¸ëŸ°ë° ë§ì´ì£ ", "ì‚¬ì‹¤ ì—¬ê¸°ì„œ ì¤‘ìš”í•œ ê±´")
6. ì§§ì€ ë¬¸ìž¥ ì¤‘ê°„ì— ì‚½ìž… ("ì†”ì§ížˆ ì• ë§¤í•˜ì£ .", "ê·¼ë°ìš”.")

[ì¶œë ¥ í˜•ì‹ - JSON]
{
  "improved_body": "ê°œì„ ëœ ë³¸ë¬¸ HTML (naver-post-container í´ëž˜ìŠ¤ ìœ ì§€)",
  "changes_made": ["ë³€ê²½í•œ ë‚´ìš© 1", "ë³€ê²½í•œ ë‚´ìš© 2", ...]
}`;
      
      const improvedAiText = await callOpenAI(aiSmellImprovementPrompt, 'AI ëƒ„ìƒˆ ì œê±° ì „ë¬¸ê°€ë¡œì„œ ì‚¬ëžŒì´ ì“´ ê²ƒì²˜ëŸ¼ ìžì—°ìŠ¤ëŸ½ê²Œ ê°œì„ í•´ì£¼ì„¸ìš”.');
      
      let improvedAiData;
      try {
        const jsonMatch = improvedAiText.match(/\{[\s\S]*\}/);
        improvedAiData = jsonMatch ? JSON.parse(jsonMatch[0]) : null;
      } catch {
        console.warn('AI ëƒ„ìƒˆ ê°œì„  ì‘ë‹µ JSON íŒŒì‹± ì‹¤íŒ¨');
      }
      
      if (improvedAiData?.improved_body) {
        const improvedMainTitle = request.topic || textData.title;
        if (improvedAiData.improved_body.includes('class="naver-post-container"')) {
          finalHtml = improvedAiData.improved_body.replace(
            '<div class="naver-post-container">',
            `<div class="naver-post-container"><h2 class="main-title">${improvedMainTitle}</h2>`
          );
        } else {
          finalHtml = `<div class="naver-post-container"><h2 class="main-title">${improvedMainTitle}</h2>${improvedAiData.improved_body}</div>`;
        }
        
        // fact_checkì˜ ai_smell_score ì—…ë°ì´íŠ¸ (ì¶”ì •ê°’)
        if (textData.fact_check) {
          textData.fact_check.ai_smell_score = Math.max(0, aiSmellScore - 10);
        }
        
        console.log('âœ… AI ëƒ„ìƒˆ ê°œì„  ì™„ë£Œ:', improvedAiData.changes_made);
        safeProgress(`âœ… AI ëƒ„ìƒˆ ê°œì„  ì™„ë£Œ (${improvedAiData.changes_made?.length || 0}ê°œ í•­ëª© ìˆ˜ì •)`);
      }
      
    } catch (aiSmellError) {
      console.error('AI ëƒ„ìƒˆ ê°œì„  ì‹¤íŒ¨:', aiSmellError);
      safeProgress('âš ï¸ AI ëƒ„ìƒˆ ê°œì„  ì‹¤íŒ¨, í˜„ìž¬ ê²°ê³¼ ìœ ì§€');
    }
    } else if (aiSmellScore >= 8 && aiSmellScore <= 15) {
    // ============================================
    // â€¢ 8~15ì  ê²½ê³„ì„ : ìˆ˜ì • ìœ„ì¹˜ ìƒì„¸ ë¶„ì„
    // ============================================
    console.log(`âš ï¸ AI ëƒ„ìƒˆ ì ìˆ˜ ${aiSmellScore}ì  - ê²½ê³„ì„  (8~15ì ), ìˆ˜ì • ìœ„ì¹˜ ë¶„ì„ ì¤‘...`);
    safeProgress(`âš ï¸ AI ëƒ„ìƒˆ ì ìˆ˜ ${aiSmellScore}ì  - ê²½ê³„ì„ ! ìˆ˜ì • í•„ìš” ìœ„ì¹˜ë¥¼ ë¶„ì„í•©ë‹ˆë‹¤...`);
    
    try {
      const aiSmellAnalysis = await analyzeAiSmell(finalHtml, request.topic);
      
      // fact_checkì— ìƒì„¸ ë¶„ì„ ê²°ê³¼ ì¶”ê°€
      if (textData.fact_check) {
        textData.fact_check.ai_smell_analysis = aiSmellAnalysis;
      }
      
      // ìš°ì„  ìˆ˜ì • í•­ëª© ì¶œë ¥
      const topIssues = aiSmellAnalysis.priority_fixes?.slice(0, 3) || [];
      console.log('â€¢ AI ëƒ„ìƒˆ ìˆ˜ì • í•„ìš” ìœ„ì¹˜:', topIssues);
      
      if (topIssues.length > 0) {
        safeProgress(`â€¢ ìˆ˜ì • í•„ìš” ìœ„ì¹˜ ë°œê²¬! ìƒì„¸ ë¶„ì„ ì™„ë£Œ`);
        console.log('ðŸ“‹ ìƒì„¸ ë¶„ì„ ê²°ê³¼:', {
          total_score: aiSmellAnalysis.total_score,
          sentence_rhythm: aiSmellAnalysis.sentence_rhythm?.score,
          judgment_avoidance: aiSmellAnalysis.judgment_avoidance?.score,
          lack_of_realism: aiSmellAnalysis.lack_of_realism?.score,
          template_structure: aiSmellAnalysis.template_structure?.score,
          fake_empathy: aiSmellAnalysis.fake_empathy?.score,
          cta_failure: aiSmellAnalysis.cta_failure?.score
        });
      }
      
      safeProgress(`âœ… AI ëƒ„ìƒˆ ì ìˆ˜ ${aiSmellScore}ì  - ë¶€ë¶„ ìˆ˜ì • í›„ ë°œí–‰ ê°€ëŠ¥`);
      
    } catch (analysisError) {
      console.error('AI ëƒ„ìƒˆ ìƒì„¸ ë¶„ì„ ì‹¤íŒ¨:', analysisError);
      safeProgress(`âœ… AI ëƒ„ìƒˆ ì ìˆ˜ ${aiSmellScore}ì  - ê²½ê³„ì„  (ë¶€ë¶„ ìˆ˜ì • ê¶Œìž¥)`);
    }
    
    } else {
    console.log(`âœ… AI ëƒ„ìƒˆ ì ìˆ˜ ${aiSmellScore}ì  - ê¸°ì¤€ ì¶©ì¡± (7ì  ì´í•˜)`);
    safeProgress(`âœ… AI ëƒ„ìƒˆ ì ìˆ˜ ${aiSmellScore}ì  - ì‚¬ëžŒ ê¸€ íŒì •! ðŸŽ‰`);
    }
  }

  // ë””ë²„ê¹…: ë°˜í™˜ ë°ì´í„° í™•ì¸
  console.log('â€¢ generateFullPost ë°˜í™˜ ë°ì´í„°:');
  console.log('  - textData.fact_check:', textData.fact_check);
  console.log('  - seoScore:', seoScore);
  
  // ìµœì¢… ì™„ë£Œ ë©”ì‹œì§€
  safeProgress('âœ… ëª¨ë“  ìƒì„± ìž‘ì—… ì™„ë£Œ!');
  
  return {
    title: textData.title,
    htmlContent: finalHtml,
    imageUrl: images[0]?.data || "",
    fullHtml: finalHtml,
    tags: [],
    factCheck: textData.fact_check,
    postType: request.postType,
    imageStyle: request.imageStyle,
    customImagePrompt: request.customImagePrompt, // ì»¤ìŠ¤í…€ ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ ì €ìž¥ (ìž¬ìƒì„±ìš©)
    seoScore // SEO ì ìˆ˜ ìžë™ í¬í•¨
  };
};

// ì¹´ë“œë‰´ìŠ¤ ê°œë³„ ìŠ¬ë¼ì´ë“œ ìž¬ìƒì„± í•¨ìˆ˜
export const regenerateCardSlide = async (
  cardIndex: number,
  currentCardHtml: string,
  userInstruction: string,
  context: {
    topic: string;
    category: string;
    totalSlides: number;
    prevCardContent?: string;
    nextCardContent?: string;
    imageStyle?: ImageStyle;
  }
): Promise<{ newCardHtml: string; newImagePrompt: string; message: string }> => {
  const ai = getAiClient();
  
  const slidePosition = cardIndex === 0 
    ? 'í‘œì§€ (1ìž¥)' 
    : cardIndex === context.totalSlides - 1 
    ? 'ë§ˆë¬´ë¦¬ (ë§ˆì§€ë§‰ ìž¥)' 
    : `ë³¸ë¬¸ (${cardIndex + 1}ìž¥)`;
  
  const imageStyleGuide = STYLE_KEYWORDS[context.imageStyle] || STYLE_KEYWORDS.illustration;
  
  // í˜„ìž¬ HTMLì—ì„œ ì´ë¯¸ì§€ë¥¼ ë§ˆì»¤ë¡œ êµì²´ (ê¸°ì¡´ ì´ë¯¸ì§€ ì œê±°)
  const cleanedHtml = currentCardHtml
    .replace(/<img[^>]*class="card-inner-img"[^>]*>/gi, `[IMG_${cardIndex + 1}]`)
    .replace(/<img[^>]*>/gi, `[IMG_${cardIndex + 1}]`);
  
  const prompt = `
ë‹¹ì‹ ì€ ì¹´ë“œë‰´ìŠ¤ ìŠ¬ë¼ì´ë“œë¥¼ ìž¬ìƒì„±í•˜ëŠ” ì „ë¬¸ê°€ìž…ë‹ˆë‹¤.

[í˜„ìž¬ ìŠ¬ë¼ì´ë“œ ì •ë³´]
- ìœ„ì¹˜: ${slidePosition} (ì´ ${context.totalSlides}ìž¥ ì¤‘ ${cardIndex + 1}ë²ˆì§¸)
- ì£¼ì œ: ${context.topic}
- ì§„ë£Œê³¼: ${context.category}

[í˜„ìž¬ ìŠ¬ë¼ì´ë“œ HTML - í…ìŠ¤íŠ¸ë§Œ ì°¸ê³ ]
${cleanedHtml}

${context.prevCardContent ? `[ì´ì „ ìŠ¬ë¼ì´ë“œ ë‚´ìš©]\n${context.prevCardContent}` : ''}
${context.nextCardContent ? `[ë‹¤ìŒ ìŠ¬ë¼ì´ë“œ ë‚´ìš©]\n${context.nextCardContent}` : ''}

[ì‚¬ìš©ìž ìš”ì²­]
${userInstruction}

[ì¤‘ìš”]
[ðŸš¨ í•„ìˆ˜ ìž‘ì„± ê·œì¹™] 
[ì¤‘ìš”]
1. card-slide êµ¬ì¡°ë¥¼ ìœ ì§€í•˜ì„¸ìš”
2. card-main-titleì€ 12ìž ì´ë‚´, card-subtitleì€ 8ìž ì´ë‚´
3. âš ï¸ ì´ë¯¸ì§€ ì˜ì—­ì€ ë°˜ë“œì‹œ [IMG_${cardIndex + 1}] í…ìŠ¤íŠ¸ ë§ˆì»¤ë§Œ ì‚¬ìš©! (img íƒœê·¸ ê¸ˆì§€!)
4. ì´ì „/ë‹¤ìŒ ìŠ¬ë¼ì´ë“œì™€ ë‚´ìš©ì´ ìžì—°ìŠ¤ëŸ½ê²Œ ì—°ê²°ë˜ì–´ì•¼ í•©ë‹ˆë‹¤
5. ${slidePosition === 'í‘œì§€ (1ìž¥)' ? 'ì£¼ì œ ì†Œê°œ + í¥ë¯¸ ìœ ë°œ ë¬¸êµ¬' : slidePosition === 'ë§ˆë¬´ë¦¬ (ë§ˆì§€ë§‰ ìž¥)' ? 'í–‰ë™ ìœ ë„ + ê°ì„±ì  ë§ˆë¬´ë¦¬' : 'êµ¬ì²´ì ì¸ ì •ë³´/ë°©ë²• ì œì‹œ'}

âš ï¸ ì¤‘ìš”: newCardHtmlì— <img> íƒœê·¸ ë„£ì§€ ë§ˆì„¸ìš”! [IMG_${cardIndex + 1}] ë§ˆì»¤ë§Œ!
ì˜ˆì‹œ: <div class="card-img-container">[IMG_${cardIndex + 1}]</div>

[ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ ê·œì¹™]
- ë°˜ë“œì‹œ í•œêµ­ì–´ë¡œ ìž‘ì„±
- ìŠ¤íƒ€ì¼: ${imageStyleGuide}
- 1:1 ì •ì‚¬ê°í˜• ì¹´ë“œë‰´ìŠ¤ í˜•ì‹
- ë¡œê³ /ì›Œí„°ë§ˆí¬/í•´ì‹œíƒœê·¸ ê¸ˆì§€

JSON í˜•ì‹ìœ¼ë¡œ ë‹µë³€:
{
  "newCardHtml": "<div class=\"card-slide\">...[IMG_${cardIndex + 1}]...</div>",
  "newImagePrompt": "1:1 ì •ì‚¬ê°í˜• ì¹´ë“œë‰´ìŠ¤, í•œêµ­ì–´ ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸...",
  "message": "ìˆ˜ì • ì™„ë£Œ ë©”ì‹œì§€"
}
`;

  try {
    const response = await ai.models.generateContent({
      model: 'gemini-3-pro-preview',
      contents: prompt,
      config: {
        responseMimeType: "application/json",
        responseSchema: {
          type: Type.OBJECT,
          properties: {
            newCardHtml: { type: Type.STRING },
            newImagePrompt: { type: Type.STRING },
            message: { type: Type.STRING }
          },
          required: ["newCardHtml", "newImagePrompt", "message"]
        }
      }
    });
    
    return JSON.parse(response.text || "{}");
  } catch (error) {
    console.error('ì¹´ë“œ ìž¬ìƒì„± ì‹¤íŒ¨:', error);
    throw error;
  }
};

// AI ìž¬ìƒì„± ëª¨ë“œ íƒ€ìž…
export type SlideRegenMode = 
  | 'rewrite'      // ðŸ”„ ì™„ì „ ìƒˆë¡œ ì“°ê¸°
  | 'strengthen'   // ðŸ’ª ì „í™˜ë ¥ ê°•í™”
  | 'simplify'     // âœ‚ï¸ ë” ê°„ê²°í•˜ê²Œ
  | 'empathy'      // ðŸ’• ê³µê° ê°•í™”
  | 'professional'; // ì „ë¬¸ì„± ê°•í™”

// ì›ê³  ë‹¨ê³„ì—ì„œ ê°œë³„ ìŠ¬ë¼ì´ë“œ ë‚´ìš© AI ìž¬ìƒì„±
export const regenerateSlideContent = async (params: {
  slideIndex: number;
  slideType: string;
  topic: string;
  category: string;
  totalSlides: number;
  currentContent: {
    subtitle: string;
    mainTitle: string;
    description: string;
    imageKeyword: string;
  };
  prevSlide?: { mainTitle: string; description: string };
  nextSlide?: { mainTitle: string; description: string };
  mode?: SlideRegenMode;  // ìž¬ìƒì„± ëª¨ë“œ ì¶”ê°€
}): Promise<{
  subtitle: string;
  mainTitle: string;
  description: string;
  speakingNote: string;
  imageKeyword: string;
}> => {
  const ai = getAiClient();
  
  const slidePosition = params.slideIndex === 0 
    ? 'í‘œì§€ (ì²« ë²ˆì§¸)' 
    : params.slideIndex === params.totalSlides - 1 
    ? 'ë§ˆë¬´ë¦¬ (ë§ˆì§€ë§‰)' 
    : `ë³¸ë¬¸ (${params.slideIndex + 1}ë²ˆì§¸)`;
  
  const slideTypeGuide = params.slideType === 'cover' 
    ? 'í‘œì§€: ë©ˆì¶”ê²Œ í•˜ëŠ” ì—­í• ! ì„¤ëª… ìµœì†Œí™”, ì§ˆë¬¸í˜•ìœ¼ë¡œ í¥ë¯¸ ìœ ë°œ'
    : params.slideType === 'closing'
    ? 'CTA: âŒëª…ë ¹í˜• ê¸ˆì§€! "~ì‹œì ìž…ë‹ˆë‹¤" í˜•íƒœë¡œ ê°„ì ‘ ìœ ë„'
    : params.slideType === 'concept'
    ? 'ì˜¤í•´ ê¹¨ê¸°: ì°©ê°ì„ ë°”ë¡œìž¡ëŠ” ì§ˆë¬¸í˜• ë©”ì‹œì§€'
    : 'ë³¸ë¬¸: íŒë‹¨ 1ì¤„ë§Œ! ì„¤ëª… ê¸ˆì§€!';
  
  // ëª¨ë“œë³„ ì¶”ê°€ ì§€ì¹¨
  const mode = params.mode || 'rewrite';
  const modeInstruction = {
    rewrite: `
[ðŸ”„ ì™„ì „ ìƒˆë¡œ ì“°ê¸° ëª¨ë“œ]
- í˜„ìž¬ ë‚´ìš©ì„ ì°¸ê³ í•˜ë˜, ì™„ì „ížˆ ìƒˆë¡œìš´ ê´€ì ìœ¼ë¡œ ë‹¤ì‹œ ìž‘ì„±
- ê°™ì€ ì£¼ì œë¥¼ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ì ‘ê·¼
- ì‹ ì„ í•œ í‘œí˜„ê³¼ êµ¬ì„±ìœ¼ë¡œ ìž¬íƒ„ìƒ`,
    strengthen: `
[ðŸ’ª ì „í™˜ë ¥ ê°•í™” ëª¨ë“œ]
- í˜„ìž¬ ë‚´ìš©ì˜ í•µì‹¬ì€ ìœ ì§€í•˜ë˜ ì „í™˜ë ¥(í–‰ë™ ìœ ë„ë ¥) ê·¹ëŒ€í™”
- "~ì‹œì ìž…ë‹ˆë‹¤", "~ë‹¨ê³„ìž…ë‹ˆë‹¤" í˜•íƒœë¡œ ì‹œì  ê³ ì •
- ë°°ì œí˜• í‘œí˜„ ê°•í™”: "~ë§Œìœ¼ë¡œëŠ” ë¶€ì¡±í•©ë‹ˆë‹¤", "~ê°€ ì•„ë‹ˆë¼ ~ê°€ ë¨¼ì €ìž…ë‹ˆë‹¤"
- ì„¤ëª… âŒ â†’ íŒë‹¨ âœ… ë³€í™˜
- CTA í•µì‹¬: "ì˜¤ì„¸ìš”"ê°€ ì•„ë‹ˆë¼ "ë‹¤ë¥¸ ì„ íƒì§€ê°€ ì•„ë‹ˆë‹¤"ë¥¼ ë§Œë“œëŠ” ê²ƒ`,
    simplify: `
[âœ‚ï¸ ë” ê°„ê²°í•˜ê²Œ ëª¨ë“œ]
- í˜„ìž¬ ë‚´ìš©ì„ ìµœëŒ€í•œ ì••ì¶•
- subtitle: 4~6ìžë¡œ ë” ì§§ê²Œ
- mainTitle: 10~12ìžë¡œ ë” ì§§ê²Œ
- description: 15~20ìž íŒë‹¨ 1ì¤„ë¡œ ì••ì¶•
- ë¶ˆí•„ìš”í•œ ìˆ˜ì‹ì–´, ì„¤ëª… ëª¨ë‘ ì œê±°
- í•µì‹¬ ë©”ì‹œì§€ë§Œ ë‚¨ê¸°ê¸°`,
    empathy: `
[ðŸ’• ê³µê° ê°•í™” ëª¨ë“œ]
- í˜„ìž¬ ë‚´ìš©ì— ë…ìž ê³µê° ìš”ì†Œ ì¶”ê°€
- ì¼ìƒ ìƒí™© ë¬˜ì‚¬ ì¶”ê°€ (ì˜ˆ: "ê²¨ìš¸ ì•„ì¹¨", "ì¶œê·¼ê¸¸")
- ë…ìžì˜ ê°ì •/ê³ ë¯¼ì„ ë‹´ì€ í‘œí˜„ ì‚¬ìš©
- "í˜¹ì‹œ ë‚˜ë„?", "ì´ëŸ° ì  ìžˆìœ¼ì‹œì£ ?" ê°™ì€ ê³µê° ìœ ë„
- ì˜í•™ ì •ë³´ë¥¼ ì¹œê·¼í•˜ê²Œ ì „ë‹¬`,
    professional: `
[ì „ë¬¸ì„± ê°•í™” ëª¨ë“œ]
- í˜„ìž¬ ë‚´ìš©ì— ì˜í•™ì  ì‹ ë¢°ê° ì¶”ê°€
- ê°€ì´ë“œë¼ì¸/ê¶Œìž¥ì‚¬í•­ ì–¸ê¸‰ (ì˜ˆ: "ëŒ€í•œOOí•™íšŒì—ì„œ ê¶Œìž¥")
- ê°ê´€ì ì´ê³  ê¶Œìœ„ìžˆëŠ” í†¤
- ì „ë¬¸ ìš©ì–´ + ì‰¬ìš´ ì„¤ëª… ë³‘ê¸°
- "~ì¸ ê²ƒìœ¼ë¡œ ì•Œë ¤ì ¸ ìžˆìŠµë‹ˆë‹¤" í˜•íƒœì˜ ì™„ì¶© í‘œí˜„`
  }[mode];
  
  const prompt = `
ë‹¹ì‹ ì€ **ì „í™˜í˜• ì¹´ë“œë‰´ìŠ¤** ì›ê³  ìž‘ì„± ì „ë¬¸ê°€ìž…ë‹ˆë‹¤.

ðŸš¨ í•µì‹¬ ì›ì¹™:
âŒ ë¸”ë¡œê·¸ = "ì½ê³  ì´í•´"
âœ… ì¹´ë“œë‰´ìŠ¤ = "ë³´ê³  íŒë‹¨" (3ì´ˆ ì•ˆì—!)

[ìŠ¬ë¼ì´ë“œ ì •ë³´]
- ìœ„ì¹˜: ${slidePosition} (ì´ ${params.totalSlides}ìž¥)
- íƒ€ìž…: ${params.slideType} â†’ ${slideTypeGuide}
- ì£¼ì œ: ${params.topic}
- ì§„ë£Œê³¼: ${params.category}

[í˜„ìž¬ ë‚´ìš© - ë” ê°„ê²°í•˜ê²Œ ìˆ˜ì •!]
ë¶€ì œ: ${params.currentContent.subtitle}
ë©”ì¸ì œëª©: ${params.currentContent.mainTitle}
ì„¤ëª…: ${params.currentContent.description}
ì´ë¯¸ì§€í‚¤ì›Œë“œ: ${params.currentContent.imageKeyword}

${params.prevSlide ? `[ì´ì „ ìŠ¬ë¼ì´ë“œ]\nì œëª©: ${params.prevSlide.mainTitle}` : ''}
${params.nextSlide ? `[ë‹¤ìŒ ìŠ¬ë¼ì´ë“œ]\nì œëª©: ${params.nextSlide.mainTitle}` : ''}

${modeInstruction}

[ðŸ“ ì¹´ë“œë‰´ìŠ¤ í…ìŠ¤íŠ¸ ê·œì¹™]
- subtitle: 4~8ìžë§Œ! (ì˜ˆ: "ê²¨ìš¸ì² ì— ìœ ë…?", "í˜¹ì‹œ ë‚˜ë„?", "ë†“ì¹˜ê¸° ì‰¬ìš´ ì‹ í˜¸ë“¤")
- mainTitle: 10~18ìž, ì§ˆë¬¸í˜• ë˜ëŠ” íŒë‹¨í˜•, <highlight>ê°•ì¡°</highlight>
  âœ… "ë”°ëœ»í•˜ê²Œ ìž…ì–´ë„\\n<highlight>í•´ê²° ì•ˆ ë˜ëŠ”</highlight> ì‹ í˜¸"
  âŒ "ìƒí™œ ê´€ë¦¬ë§Œìœ¼ë¡œ ì¶©ë¶„í• ê¹Œìš”?" (ë„ˆë¬´ ì¼ë°˜ì )
- description: íŒë‹¨ 1ì¤„ë§Œ! (15~25ìž)
  âœ… "í”¼ë¡œë‚˜ ìŠ¤íŠ¸ë ˆìŠ¤ì™€ êµ¬ë¶„ì´ í•„ìš”í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤"
  âŒ 2~3ë¬¸ìž¥ ì„¤ëª… ê¸ˆì§€!
- imageKeyword: í•œêµ­ì–´ í‚¤ì›Œë“œ (ì˜ˆ: "ê²¨ìš¸ì²  ë¹™íŒê¸¸, ë„˜ì–´ì§€ëŠ” ì‚¬ëžŒ, ì–¼ìŒ")

[ðŸš¨ ì˜ë£Œê´‘ê³ ë²• + ì¹´ë“œë‰´ìŠ¤ ê·œì¹™]
âŒ "~í•˜ì„¸ìš”" ëª…ë ¹í˜• ê¸ˆì§€!
âŒ "ì²´í¬", "ê²€ì‚¬ ë°›ìœ¼ì„¸ìš”" ê¸ˆì§€!
âŒ ê¸´ ì„¤ëª… ë¬¸ìž¥ ê¸ˆì§€!
âœ… "~ì‹œì ìž…ë‹ˆë‹¤", "~í•„ìš”í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤"

JSON í˜•ì‹:
{
  "subtitle": "4~8ìž",
  "mainTitle": "10~18ìž <highlight>ê°•ì¡°</highlight>",
  "description": "íŒë‹¨ 1ì¤„ (15~25ìž)",
  "speakingNote": "ì´ ìŠ¬ë¼ì´ë“œì˜ ì‹¬ë¦¬ì  ì—­í• ",
  "imageKeyword": "í•œêµ­ì–´ í‚¤ì›Œë“œ 3~4ê°œ"
}
`;

  try {
    const response = await ai.models.generateContent({
      model: 'gemini-3-pro-preview',
      contents: prompt,
      config: {
        responseMimeType: "application/json",
        responseSchema: {
          type: Type.OBJECT,
          properties: {
            subtitle: { type: Type.STRING },
            mainTitle: { type: Type.STRING },
            description: { type: Type.STRING },
            speakingNote: { type: Type.STRING },
            imageKeyword: { type: Type.STRING }
          },
          required: ["subtitle", "mainTitle", "description", "speakingNote", "imageKeyword"]
        }
      }
    });
    
    return JSON.parse(response.text || "{}");
  } catch (error) {
    console.error('ìŠ¬ë¼ì´ë“œ ì›ê³  ìž¬ìƒì„± ì‹¤íŒ¨:', error);
    throw error;
  }
};

export const modifyPostWithAI = async (currentHtml: string, userInstruction: string): Promise<{ 
  newHtml: string, 
  message: string, 
  regenerateImageIndices?: number[],
  newImagePrompts?: string[]
}> => {
    const ai = getAiClient();
    
    // ì´ë¯¸ì§€ URLì„ í”Œë ˆì´ìŠ¤í™€ë”ë¡œ ëŒ€ì²´ (í† í° ì´ˆê³¼ ë°©ì§€)
    // base64 ì´ë¯¸ì§€ë‚˜ ê¸´ URLì„ ì§§ì€ í”Œë ˆì´ìŠ¤í™€ë”ë¡œ ë³€í™˜
    const imageMap: Map<string, string> = new Map();
    let imgCounter = 0;
    
    const sanitizedHtml = currentHtml.replace(
      /<img([^>]*?)src=["']([^"']+)["']([^>]*)>/gi,
      (match, before, src, after) => {
        // ì´ë¯¸ í”Œë ˆì´ìŠ¤í™€ë”ì¸ ê²½ìš° ìŠ¤í‚µ
        if (src.startsWith('__IMG_PLACEHOLDER_')) {
          return match;
        }
        const placeholder = `__IMG_PLACEHOLDER_${imgCounter}__`;
        imageMap.set(placeholder, src);
        imgCounter++;
        return `<img${before}src="${placeholder}"${after}>`;
      }
    );
    
    try {
      const response = await ai.models.generateContent({
        model: "gemini-3-pro-preview",  // ê³ í’ˆì§ˆ ê¸€ì“°ê¸°ìš© pro ëª¨ë¸
        contents: `${MEDICAL_SAFETY_SYSTEM_PROMPT}\n[í˜„ìž¬ ì›ê³ ] ${sanitizedHtml}\n[ìˆ˜ì • ìš”ì²­] ${userInstruction}\nì˜ë£Œë²• ì¤€ìˆ˜ í•„ìˆ˜. ì´ë¯¸ì§€ srcëŠ” __IMG_PLACEHOLDER_N__ í˜•ì‹ìœ¼ë¡œ ìœ ì§€í•˜ì„¸ìš”.`,
        config: { 
          responseMimeType: "application/json", 
          responseSchema: { 
            type: Type.OBJECT, 
            properties: { 
              newHtml: { type: Type.STRING }, 
              message: { type: Type.STRING },
              regenerateImageIndices: { type: Type.ARRAY, items: { type: Type.NUMBER } },
              newImagePrompts: { type: Type.ARRAY, items: { type: Type.STRING } }
            }, 
            required: ["newHtml", "message"] 
          } 
        }
      });
      
      const result = JSON.parse(response.text || "{}");
      
      // í”Œë ˆì´ìŠ¤í™€ë”ë¥¼ ì›ëž˜ ì´ë¯¸ì§€ URLë¡œ ë³µì›
      let restoredHtml = result.newHtml;
      imageMap.forEach((originalSrc, placeholder) => {
        restoredHtml = restoredHtml.replace(new RegExp(placeholder, 'g'), originalSrc);
      });
      
      return {
        ...result,
        newHtml: restoredHtml
      };
    } catch (error) { throw error; }
};

// ============================================
// ðŸŽ¯ SEO ì ìˆ˜ í‰ê°€ í•¨ìˆ˜ (100ì  ë§Œì )
// ============================================

/**
 * SEO ì ìˆ˜ í‰ê°€ í•¨ìˆ˜
 * ë¸”ë¡œê·¸ ì½˜í…ì¸ ì˜ SEO ìµœì í™” ìˆ˜ì¤€ì„ 100ì  ë§Œì ìœ¼ë¡œ í‰ê°€
 * 
 * í‰ê°€ í•­ëª©:
 * â‘  ì œëª© ìµœì í™” (25ì )
 * â‘¡ ë³¸ë¬¸ í‚¤ì›Œë“œ êµ¬ì¡° (25ì )
 * â‘¢ ì‚¬ìš©ìž ì²´ë¥˜ êµ¬ì¡° (20ì )
 * â‘£ ì˜ë£Œë²• ì•ˆì „ì„± + ì‹ ë¢° ì‹ í˜¸ (20ì )
 * â‘¤ ì „í™˜ ì—°ê²°ì„± (10ì )
 * 
 * 85ì  ë¯¸ë§Œ: ìž¬ì„¤ê³„/ìž¬ìž‘ì„± ê¶Œìž¥
 */
export const evaluateSeoScore = async (
  htmlContent: string,
  title: string,
  topic: string,
  keywords: string
): Promise<SeoScoreReport> => {
  const ai = getAiClient();
  const currentYear = getCurrentYear();
  
  // ë°©ì–´ ì½”ë“œ: í•„ìˆ˜ íŒŒë¼ë¯¸í„° ê²€ì¦
  if (!htmlContent || typeof htmlContent !== 'string') {
    console.error('âŒ evaluateSeoScore: content(HTML)ê°€ ì—†ê±°ë‚˜ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤');
    console.error('   - ì „ë‹¬ëœ íƒ€ìž…:', typeof htmlContent);
    console.error('   - ì „ë‹¬ëœ ê°’ ê¸¸ì´:', htmlContent?.length || 0);
    console.error('   - ì „ë‹¬ëœ ê°’ ë¯¸ë¦¬ë³´ê¸°:', String(htmlContent).substring(0, 100));
    console.error('   - title:', title?.substring(0, 50));
    console.error('   - topic:', topic?.substring(0, 50));
    throw new Error('SEO í‰ê°€ì— í•„ìš”í•œ HTML ì½˜í…ì¸ ê°€ ì—†ìŠµë‹ˆë‹¤. content ë˜ëŠ” contentHtml í•„ë“œë¥¼ í™•ì¸í•˜ì„¸ìš”.');
  }
  
  const safeHtmlContent = htmlContent || '';
  const safeTitle = title || 'ì œëª© ì—†ìŒ';
  const safeTopic = topic || 'ì£¼ì œ ì—†ìŒ';
  const safeKeywords = keywords || 'í‚¤ì›Œë“œ ì—†ìŒ';
  
  const prompt = `ë‹¹ì‹ ì€ ë„¤ì´ë²„ ë¸”ë¡œê·¸ SEO ì „ë¬¸ê°€ì´ìž ë³‘ì› ë§ˆì¼€íŒ… ì½˜í…ì¸  ë¶„ì„ê°€ìž…ë‹ˆë‹¤.

ì•„ëž˜ ë¸”ë¡œê·¸ ì½˜í…ì¸ ì˜ SEO ì ìˆ˜ë¥¼ 100ì  ë§Œì ìœ¼ë¡œ í‰ê°€í•´ì£¼ì„¸ìš”.

[ì¤‘ìš”]
ðŸ“Š SEO ì ìˆ˜ í‰ê°€ ê¸°ì¤€ (100ì  ë§Œì )
[ì¤‘ìš”]

[â€» í‰ê°€ ëŒ€ìƒ ì½˜í…ì¸ ]
- ì œëª©: "${safeTitle}"
- ì£¼ì œ: "${safeTopic}"
- í•µì‹¬ í‚¤ì›Œë“œ: "${safeKeywords}"
- ë³¸ë¬¸:
${safeHtmlContent.substring(0, 8000)}

---
â‘  ì œëª© ìµœì í™” (25ì  ë§Œì )
---
â€» keyword_natural (10ì ): í•µì‹¬ í‚¤ì›Œë“œ ìžì—° í¬í•¨
   - 10ì : í‚¤ì›Œë“œê°€ ì œëª© ì•ž 50%ì— ìžì—°ìŠ¤ëŸ½ê²Œ ë°°ì¹˜
   - 5ì : í‚¤ì›Œë“œ ìžˆìœ¼ë‚˜ ì–´ìƒ‰í•˜ê±°ë‚˜ ë’¤ìª½ì— ìœ„ì¹˜
   - 0ì : í‚¤ì›Œë“œ ì—†ìŒ ë˜ëŠ” ê°•ì œ ì‚½ìž… ëŠë‚Œ

â€» seasonality (5ì ): ì‹œê¸°ì„±/ìƒí™©ì„± í¬í•¨
   - 5ì : "ê²¨ìš¸ì² ", "ìš”ì¦˜", "í™˜ì ˆê¸°" ë“± ì‹œê¸° í‘œí˜„ í¬í•¨
   - 2ì : ì‹œê°„ì  ë§¥ë½ ì•”ì‹œë§Œ ìžˆìŒ
   - 0ì : ì‹œê¸°ì„± ì—†ëŠ” ì¼ë°˜ì ì¸ ì œëª©

â€» judgment_inducing (5ì ): íŒë‹¨ ìœ ë„í˜• êµ¬ì¡°
   - 5ì : "~ì¼ê¹Œìš”?", "~í™•ì¸ í¬ì¸íŠ¸" ë“± ë…ìž ì°¸ì—¬ ìœ ë„
   - 2ì : ì§ˆë¬¸í˜•ì´ì§€ë§Œ ì¼ë°˜ì 
   - 0ì : ë‹¨ìˆœ ì •ë³´ ë‚˜ì—´í˜•

â€» medical_law_safe (5ì ): ì˜ë£Œê´‘ê³  ë¦¬ìŠ¤í¬ ì—†ìŒ
   - 5ì : ì™„ì „ ì•ˆì „ (ì¹˜ë£Œ, ì™„ì¹˜, ìµœê³  ë“± ê¸ˆì§€ì–´ ì—†ìŒ)
   - 2ì : ê²½ë¯¸í•œ ë¦¬ìŠ¤í¬ (ì• ë§¤í•œ í‘œí˜„ í¬í•¨)
   - 0ì : ëª…ë°±í•œ ì˜ë£Œê´‘ê³ ë²• ìœ„ë°˜ í‘œí˜„

---
â‘¡ ë³¸ë¬¸ í‚¤ì›Œë“œ êµ¬ì¡° (25ì  ë§Œì )
---
â€» main_keyword_exposure (10ì ): ë©”ì¸ í‚¤ì›Œë“œ 3~5íšŒ ìžì—° ë…¸ì¶œ
   - 10ì : 1000ìžë‹¹ 15~25íšŒ ìˆ˜ì¤€ (1.5~2.5% ë°€ë„), ìžì—°ìŠ¤ëŸ¬ì›€
   - 5ì : í‚¤ì›Œë“œ ìžˆìœ¼ë‚˜ ë¹ˆë„ ë¶€ì¡± ë˜ëŠ” ê³¼ë‹¤
   - 0ì : í‚¤ì›Œë“œ ìŠ¤í„°í•‘ ë˜ëŠ” ì „í˜€ ì—†ìŒ

â€» related_keyword_spread (5ì ): ì—°ê´€ í‚¤ì›Œë“œ(LSI) ë¶„ì‚° ë°°ì¹˜
   - 5ì : ë™ì˜ì–´/ìœ ì‚¬ì–´ 3ê°œ ì´ìƒ ìžì—°ìŠ¤ëŸ½ê²Œ ë¶„ì‚°
   - 2ì : 1~2ê°œë§Œ ìžˆê±°ë‚˜ íŽ¸ì¤‘ë¨
   - 0ì : ì—°ê´€ í‚¤ì›Œë“œ ì „ë¬´

â€» subheading_variation (5ì ): ì†Œì œëª©ì— í‚¤ì›Œë“œ ë³€ì£¼ í¬í•¨
   - 5ì : ëª¨ë“  ì†Œì œëª©(H3)ì— í‚¤ì›Œë“œ ë˜ëŠ” ê´€ë ¨ì–´ í¬í•¨
   - 2ì : ì¼ë¶€ ì†Œì œëª©ì—ë§Œ í¬í•¨
   - 0ì : ì†Œì œëª©ì— í‚¤ì›Œë“œ ì—†ìŒ

â€» no_meaningless_repeat (5ì ): ì˜ë¯¸ ì—†ëŠ” ë°˜ë³µ ì—†ìŒ
   - 5ì : ë™ì¼ í‘œí˜„ì´ ë§¥ë½ ë‹¤ì–‘í•˜ê²Œ ì‚¬ìš©ë¨
   - 2ì : ì¼ë¶€ ê¸°ê³„ì  ë°˜ë³µ ì¡´ìž¬
   - 0ì : ê°™ì€ ë¬¸ìž¥/í‘œí˜„ ê³¼ë‹¤ ë°˜ë³µ

---
â‘¢ ì‚¬ìš©ìž ì²´ë¥˜ êµ¬ì¡° (20ì  ë§Œì )
---
â€» intro_problem_recognition (5ì ): ë„ìž…ë¶€ 5ì¤„ ì´ë‚´ ë¬¸ì œ ì¸ì‹
   - 5ì : ì²« 3ì¤„ ë‚´ ê³µê°/ì§ˆë¬¸ìœ¼ë¡œ ì‹œìž‘, ë¬¸ì œ ì œê¸° ëª…í™•
   - 2ì : ë„ìž…ë¶€ê°€ ìžˆìœ¼ë‚˜ ëŠ˜ì–´ì§
   - 0ì : "ì˜¤ëŠ˜ì€ ~ì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤" ë“± AI ë„ìž…ë¶€

â€» relatable_examples (5ì ): 'ë‚˜ ì–˜ê¸° ê°™ë‹¤' ìƒí™œ ì˜ˆì‹œ
   - 5ì : êµ¬ì²´ì  ìƒí™©/ì‹œê°„ëŒ€/ìž¥ì†Œ ë¬˜ì‚¬ 3ê°œ ì´ìƒ
   - 2ì : 1~2ê°œ ìžˆìœ¼ë‚˜ ì¼ë°˜ì 
   - 0ì : ìƒí™œ ì˜ˆì‹œ ì „ë¬´, ì„¤ëª…ë§Œ

â€» mid_engagement_points (5ì ): ì¤‘ê°„ ì´íƒˆ ë°©ì§€ í¬ì¸íŠ¸
   - 5ì : ì²´í¬ë¦¬ìŠ¤íŠ¸, ì§ˆë¬¸í˜• ì†Œì œëª©, "ë” ì•Œì•„ë³´ë©´" ë“± ì¡´ìž¬
   - 2ì : ì•½ê°„ì˜ ì°¸ì—¬ ìœ ë„
   - 0ì : ë‹¨ì¡°ë¡œìš´ ë‚˜ì—´ë§Œ

â€» no_info_overload (5ì ): ì •ë³´ ê³¼ë¶€í•˜ ì—†ìŒ
   - 5ì : 1,500~3,000ìž, í•µì‹¬ ì •ë³´ ë°€ë„ ë†’ìŒ
   - 2ì : ë„ˆë¬´ ê¸¸ê±°ë‚˜ ì‚°ë§Œí•¨
   - 0ì : ì •ë³´ ê³¼ë‹¤ë¡œ ì´íƒˆ ìœ ë°œ

---
â‘£ ì˜ë£Œë²• ì•ˆì „ì„± + ì‹ ë¢° ì‹ í˜¸ (20ì  ë§Œì )
---
â€» no_definitive_guarantee (5ì ): ë‹¨ì •Â·ë³´ìž¥ í‘œí˜„ ì—†ìŒ
   - 5ì : "~ì¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤", "~ê²½ìš°ë„ ìžˆìŠµë‹ˆë‹¤" ë“± ì™„í™” í‘œí˜„
   - 2ì : ì¼ë¶€ ë‹¨ì • í‘œí˜„ ì¡´ìž¬
   - 0ì : "ë°˜ë“œì‹œ", "í™•ì‹¤ížˆ", "100%" ë“± ë³´ìž¥ í‘œí˜„

â€» individual_difference (5ì ): ê°œì¸ì°¨/ìƒí™©ë³„ ì°¨ì´ ìžì—° ì–¸ê¸‰
   - 5ì : ê°œì¸ì°¨ ì–¸ê¸‰ 2íšŒ ì´ìƒ, ìžì—°ìŠ¤ëŸ¬ì›€
   - 2ì : 1íšŒ í˜•ì‹ì  ì–¸ê¸‰
   - 0ì : ê°œì¸ì°¨ ì–¸ê¸‰ ì—†ìŒ

â€» self_diagnosis_limit (5ì ): ìžê°€ì§„ë‹¨ í•œê³„ ëª…í™•í™”
   - 5ì : "ì¦ìƒë§Œìœ¼ë¡œ ë‹¨ì • ë¶ˆê°€" ë“± í•œê³„ ëª…í™•
   - 2ì : ì•”ì‹œë§Œ ìžˆìŒ
   - 0ì : ìžê°€ì§„ë‹¨ ìœ ë„í•˜ëŠ” ëŠë‚Œ

â€» minimal_direct_promo (5ì ): ë³‘ì› ì§ì ‘ í™ë³´ ìµœì†Œí™”
   - 5ì : ë³‘ì›ëª…/ì—°ë½ì²˜ ì—†ìŒ, ì¼ë°˜ì  ì•ˆë‚´ë§Œ
   - 2ì : ê°„ì ‘ì  í™ë³´ ëŠë‚Œ
   - 0ì : ì§ì ‘ì  ë³‘ì› í™ë³´

---
â‘¤ ì „í™˜ ì—°ê²°ì„± (10ì  ë§Œì )
---
â€» cta_flow_natural (5ì ): CTAê°€ ì •ë³´ íë¦„ì„ ëŠì§€ ì•ŠìŒ
   - 5ì : ê¸€ ë§¥ë½ì—ì„œ ìžì—°ìŠ¤ëŸ½ê²Œ í™•ì¸ í•„ìš”ì„± ë„ì¶œ
   - 2ì : CTA ìžˆìœ¼ë‚˜ ê°‘ìž‘ìŠ¤ëŸ¬ì›€
   - 0ì : "ë°©ë¬¸í•˜ì„¸ìš”", "ì˜ˆì•½í•˜ì„¸ìš”" ì§ì ‘ ê¶Œìœ 

â€» time_fixed_sentence (5ì ): ì‹œì  ê³ ì •í˜• ë¬¸ìž¥ ì¡´ìž¬
   - 5ì : "ì´ ì‹œì ë¶€í„°ëŠ”~", "ë°˜ë³µëœë‹¤ë©´~" ë“± ì‹œì  ê³ ì •
   - 2ì : ì•½í•œ ì‹œì  ì•”ì‹œ
   - 0ì : "ì–¸ì  ê°€", "ë‚˜ì¤‘ì—" ë“± ë¯¸ë£¨ê¸° í—ˆìš©

[ì¤‘ìš”]
âš ï¸ í‰ê°€ ì‹œ ì£¼ì˜ì‚¬í•­
[ì¤‘ìš”]

1. SEO ì ìˆ˜ëŠ” "ì™„ì„±ë„"ê°€ ì•„ë‹ˆë¼ "ë¹„êµ ì§€í‘œ"ë¡œ í™œìš©ë©ë‹ˆë‹¤
2. 85ì  ë¯¸ë§Œì€ ìž¬ì„¤ê³„/ìž¬ìž‘ì„±ì´ í•„ìš”í•œ ìˆ˜ì¤€ìž…ë‹ˆë‹¤
3. ê° í•­ëª©ë³„ë¡œ êµ¬ì²´ì ì¸ ê°œì„  í”¼ë“œë°±ì„ ë°˜ë“œì‹œ ìž‘ì„±í•˜ì„¸ìš”
4. ì˜ë£Œë²• ì•ˆì „ì„±ì€ ë‹¤ë¥¸ í•­ëª©ë³´ë‹¤ ì—„ê²©í•˜ê²Œ í‰ê°€í•˜ì„¸ìš”
5. í˜„ìž¬ ì‹œì (${currentYear}ë…„) ê¸°ì¤€ ë„¤ì´ë²„ SEO íŠ¸ë Œë“œ ë°˜ì˜

ê° í•­ëª©ì˜ feedbackì—ëŠ”:
- ìž˜ëœ ì  1ê°œ ì´ìƒ
- ê°œì„ ì´ í•„ìš”í•œ ì  1ê°œ ì´ìƒ
- êµ¬ì²´ì ì¸ ê°œì„  ë°©ë²• ì œì•ˆ

ðŸŽ¯ **improvement_suggestions í•„ìˆ˜ ìž‘ì„±!**
85ì  ì´ìƒ ë‹¬ì„±ì„ ìœ„í•œ êµ¬ì²´ì ì´ê³  ì‹¤í–‰ ê°€ëŠ¥í•œ ê°œì„  ì œì•ˆ 3~5ê°œë¥¼ ë°°ì—´ë¡œ ì œê³µí•´ì£¼ì„¸ìš”.
ì˜ˆì‹œ:
- "ì œëª© ì•žë¶€ë¶„ì— 'ê²¨ìš¸ì² ' ì‹œê¸° í‚¤ì›Œë“œ ì¶”ê°€"
- "ì²« ë¬¸ë‹¨ì— êµ¬ì²´ì ì¸ ìƒí™© ë¬˜ì‚¬ ì¶”ê°€ (ì˜ˆ: 'ì•„ì¹¨ì— ì¼ì–´ë‚¬ëŠ”ë°...')"
- "ì†Œì œëª© 3ê°œì— ë©”ì¸ í‚¤ì›Œë“œ 'ê°ê¸°' í¬í•¨ì‹œí‚¤ê¸°"

JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µí•´ì£¼ì„¸ìš”.`;

  try {
    const response = await ai.models.generateContent({
      model: 'gemini-3-pro-preview',
      contents: prompt,
      config: {
        responseMimeType: "application/json",
        responseSchema: {
          type: Type.OBJECT,
          properties: {
            total: { type: Type.INTEGER },
            title: {
              type: Type.OBJECT,
              properties: {
                score: { type: Type.INTEGER },
                keyword_natural: { type: Type.INTEGER },
                seasonality: { type: Type.INTEGER },
                judgment_inducing: { type: Type.INTEGER },
                medical_law_safe: { type: Type.INTEGER },
                feedback: { type: Type.STRING }
              },
              required: ["score", "keyword_natural", "seasonality", "judgment_inducing", "medical_law_safe", "feedback"]
            },
            keyword_structure: {
              type: Type.OBJECT,
              properties: {
                score: { type: Type.INTEGER },
                main_keyword_exposure: { type: Type.INTEGER },
                related_keyword_spread: { type: Type.INTEGER },
                subheading_variation: { type: Type.INTEGER },
                no_meaningless_repeat: { type: Type.INTEGER },
                feedback: { type: Type.STRING }
              },
              required: ["score", "main_keyword_exposure", "related_keyword_spread", "subheading_variation", "no_meaningless_repeat", "feedback"]
            },
            user_retention: {
              type: Type.OBJECT,
              properties: {
                score: { type: Type.INTEGER },
                intro_problem_recognition: { type: Type.INTEGER },
                relatable_examples: { type: Type.INTEGER },
                mid_engagement_points: { type: Type.INTEGER },
                no_info_overload: { type: Type.INTEGER },
                feedback: { type: Type.STRING }
              },
              required: ["score", "intro_problem_recognition", "relatable_examples", "mid_engagement_points", "no_info_overload", "feedback"]
            },
            medical_safety: {
              type: Type.OBJECT,
              properties: {
                score: { type: Type.INTEGER },
                no_definitive_guarantee: { type: Type.INTEGER },
                individual_difference: { type: Type.INTEGER },
                self_diagnosis_limit: { type: Type.INTEGER },
                minimal_direct_promo: { type: Type.INTEGER },
                feedback: { type: Type.STRING }
              },
              required: ["score", "no_definitive_guarantee", "individual_difference", "self_diagnosis_limit", "minimal_direct_promo", "feedback"]
            },
            conversion: {
              type: Type.OBJECT,
              properties: {
                score: { type: Type.INTEGER },
                cta_flow_natural: { type: Type.INTEGER },
                time_fixed_sentence: { type: Type.INTEGER },
                feedback: { type: Type.STRING }
              },
              required: ["score", "cta_flow_natural", "time_fixed_sentence", "feedback"]
            },
            improvement_suggestions: {
              type: Type.ARRAY,
              items: { type: Type.STRING },
              description: "85ì  ì´ìƒ ë‹¬ì„±ì„ ìœ„í•œ êµ¬ì²´ì ì¸ ê°œì„  ì œì•ˆ 3~5ê°œ"
            }
          },
          required: ["total", "title", "keyword_structure", "user_retention", "medical_safety", "conversion", "improvement_suggestions"]
        }
      }
    });
    
    const result = JSON.parse(response.text || "{}");
    
    // ì´ì  ê²€ì¦ ë° ìž¬ê³„ì‚°
    const calculatedTotal = 
      (result.title?.score || 0) +
      (result.keyword_structure?.score || 0) +
      (result.user_retention?.score || 0) +
      (result.medical_safety?.score || 0) +
      (result.conversion?.score || 0);
    
    result.total = calculatedTotal;
    
    console.log('ðŸ“Š SEO ì ìˆ˜ í‰ê°€ ì™„ë£Œ:', result.total, 'ì ');
    return result;
  } catch (error) {
    console.error('SEO ì ìˆ˜ í‰ê°€ ì‹¤íŒ¨:', error);
    // ì‹¤íŒ¨ ì‹œ ê¸°ë³¸ê°’ ë°˜í™˜
    return {
      total: 0,
      title: {
        score: 0,
        keyword_natural: 0,
        seasonality: 0,
        judgment_inducing: 0,
        medical_law_safe: 0,
        feedback: 'SEO í‰ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'
      },
      keyword_structure: {
        score: 0,
        main_keyword_exposure: 0,
        related_keyword_spread: 0,
        subheading_variation: 0,
        no_meaningless_repeat: 0,
        feedback: 'SEO í‰ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'
      },
      user_retention: {
        score: 0,
        intro_problem_recognition: 0,
        relatable_examples: 0,
        mid_engagement_points: 0,
        no_info_overload: 0,
        feedback: 'SEO í‰ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'
      },
      medical_safety: {
        score: 0,
        no_definitive_guarantee: 0,
        individual_difference: 0,
        self_diagnosis_limit: 0,
        minimal_direct_promo: 0,
        feedback: 'SEO í‰ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'
      },
      conversion: {
        score: 0,
        cta_flow_natural: 0,
        time_fixed_sentence: 0,
        feedback: 'SEO í‰ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'
      }
    };
  }
};

// ============================================
// ðŸ¤– AI ëƒ„ìƒˆ ìƒì„¸ ë¶„ì„ í•¨ìˆ˜ (8~15ì  êµ¬ê°„ ìˆ˜ì • ê°€ì´ë“œ)
// ============================================

/**
 * AI ëƒ„ìƒˆ ìƒì„¸ ë¶„ì„ í•¨ìˆ˜
 * 8~15ì  ê²½ê³„ì„  êµ¬ê°„ì—ì„œ ì–´ë””ë¥¼ ìˆ˜ì •í•´ì•¼ í•˜ëŠ”ì§€ êµ¬ì²´ì ìœ¼ë¡œ ì•Œë ¤ì¤Œ
 * 
 * ë¶„ì„ í•­ëª©:
 * â‘  ë¬¸ìž¥ ë¦¬ë“¬ ë‹¨ì¡°ë¡œì›€ (0~25ì )
 * â‘¡ íŒë‹¨ ë‹¨ì •í˜• ê¸€ì“°ê¸° (0~20ì )
 * â‘¢ í˜„ìž¥ê° ë¶€ìž¬ (0~20ì )
 * â‘£ í…œí”Œë¦¿ êµ¬ì¡° (0~15ì )
 * â‘¤ ê°€ì§œ ê³µê° (0~10ì )
 * â‘¥ í–‰ë™ ìœ ë„ ì‹¤íŒ¨ (0~10ì )
 */
export const analyzeAiSmell = async (
  htmlContent: string,
  topic: string
): Promise<{
  total_score: number;
  sentence_rhythm: { score: number; issues: string[]; fix_suggestions: string[] };
  judgment_avoidance: { score: number; issues: string[]; fix_suggestions: string[] };
  lack_of_realism: { score: number; issues: string[]; fix_suggestions: string[] };
  template_structure: { score: number; issues: string[]; fix_suggestions: string[] };
  fake_empathy: { score: number; issues: string[]; fix_suggestions: string[] };
  cta_failure: { score: number; issues: string[]; fix_suggestions: string[] };
  priority_fixes: string[];
}> => {
  const ai = getAiClient();
  const currentYear = new Date().getFullYear();
  
  const today = new Date();
  const todayStr = `${today.getFullYear()}ë…„ ${today.getMonth() + 1}ì›” ${today.getDate()}ì¼`;
  
  const prompt = `ë‹¹ì‹ ì€ AIê°€ ì“´ ê¸€ê³¼ ì‚¬ëžŒì´ ì“´ ê¸€ì„ êµ¬ë¶„í•˜ëŠ” ì „ë¬¸ê°€ìž…ë‹ˆë‹¤.

ðŸ“… **ì˜¤ëŠ˜ ë‚ ì§œ: ${todayStr}** (ì´ê²ƒì´ í˜„ìž¬ ì‹œì ìž…ë‹ˆë‹¤. ë¯¸ëž˜ê°€ ì•„ë‹™ë‹ˆë‹¤!)

ì•„ëž˜ ë¸”ë¡œê·¸ ê¸€ì˜ "AI ëƒ„ìƒˆ"ë¥¼ ë¶„ì„í•˜ê³ , ì–´ë””ë¥¼ ìˆ˜ì •í•´ì•¼ í•˜ëŠ”ì§€ êµ¬ì²´ì ìœ¼ë¡œ ì•Œë ¤ì£¼ì„¸ìš”.

[ë¶„ì„ ëŒ€ìƒ ê¸€]
ì£¼ì œ: "${topic}"
ë³¸ë¬¸:
${htmlContent.substring(0, 8000)}

[ì¤‘ìš”]
ðŸš¨ ì˜ë£Œê´‘ê³ ë²• ì¤€ìˆ˜ í•„ìˆ˜! - ìˆ˜ì • ì œì•ˆ ì‹œ ì ˆëŒ€ ìœ„ë°˜ ê¸ˆì§€! ðŸš¨
[ì¤‘ìš”]

**fix_suggestions ìž‘ì„± ì‹œ ë°˜ë“œì‹œ ì•„ëž˜ ê·œì¹™ì„ ì¤€ìˆ˜í•˜ì„¸ìš”:**

âŒ **ì ˆëŒ€ ê¸ˆì§€ í‘œí˜„ (ìˆ˜ì • ì œì•ˆì— í¬í•¨í•˜ë©´ ì•ˆ ë¨!):**
â€¢ "~ì´ë©´ OOë³‘ìž…ë‹ˆë‹¤", "~ì´ë©´ OOì´ ì•„ë‹™ë‹ˆë‹¤" â†’ ì§ˆë³‘ ë‹¨ì • ê¸ˆì§€!
â€¢ "ë°”ë¡œ OOê³¼ë¡œ ê°€ì„¸ìš”", "ë‹¹ìž¥ ë³‘ì› ê°€ì„¸ìš”" â†’ ì§ì ‘ì  ë³‘ì› ë°©ë¬¸ ê¶Œìœ  ê¸ˆì§€!
â€¢ "3ì¼ ì´ìƒì´ë©´ ë¹„ì—¼", "ì¼ì£¼ì¼ ë„˜ìœ¼ë©´ íë ´" â†’ ê¸°ê°„+ì§ˆë³‘ ë‹¨ì • ê¸ˆì§€!
â€¢ "í™•ì‹¤ížˆ ~ìž…ë‹ˆë‹¤", "ë°˜ë“œì‹œ ~í•´ì•¼ í•©ë‹ˆë‹¤" â†’ ë‹¨ì •ì  í‘œí˜„ ê¸ˆì§€!

âœ… **í—ˆìš©ë˜ëŠ” ëŒ€ì•ˆ í‘œí˜„:**
â€¢ "~ì¼ ê°€ëŠ¥ì„±ì´ ë†’ì•„ìš”" â†’ "ì´ëŸ° íŒ¨í„´ì´ ë°˜ë³µëœë‹¤ë©´ í™•ì¸ì´ í•„ìš”í•´ìš”"
â€¢ "ë°”ë¡œ ë³‘ì› ê°€ì„¸ìš”" â†’ "ì§€ì†ëœë‹¤ë©´ í™•ì¸ë°›ì•„ë³´ì‹œëŠ” ê²ƒë„ ë°©ë²•ì´ì—ìš”"
â€¢ "3ì¼ì´ë©´ ë¹„ì—¼" â†’ "ë©°ì¹ ì§¸ ì§€ì†ëœë‹¤ë©´ ë‹¤ë¥¸ ì›ì¸ì¼ ìˆ˜ë„ ìžˆì–´ìš”"
â€¢ "ë°˜ë“œì‹œ ~í•´ì•¼" â†’ "~í•´ë³´ì‹œëŠ” ê²ƒì´ ë„ì›€ì´ ë  ìˆ˜ ìžˆì–´ìš”"

[ì¤‘ìš”]
ðŸ¤– AI ëƒ„ìƒˆ ë¶„ì„ ê¸°ì¤€ (ì´ 100ì  - ë‚®ì„ìˆ˜ë¡ ì¢‹ìŒ!)
[ì¤‘ìš”]

---
â‘  ë¬¸ìž¥ ë¦¬ë“¬ ë‹¨ì¡°ë¡œì›€ (0~25ì ) â˜… ê°€ìž¥ ì¤‘ìš”
---
ì²´í¬ í¬ì¸íŠ¸:
â€¢ ë™ì¼ ì¢…ê²°ì–´ë¯¸ 3íšŒ ì´ìƒ ë°˜ë³µ ("~ìŠµë‹ˆë‹¤", "~ìžˆìŠµë‹ˆë‹¤" ì—°ì†) â†’ +7ì 
â€¢ ë¬¸ìž¥ ì‹œìž‘ íŒ¨í„´ 3íšŒ ì´ìƒ ë°˜ë³µ ("ìš”ì¦˜", "ë§Žì€ ë¶„ë“¤ì´" ë°˜ë³µ) â†’ +6ì 
â€¢ ë¬¸ë‹¨ ê¸¸ì´ê°€ ë„ˆë¬´ ê· ì¼í•¨ â†’ +6ì 
â€¢ ì§ˆë¬¸Â·ê°íƒ„Â·ì§§ì€ ë¬¸ìž¥ ì—†ì´ ì„¤ëª…ë§Œ ì—°ì† â†’ +6ì 
â€¢ 'ì„¤ëª… ë¬¸ë‹¨ + ë¶ˆë¦¿í¬ì¸íŠ¸ ë¦¬ìŠ¤íŠ¸' ê¸°ê³„ì  ë°˜ë³µ â†’ +5ì 
â€¢ ì¶œì²˜(ì‹¬í‰ì›, ì§ˆë³‘ì²­, ê³¼ê±° ì—°ë„ ë“±) ì–¸ê¸‰ìœ¼ë¡œ ë¬¸ë§¥ ëŠê¹€ â†’ +4ì 

**ìˆ˜ì • ë°©í–¥:**
âœ… ë¶ˆë¦¿í¬ì¸íŠ¸ ìš”ì•½ì„ í•˜ë‚˜ ì‚­ì œí•˜ê³  ëŒ€í™”ì²´/Q&A í˜•ì‹ìœ¼ë¡œ ë³€ê²½
âœ… ì¶œì²˜ ì–¸ê¸‰ì„ 'ìµœê·¼ ì§€ì¹¨ì— ë”°ë¥´ë©´' ì •ë„ë¡œ ìžì—°ìŠ¤ëŸ½ê²Œ ë…¹ì´ê¸°
âœ… êµ¬ì²´ì  ì—°ë„ ì‚­ì œ â†’ 'ìµœê·¼', 'ì´ë²ˆ ê²¨ìš¸' ë“±ìœ¼ë¡œ ëŒ€ì²´ (â€» ì°¸ê³ : í˜„ìž¬ ì—°ë„ëŠ” ${currentYear}ë…„)

**issuesì— ì‹¤ì œ ë¬¸ì œê°€ ë˜ëŠ” ë¬¸ìž¥/íŒ¨í„´ì„ êµ¬ì²´ì ìœ¼ë¡œ ì ì–´ì£¼ì„¸ìš”!**
ì˜ˆ: "~ìˆ˜ ìžˆìŠµë‹ˆë‹¤"ê°€ 3ë²ˆ ì—°ì† ë‚˜ì˜´ (ë¬¸ë‹¨ 2)", "ëª¨ë“  ë¬¸ìž¥ì´ 'ìš”ì¦˜'ìœ¼ë¡œ ì‹œìž‘"

---
â‘¡ íŒë‹¨ ë‹¨ì •í˜• ê¸€ì“°ê¸° (0~20ì )
---
ì²´í¬ í¬ì¸íŠ¸:
â€¢ í•œ ë¬¸ë‹¨ì— ì¡°ê±´/ê°€ëŠ¥ì„± ì¢…ê²° 3íšŒ ì´ìƒ ("~ì¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤" ì§‘ì¤‘) â†’ +8ì 
â€¢ ëª…í™•í•œ ê¸°ì¤€ ì—†ì´ "í™•ì¸ í•„ìš”"ë§Œ ë°˜ë³µ â†’ +7ì 
â€¢ ê¸€ ì „ì²´ì—ì„œ ì €ìž ì˜ê²¬/íŒë‹¨ 0íšŒ â†’ +5ì 
â€¢ 'ë‹¨ì •í•˜ê¸° ì–´ë µê³ ', 'ì˜¤í•´ê°€ ìƒê¸°ê¸° ì‰½ìŠµë‹ˆë‹¤' ë“± íšŒí”¼í˜• ë°˜ë³µ â†’ +4ì 

**ìˆ˜ì • ë°©í–¥ (ì˜ë£Œê´‘ê³ ë²• ì¤€ìˆ˜!):**
âœ… 'ë‹¨ì •í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤' â†’ 'ì´ëŸ° ê²½ìš°ì—” ë‹¤ë¥¸ ì›ì¸ë„ ìƒê°í•´ë³¼ ìˆ˜ ìžˆì–´ìš”'
âœ… '~ë– ì˜¬ë¦¬ê²Œ ë©ë‹ˆë‹¤' â†’ 'í•œë²ˆ ì²´í¬í•´ë³´ì‹œëŠ” ê²Œ ì¢‹ê² ì–´ìš”'
âœ… ê°€ëŠ¥ì„± ë‚˜ì—´ â†’ 'ì´ íŒ¨í„´ì´ ë°˜ë³µë˜ë©´ í™•ì¸ì´ í•„ìš”í•œ ì‹œì ì´ì—ìš”'
âš ï¸ ì£¼ì˜: "~ì´ë©´ OOë³‘ìž…ë‹ˆë‹¤" ê°™ì€ ì§ˆë³‘ ë‹¨ì •ì€ ì ˆëŒ€ ê¸ˆì§€!

---
â‘¢ í˜„ìž¥ê° ë¶€ìž¬ (0~20ì )
---
ì²´í¬ í¬ì¸íŠ¸:
â€¢ ì‹œê°„/ê³„ì ˆ/ìƒí™© ë§¥ë½ ì „ë¬´ â†’ +7ì 
â€¢ ì‹¤ì œ ì§ˆë¬¸/ê³ ë¯¼ ì‹œë‚˜ë¦¬ì˜¤ ì—†ìŒ â†’ +7ì 
â€¢ êµ¬ì²´ì  ì—°ë„/ë‚ ì§œ(${currentYear - 1}ë…„, ${currentYear}ë…„ 10ì›” ë“±) ì‚½ìž…ìœ¼ë¡œ ì´ì§ˆê° â†’ +5ì 
â€¢ 3ì¸ì¹­ ê´€ì°°ìž('ë§Žì€ ë¶„ë“¤ì´', 'ì–´ë–¤ ë¶„ë“¤ì€') ì‹œì ë§Œ ì¡´ìž¬ â†’ +4ì 

**ìˆ˜ì • ë°©í–¥:**
âœ… ì—°ë„/ë‚ ì§œ ì‚­ì œ â†’ 'ìµœê·¼ ìœ í–‰í•˜ëŠ”', 'ì´ë²ˆ ê²¨ìš¸ì—ëŠ”'ìœ¼ë¡œ ëŒ€ì²´
âœ… êµ¬ì²´ì  ìƒí™© ë¬˜ì‚¬ ì¶”ê°€ (ì˜ˆ: 'íšŒì˜ ì¤‘ì— ê¸°ì¹¨ì´ í„°ì ¸ì„œ ê³¤ëž€í–ˆë˜ ì ')
âœ… ê¸°ê´€ëª…(ê±´ê°•ë³´í—˜ì‹¬ì‚¬í‰ê°€ì› ë“±)ì„ ìžì—°ìŠ¤ëŸ½ê²Œ ìˆœí™”

---
â‘£ í…œí”Œë¦¿ êµ¬ì¡° (0~15ì )
---
ì²´í¬ í¬ì¸íŠ¸:
â€¢ ì •ì˜â†’ì›ì¸â†’ì¦ìƒâ†’ì¹˜ë£Œ ìˆœì„œ ê·¸ëŒ€ë¡œ â†’ +6ì 
â€¢ ë…ìž ìžê°€ ì²´í¬ í¬ì¸íŠ¸ ì—†ìŒ â†’ +5ì 
â€¢ ë¬¸ë‹¨ ê°„ ì „í™˜ì–´ ì—†ì´ ë‚˜ì—´ë§Œ â†’ +4ì 
â€¢ 'ì„œë¡ -ë³¸ë¡ 1(ë¬¸ë‹¨+ë¦¬ìŠ¤íŠ¸)-ë³¸ë¡ 2(ë¬¸ë‹¨+ë¦¬ìŠ¤íŠ¸)-ê²°ë¡ -CTA' ì „í˜•ì  êµ¬ì¡° â†’ +4ì 
â€¢ ì†Œì œëª©ì— ì´ëª¨ì§€(ðŸŽ¯, ðŸ“Œ, âš ï¸, âœ…) ì •í˜•í™” íŒ¨í„´ â†’ +3ì 

**ìˆ˜ì • ë°©í–¥:**
âœ… ë³¸ë¡  ì¤‘ í•œ ë¶€ë¶„ì€ ë¦¬ìŠ¤íŠ¸ ì—†ì´ ì¤„ê¸€ë¡œë§Œ ì„œìˆ 
âœ… ì†Œì œëª© ì´ëª¨ì§€ ì œê±°í•˜ê±°ë‚˜ ì§ˆë¬¸í˜•('ê°ê¸°ì¼ê¹Œìš”?')ìœ¼ë¡œ ë³€ê²½
âœ… ê²°ë¡  ë¬¸ë‹¨ ì‚­ì œí•˜ê³  CTAì— í•µì‹¬ ë©”ì‹œì§€ í†µí•©

---
â‘¤ ê°€ì§œ ê³µê° (0~10ì )
---
ì²´í¬ í¬ì¸íŠ¸:
â€¢ "ê±±ì •ë˜ì‹¤ ìˆ˜ ìžˆìŠµë‹ˆë‹¤" ë¥˜ ë²”ìš© ê³µê°ë§Œ ì¡´ìž¬ â†’ +4ì 
â€¢ êµ¬ì²´ì  ìƒí™©Â·ê°ì • ì§€ëª© ì—†ìŒ â†’ +3ì 
â€¢ ê³µê° ë¬¸ìž¥ì´ í•­ìƒ ë¬¸ë‹¨ ì²« ì¤„ì—ë§Œ ìœ„ì¹˜ â†’ +3ì 
â€¢ 'ì°¸ ì• ë§¤í•˜ê²Œ ì‹œìž‘ë  ë•Œê°€ ë§Žì•„ìš”' ê°™ì€ ë²”ìš©ì  ë©˜íŠ¸ â†’ +2ì 

**ìˆ˜ì • ë°©í–¥:**
âœ… 'ì• ë§¤í•˜ì£ ?' â†’ 'ìžê³  ì¼ì–´ë‚¬ëŠ”ë° ì¹¨ ì‚¼í‚¤ê¸°ê°€ ë¬´ì„­ë‹¤ë©´' (êµ¬ì²´ì  ê³ í†µ)
âœ… ê°ê¸° ê±¸ë ¸ì„ ë•Œì˜ ì§œì¦ë‚˜ëŠ” ê°ì • ì–¸ê¸‰ (ì¼ ëŠ¥ë¥  ì €í•˜, ì•½ ê¸°ìš´ ëª½ë¡±í•¨ ë“±)

---
â‘¥ í–‰ë™ ìœ ë„ ì‹¤íŒ¨ (0~10ì )
---
ì²´í¬ í¬ì¸íŠ¸:
â€¢ ë§¤ë²ˆ ë™ì¼í•œ CTA ë¬¸êµ¬ë¡œ ì¢…ê²° â†’ +4ì 
â€¢ ì‹œì Â·ì¡°ê±´ ì—†ëŠ” ë§‰ì—°í•œ ê¶Œìœ  â†’ +3ì 
â€¢ ë…ìž ìƒí™©ë³„ ë¶„ê¸° ì—†ìŒ â†’ +3ì 
â€¢ 'ìžê°€ íŒë‹¨ìœ¼ë¡œëŠ” ì •ë¦¬ê°€ ì•ˆ ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤' ê°™ì€ í–‰ë™ ìœ ë³´ â†’ +3ì 

**ìˆ˜ì • ë°©í–¥ (ì˜ë£Œê´‘ê³ ë²• ì¤€ìˆ˜!):**
âœ… 'í™•ì¸' ëŒ€ì‹  êµ¬ì²´ì  í–‰ë™ ê¶Œìœ : 'ì²´ì˜¨ ìž¬ë³´ê¸°', 'ìˆ˜ë¶„ ì„­ì·¨ ëŠ˜ë¦¬ê¸°'
âœ… ì‹œì  ì¡°ê±´ ì¶”ê°€: 'ë©°ì¹ ì§¸ ì§€ì†ëœë‹¤ë©´ ì‚´íŽ´ë³´ëŠ” ê²ƒë„ ë°©ë²•ì´ì—ìš”'
âœ… 'í™•ì¸' í‘œí˜„ ë°˜ë³µ ì™„í™” (ì˜ë£Œê¸°ê´€ ìœ ë„ ëŠë‚Œ ìµœì†Œí™”):
   âŒ "í™•ì¸í•´ë³´ì„¸ìš”", "í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤" ë°˜ë³µ
   âŒ "ê¸°ì¤€ì„ ì„¸ìš°ë‹¤", "ê¸°ì¤€ì„ ë§ˆë ¨í•˜ë‹¤", "íŒë‹¨ì´ ì •ë¦¬ë˜ë‹¤" (ì¶”ìƒ ëª…ì‚¬ ì—°ê²° ê¸ˆì§€)
   âœ… "ìƒí™©ì„ í•œ ë²ˆ ì •ë¦¬í•´ë³´ëŠ” ê²ƒë„ ë„ì›€ì´ ë©ë‹ˆë‹¤"
   âœ… "íë¦„ì„ í•œ ë²ˆ ì •ë¦¬í•´ë³¼ ì‹œì ì¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤"
   âœ… "ì ê²€í•´ë³´ëŠ” ê²ƒë„ ë°©ë²•ì´ì—ìš”"
   â€» 'í™•ì¸' ëŒ€ì²´ì–´: ì •ë¦¬, ì ê²€, ì‚´íŽ´ë³´ê¸°, íë¦„ íŒŒì•…, ì²´í¬
âš ï¸ ì£¼ì˜: "ë°”ë¡œ OOê³¼ ê°€ì„¸ìš”" ê°™ì€ ì§ì ‘ì  ë³‘ì› ë°©ë¬¸ ê¶Œìœ ëŠ” ì ˆëŒ€ ê¸ˆì§€!

[ì¤‘ìš”]
âš ï¸ ë¶„ì„ ì‹œ ì£¼ì˜ì‚¬í•­
[ì¤‘ìš”]

1. **issues**ì—ëŠ” ì‹¤ì œ ê¸€ì—ì„œ ë°œê²¬ëœ êµ¬ì²´ì ì¸ ë¬¸ì œì ì„ ì ì–´ì£¼ì„¸ìš”
   - âŒ "ë¬¸ìž¥ ë¦¬ë“¬ì´ ë‹¨ì¡°ë¡œì›€" (ë„ˆë¬´ ì¼ë°˜ì )
   - âœ… "'~ìˆ˜ ìžˆìŠµë‹ˆë‹¤'ê°€ 2ë¬¸ë‹¨ì—ì„œ 4ë²ˆ ì—°ì† ì‚¬ìš©ë¨" (êµ¬ì²´ì )

2. **fix_suggestions**ì—ëŠ” ë°”ë¡œ ì ìš©í•  ìˆ˜ ìžˆëŠ” ìˆ˜ì • ì œì•ˆì„ ì ì–´ì£¼ì„¸ìš”
   - âŒ "ë¬¸ìž¥ì„ ë‹¤ì–‘í•˜ê²Œ ì¨ë¼" (ë„ˆë¬´ ì¼ë°˜ì )
   - âœ… "2ë¬¸ë‹¨ 3ë²ˆì§¸ '~ìˆ˜ ìžˆìŠµë‹ˆë‹¤'ë¥¼ '~ì¸ ê²½ìš°ë„ ìžˆë”ë¼ê³ ìš”'ë¡œ ë³€ê²½" (êµ¬ì²´ì )
   - ðŸš¨ ì˜ë£Œê´‘ê³ ë²• ìœ„ë°˜ í‘œí˜„(ì§ˆë³‘ ë‹¨ì •, ë³‘ì› ë°©ë¬¸ ê¶Œìœ )ì€ ì ˆëŒ€ í¬í•¨ ê¸ˆì§€!

3. **priority_fixes**ì—ëŠ” ê°€ìž¥ ì ìˆ˜ê°€ ë†’ì€ í•­ëª©ë¶€í„° ìš°ì„  ìˆ˜ì • ì‚¬í•­ì„ ì ì–´ì£¼ì„¸ìš”

JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µí•´ì£¼ì„¸ìš”.`;

  try {
    // ðŸš€ íƒ€ìž„ì•„ì›ƒ ì¶”ê°€ (30ì´ˆ) - AI ëƒ„ìƒˆ ë¶„ì„ì´ ë¬´í•œ ëŒ€ê¸°í•˜ëŠ” ê²ƒ ë°©ì§€
    const ANALYSIS_TIMEOUT = 30000;
    
    const analysisPromise = ai.models.generateContent({
      model: 'gemini-3-pro-preview',
      contents: prompt,
      config: {
        responseMimeType: "application/json",
        responseSchema: {
          type: Type.OBJECT,
          properties: {
            total_score: { type: Type.INTEGER },
            sentence_rhythm: {
              type: Type.OBJECT,
              properties: {
                score: { type: Type.INTEGER },
                issues: { type: Type.ARRAY, items: { type: Type.STRING } },
                fix_suggestions: { type: Type.ARRAY, items: { type: Type.STRING } }
              },
              required: ["score", "issues", "fix_suggestions"]
            },
            judgment_avoidance: {
              type: Type.OBJECT,
              properties: {
                score: { type: Type.INTEGER },
                issues: { type: Type.ARRAY, items: { type: Type.STRING } },
                fix_suggestions: { type: Type.ARRAY, items: { type: Type.STRING } }
              },
              required: ["score", "issues", "fix_suggestions"]
            },
            lack_of_realism: {
              type: Type.OBJECT,
              properties: {
                score: { type: Type.INTEGER },
                issues: { type: Type.ARRAY, items: { type: Type.STRING } },
                fix_suggestions: { type: Type.ARRAY, items: { type: Type.STRING } }
              },
              required: ["score", "issues", "fix_suggestions"]
            },
            template_structure: {
              type: Type.OBJECT,
              properties: {
                score: { type: Type.INTEGER },
                issues: { type: Type.ARRAY, items: { type: Type.STRING } },
                fix_suggestions: { type: Type.ARRAY, items: { type: Type.STRING } }
              },
              required: ["score", "issues", "fix_suggestions"]
            },
            fake_empathy: {
              type: Type.OBJECT,
              properties: {
                score: { type: Type.INTEGER },
                issues: { type: Type.ARRAY, items: { type: Type.STRING } },
                fix_suggestions: { type: Type.ARRAY, items: { type: Type.STRING } }
              },
              required: ["score", "issues", "fix_suggestions"]
            },
            cta_failure: {
              type: Type.OBJECT,
              properties: {
                score: { type: Type.INTEGER },
                issues: { type: Type.ARRAY, items: { type: Type.STRING } },
                fix_suggestions: { type: Type.ARRAY, items: { type: Type.STRING } }
              },
              required: ["score", "issues", "fix_suggestions"]
            },
            priority_fixes: {
              type: Type.ARRAY,
              items: { type: Type.STRING },
              description: "ìš°ì„  ìˆ˜ì •í•´ì•¼ í•  í•­ëª© (ì ìˆ˜ ë†’ì€ ìˆœ)"
            }
          },
          required: ["total_score", "sentence_rhythm", "judgment_avoidance", "lack_of_realism", "template_structure", "fake_empathy", "cta_failure", "priority_fixes"]
        }
      }
    });
    
    const timeoutPromise = new Promise<never>((_, reject) => {
      setTimeout(() => reject(new Error('AI ëƒ„ìƒˆ ë¶„ì„ íƒ€ìž„ì•„ì›ƒ (30ì´ˆ)')), ANALYSIS_TIMEOUT);
    });
    
    const response = await Promise.race([analysisPromise, timeoutPromise]);
    
    const result = JSON.parse(response.text || "{}");
    
    // ì´ì  ìž¬ê³„ì‚°
    const calculatedTotal = 
      (result.sentence_rhythm?.score || 0) +
      (result.judgment_avoidance?.score || 0) +
      (result.lack_of_realism?.score || 0) +
      (result.template_structure?.score || 0) +
      (result.fake_empathy?.score || 0) +
      (result.cta_failure?.score || 0);
    
    result.total_score = calculatedTotal;
    
    console.log('ðŸ¤– AI ëƒ„ìƒˆ ë¶„ì„ ì™„ë£Œ:', result.total_score, 'ì ');
    return result;
  } catch (error) {
    console.error('AI ëƒ„ìƒˆ ë¶„ì„ ì‹¤íŒ¨:', error);
    return {
      total_score: 0,
      sentence_rhythm: { score: 0, issues: ['ë¶„ì„ ì‹¤íŒ¨'], fix_suggestions: [] },
      judgment_avoidance: { score: 0, issues: ['ë¶„ì„ ì‹¤íŒ¨'], fix_suggestions: [] },
      lack_of_realism: { score: 0, issues: ['ë¶„ì„ ì‹¤íŒ¨'], fix_suggestions: [] },
      template_structure: { score: 0, issues: ['ë¶„ì„ ì‹¤íŒ¨'], fix_suggestions: [] },
      fake_empathy: { score: 0, issues: ['ë¶„ì„ ì‹¤íŒ¨'], fix_suggestions: [] },
      cta_failure: { score: 0, issues: ['ë¶„ì„ ì‹¤íŒ¨'], fix_suggestions: [] },
      priority_fixes: ['AI ëƒ„ìƒˆ ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.']
    };
  }
};

// AI ëƒ„ìƒˆ ìž¬ê²€ì‚¬ í•¨ìˆ˜ (ìˆ˜ë™ ìž¬ìƒì„± í›„ ì‚¬ìš©)
export const recheckAiSmell = async (htmlContent: string): Promise<FactCheckReport> => {
  console.log('ðŸ”„ AI ëƒ„ìƒˆ ìž¬ê²€ì‚¬ ì‹œìž‘...');
  const ai = getAiClient();
  
  // HTMLì—ì„œ í…ìŠ¤íŠ¸ë§Œ ì¶”ì¶œ
  const tempDiv = document.createElement('div');
  tempDiv.innerHTML = htmlContent;
  const textContent = tempDiv.textContent || tempDiv.innerText || '';
  
  const prompt = `
ë‹¹ì‹ ì€ ì˜ë£Œ ë¸”ë¡œê·¸ ì½˜í…ì¸  í’ˆì§ˆ ê²€ì‚¬ ì „ë¬¸ê°€ìž…ë‹ˆë‹¤.
ì•„ëž˜ ë¸”ë¡œê·¸ ê¸€ì„ ë¶„ì„í•˜ì—¬ íŒ©íŠ¸ ì²´í¬ ë¦¬í¬íŠ¸ë¥¼ ìž‘ì„±í•´ì£¼ì„¸ìš”.

[ê²€ì‚¬ ëŒ€ìƒ ê¸€]
${textContent}

[ê²€ì‚¬ í•­ëª©]

1. **íŒ©íŠ¸ ì •í™•ì„± (fact_score)**: 0~100ì 
- ì˜í•™ì ìœ¼ë¡œ ê²€ì¦ëœ ì •ë³´ì¸ê°€?
- ì¶œì²˜ê°€ ëª…í™•í•œê°€?
- ê³¼ìž¥ë˜ê±°ë‚˜ ìž˜ëª»ëœ ì •ë³´ëŠ” ì—†ëŠ”ê°€?

2. **ì˜ë£Œë²• ì•ˆì „ì„± (safety_score)**: 0~100ì 
- ì¹˜ë£Œ íš¨ê³¼ë¥¼ ë‹¨ì •í•˜ì§€ ì•ŠëŠ”ê°€?
- ë³‘ì› ë°©ë¬¸ì„ ì§ì ‘ ê¶Œìœ í•˜ì§€ ì•ŠëŠ”ê°€?
- ìžê°€ ì§„ë‹¨ì„ ìœ ë„í•˜ì§€ ì•ŠëŠ”ê°€?

3. **ì „í™˜ë ¥ ì ìˆ˜ (conversion_score)**: 0~100ì 
- ì˜ë£Œë²•ì„ ì¤€ìˆ˜í•˜ë©´ì„œë„ ìžì—°ìŠ¤ëŸ½ê²Œ í–‰ë™ì„ ìœ ë„í•˜ëŠ”ê°€?
- CTAê°€ ê°•ìš”ê°€ ì•„ë‹Œ ì œì•ˆ í˜•íƒœì¸ê°€?

**4. AI ëƒ„ìƒˆ ì ìˆ˜ (ai_smell_score)**: 0~100ì  (ë‚®ì„ìˆ˜ë¡ ì¢‹ìŒ)
- ë¬¸ìž¥ ë¦¬ë“¬ì´ ë‹¨ì¡°ë¡œìš´ê°€? (0~25ì )
- íŒë‹¨ ë‹¨ì •í˜• ê¸€ì“°ê¸°ê°€ ë°˜ë³µë˜ëŠ”ê°€? (0~20ì )
- í˜„ìž¥ê°ì´ ë¶€ì¡±í•œê°€? (0~20ì )
- í…œí”Œë¦¿ êµ¬ì¡°ê°€ ëšœë ·í•œê°€? (0~15ì )
- ê°€ì§œ ê³µê° í‘œí˜„ì´ ìžˆëŠ”ê°€? (0~10ì )
- í–‰ë™ ìœ ë„ê°€ ì‹¤íŒ¨í–ˆëŠ”ê°€? (0~10ì )

**AI ëƒ„ìƒˆ ì ìˆ˜ ê³„ì‚°:**
= ë¬¸ìž¥ ë¦¬ë“¬(25) + íŒë‹¨ ë‹¨ì •(20) + í˜„ìž¥ê° ë¶€ìž¬(20) + í…œí”Œë¦¿ êµ¬ì¡°(15) + ê°€ì§œ ê³µê°(10) + CTA ì‹¤íŒ¨(10)

**í‰ê°€ ê¸°ì¤€:**
- 0~20ì : ì‚¬ëžŒ ê¸€ ìˆ˜ì¤€ âœ…
- 21~40ì : ê²½ê³„ì„  (ë¶€ë¶„ ìˆ˜ì • ê¶Œìž¥) âš ï¸
- 41ì  ì´ìƒ: AI ëƒ„ìƒˆ ê°•í•¨ (ìž¬ìž‘ì„± í•„ìš”) âŒ

5. **ê²€ì¦ëœ íŒ©íŠ¸ ê°œìˆ˜ (verified_facts_count)**: ìˆ«ìž
- ê¸€ì—ì„œ ê²€ì¦ ê°€ëŠ¥í•œ ì˜í•™ ì •ë³´ì˜ ê°œìˆ˜

6. **ë¬¸ì œì  (issues)**: ë°°ì—´
- ë°œê²¬ëœ ë¬¸ì œì ë“¤ì„ êµ¬ì²´ì ìœ¼ë¡œ ë‚˜ì—´

7. **ê°œì„  ì œì•ˆ (recommendations)**: ë°°ì—´
- êµ¬ì²´ì ì¸ ê°œì„  ë°©ë²• ì œì•ˆ

JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µí•´ì£¼ì„¸ìš”.`;

  try {
    const response = await ai.models.generateContent({
      model: 'gemini-3-pro-preview',
      contents: prompt,
      config: {
        responseMimeType: "application/json",
        responseSchema: {
          type: Type.OBJECT,
          properties: {
            fact_check: {
              type: Type.OBJECT,
              properties: {
                fact_score: { type: Type.INTEGER },
                verified_facts_count: { type: Type.INTEGER },
                safety_score: { type: Type.INTEGER },
                conversion_score: { type: Type.INTEGER },
                ai_smell_score: { type: Type.INTEGER },
                issues: {
                  type: Type.ARRAY,
                  items: { type: Type.STRING }
                },
                recommendations: {
                  type: Type.ARRAY,
                  items: { type: Type.STRING }
                }
              },
              required: ["fact_score", "safety_score", "conversion_score", "ai_smell_score", "verified_facts_count", "issues", "recommendations"]
            }
          },
          required: ["fact_check"]
        }
      }
    });
    
    const result = JSON.parse(response.text || "{}");
    console.log('âœ… AI ëƒ„ìƒˆ ìž¬ê²€ì‚¬ ì™„ë£Œ:', result.fact_check);
    
    // AI ëƒ„ìƒˆ ìƒì„¸ ë¶„ì„ ì¶”ê°€ (ëª¨ë“  ì ìˆ˜ì—ì„œ ìƒì„¸ ë¶„ì„ ì œê³µ)
    const aiSmellScore = result.fact_check.ai_smell_score || 0;
    console.log(`â€¢ AI ëƒ„ìƒˆ ì ìˆ˜: ${aiSmellScore}ì  - ìƒì„¸ ë¶„ì„ ì‹œìž‘...`);
    try {
      const detailedAnalysis = await analyzeAiSmell(textContent, '');
      result.fact_check.ai_smell_analysis = detailedAnalysis;
      console.log('âœ… AI ëƒ„ìƒˆ ìƒì„¸ ë¶„ì„ ì™„ë£Œ:', detailedAnalysis.total_score, 'ì ');
    } catch (analysisError) {
      console.error('âš ï¸ AI ëƒ„ìƒˆ ìƒì„¸ ë¶„ì„ ì‹¤íŒ¨:', analysisError);
      // ìƒì„¸ ë¶„ì„ ì‹¤íŒ¨í•´ë„ ê¸°ë³¸ ê²°ê³¼ëŠ” ë°˜í™˜
    }
    
    return result.fact_check;
  } catch (error) {
    console.error('âŒ AI ëƒ„ìƒˆ ìž¬ê²€ì‚¬ ì‹¤íŒ¨:', error);
    throw new Error('AI ëƒ„ìƒˆ ìž¬ê²€ì‚¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
  }
};

