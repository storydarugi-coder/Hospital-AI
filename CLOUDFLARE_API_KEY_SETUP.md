═══════════════════════════════════════════════════════════
🎯 문제 해결: Cloudflare Pages에 API 키 설정
═══════════════════════════════════════════════════════════

📊 현재 상황:
- ✅ 로컬 빌드: 새 API 키 포함됨
- ❌ 프로덕션: 이전 API 키가 사용됨 (...Hd0SLSiI)

💡 이유:
Cloudflare Pages는 자체 빌드 시스템을 사용하므로
로컬 .env.local 파일이 아닌 Cloudflare 환경 변수를 읽습니다!

═══════════════════════════════════════════════════════════
🚀 해결 방법: Cloudflare 대시보드에서 환경 변수 설정
═══════════════════════════════════════════════════════════

1️⃣ Cloudflare Dashboard 접속
   👉 https://dash.cloudflare.com/

2️⃣ 프로젝트 선택
   - 좌측 메뉴: Workers & Pages
   - 프로젝트 클릭: hospital-ai

3️⃣ 환경 변수 설정
   - 상단 탭: Settings
   - 좌측 메뉴: Environment variables
   
4️⃣ API 키 추가/수정
   
   기존 키가 있는 경우:
   - VITE_GEMINI_API_KEY 찾기
   - 우측 "Edit" 버튼 클릭
   - Value 변경: AIzaSyDOVqA7HP5yRZWalhEu12ECrhqP2R3cetg
   - "Save" 클릭
   
   새로 추가하는 경우:
   - "Add variables" 버튼 클릭
   - Variable name: VITE_GEMINI_API_KEY
   - Value: AIzaSyDOVqA7HP5yRZWalhEu12ECrhqP2R3cetg
   - Environment: Production ✅ (체크)
   - "Save" 클릭

5️⃣ 재배포 (필수!)
   
   옵션 A - 수동 재배포:
   - 상단 탭: Deployments
   - 최신 배포 찾기
   - 우측 "⋯" 메뉴 클릭
   - "Retry deployment" 선택
   - 빌드 완료 대기 (~2-3분)
   
   옵션 B - 자동 재배포 (더미 커밋):
   - 이미 푸시되었으므로 자동 배포 시작됨!
   - Deployments 탭에서 진행 상황 확인

6️⃣ 확인
   - 배포 완료 후: https://story-darugi.com 접속
   - F12 → Console 탭
   - 로그 확인:
     📊 API 키 상태:
       키 1: ...2R3cetg - ✅ 사용 가능
   
   ✅ 성공: ...2R3cetg (새 키)
   ❌ 실패: ...Hd0SLSiI (이전 키) → 4~5단계 다시 확인

═══════════════════════════════════════════════════════════
⚠️ 중요 참고사항
═══════════════════════════════════════════════════════════

1. 로컬 환경 vs 프로덕션:
   ✅ 로컬: .env.local 파일 사용 (이미 설정됨)
   ✅ 프로덕션: Cloudflare 환경 변수 사용 (설정 필요!)

2. 환경 변수 변경 후:
   - 반드시 재배포 필요!
   - 환경 변수만 저장하고 재배포 안 하면 적용 안 됨

3. 빌드 시간:
   - 보통 2-3분 소요
   - Deployments 탭에서 실시간 로그 확인 가능

4. 캐시 문제:
   - 브라우저 캐시 때문에 이전 키가 보일 수 있음
   - Ctrl+Shift+R (강제 새로고침) 시도
   - 또는 시크릿 모드에서 테스트

═══════════════════════════════════════════════════════════
📚 관련 문서
═══════════════════════════════════════════════════════════

- GOOGLE_API_KEY_SETUP.md ← 전체 설정 가이드 (업데이트됨)
- QUICK_API_KEY_UPDATE.md ← 로컬/브라우저 설정
- API_KEY_FAQ.md ← 문제 해결

═══════════════════════════════════════════════════════════
🔐 보안 참고
═══════════════════════════════════════════════════════════

✅ Cloudflare 환경 변수는 암호화되어 저장됩니다
✅ Git에 커밋되지 않습니다
✅ 프로덕션 환경에서 안전하게 사용 가능합니다

❌ 빌드 로그에 API 키가 노출될 수 있으므로 주의!
   (Cloudflare는 빌드 로그를 비공개로 관리)

═══════════════════════════════════════════════════════════
