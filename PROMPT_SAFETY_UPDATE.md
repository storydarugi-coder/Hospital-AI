# 프롬프트 의료광고법 안전성 강화 업데이트

## 📋 변경 개요
프롬프트 파일 간 중복/상충 규칙을 정리하고, **의료광고법 기준으로 가장 엄격한 안전 규칙**으로 통일했습니다.

## 🔴 주요 변경사항

### 1. 의료 판단 유도 표현 **절대 금지** (P1 - 즉시 탈락)
**변경 전:**
- "의심" - 3회까지 허용
- "판단" - 2회까지 허용
- "가능성" - 3회까지 허용

**변경 후 (엄격화):**
```
의심 | 판단 | 가능성 | 진단 | 체크 | 구분 | 차이 | 여부
→ 모두 1회도 사용 금지!
```

**대체 표현:**
- "의심" → "살펴볼 필요가 있는", "확인해볼 만한", "주의가 필요한"
- "판단" → "확인", "파악", "살펴보기"
- "가능성" → "경우가 있다", "상황이 있다", "언급되곤 한다"
- "체크" → "확인", "살펴보기"

### 2. 기관명(연도) 형식 절대 금지 추가
**새롭게 추가된 금지 규칙:**
```
❌ 기관명(연도) 형식 절대 금지!
  - "질병관리청(2024)" ❌
  - "대한OO학회(2025)" ❌
  - "보건복지부(2026)" ❌
```

**대체 표현:**
- "질병관리청(2024)에 따르면" → "최근 지침에 따르면"
- "대한OO학회(2025)" → "전문가들은", "의료계에서는"

### 3. 환자/내원 표현 지양 규칙 명시
**새롭게 추가:**
```
❌ 환자, 환자분들, 내원 → 모두 0개

✅ 대체 표현:
- "환자" → "~를 겪는 분", "~로 고민하는 분"
- "내원" → "병원을 방문하는 분", "진료를 받으러 오는 분"
```

### 4. detectAiSmell 함수 강화
**humanWritingPrompts.ts의 AI 냄새 감지 함수에 의료광고법 위반 표현 감지 추가:**
- "의심" - maxAllowed: 0 (절대 금지)
- "판단" - maxAllowed: 0 (절대 금지)
- "가능성" - maxAllowed: 0 (절대 금지)
- "환자" - maxAllowed: 0
- "내원" - maxAllowed: 0
- 기관명(연도) 형식 - maxAllowed: 0

## 📊 영향 범위

### 1. 수정된 파일
- ✅ `src/lib/gpt52-prompts-staged.ts` - 메인 프롬프트 파일 (SYSTEM_PROMPT, Stage2 체크리스트)
- ✅ `src/utils/humanWritingPrompts.ts` - AI 냄새 감지 함수 강화
- ℹ️ `src/services/geminiService.ts` - 이미 엄격한 규칙 적용 중 (변경 없음)

### 2. 통합된 금지 표현 (최종 버전)
```
[P1 - 절대 금지 (1회도 불가)]
━━━━━━━━━━━━━━━━━━
의심, 판단, 가능성, 진단, 체크, 구분, 차이, 여부
환자, 환자분들, 내원
전문가, 전문의, 명의, 베테랑, 숙련된, 전문, 전문적
기관명(연도) 형식 (예: "질병관리청(2024)")
공공기관명/학회명 언급 (질병관리청, 대한OO학회 등)
모든 구체적 숫자 (%, 연 2~4회, 24시간, 10명 중 3명 등)
물음표(?), 비용/가격, 증상 번호 매기기
```

## ✅ 기대 효과

### 1. 의료광고법 준수율 향상
- ❌ 의심/판단 표현 완전 차단으로 자가진단 유도 방지
- ❌ 기관명(연도) 형식 차단으로 출처 의존 광고 방지
- ❌ 환자/내원 표현 제거로 병원 마케팅 느낌 제거

### 2. 일관성 향상
- 모든 프롬프트 파일이 동일한 기준 적용
- 감지 함수(`detectAiSmell`)도 동일 기준으로 작동

### 3. 리스크 감소
- 가장 엄격한 기준 적용으로 의료광고 관련 민원/신고 가능성 최소화
- 네이버 검색 품질 필터 통과율 향상

## 🔍 테스트 권장사항

### 1. 금지 표현 테스트
```typescript
const testTexts = [
  "이런 증상이 의심됩니다", // ❌ 탈락
  "판단이 필요합니다", // ❌ 탈락
  "가능성을 고려해볼 수 있습니다", // ❌ 탈락
  "질병관리청(2024)에 따르면", // ❌ 탈락
  "환자분들이 많이 찾습니다", // ❌ 탈락
  "내원하시는 분들의 경우", // ❌ 탈락
];

testTexts.forEach(text => {
  const result = detectAiSmell(text);
  console.log(result.detected ? '❌ 탈락' : '✅ 통과');
});
```

### 2. 대체 표현 테스트
```typescript
const safeTexts = [
  "이런 증상이 있다면 살펴볼 필요가 있습니다", // ✅ 안전
  "확인이 도움될 수 있습니다", // ✅ 안전
  "이런 경우가 있는 것으로 알려져 있습니다", // ✅ 안전
  "최근 지침에 따르면", // ✅ 안전
  "~를 겪는 분들이 많습니다", // ✅ 안전
  "병원을 방문하는 분들의 경우", // ✅ 안전
];
```

## 📝 사용자 가이드

### 글 작성 시 주의사항
1. ❌ **절대 사용하지 말 것:**
   - 의심, 판단, 가능성, 체크 등 의료 판단 유도 표현
   - "질병관리청(2024)" 같은 기관명(연도) 형식
   - 환자, 내원 같은 병원 내부 용어

2. ✅ **권장 대체 표현:**
   - "살펴볼 필요가 있는", "확인해볼 만한"
   - "최근 지침에 따르면", "전문가들은"
   - "~를 겪는 분", "병원을 방문하는 분"

## 🚀 다음 단계
- [ ] 테스트 코드 작성 (detectAiSmell 함수 테스트)
- [ ] 실제 글 생성 테스트
- [ ] 사용자 교육 자료 업데이트

---

**작성일:** 2026-01-14
**버전:** v5.14
**담당자:** GenSpark AI Developer
